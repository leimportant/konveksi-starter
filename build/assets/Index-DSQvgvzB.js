import{b as K,r as x,f as fe,H as W,j as u,G as ce,u as F,e as pe,o as ve,g as m,q as n,x as o,y as be,z as a,l as s,B as O,A as d,O as ye,F as g,D as C,k as v,N as xe,I as R,m as T,P as j}from"./app-C0ZtNFPV.js";import{_ as ge}from"./AppLayout.vue_vue_type_script_setup_true_lang-CxyMViV1.js";import{_ as _e}from"./DocumentList.vue_vue_type_script_setup_true_lang-DhWvrvZy.js";import{_ as y}from"./Button.vue_vue_type_script_setup_true_lang-B6TXREVN.js";import{_ as I}from"./Input.vue_vue_type_script_setup_true_lang-BWB1n0oK.js";import{_ as we,a as ke,b as h,c as P,d as Ce,e as U}from"./TableRow.vue_vue_type_script_setup_true_lang-CVJoN5Nr.js";import{u as Pe}from"./useToast-DV2nGitA.js";import{u as Ue}from"./useProductStore-BuBbG374.js";import{u as $e}from"./useCategoryStore-D1VRUF1Z.js";import{u as Me}from"./useUomStore-CL0R-Ai3.js";import{d as Ne}from"./debounce-BcZQbp_F.js";import{P as Se}from"./plus-jsIhsatj.js";import{S as Ve}from"./square-pen-Cj9XWA8y.js";import{T as qe}from"./trash-2-Bt8Dqp-q.js";import{U as Te}from"./upload-ajwxBhJr.js";import"./index-C2dazRLE.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BIT3zfbJ.js";import"./trash-C6WxX6NS.js";const G=K({__name:"QuillEditor",setup(E){const i=x("");return(b,p)=>{const N=fe("QuillEditor",!0);return u(),W(N,{content:i.value,"onUpdate:content":p[0]||(p[0]=_=>i.value=_),theme:"snow",contentType:"html"},null,8,["content"])}}});function je(E,i){const b=document.createElement("div");b.innerHTML=E||"";const p=b.textContent||b.innerText||"";return p.length>i?p.slice(0,i)+"...":p}const Ee={class:"px-4 py-4"},ze={class:"flex justify-between items-center mb-6"},Be={class:"rounded-md border"},De={class:"flex justify-end mt-4 space-x-2"},Fe=["disabled"],Oe=["onClick"],Ie=["disabled"],Ae={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},He={class:"relative bg-white p-6 rounded-lg shadow-xl w-full max-w-sm md:max-w-md lg:max-w-lg xl:max-w-4xl max-h-[90vh] overflow-y-auto"},Qe={class:"flex justify-between items-center mb-4"},Le={class:"mt-4 flex justify-end"},Re={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},he={class:"bg-white p-6 rounded-lg w-[1000px]"},Ge={class:"space-y-4"},Je=["value"],Ke=["value"],We={class:"flex justify-end gap-2 mt-4"},Xe={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Ye={class:"bg-white p-6 rounded-lg w-[1000px]"},Ze={class:"space-y-4"},et=["value"],tt=["value"],ot={class:"flex justify-end gap-2 mt-4"},J=10,wt=K({__name:"Index",setup(E){const i=Pe(),b=x(!1),p=x(!1),N=x(null),_=x(!1),S=x(null),X=x("product"),l=ce({name:"",descriptions:"",category_id:0,uom_id:""}),Y=[{title:"Product",href:"/products"}],w=Ue(),A=$e(),H=Me(),{items:Q,total:Z,loading:ee,filterName:z}=F(w),{items:B}=F(A),{items:D}=F(H),f=x(1),L=x(0),V=pe(()=>Math.ceil(L.value/J)),$=async r=>{await w.fetchProducts(r,J),L.value=Z.value||0,f.value=r};ve(async()=>{await Promise.all([A.fetchCategories(),H.fetchUoms()]),await $(f.value)});const q=async r=>{r<1||r>V.value||await $(r)},te=async()=>{f.value<V.value&&await q(f.value+1)},oe=async()=>{f.value>1&&await q(f.value-1)},se=Ne((r,e)=>{w.setFilter(r,e)},400),le=r=>{const e=r.target;se("name",e.value)},ne=async()=>{var r,e,t,c;if(!l.name)return i.error("Name is required");if(!l.category_id)return i.error("Category is required");if(!l.uom_id)return i.error("UOM is required");try{await w.createProduct({name:l.name,descriptions:l.descriptions,category_id:Number(l.category_id),uom_id:l.uom_id}),i.success("Product created successfully"),l.reset(),b.value=!1,await $(f.value)}catch(k){const M=(c=(t=(e=(r=k==null?void 0:k.response)==null?void 0:r.data)==null?void 0:e.errors)==null?void 0:t.name)==null?void 0:c[0];i.error(M||"Failed to create Product")}},re=r=>{S.value=r,l.name=r.name,l.descriptions=l.descriptions,l.category_id=r.category_id,l.uom_id=r.uom_id,_.value=!0},ae=async()=>{var e,t,c,k;if(!S.value||!l.name)return i.error("Name is required");if(!l.category_id)return i.error("Category is required");if(!l.uom_id)return i.error("UOM is required");const r=S.value.id;try{await w.updateProduct(r,{name:l.name,descriptions:l.descriptions,category_id:l.category_id,uom_id:l.uom_id}),i.success("Product updated successfully"),l.reset(),_.value=!1,S.value=null,await $(f.value)}catch(M){const me=(k=(c=(t=(e=M==null?void 0:M.response)==null?void 0:e.data)==null?void 0:t.errors)==null?void 0:c.name)==null?void 0:k[0];i.error(me||"Failed to update Product")}},ie=async r=>{var e,t;if(confirm("Are you sure you want to delete this Product?"))try{await w.deleteProduct(r),i.success("Product deleted successfully"),Q.value.length===1&&f.value>1?await q(f.value-1):await $(f.value)}catch(c){i.error(((t=(e=c==null?void 0:c.response)==null?void 0:e.data)==null?void 0:t.message)??"Failed to delete Product")}},de=r=>{const e=B.value.find(t=>t.id===r);return(e==null?void 0:e.name)||"N/A"},ue=r=>{const e=D.value.find(t=>t.id===r);return(e==null?void 0:e.name)||"N/A"};return(r,e)=>(u(),m(g,null,[n(o(be),{title:"Product Management"}),n(ge,{breadcrumbs:Y},{default:a(()=>[s("div",Ee,[s("div",ze,[n(o(y),{onClick:e[0]||(e[0]=t=>b.value=!0),class:"bg-indigo-600 text-white py-2 rounded-md hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:a(()=>[n(o(Se),{class:"h-4 w-4"}),e[14]||(e[14]=d(" Add "))]),_:1,__:[14]}),n(o(I),{modelValue:o(z),"onUpdate:modelValue":e[1]||(e[1]=t=>ye(z)?z.value=t:null),placeholder:"Search",onInput:le,class:"w-64","aria-label":"Search",disabled:o(ee)},null,8,["modelValue","disabled"])]),s("div",Be,[n(o(we),null,{default:a(()=>[n(o(ke),null,{default:a(()=>[n(o(h),{class:"bg-gray-100"},{default:a(()=>[n(o(P),null,{default:a(()=>e[15]||(e[15]=[d("ID")])),_:1,__:[15]}),n(o(P),null,{default:a(()=>e[16]||(e[16]=[d("Name")])),_:1,__:[16]}),n(o(P),null,{default:a(()=>e[17]||(e[17]=[d("Category")])),_:1,__:[17]}),n(o(P),null,{default:a(()=>e[18]||(e[18]=[d("UOM")])),_:1,__:[18]}),n(o(P),null,{default:a(()=>e[19]||(e[19]=[d("Descriptions")])),_:1,__:[19]}),n(o(P),{class:"w-24"},{default:a(()=>e[20]||(e[20]=[d("Actions")])),_:1,__:[20]})]),_:1})]),_:1}),n(o(Ce),null,{default:a(()=>[(u(!0),m(g,null,C(o(Q),t=>(u(),W(o(h),{key:t.id},{default:a(()=>[n(o(U),null,{default:a(()=>[d(v(t.id),1)]),_:2},1024),n(o(U),null,{default:a(()=>[d(v(t.name),1)]),_:2},1024),n(o(U),null,{default:a(()=>[d(v(de(t.category_id)),1)]),_:2},1024),n(o(U),null,{default:a(()=>[d(v(ue(t.uom_id)),1)]),_:2},1024),n(o(U),null,{default:a(()=>[d(v(o(je)(t.descriptions,50)),1)]),_:2},1024),n(o(U),{class:"flex gap-2"},{default:a(()=>[n(o(y),{variant:"ghost",size:"icon",onClick:c=>re(t)},{default:a(()=>[n(o(Ve),{class:"h-4 w-4"})]),_:2},1032,["onClick"]),n(o(y),{variant:"ghost",size:"icon",onClick:c=>ie(t.id)},{default:a(()=>[n(o(qe),{class:"h-4 w-4"})]),_:2},1032,["onClick"]),n(o(y),{variant:"ghost",size:"icon",onClick:c=>{p.value=!0,N.value=t.id}},{default:a(()=>[n(o(Te),{class:"h-4 w-4"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),s("div",De,[s("button",{onClick:oe,disabled:f.value===1,class:"px-3 py-1 rounded border border-gray-300 text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed"}," Previous ",8,Fe),(u(!0),m(g,null,C(V.value,t=>(u(),m("button",{key:t,onClick:c=>q(t),class:xe(["px-3 py-1 rounded border text-xs",t===f.value?"bg-blue-600 border-blue-600 text-white":"border-gray-300 text-gray-700 hover:bg-gray-100"])},v(t),11,Oe))),128)),s("button",{onClick:te,disabled:f.value===V.value,class:"px-3 py-1 rounded border border-gray-300 text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed"}," Next ",8,Ie)]),p.value?(u(),m("div",Ae,[s("div",He,[s("div",Qe,[e[22]||(e[22]=s("h2",{class:"text-lg font-semibold"},"Upload Media",-1)),s("button",{onClick:e[2]||(e[2]=t=>p.value=!1),class:"text-gray-500 hover:text-gray-800 transition p-1 rounded-full hover:bg-gray-100","aria-label":"Tutup modal"},e[21]||(e[21]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),n(_e,{"reference-id":N.value,"reference-type":X.value},null,8,["reference-id","reference-type"]),s("div",Le,[n(o(y),{onClick:e[3]||(e[3]=t=>p.value=!1),variant:"outline"},{default:a(()=>e[23]||(e[23]=[d("Tutup")])),_:1,__:[23]})])])])):O("",!0),b.value?(u(),m("div",Re,[s("div",he,[e[32]||(e[32]=s("h2",{class:"text-lg font-semibold mb-4"},"Buat Produk Baru",-1)),s("form",{onSubmit:R(ne,["prevent"])},[s("div",Ge,[s("div",null,[e[25]||(e[25]=s("label",{class:"block text-xs font-medium mb-1"},"Category",-1)),T(s("select",{"onUpdate:modelValue":e[4]||(e[4]=t=>o(l).category_id=t),class:"w-full text-xs rounded-md border border-input px-3 py-2",required:""},[e[24]||(e[24]=s("option",{value:"0"},"Select Category",-1)),(u(!0),m(g,null,C(o(B),t=>(u(),m("option",{key:t.id,value:t.id},v(t.name),9,Je))),128))],512),[[j,o(l).category_id]])]),s("div",null,[e[26]||(e[26]=s("label",{class:"block text-xs font-medium mb-1"},"Name",-1)),n(o(I),{modelValue:o(l).name,"onUpdate:modelValue":e[5]||(e[5]=t=>o(l).name=t),placeholder:"Product Name",class:"text-xs",required:""},null,8,["modelValue"])]),s("div",null,[e[28]||(e[28]=s("label",{class:"block text-xs font-medium mb-1"},"UOM",-1)),T(s("select",{"onUpdate:modelValue":e[6]||(e[6]=t=>o(l).uom_id=t),class:"w-full rounded-md border text-xs border-input px-3 py-2",required:""},[e[27]||(e[27]=s("option",{value:""},"Select UOM",-1)),(u(!0),m(g,null,C(o(D),t=>(u(),m("option",{key:t.id,value:t.id},v(t.name),9,Ke))),128))],512),[[j,o(l).uom_id]])])]),s("div",null,[e[29]||(e[29]=s("label",{class:"block text-xs font-medium mb-1"},"Description",-1)),n(o(G),{content:o(l).descriptions,"onUpdate:content":e[7]||(e[7]=t=>o(l).descriptions=t),contentType:"html",class:"w-full border-input px-3 py-2 border min-h-[50px]"},null,8,["content"])]),s("div",We,[n(o(y),{type:"button",variant:"outline",onClick:e[8]||(e[8]=t=>b.value=!1)},{default:a(()=>e[30]||(e[30]=[d("Cancel")])),_:1,__:[30]}),n(o(y),{type:"submit"},{default:a(()=>e[31]||(e[31]=[d("Create")])),_:1,__:[31]})])],32)])])):O("",!0),_.value?(u(),m("div",Xe,[s("div",Ye,[e[41]||(e[41]=s("h2",{class:"text-lg font-semibold mb-4"},"Edit Product",-1)),s("form",{onSubmit:R(ae,["prevent"])},[s("div",Ze,[s("div",null,[e[34]||(e[34]=s("label",{class:"block text-xs font-medium mb-1"},"Category",-1)),T(s("select",{"onUpdate:modelValue":e[9]||(e[9]=t=>o(l).category_id=t),class:"w-full text-xs rounded-md border border-input px-3 py-2",required:""},[e[33]||(e[33]=s("option",{value:"0"},"Select Category",-1)),(u(!0),m(g,null,C(o(B),t=>(u(),m("option",{key:t.id,value:t.id},v(t.name),9,et))),128))],512),[[j,o(l).category_id]])]),s("div",null,[e[35]||(e[35]=s("label",{class:"block text-xs font-medium mb-1"},"Name",-1)),n(o(I),{modelValue:o(l).name,"onUpdate:modelValue":e[10]||(e[10]=t=>o(l).name=t),placeholder:"Product Name",class:"text-xs",required:""},null,8,["modelValue"])]),s("div",null,[e[37]||(e[37]=s("label",{class:"block text-xs font-medium mb-1"},"UOM",-1)),T(s("select",{"onUpdate:modelValue":e[11]||(e[11]=t=>o(l).uom_id=t),class:"w-full text-xs rounded-md border border-input px-3 py-2",required:""},[e[36]||(e[36]=s("option",{value:""},"Select UOM",-1)),(u(!0),m(g,null,C(o(D),t=>(u(),m("option",{key:t.id,value:t.id},v(t.name),9,tt))),128))],512),[[j,o(l).uom_id]])]),s("div",null,[e[38]||(e[38]=s("label",{class:"block text-xs font-medium mb-1"},"Description",-1)),n(o(G),{content:o(l).descriptions,"onUpdate:content":e[12]||(e[12]=t=>o(l).descriptions=t),contentType:"html",class:"w-full text-xs border-input px-3 py-2 border min-h-[50px]"},null,8,["content"])])]),s("div",ot,[n(o(y),{type:"button",variant:"outline",onClick:e[13]||(e[13]=t=>_.value=!1)},{default:a(()=>e[39]||(e[39]=[d("Cancel")])),_:1,__:[39]}),n(o(y),{type:"submit"},{default:a(()=>e[40]||(e[40]=[d("Update")])),_:1,__:[40]})])],32)])])):O("",!0)])]),_:1})],64))}});export{wt as default};
