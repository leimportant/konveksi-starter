import{d as J,a as w,b as K,r as N,G as Q,u as W,e as X,o as Y,g as y,j as _,q as s,x as t,y as Z,z as o,l as i,B as I,A as f,O as ee,F as P,D as T,H as te,k as q,N as ae,I as U}from"./app-C0ZtNFPV.js";import{_ as se}from"./AppLayout.vue_vue_type_script_setup_true_lang-CxyMViV1.js";import{_ as b}from"./Button.vue_vue_type_script_setup_true_lang-B6TXREVN.js";import{_ as v}from"./Input.vue_vue_type_script_setup_true_lang-BWB1n0oK.js";import{_ as le,a as oe,b as z,c as F,d as re,e as j}from"./TableRow.vue_vue_type_script_setup_true_lang-CVJoN5Nr.js";import{u as de}from"./useToast-DV2nGitA.js";import{P as ie}from"./plus-jsIhsatj.js";import{S as ne}from"./square-pen-Cj9XWA8y.js";import{T as ue}from"./trash-2-Bt8Dqp-q.js";import"./index-C2dazRLE.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BIT3zfbJ.js";const ce=J("sloc",{state:()=>({items:[],total:0,loaded:!1,loading:!1,currentPage:1,lastPage:1,filterName:""}),actions:{async fetchSlocs(m=1,l=10){this.loading=!0;try{const n=await w.get("/api/slocs",{params:{page:m,perPage:l,name:this.filterName}});this.items=n.data.data,this.total=n.data.total,this.currentPage=m,this.lastPage=n.data.last_page||1,this.loaded=!0}catch(n){console.error("Failed to fetch Slocs",n)}},setFilter(m,l){m==="name"&&(this.filterName=l,this.currentPage=1,this.fetchSlocs(1))},async createSloc(m,l){try{await w.post("/api/slocs",{id:m,name:l}),await this.fetchSlocs()}catch(n){throw n}},async updateSloc(m,l){try{await w.put(`/api/slocs/${m}`,{name:l}),await this.fetchSlocs()}catch(n){throw n}},async deleteSloc(m){try{await w.delete(`/api/slocs/${m}`),await this.fetchSlocs()}catch(l){throw l}}}}),me={class:"px-4 py-4"},fe={class:"flex justify-between items-center mb-6"},pe={class:"rounded-md border"},_e={class:"flex justify-end mt-4 space-x-2"},be=["disabled"],ye=["onClick","disabled"],ge=["disabled"],ve={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},he={class:"bg-white p-6 rounded-lg w-96"},Se={class:"mb-4"},we={class:"mb-4"},xe={class:"flex justify-end gap-2"},ke={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Ce={class:"bg-white p-6 rounded-lg w-96"},Ve={class:"mb-4"},$e={class:"mb-4"},Ne={class:"flex justify-end gap-2"},Me=K({__name:"Index",setup(m){const l=de(),n=N(!1),h=N(!1),S=N(null),r=Q({id:"",name:""}),E=[{title:"Sloc",href:"/slocs"}],u=ce(),{items:B,currentPage:g,lastPage:D,loading:x,filterName:k}=W(u),C=X(()=>D.value||1),V=async d=>{d<1||d>C.value||await u.fetchSlocs(d)},M=()=>V(g.value+1),A=()=>V(g.value-1),R=async(d,e)=>{const a=e.target;u.setFilter(d,a.value),await u.fetchSlocs()};Y(()=>{u.fetchSlocs()});const G=async()=>{var d,e,a,c;if(!r.id)return l.error("Id is required");if(!r.name)return l.error("Name is required");try{await u.createSloc(r.id,r.name),l.success("Sloc created successfully"),r.reset(),u.loaded=!1,await u.fetchSlocs(),n.value=!1}catch(p){const $=(c=(a=(e=(d=p==null?void 0:p.response)==null?void 0:d.data)==null?void 0:e.errors)==null?void 0:a.name)==null?void 0:c[0];l.error($||"Failed to create Sloc")}},H=d=>{S.value=d,r.id=d.id,r.name=d.name,h.value=!0},L=async()=>{var d,e,a,c;if(!S.value||!r.name)return l.error("Name is required");try{await u.updateSloc(S.value.id,r.name),l.success("Sloc updated successfully"),r.reset(),u.loaded=!1,await u.fetchSlocs(),h.value=!1,S.value=null}catch(p){const $=(c=(a=(e=(d=p==null?void 0:p.response)==null?void 0:d.data)==null?void 0:e.errors)==null?void 0:a.name)==null?void 0:c[0];l.error($||"Failed to update Sloc")}},O=async d=>{var e,a;if(confirm("Are you sure you want to delete this Sloc?"))try{await u.deleteSloc(d),l.success("Sloc deleted successfully"),u.loaded=!1,await u.fetchSlocs()}catch(c){l.error(((a=(e=c==null?void 0:c.response)==null?void 0:e.data)==null?void 0:a.message)??"Failed to delete Sloc")}};return(d,e)=>(_(),y(P,null,[s(t(Z),{title:"Sloc Management"}),s(se,{breadcrumbs:E},{default:o(()=>[i("div",me,[i("div",fe,[s(t(b),{onClick:e[0]||(e[0]=a=>n.value=!0),class:"bg-indigo-600 text-white py-2 rounded-md hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:o(()=>[s(t(ie),{class:"h-4 w-4"}),e[9]||(e[9]=f(" Add "))]),_:1,__:[9]}),s(t(v),{modelValue:t(k),"onUpdate:modelValue":e[1]||(e[1]=a=>ee(k)?k.value=a:null),placeholder:"Search",onInput:e[2]||(e[2]=a=>R("name",a)),class:"w-64","aria-label":"Search"},null,8,["modelValue"])]),i("div",pe,[s(t(le),null,{default:o(()=>[s(t(oe),null,{default:o(()=>[s(t(z),{class:"bg-gray-100"},{default:o(()=>[s(t(F),null,{default:o(()=>e[10]||(e[10]=[f("Id")])),_:1,__:[10]}),s(t(F),null,{default:o(()=>e[11]||(e[11]=[f("Name")])),_:1,__:[11]}),s(t(F),{class:"w-24"},{default:o(()=>e[12]||(e[12]=[f("Actions")])),_:1,__:[12]})]),_:1})]),_:1}),s(t(re),null,{default:o(()=>[(_(!0),y(P,null,T(t(B),a=>(_(),te(t(z),{key:a.id},{default:o(()=>[s(t(j),null,{default:o(()=>[f(q(a.id),1)]),_:2},1024),s(t(j),null,{default:o(()=>[f(q(a.name),1)]),_:2},1024),s(t(j),{class:"flex gap-2"},{default:o(()=>[s(t(b),{variant:"ghost",size:"icon",onClick:c=>H(a)},{default:o(()=>[s(t(ne),{class:"h-4 w-4"})]),_:2},1032,["onClick"]),s(t(b),{variant:"ghost",size:"icon",onClick:c=>O(a.id)},{default:o(()=>[s(t(ue),{class:"h-4 w-4"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),i("div",_e,[i("button",{onClick:A,disabled:t(g)===1||t(x),class:"px-3 py-1 rounded border border-gray-300 text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed"}," Previous ",8,be),(_(!0),y(P,null,T(C.value,a=>(_(),y("button",{key:a,onClick:c=>V(a),class:ae(["px-3 py-1 rounded border text-sm",a===t(g)?"bg-blue-600 border-blue-600 text-white":"border-gray-300 text-gray-700 hover:bg-gray-100"]),disabled:t(x)},q(a),11,ye))),128)),i("button",{onClick:M,disabled:t(g)===C.value||t(x),class:"px-3 py-1 rounded border border-gray-300 text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed"}," Next ",8,ge)]),n.value?(_(),y("div",ve,[i("div",he,[e[15]||(e[15]=i("h2",{class:"text-lg font-semibold mb-4"},"Tambah Data",-1)),i("form",{onSubmit:U(G,["prevent"])},[i("div",Se,[s(t(v),{modelValue:t(r).id,"onUpdate:modelValue":e[3]||(e[3]=a=>t(r).id=a),placeholder:"Sloc Id",required:""},null,8,["modelValue"])]),i("div",we,[s(t(v),{modelValue:t(r).name,"onUpdate:modelValue":e[4]||(e[4]=a=>t(r).name=a),placeholder:"Sloc Name",required:""},null,8,["modelValue"])]),i("div",xe,[s(t(b),{type:"button",variant:"outline",onClick:e[5]||(e[5]=a=>n.value=!1)},{default:o(()=>e[13]||(e[13]=[f("Cancel")])),_:1,__:[13]}),s(t(b),{type:"submit"},{default:o(()=>e[14]||(e[14]=[f("Create")])),_:1,__:[14]})])],32)])])):I("",!0),h.value?(_(),y("div",ke,[i("div",Ce,[e[18]||(e[18]=i("h2",{class:"text-lg font-semibold mb-4"},"Edit Sloc",-1)),i("form",{onSubmit:U(L,["prevent"])},[i("div",Ve,[s(t(v),{modelValue:t(r).id,"onUpdate:modelValue":e[6]||(e[6]=a=>t(r).id=a),placeholder:"ID",required:"",readonly:""},null,8,["modelValue"])]),i("div",$e,[s(t(v),{modelValue:t(r).name,"onUpdate:modelValue":e[7]||(e[7]=a=>t(r).name=a),placeholder:"Sloc Name",required:""},null,8,["modelValue"])]),i("div",Ne,[s(t(b),{type:"button",variant:"outline",onClick:e[8]||(e[8]=a=>h.value=!1)},{default:o(()=>e[16]||(e[16]=[f("Cancel")])),_:1,__:[16]}),s(t(b),{type:"submit"},{default:o(()=>e[17]||(e[17]=[f("Update")])),_:1,__:[17]})])],32)])])):I("",!0)])]),_:1})],64))}});export{Me as default};
