import{d as x,L as b,e as h,b as y,o as w,T as C,g as s,j as o,q as d,x as a,y as P,z as c,l as n,B as f,F as p,D as S,k as u,S as T,A as k,M as L}from"./app-C0ZtNFPV.js";import{_ as j}from"./AppLayout.vue_vue_type_script_setup_true_lang-CxyMViV1.js";import{_ as B}from"./Button.vue_vue_type_script_setup_true_lang-B6TXREVN.js";import{u as M}from"./useCartStore-pAcp0Plh.js";import{u as A}from"./useToast-DV2nGitA.js";import"./index-C2dazRLE.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BIT3zfbJ.js";const N=x("auth",()=>{const g=b(),i=h(()=>{var e;return((e=g.props.auth)==null?void 0:e.user)??null}),l=h(()=>!!i.value);return{user:i,isLoggedIn:l}}),V={class:"px-4 py-4"},D={key:0,class:"text-center text-gray-500"},E={key:1,class:"text-center text-gray-500"},$={key:2,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},z={class:"aspect-video overflow-hidden rounded-lg bg-gray-100 mb-4"},F=["src"],G=["src"],H={class:"text-lg font-semibold mb-1 truncate"},I={class:"text-gray-700 mb-2 text-sm"},q={class:"text-orange-600 font-semibold mb-4"},J={class:"flex justify-between gap-2"},R={key:3,class:"text-center py-4 text-gray-500"},ee=y({__name:"Shopping",setup(g){const i=A(),l=N(),e=M(),m=async()=>{!e.loading&&e.currentPage<e.lastPage&&window.innerHeight+window.scrollY>=document.body.offsetHeight-200&&await e.fetchProducts(e.currentPage+1)};w(()=>{e.fetchProducts(1),window.addEventListener("scroll",m)}),C(()=>{window.removeEventListener("scroll",m)});const v=async _=>{try{await e.addToCart(_),i.success("Produk ditambahkan ke keranjang."),l.isLoggedIn||setTimeout(()=>{L.visit(route("login"))},1200)}catch(r){console.error(r),i.error("Gagal menambahkan produk.")}};return(_,r)=>(o(),s(p,null,[d(a(P),{title:"Belanja Produk"}),d(j,null,{default:c(()=>[n("div",V,[r[2]||(r[2]=n("h1",{class:"text-3xl font-semibold mb-6"},"Produk Tersedia",-1)),a(e).loading&&a(e).products.length===0?(o(),s("div",D," Memuat produk... ")):a(e).products.length===0?(o(),s("div",E," Tidak ada produk tersedia. ")):(o(),s("div",$,[(o(!0),s(p,null,S(a(e).products,t=>(o(),s("div",{key:t.id,class:"border rounded-xl p-4 shadow hover:shadow-md transition"},[n("div",z,[t.image?(o(),s("img",{key:0,src:t.image,alt:"Gambar produk",class:"w-full h-full object-cover"},null,8,F)):t.video?(o(),s("video",{key:1,src:t.video,controls:"",class:"w-full h-full object-cover"},null,8,G)):f("",!0)]),n("h2",H,u(t.name),1),n("p",I,u(t.short_description),1),n("p",q," Rp "+u(t.price?t.price.toLocaleString():"0"),1),n("div",J,[d(a(T),{class:"text-sm text-blue-600 hover:underline"},{default:c(()=>r[0]||(r[0]=[k(" Detail ")])),_:1,__:[0]}),d(a(B),{onClick:U=>v(t.id),size:"sm",class:"bg-indigo-600 text-white py-2 rounded-md hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:c(()=>r[1]||(r[1]=[k(" Add to Cart ")])),_:2,__:[1]},1032,["onClick"])])]))),128))])),a(e).loading&&a(e).products.length>0?(o(),s("div",R," Memuat lebih banyak produk... ")):f("",!0)])]),_:1})],64))}});export{ee as default};
