import{b as J,r as N,G as Q,u as W,e as X,o as Y,g as _,j as b,q as s,x as e,y as Z,z as r,l,B as E,A as m,O as ee,F as V,D as M,H as te,k as T,N as ae,I as j}from"./app-C0ZtNFPV.js";import{_ as se}from"./AppLayout.vue_vue_type_script_setup_true_lang-CxyMViV1.js";import{_ as y}from"./Button.vue_vue_type_script_setup_true_lang-B6TXREVN.js";import{_ as $}from"./Input.vue_vue_type_script_setup_true_lang-BWB1n0oK.js";import{_ as oe,a as re,b as B,c as F,d as le,e as q}from"./TableRow.vue_vue_type_script_setup_true_lang-CVJoN5Nr.js";import{u as ie}from"./useToast-DV2nGitA.js";import{u as ne}from"./useCategoryStore-D1VRUF1Z.js";import{P as de}from"./plus-jsIhsatj.js";import{S as ue}from"./square-pen-Cj9XWA8y.js";import{T as ce}from"./trash-2-Bt8Dqp-q.js";import"./index-C2dazRLE.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BIT3zfbJ.js";const me={class:"px-4 py-4"},ge={class:"flex justify-between items-center mb-6"},fe={class:"rounded-md border"},be={class:"flex justify-end mt-4 space-x-2"},ye=["disabled"],_e=["onClick","disabled"],pe=["disabled"],ve={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Ce={class:"bg-white p-6 rounded-lg w-96"},he={class:"mb-4"},xe={class:"flex justify-end gap-2"},we={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},ke={class:"bg-white p-6 rounded-lg w-96"},Ne={class:"mb-4"},Ve={class:"flex justify-end gap-2"},Ue=J({__name:"Index",setup($e){const u=ie(),v=N(!1),C=N(!1),p=N(null),i=Q({name:""}),z=[{title:"Category",href:"/categories"}],d=ne(),{items:A,currentPage:c,lastPage:D,loading:g,filterName:h}=W(d),x=X(()=>D.value||1),w=async o=>{o<1||o>x.value||await d.fetchCategories(o)},U=()=>w(c.value+1),I=()=>w(c.value-1),K=(o,t)=>{const a=t.target;d.setFilter(o,a.value)},R=()=>{i.reset(),v.value=!0},S=()=>{v.value=!1,i.reset()},P=()=>{C.value=!1,p.value=null,i.reset()};Y(()=>{d.fetchCategories()});const G=async()=>{var o,t,a,n;if(!i.name)return u.error("Name is required");try{await d.createCategory(i.name),u.success("Category created successfully"),i.reset(),await d.fetchCategories(c.value),S()}catch(f){const k=(n=(a=(t=(o=f==null?void 0:f.response)==null?void 0:o.data)==null?void 0:t.errors)==null?void 0:a.name)==null?void 0:n[0];u.error(k||"Failed to create Category")}},H=o=>{p.value=o,i.name=o.name,C.value=!0},L=async()=>{var o,t,a,n;if(!p.value||!i.name)return u.error("Name is required");try{await d.updateCategory(p.value.id,i.name),u.success("Category updated successfully"),i.reset(),await d.fetchCategories(c.value),P()}catch(f){const k=(n=(a=(t=(o=f==null?void 0:f.response)==null?void 0:o.data)==null?void 0:t.errors)==null?void 0:a.name)==null?void 0:n[0];u.error(k||"Failed to update Category")}},O=async o=>{var t,a;if(confirm("Are you sure you want to delete this Category?"))try{await d.deleteCategory(o),u.success("Category deleted successfully"),await d.fetchCategories(c.value)}catch(n){u.error(((a=(t=n==null?void 0:n.response)==null?void 0:t.data)==null?void 0:a.message)??"Failed to delete Category")}};return(o,t)=>(b(),_(V,null,[s(e(Z),{title:"Category Management"}),s(se,{breadcrumbs:z},{default:r(()=>[l("div",me,[l("div",ge,[s(e(y),{onClick:R,"aria-label":"Tambah Kategori Baru",disabled:e(g),class:"bg-indigo-600 text-white py-2 rounded-md hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:r(()=>[s(e(de),{class:"h-4 w-4"}),t[4]||(t[4]=m(" Add "))]),_:1,__:[4]},8,["disabled"]),s(e($),{modelValue:e(h),"onUpdate:modelValue":t[0]||(t[0]=a=>ee(h)?h.value=a:null),placeholder:"Search Categories",onInput:t[1]||(t[1]=a=>K("name",a)),class:"w-64","aria-label":"Search Categories",disabled:e(g)},null,8,["modelValue","disabled"])]),l("div",fe,[s(e(oe),null,{default:r(()=>[s(e(re),null,{default:r(()=>[s(e(B),{class:"bg-gray-100"},{default:r(()=>[s(e(F),null,{default:r(()=>t[5]||(t[5]=[m("Name")])),_:1,__:[5]}),s(e(F),{class:"w-24"},{default:r(()=>t[6]||(t[6]=[m("Actions")])),_:1,__:[6]})]),_:1})]),_:1}),s(e(le),null,{default:r(()=>[(b(!0),_(V,null,M(e(A),a=>(b(),te(e(B),{key:a.id},{default:r(()=>[s(e(q),null,{default:r(()=>[m(T(a.name),1)]),_:2},1024),s(e(q),{class:"flex gap-2"},{default:r(()=>[s(e(y),{variant:"ghost",size:"icon",onClick:n=>H(a),"aria-label":"Edit category",disabled:e(g)},{default:r(()=>[s(e(ue),{class:"h-4 w-4"})]),_:2},1032,["onClick","disabled"]),s(e(y),{variant:"ghost",size:"icon",onClick:n=>O(a.id),"aria-label":"Delete category",disabled:e(g)},{default:r(()=>[s(e(ce),{class:"h-4 w-4"})]),_:2},1032,["onClick","disabled"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),l("div",be,[l("button",{onClick:I,disabled:e(c)===1||e(g),class:"px-3 py-1 rounded border border-gray-300 text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed"}," Previous ",8,ye),(b(!0),_(V,null,M(x.value,a=>(b(),_("button",{key:a,onClick:n=>w(a),class:ae(["px-3 py-1 rounded border text-sm",a===e(c)?"bg-blue-600 border-blue-600 text-white":"border-gray-300 text-gray-700 hover:bg-gray-100"]),disabled:e(g)},T(a),11,_e))),128)),l("button",{onClick:U,disabled:e(c)===x.value||e(g),class:"px-3 py-1 rounded border border-gray-300 text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed"}," Next ",8,pe)]),v.value?(b(),_("div",ve,[l("div",Ce,[t[9]||(t[9]=l("h2",{class:"text-lg font-semibold mb-4"},"Tambah Kategori Baru",-1)),l("form",{onSubmit:j(G,["prevent"])},[l("div",he,[s(e($),{modelValue:e(i).name,"onUpdate:modelValue":t[2]||(t[2]=a=>e(i).name=a),placeholder:"Category Name",required:"","aria-label":"Category Name"},null,8,["modelValue"])]),l("div",xe,[s(e(y),{type:"button",variant:"outline",onClick:S},{default:r(()=>t[7]||(t[7]=[m("Cancel")])),_:1,__:[7]}),s(e(y),{type:"submit",class:"bg-indigo-600 text-white py-2 rounded-md hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:r(()=>t[8]||(t[8]=[m("Simpan")])),_:1,__:[8]})])],32)])])):E("",!0),C.value?(b(),_("div",we,[l("div",ke,[t[12]||(t[12]=l("h2",{class:"text-lg font-semibold mb-4"},"Edit Category",-1)),l("form",{onSubmit:j(L,["prevent"])},[l("div",Ne,[s(e($),{modelValue:e(i).name,"onUpdate:modelValue":t[3]||(t[3]=a=>e(i).name=a),placeholder:"Category Name",required:"","aria-label":"Category Name"},null,8,["modelValue"])]),l("div",Ve,[s(e(y),{type:"button",variant:"outline",onClick:P},{default:r(()=>t[10]||(t[10]=[m("Cancel")])),_:1,__:[10]}),s(e(y),{type:"submit",class:"bg-indigo-600 text-white py-2 rounded-md hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:r(()=>t[11]||(t[11]=[m("Simpan")])),_:1,__:[11]})])],32)])])):E("",!0)])]),_:1})],64))}});export{Ue as default};
