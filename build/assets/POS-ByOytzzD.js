import{b as zt,e as Ue,H as yr,j as V,x as O,a3 as jo,z as q,K as un,r as I,w as dt,q as D,l as h,A as ue,g as z,B as $e,F as He,D as ft,k as B,a as rt,o as Ro,c as Fo,m as ze,E as Io,a5 as Uo,L as No,y as Wo,p as ct,P as Gr,Z as Qr,n as Bo,_ as Lo}from"./app-C0ZtNFPV.js";import{e as qo,o as Vo,a as Ho,_ as he}from"./Button.vue_vue_type_script_setup_true_lang-B6TXREVN.js";import{_ as zo,a as Jo,b as Yr,c as kt,d as Go,e as Et}from"./TableRow.vue_vue_type_script_setup_true_lang-CVJoN5Nr.js";import{_ as Qo}from"./AppLayout.vue_vue_type_script_setup_true_lang-CxyMViV1.js";import{u as Yo}from"./useToast-DV2nGitA.js";import{a as Ko,b as Xo,c as Zo,_ as ei}from"./DialogTitle.vue_vue_type_script_setup_true_lang-B6zpEh0A.js";import{_ as Bt}from"./Input.vue_vue_type_script_setup_true_lang-BWB1n0oK.js";import{P as ti,S as ri,U as ni,R as ai}from"./user-plus-D2KpIxMm.js";import{T as Kr}from"./trash-2-Bt8Dqp-q.js";import"./index-C2dazRLE.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BIT3zfbJ.js";const oi=zt({__name:"DialogDescription",props:{asChild:{type:Boolean},as:{type:[String,Object,Function]},class:{}},setup(r){const i=r,a=Ue(()=>{const{class:c,...v}=i;return v}),l=qo(a);return(c,v)=>(V(),yr(O(Vo),jo(O(l),{class:O(Ho)("text-sm text-muted-foreground",i.class)}),{default:q(()=>[un(c.$slots,"default")]),_:3},16,["class"]))}}),ii={class:"grid gap-4 py-4"},si={key:0},li={key:0,class:"border rounded-md max-h-40 overflow-y-auto"},ui=["onClick"],ci={key:1,class:"text-sm text-gray-500 mt-2"},di={key:1},fi={class:"flex justify-end gap-2 mt-4"},pi=zt({__name:"CustomerDialog",props:{show:{type:Boolean}},emits:["update:show","customerSelected"],setup(r,{emit:i}){const a=r,l=i,c=I(""),v=I([]),g=I(""),T=I(""),m=I(""),_=I(!1),P=async()=>{if(c.value.length<2){v.value=[];return}try{const M=await rt.get(`/api/customers/search?query=${c.value}`);v.value=M.data}catch(M){console.error("Error searching customers:",M)}},$=async()=>{try{const M=await rt.post("/api/customers",{name:g.value,phone:T.value,address:m.value});l("customerSelected",M.data),l("update:show",!1),W()}catch(M){console.error("Error adding customer:",M)}},H=M=>{l("customerSelected",M),l("update:show",!1),W()},W=()=>{c.value="",v.value=[],g.value="",T.value="",m.value="",_.value=!1};return dt(()=>a.show,M=>{M||W()}),(M,E)=>(V(),yr(O(ei),{open:M.show,"onUpdate:open":E[6]||(E[6]=U=>l("update:show",U))},{default:q(()=>[D(O(Ko),{class:"sm:max-w-[425px]"},{default:q(()=>[D(O(Xo),null,{default:q(()=>[D(O(Zo),null,{default:q(()=>E[7]||(E[7]=[ue("Pilih Customer")])),_:1,__:[7]}),D(O(oi),null,{default:q(()=>E[8]||(E[8]=[ue(" Search for an existing customer or add a new one. ")])),_:1,__:[8]})]),_:1}),h("div",ii,[_.value?(V(),z("div",di,[E[12]||(E[12]=h("h4",{class:"text-md font-semibold mb-2"},"Buat Customer Baru",-1)),D(O(Bt),{modelValue:g.value,"onUpdate:modelValue":E[2]||(E[2]=U=>g.value=U),placeholder:"Name",class:"mb-2"},null,8,["modelValue"]),D(O(Bt),{modelValue:T.value,"onUpdate:modelValue":E[3]||(E[3]=U=>T.value=U),placeholder:"Phone",class:"mb-2"},null,8,["modelValue"]),D(O(Bt),{modelValue:m.value,"onUpdate:modelValue":E[4]||(E[4]=U=>m.value=U),placeholder:"Address (Optional)",class:"mb-2"},null,8,["modelValue"]),h("div",fi,[D(O(he),{variant:"outline",onClick:E[5]||(E[5]=U=>_.value=!1)},{default:q(()=>E[10]||(E[10]=[ue("Back to Search")])),_:1,__:[10]}),D(O(he),{onClick:$},{default:q(()=>E[11]||(E[11]=[ue("Save New Customer")])),_:1,__:[11]})])])):(V(),z("div",si,[D(O(Bt),{modelValue:c.value,"onUpdate:modelValue":E[0]||(E[0]=U=>c.value=U),onInput:P,placeholder:"Search customer by name or phone...",class:"mb-2"},null,8,["modelValue"]),v.value.length>0?(V(),z("div",li,[(V(!0),z(He,null,ft(v.value,U=>(V(),z("div",{key:U.id,onClick:Q=>H(U),class:"p-2 cursor-pointer hover:bg-gray-100"}," #"+B(U.id)+" - "+B(U.name)+" ("+B(U.phone)+") ",9,ui))),128))])):c.value.length>=2?(V(),z("p",ci,"No customers found.")):$e("",!0),D(O(he),{onClick:E[1]||(E[1]=U=>_.value=!0),class:"mt-4 w-full bg-indigo-600 py-2 text-white hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:q(()=>E[9]||(E[9]=[ue("Tambah Customer")])),_:1,__:[9]})]))])]),_:1})]),_:1},8,["open"]))}});var cn=(r,i,a)=>{if(!i.has(r))throw TypeError("Cannot "+a)},Xr=(r,i,a)=>(cn(r,i,"read from private field"),a?a.call(r):i.get(r)),vi=(r,i,a)=>{if(i.has(r))throw TypeError("Cannot add the same private member more than once");i instanceof WeakSet?i.add(r):i.set(r,a)},mi=(r,i,a,l)=>(cn(r,i,"write to private field"),i.set(r,a),a);const dn=[["aztec","Aztec"],["code_128","Code128"],["code_39","Code39"],["code_93","Code93"],["codabar","Codabar"],["databar","DataBar"],["databar_expanded","DataBarExpanded"],["data_matrix","DataMatrix"],["dx_film_edge","DXFilmEdge"],["ean_13","EAN-13"],["ean_8","EAN-8"],["itf","ITF"],["maxi_code","MaxiCode"],["micro_qr_code","MicroQRCode"],["pdf417","PDF417"],["qr_code","QRCode"],["rm_qr_code","rMQRCode"],["upc_a","UPC-A"],["upc_e","UPC-E"],["linear_codes","Linear-Codes"],["matrix_codes","Matrix-Codes"]],hi=[...dn,["unknown"]].map(r=>r[0]),qt=new Map(dn);function yi(r){for(const[i,a]of qt)if(r===a)return i;return"unknown"}function gi(r){if(fn(r))return{width:r.naturalWidth,height:r.naturalHeight};if(pn(r))return{width:r.width.baseVal.value,height:r.height.baseVal.value};if(vn(r))return{width:r.videoWidth,height:r.videoHeight};if(hn(r))return{width:r.width,height:r.height};if(gn(r))return{width:r.displayWidth,height:r.displayHeight};if(mn(r))return{width:r.width,height:r.height};if(yn(r))return{width:r.width,height:r.height};throw new TypeError("The provided value is not of type '(Blob or HTMLCanvasElement or HTMLImageElement or HTMLVideoElement or ImageBitmap or ImageData or OffscreenCanvas or SVGImageElement or VideoFrame)'.")}function fn(r){try{return r instanceof HTMLImageElement}catch{return!1}}function pn(r){try{return r instanceof SVGImageElement}catch{return!1}}function vn(r){try{return r instanceof HTMLVideoElement}catch{return!1}}function mn(r){try{return r instanceof HTMLCanvasElement}catch{return!1}}function hn(r){try{return r instanceof ImageBitmap}catch{return!1}}function yn(r){try{return r instanceof OffscreenCanvas}catch{return!1}}function gn(r){try{return r instanceof VideoFrame}catch{return!1}}function bn(r){try{return r instanceof Blob}catch{return!1}}function bi(r){try{return r instanceof ImageData}catch{return!1}}function wi(r,i){try{const a=new OffscreenCanvas(r,i);if(a.getContext("2d")instanceof OffscreenCanvasRenderingContext2D)return a;throw void 0}catch{const l=document.createElement("canvas");return l.width=r,l.height=i,l}}async function wn(r){if(fn(r)&&!await $i(r))throw new DOMException("Failed to load or decode HTMLImageElement.","InvalidStateError");if(pn(r)&&!await Ti(r))throw new DOMException("Failed to load or decode SVGImageElement.","InvalidStateError");if(gn(r)&&Pi(r))throw new DOMException("VideoFrame is closed.","InvalidStateError");if(vn(r)&&(r.readyState===0||r.readyState===1))throw new DOMException("Invalid element or state.","InvalidStateError");if(hn(r)&&ki(r))throw new DOMException("The image source is detached.","InvalidStateError");const{width:i,height:a}=gi(r);if(i===0||a===0)return null;const l=wi(i,a).getContext("2d");l.drawImage(r,0,0);try{return l.getImageData(0,0,i,a)}catch{throw new DOMException("Source would taint origin.","SecurityError")}}async function _i(r){let i;try{if(globalThis.createImageBitmap)i=await createImageBitmap(r);else if(globalThis.Image){i=new Image;let a="";try{a=URL.createObjectURL(r),i.src=a,await i.decode()}finally{URL.revokeObjectURL(a)}}else return r}catch{throw new DOMException("Failed to load or decode Blob.","InvalidStateError")}return await wn(i)}function xi(r){const{width:i,height:a}=r;if(i===0||a===0)return null;const l=r.getContext("2d");try{return l.getImageData(0,0,i,a)}catch{throw new DOMException("Source would taint origin.","SecurityError")}}async function Ci(r){if(bn(r))return await _i(r);if(bi(r)){if(Si(r))throw new DOMException("The image data has been detached.","InvalidStateError");return r}return mn(r)||yn(r)?xi(r):await wn(r)}async function $i(r){try{return await r.decode(),!0}catch{return!1}}async function Ti(r){var i;try{return await((i=r.decode)==null?void 0:i.call(r)),!0}catch{return!1}}function Pi(r){return r.format===null}function Si(r){return r.data.buffer.byteLength===0}function ki(r){return r.width===0&&r.height===0}function Zr(r,i){return r instanceof DOMException?new DOMException(`${i}: ${r.message}`,r.name):r instanceof Error?new r.constructor(`${i}: ${r.message}`):new Error(`${i}: ${r}`)}const en=["Aztec","Codabar","Code128","Code39","Code93","DataBar","DataBarExpanded","DataMatrix","DXFilmEdge","EAN-13","EAN-8","ITF","Linear-Codes","Matrix-Codes","MaxiCode","MicroQRCode","None","PDF417","QRCode","rMQRCode","UPC-A","UPC-E"];function Ei(r){return r.join("|")}function Oi(r){const i=tn(r);let a=0,l=en.length-1;for(;a<=l;){const c=Math.floor((a+l)/2),v=en[c],g=tn(v);if(g===i)return v;g<i?a=c+1:l=c-1}return"None"}function tn(r){return r.toLowerCase().replace(/_-\[\]/g,"")}function Di(r,i){return r.Binarizer[i]}function Mi(r,i){return r.CharacterSet[i]}const Ai=["Text","Binary","Mixed","GS1","ISO15434","UnknownECI"];function ji(r){return Ai[r.value]}function Ri(r,i){return r.EanAddOnSymbol[i]}function Fi(r,i){return r.TextMode[i]}const mt={formats:[],tryHarder:!0,tryRotate:!0,tryInvert:!0,tryDownscale:!0,binarizer:"LocalAverage",isPure:!1,downscaleFactor:3,downscaleThreshold:500,minLineCount:2,maxNumberOfSymbols:255,tryCode39ExtendedMode:!1,validateCode39CheckSum:!1,validateITFCheckSum:!1,returnCodabarStartEnd:!1,returnErrors:!1,eanAddOnSymbol:"Read",textMode:"Plain",characterSet:"Unknown"};function _n(r,i){return{...i,formats:Ei(i.formats),binarizer:Di(r,i.binarizer),eanAddOnSymbol:Ri(r,i.eanAddOnSymbol),textMode:Fi(r,i.textMode),characterSet:Mi(r,i.characterSet)}}function xn(r){return{...r,format:Oi(r.format),eccLevel:r.eccLevel,contentType:ji(r.contentType)}}const Ii={locateFile:(r,i)=>{const a=r.match(/_(.+?)\.wasm$/);return a?`https://fastly.jsdelivr.net/npm/zxing-wasm@1.1.3/dist/${a[1]}/${r}`:i+r}};let rn=new WeakMap;function gr(r,i){var a;const l=rn.get(r);if(l!=null&&l.modulePromise&&i===void 0)return l.modulePromise;const c=(a=l==null?void 0:l.moduleOverrides)!=null?a:Ii,v=r({...c});return rn.set(r,{moduleOverrides:c,modulePromise:v}),v}async function Ui(r,i,a=mt){const l={...mt,...a},c=await gr(r),{size:v}=i,g=new Uint8Array(await i.arrayBuffer()),T=c._malloc(v);c.HEAPU8.set(g,T);const m=c.readBarcodesFromImage(T,v,_n(c,l));c._free(T);const _=[];for(let P=0;P<m.size();++P)_.push(xn(m.get(P)));return _}async function Ni(r,i,a=mt){const l={...mt,...a},c=await gr(r),{data:v,width:g,height:T,data:{byteLength:m}}=i,_=c._malloc(m);c.HEAPU8.set(v,_);const P=c.readBarcodesFromPixmap(_,g,T,_n(c,l));c._free(_);const $=[];for(let H=0;H<P.size();++H)$.push(xn(P.get(H)));return $}({...mt,formats:[...mt.formats]});var br=(()=>{var r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return function(i={}){var a=i,l,c;a.ready=new Promise((e,t)=>{l=e,c=t});var v=Object.assign({},a),g="./this.program",T=typeof window=="object",m=typeof importScripts=="function";typeof process=="object"&&typeof process.versions=="object"&&process.versions.node;var _="";function P(e){return a.locateFile?a.locateFile(e,_):_+e}var $;(T||m)&&(m?_=self.location.href:typeof document<"u"&&document.currentScript&&(_=document.currentScript.src),r&&(_=r),_.indexOf("blob:")!==0?_=_.substr(0,_.replace(/[?#].*/,"").lastIndexOf("/")+1):_="",m&&($=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)})),a.print||console.log.bind(console);var H=a.printErr||console.error.bind(console);Object.assign(a,v),v=null,a.arguments&&a.arguments,a.thisProgram&&(g=a.thisProgram),a.quit&&a.quit;var W;a.wasmBinary&&(W=a.wasmBinary),typeof WebAssembly!="object"&&be("no native wasm support detected");var M,E=!1,U,Q,ve,J,j,N,xe,Ce;function Je(){var e=M.buffer;a.HEAP8=U=new Int8Array(e),a.HEAP16=ve=new Int16Array(e),a.HEAPU8=Q=new Uint8Array(e),a.HEAPU16=J=new Uint16Array(e),a.HEAP32=j=new Int32Array(e),a.HEAPU32=N=new Uint32Array(e),a.HEAPF32=xe=new Float32Array(e),a.HEAPF64=Ce=new Float64Array(e)}var De=[],Me=[],Te=[];function Pe(){if(a.preRun)for(typeof a.preRun=="function"&&(a.preRun=[a.preRun]);a.preRun.length;)fe(a.preRun.shift());G(De)}function ke(){G(Me)}function Ge(){if(a.postRun)for(typeof a.postRun=="function"&&(a.postRun=[a.postRun]);a.postRun.length;)Ze(a.postRun.shift());G(Te)}function fe(e){De.unshift(e)}function nt(e){Me.unshift(e)}function Ze(e){Te.unshift(e)}var ye=0,We=null;function Ae(e){var t;ye++,(t=a.monitorRunDependencies)===null||t===void 0||t.call(a,ye)}function ge(e){var t;if(ye--,(t=a.monitorRunDependencies)===null||t===void 0||t.call(a,ye),ye==0&&We){var n=We;We=null,n()}}function be(e){var t;(t=a.onAbort)===null||t===void 0||t.call(a,e),e="Aborted("+e+")",H(e),E=!0,e+=". Build with -sASSERTIONS for more info.";var n=new WebAssembly.RuntimeError(e);throw c(n),n}var et="data:application/octet-stream;base64,",at=e=>e.startsWith(et),je;je="zxing_reader.wasm",at(je)||(je=P(je));function ot(e){if(e==je&&W)return new Uint8Array(W);if($)return $(e);throw"both async and sync fetching of the wasm failed"}function ht(e){return!W&&(T||m)&&typeof fetch=="function"?fetch(e,{credentials:"same-origin"}).then(t=>{if(!t.ok)throw"failed to load wasm binary file at '"+e+"'";return t.arrayBuffer()}).catch(()=>ot(e)):Promise.resolve().then(()=>ot(e))}function Be(e,t,n){return ht(e).then(o=>WebAssembly.instantiate(o,t)).then(o=>o).then(n,o=>{H(`failed to asynchronously prepare wasm: ${o}`),be(o)})}function Dt(e,t,n,o){return!e&&typeof WebAssembly.instantiateStreaming=="function"&&!at(t)&&typeof fetch=="function"?fetch(t,{credentials:"same-origin"}).then(s=>{var u=WebAssembly.instantiateStreaming(s,n);return u.then(o,function(f){return H(`wasm streaming compile failed: ${f}`),H("falling back to ArrayBuffer instantiation"),Be(t,n,o)})}):Be(t,n,o)}function Jt(){var e={a:fo};function t(o,s){return ce=o.exports,M=ce.ia,Je(),Sr=ce.ma,nt(ce.ja),ge(),ce}Ae();function n(o){t(o.instance)}if(a.instantiateWasm)try{return a.instantiateWasm(e,t)}catch(o){H(`Module.instantiateWasm callback failed with error: ${o}`),c(o)}return Dt(W,je,e,n).catch(c),{}}var G=e=>{for(;e.length>0;)e.shift()(a)};a.noExitRuntime;var it=[],tt=0,Gt=e=>{var t=new yt(e);return t.get_caught()||(t.set_caught(!0),tt--),t.set_rethrown(!1),it.push(t),Br(t.excPtr),t.get_exception_ptr()},Ee=0,Qt=()=>{Z(0,0);var e=it.pop();Wr(e.excPtr),Ee=0};function yt(e){this.excPtr=e,this.ptr=e-24,this.set_type=function(t){N[this.ptr+4>>2]=t},this.get_type=function(){return N[this.ptr+4>>2]},this.set_destructor=function(t){N[this.ptr+8>>2]=t},this.get_destructor=function(){return N[this.ptr+8>>2]},this.set_caught=function(t){t=t?1:0,U[this.ptr+12>>0]=t},this.get_caught=function(){return U[this.ptr+12>>0]!=0},this.set_rethrown=function(t){t=t?1:0,U[this.ptr+13>>0]=t},this.get_rethrown=function(){return U[this.ptr+13>>0]!=0},this.init=function(t,n){this.set_adjusted_ptr(0),this.set_type(t),this.set_destructor(n)},this.set_adjusted_ptr=function(t){N[this.ptr+16>>2]=t},this.get_adjusted_ptr=function(){return N[this.ptr+16>>2]},this.get_exception_ptr=function(){var t=qr(this.get_type());if(t)return N[this.excPtr>>2];var n=this.get_adjusted_ptr();return n!==0?n:this.excPtr}}var Yt=e=>{throw Ee||(Ee=e),Ee},gt=e=>{var t=Ee;if(!t)return St(0),0;var n=new yt(t);n.set_adjusted_ptr(t);var o=n.get_type();if(!o)return St(0),t;for(var s in e){var u=e[s];if(u===0||u===o)break;var f=n.ptr+16;if(Lr(u,o,f))return St(u),t}return St(o),t},Kt=()=>gt([]),Xt=e=>gt([e]),Zt=(e,t)=>gt([e,t]),Mt=()=>{var e=it.pop();e||be("no exception to throw");var t=e.excPtr;throw e.get_rethrown()||(it.push(e),e.set_rethrown(!0),e.set_caught(!1),tt++),Ee=t,Ee},er=(e,t,n)=>{var o=new yt(e);throw o.init(t,n),Ee=e,tt++,Ee},tr=()=>tt,we={},st=e=>{for(;e.length;){var t=e.pop(),n=e.pop();n(t)}};function bt(e){return this.fromWireType(j[e>>2])}var Qe={},Le={},lt={},x,d=e=>{throw new x(e)},b=(e,t,n)=>{e.forEach(function(p){lt[p]=t});function o(p){var y=n(p);y.length!==e.length&&d("Mismatched type converter count");for(var C=0;C<e.length;++C)Re(e[C],y[C])}var s=new Array(t.length),u=[],f=0;t.forEach((p,y)=>{Le.hasOwnProperty(p)?s[y]=Le[p]:(u.push(p),Qe.hasOwnProperty(p)||(Qe[p]=[]),Qe[p].push(()=>{s[y]=Le[p],++f,f===u.length&&o(s)}))}),u.length===0&&o(s)},te=e=>{var t=we[e];delete we[e];var n=t.rawConstructor,o=t.rawDestructor,s=t.fields,u=s.map(f=>f.getterReturnType).concat(s.map(f=>f.setterArgumentType));b([e],u,f=>{var p={};return s.forEach((y,C)=>{var S=y.fieldName,A=f[C],F=y.getter,L=y.getterContext,ee=f[C+s.length],se=y.setter,K=y.setterContext;p[S]={read:pe=>A.fromWireType(F(L,pe)),write:(pe,w)=>{var k=[];se(K,pe,ee.toWireType(k,w)),st(k)}}}),[{name:t.name,fromWireType:y=>{var C={};for(var S in p)C[S]=p[S].read(y);return o(y),C},toWireType:(y,C)=>{for(var S in p)if(!(S in C))throw new TypeError(`Missing field: "${S}"`);var A=n();for(S in p)p[S].write(A,C[S]);return y!==null&&y.push(o,A),A},argPackAdvance:Fe,readValueFromPointer:bt,destructorFunction:o}]})},re=(e,t,n,o,s)=>{},ne=()=>{for(var e=new Array(256),t=0;t<256;++t)e[t]=String.fromCharCode(t);me=e},me,X=e=>{for(var t="",n=e;Q[n];)t+=me[Q[n++]];return t},Y,R=e=>{throw new Y(e)};function wt(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var o=t.name;if(e||R(`type "${o}" must have a positive integer typeid pointer`),Le.hasOwnProperty(e)){if(n.ignoreDuplicateRegistrations)return;R(`Cannot register type '${o}' twice`)}if(Le[e]=t,delete lt[e],Qe.hasOwnProperty(e)){var s=Qe[e];delete Qe[e],s.forEach(u=>u())}}function Re(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");return wt(e,t,n)}var Fe=8,Un=(e,t,n,o)=>{t=X(t),Re(e,{name:t,fromWireType:function(s){return!!s},toWireType:function(s,u){return u?n:o},argPackAdvance:Fe,readValueFromPointer:function(s){return this.fromWireType(Q[s])},destructorFunction:null})},Nn=e=>({count:e.count,deleteScheduled:e.deleteScheduled,preservePointerOnDelete:e.preservePointerOnDelete,ptr:e.ptr,ptrType:e.ptrType,smartPtr:e.smartPtr,smartPtrType:e.smartPtrType}),rr=e=>{function t(n){return n.$$.ptrType.registeredClass.name}R(t(e)+" instance already deleted")},nr=!1,wr=e=>{},Wn=e=>{e.smartPtr?e.smartPtrType.rawDestructor(e.smartPtr):e.ptrType.registeredClass.rawDestructor(e.ptr)},_r=e=>{e.count.value-=1;var t=e.count.value===0;t&&Wn(e)},xr=(e,t,n)=>{if(t===n)return e;if(n.baseClass===void 0)return null;var o=xr(e,t,n.baseClass);return o===null?null:n.downcast(o)},Cr={},Bn=()=>Object.keys(Ct).length,Ln=()=>{var e=[];for(var t in Ct)Ct.hasOwnProperty(t)&&e.push(Ct[t]);return e},_t=[],ar=()=>{for(;_t.length;){var e=_t.pop();e.$$.deleteScheduled=!1,e.delete()}},xt,qn=e=>{xt=e,_t.length&&xt&&xt(ar)},Vn=()=>{a.getInheritedInstanceCount=Bn,a.getLiveInheritedInstances=Ln,a.flushPendingDeletes=ar,a.setDelayFunction=qn},Ct={},Hn=(e,t)=>{for(t===void 0&&R("ptr should not be undefined");e.baseClass;)t=e.upcast(t),e=e.baseClass;return t},zn=(e,t)=>(t=Hn(e,t),Ct[t]),At=(e,t)=>{(!t.ptrType||!t.ptr)&&d("makeClassHandle requires ptr and ptrType");var n=!!t.smartPtrType,o=!!t.smartPtr;return n!==o&&d("Both smartPtrType and smartPtr must be specified"),t.count={value:1},$t(Object.create(e,{$$:{value:t,writable:!0}}))};function Jn(e){var t=this.getPointee(e);if(!t)return this.destructor(e),null;var n=zn(this.registeredClass,t);if(n!==void 0){if(n.$$.count.value===0)return n.$$.ptr=t,n.$$.smartPtr=e,n.clone();var o=n.clone();return this.destructor(e),o}function s(){return this.isSmartPointer?At(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:t,smartPtrType:this,smartPtr:e}):At(this.registeredClass.instancePrototype,{ptrType:this,ptr:e})}var u=this.registeredClass.getActualType(t),f=Cr[u];if(!f)return s.call(this);var p;this.isConst?p=f.constPointerType:p=f.pointerType;var y=xr(t,this.registeredClass,p.registeredClass);return y===null?s.call(this):this.isSmartPointer?At(p.registeredClass.instancePrototype,{ptrType:p,ptr:y,smartPtrType:this,smartPtr:e}):At(p.registeredClass.instancePrototype,{ptrType:p,ptr:y})}var $t=e=>typeof FinalizationRegistry>"u"?($t=t=>t,e):(nr=new FinalizationRegistry(t=>{_r(t.$$)}),$t=t=>{var n=t.$$,o=!!n.smartPtr;if(o){var s={$$:n};nr.register(t,s,t)}return t},wr=t=>nr.unregister(t),$t(e)),Gn=()=>{Object.assign(jt.prototype,{isAliasOf(e){if(!(this instanceof jt)||!(e instanceof jt))return!1;var t=this.$$.ptrType.registeredClass,n=this.$$.ptr;e.$$=e.$$;for(var o=e.$$.ptrType.registeredClass,s=e.$$.ptr;t.baseClass;)n=t.upcast(n),t=t.baseClass;for(;o.baseClass;)s=o.upcast(s),o=o.baseClass;return t===o&&n===s},clone(){if(this.$$.ptr||rr(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var e=$t(Object.create(Object.getPrototypeOf(this),{$$:{value:Nn(this.$$)}}));return e.$$.count.value+=1,e.$$.deleteScheduled=!1,e},delete(){this.$$.ptr||rr(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&R("Object already scheduled for deletion"),wr(this),_r(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)},isDeleted(){return!this.$$.ptr},deleteLater(){return this.$$.ptr||rr(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&R("Object already scheduled for deletion"),_t.push(this),_t.length===1&&xt&&xt(ar),this.$$.deleteScheduled=!0,this}})};function jt(){}var Tt=(e,t)=>Object.defineProperty(t,"name",{value:e}),$r=(e,t,n)=>{if(e[t].overloadTable===void 0){var o=e[t];e[t]=function(){return e[t].overloadTable.hasOwnProperty(arguments.length)||R(`Function '${n}' called with an invalid number of arguments (${arguments.length}) - expects one of (${e[t].overloadTable})!`),e[t].overloadTable[arguments.length].apply(this,arguments)},e[t].overloadTable=[],e[t].overloadTable[o.argCount]=o}},or=(e,t,n)=>{a.hasOwnProperty(e)?((n===void 0||a[e].overloadTable!==void 0&&a[e].overloadTable[n]!==void 0)&&R(`Cannot register public name '${e}' twice`),$r(a,e,e),a.hasOwnProperty(n)&&R(`Cannot register multiple overloads of a function with the same number of arguments (${n})!`),a[e].overloadTable[n]=t):(a[e]=t,n!==void 0&&(a[e].numArguments=n))},Qn=48,Yn=57,Kn=e=>{if(e===void 0)return"_unknown";e=e.replace(/[^a-zA-Z0-9_]/g,"$");var t=e.charCodeAt(0);return t>=Qn&&t<=Yn?`_${e}`:e};function Xn(e,t,n,o,s,u,f,p){this.name=e,this.constructor=t,this.instancePrototype=n,this.rawDestructor=o,this.baseClass=s,this.getActualType=u,this.upcast=f,this.downcast=p,this.pureVirtualFunctions=[]}var ir=(e,t,n)=>{for(;t!==n;)t.upcast||R(`Expected null or instance of ${n.name}, got an instance of ${t.name}`),e=t.upcast(e),t=t.baseClass;return e};function Zn(e,t){if(t===null)return this.isReference&&R(`null is not a valid ${this.name}`),0;t.$$||R(`Cannot pass "${dr(t)}" as a ${this.name}`),t.$$.ptr||R(`Cannot pass deleted object as a pointer of type ${this.name}`);var n=t.$$.ptrType.registeredClass,o=ir(t.$$.ptr,n,this.registeredClass);return o}function ea(e,t){var n;if(t===null)return this.isReference&&R(`null is not a valid ${this.name}`),this.isSmartPointer?(n=this.rawConstructor(),e!==null&&e.push(this.rawDestructor,n),n):0;(!t||!t.$$)&&R(`Cannot pass "${dr(t)}" as a ${this.name}`),t.$$.ptr||R(`Cannot pass deleted object as a pointer of type ${this.name}`),!this.isConst&&t.$$.ptrType.isConst&&R(`Cannot convert argument of type ${t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name} to parameter type ${this.name}`);var o=t.$$.ptrType.registeredClass;if(n=ir(t.$$.ptr,o,this.registeredClass),this.isSmartPointer)switch(t.$$.smartPtr===void 0&&R("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:t.$$.smartPtrType===this?n=t.$$.smartPtr:R(`Cannot convert argument of type ${t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name} to parameter type ${this.name}`);break;case 1:n=t.$$.smartPtr;break;case 2:if(t.$$.smartPtrType===this)n=t.$$.smartPtr;else{var s=t.clone();n=this.rawShare(n,qe.toHandle(()=>s.delete())),e!==null&&e.push(this.rawDestructor,n)}break;default:R("Unsupporting sharing policy")}return n}function ta(e,t){if(t===null)return this.isReference&&R(`null is not a valid ${this.name}`),0;t.$$||R(`Cannot pass "${dr(t)}" as a ${this.name}`),t.$$.ptr||R(`Cannot pass deleted object as a pointer of type ${this.name}`),t.$$.ptrType.isConst&&R(`Cannot convert argument of type ${t.$$.ptrType.name} to parameter type ${this.name}`);var n=t.$$.ptrType.registeredClass,o=ir(t.$$.ptr,n,this.registeredClass);return o}function Tr(e){return this.fromWireType(N[e>>2])}var ra=()=>{Object.assign(Rt.prototype,{getPointee(e){return this.rawGetPointee&&(e=this.rawGetPointee(e)),e},destructor(e){var t;(t=this.rawDestructor)===null||t===void 0||t.call(this,e)},argPackAdvance:Fe,readValueFromPointer:Tr,deleteObject(e){e!==null&&e.delete()},fromWireType:Jn})};function Rt(e,t,n,o,s,u,f,p,y,C,S){this.name=e,this.registeredClass=t,this.isReference=n,this.isConst=o,this.isSmartPointer=s,this.pointeeType=u,this.sharingPolicy=f,this.rawGetPointee=p,this.rawConstructor=y,this.rawShare=C,this.rawDestructor=S,!s&&t.baseClass===void 0?o?(this.toWireType=Zn,this.destructorFunction=null):(this.toWireType=ta,this.destructorFunction=null):this.toWireType=ea}var Pr=(e,t,n)=>{a.hasOwnProperty(e)||d("Replacing nonexistant public symbol"),a[e].overloadTable!==void 0&&n!==void 0?a[e].overloadTable[n]=t:(a[e]=t,a[e].argCount=n)},na=(e,t,n)=>{var o=a["dynCall_"+e];return n&&n.length?o.apply(null,[t].concat(n)):o.call(null,t)},Ft=[],Sr,ae=e=>{var t=Ft[e];return t||(e>=Ft.length&&(Ft.length=e+1),Ft[e]=t=Sr.get(e)),t},aa=(e,t,n)=>{if(e.includes("j"))return na(e,t,n);var o=ae(t).apply(null,n);return o},oa=(e,t)=>{var n=[];return function(){return n.length=0,Object.assign(n,arguments),aa(e,t,n)}},Oe=(e,t)=>{e=X(e);function n(){return e.includes("j")?oa(e,t):ae(t)}var o=n();return typeof o!="function"&&R(`unknown function pointer with signature ${e}: ${t}`),o},ia=(e,t)=>{var n=Tt(t,function(o){this.name=t,this.message=o;var s=new Error(o).stack;s!==void 0&&(this.stack=this.toString()+`
`+s.replace(/^Error(:[^\n]*)?\n/,""))});return n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.prototype.toString=function(){return this.message===void 0?this.name:`${this.name}: ${this.message}`},n},kr,Er=e=>{var t=Nr(e),n=X(t);return Ve(t),n},It=(e,t)=>{var n=[],o={};function s(u){if(!o[u]&&!Le[u]){if(lt[u]){lt[u].forEach(s);return}n.push(u),o[u]=!0}}throw t.forEach(s),new kr(`${e}: `+n.map(Er).join([", "]))},sa=(e,t,n,o,s,u,f,p,y,C,S,A,F)=>{S=X(S),u=Oe(s,u),p&&(p=Oe(f,p)),C&&(C=Oe(y,C)),F=Oe(A,F);var L=Kn(S);or(L,function(){It(`Cannot construct ${S} due to unbound types`,[o])}),b([e,t,n],o?[o]:[],function(ee){ee=ee[0];var se,K;o?(se=ee.registeredClass,K=se.instancePrototype):K=jt.prototype;var pe=Tt(S,function(){if(Object.getPrototypeOf(this)!==w)throw new Y("Use 'new' to construct "+S);if(k.constructor_body===void 0)throw new Y(S+" has no accessible constructor");var Jr=k.constructor_body[arguments.length];if(Jr===void 0)throw new Y(`Tried to invoke ctor of ${S} with invalid number of parameters (${arguments.length}) - expected (${Object.keys(k.constructor_body).toString()}) parameters instead!`);return Jr.apply(this,arguments)}),w=Object.create(K,{constructor:{value:pe}});pe.prototype=w;var k=new Xn(S,pe,w,F,se,u,p,C);if(k.baseClass){var le,de;(de=(le=k.baseClass).__derivedClasses)!==null&&de!==void 0||(le.__derivedClasses=[]),k.baseClass.__derivedClasses.push(k)}var ut=new Rt(S,k,!0,!1,!1),Wt=new Rt(S+"*",k,!1,!1,!1),zr=new Rt(S+" const*",k,!1,!0,!1);return Cr[e]={pointerType:Wt,constPointerType:zr},Pr(L,pe),[ut,Wt,zr]})},sr=(e,t)=>{for(var n=[],o=0;o<e;o++)n.push(N[t+o*4>>2]);return n};function la(e){for(var t=1;t<e.length;++t)if(e[t]!==null&&e[t].destructorFunction===void 0)return!0;return!1}function lr(e,t,n,o,s,u){var f=t.length;f<2&&R("argTypes array size mismatch! Must at least get return value and 'this' types!");var p=t[1]!==null&&n!==null,y=la(t),C=t[0].name!=="void",S=f-2,A=new Array(S),F=[],L=[],ee=function(){arguments.length!==S&&R(`function ${e} called with ${arguments.length} arguments, expected ${S}`),L.length=0;var se;F.length=p?2:1,F[0]=s,p&&(se=t[1].toWireType(L,this),F[1]=se);for(var K=0;K<S;++K)A[K]=t[K+2].toWireType(L,arguments[K]),F.push(A[K]);var pe=o.apply(null,F);function w(k){if(y)st(L);else for(var le=p?1:2;le<t.length;le++){var de=le===1?se:A[le-2];t[le].destructorFunction!==null&&t[le].destructorFunction(de)}if(C)return t[0].fromWireType(k)}return w(pe)};return Tt(e,ee)}var ua=(e,t,n,o,s,u)=>{var f=sr(t,n);s=Oe(o,s),b([],[e],function(p){p=p[0];var y=`constructor ${p.name}`;if(p.registeredClass.constructor_body===void 0&&(p.registeredClass.constructor_body=[]),p.registeredClass.constructor_body[t-1]!==void 0)throw new Y(`Cannot register multiple constructors with identical number of parameters (${t-1}) for class '${p.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return p.registeredClass.constructor_body[t-1]=()=>{It(`Cannot construct ${p.name} due to unbound types`,f)},b([],f,C=>(C.splice(1,0,null),p.registeredClass.constructor_body[t-1]=lr(y,C,null,s,u),[])),[]})},Or=e=>{e=e.trim();const t=e.indexOf("(");return t!==-1?e.substr(0,t):e},ca=(e,t,n,o,s,u,f,p,y)=>{var C=sr(n,o);t=X(t),t=Or(t),u=Oe(s,u),b([],[e],function(S){S=S[0];var A=`${S.name}.${t}`;t.startsWith("@@")&&(t=Symbol[t.substring(2)]),p&&S.registeredClass.pureVirtualFunctions.push(t);function F(){It(`Cannot call ${A} due to unbound types`,C)}var L=S.registeredClass.instancePrototype,ee=L[t];return ee===void 0||ee.overloadTable===void 0&&ee.className!==S.name&&ee.argCount===n-2?(F.argCount=n-2,F.className=S.name,L[t]=F):($r(L,t,A),L[t].overloadTable[n-2]=F),b([],C,function(se){var K=lr(A,se,S,u,f);return L[t].overloadTable===void 0?(K.argCount=n-2,L[t]=K):L[t].overloadTable[n-2]=K,[]}),[]})};function da(){Object.assign(Dr.prototype,{get(e){return this.allocated[e]},has(e){return this.allocated[e]!==void 0},allocate(e){var t=this.freelist.pop()||this.allocated.length;return this.allocated[t]=e,t},free(e){this.allocated[e]=void 0,this.freelist.push(e)}})}function Dr(){this.allocated=[void 0],this.freelist=[]}var Se=new Dr,ur=e=>{e>=Se.reserved&&--Se.get(e).refcount===0&&Se.free(e)},fa=()=>{for(var e=0,t=Se.reserved;t<Se.allocated.length;++t)Se.allocated[t]!==void 0&&++e;return e},pa=()=>{Se.allocated.push({value:void 0},{value:null},{value:!0},{value:!1}),Se.reserved=Se.allocated.length,a.count_emval_handles=fa},qe={toValue:e=>(e||R("Cannot use deleted val. handle = "+e),Se.get(e).value),toHandle:e=>{switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:return Se.allocate({refcount:1,value:e})}}},va=(e,t)=>{t=X(t),Re(e,{name:t,fromWireType:n=>{var o=qe.toValue(n);return ur(n),o},toWireType:(n,o)=>qe.toHandle(o),argPackAdvance:Fe,readValueFromPointer:bt,destructorFunction:null})},ma=(e,t,n)=>{switch(t){case 1:return n?function(o){return this.fromWireType(U[o>>0])}:function(o){return this.fromWireType(Q[o>>0])};case 2:return n?function(o){return this.fromWireType(ve[o>>1])}:function(o){return this.fromWireType(J[o>>1])};case 4:return n?function(o){return this.fromWireType(j[o>>2])}:function(o){return this.fromWireType(N[o>>2])};default:throw new TypeError(`invalid integer width (${t}): ${e}`)}},ha=(e,t,n,o)=>{t=X(t);function s(){}s.values={},Re(e,{name:t,constructor:s,fromWireType:function(u){return this.constructor.values[u]},toWireType:(u,f)=>f.value,argPackAdvance:Fe,readValueFromPointer:ma(t,n,o),destructorFunction:null}),or(t,s)},cr=(e,t)=>{var n=Le[e];return n===void 0&&R(t+" has unknown type "+Er(e)),n},ya=(e,t,n)=>{var o=cr(e,"enum");t=X(t);var s=o.constructor,u=Object.create(o.constructor.prototype,{value:{value:n},constructor:{value:Tt(`${o.name}_${t}`,function(){})}});s.values[n]=u,s[t]=u},dr=e=>{if(e===null)return"null";var t=typeof e;return t==="object"||t==="array"||t==="function"?e.toString():""+e},ga=(e,t)=>{switch(t){case 4:return function(n){return this.fromWireType(xe[n>>2])};case 8:return function(n){return this.fromWireType(Ce[n>>3])};default:throw new TypeError(`invalid float width (${t}): ${e}`)}},ba=(e,t,n)=>{t=X(t),Re(e,{name:t,fromWireType:o=>o,toWireType:(o,s)=>s,argPackAdvance:Fe,readValueFromPointer:ga(t,n),destructorFunction:null})},wa=(e,t,n,o,s,u,f)=>{var p=sr(t,n);e=X(e),e=Or(e),s=Oe(o,s),or(e,function(){It(`Cannot call ${e} due to unbound types`,p)},t-1),b([],p,function(y){var C=[y[0],null].concat(y.slice(1));return Pr(e,lr(e,C,null,s,u),t-1),[]})},_a=(e,t,n)=>{switch(t){case 1:return n?o=>U[o>>0]:o=>Q[o>>0];case 2:return n?o=>ve[o>>1]:o=>J[o>>1];case 4:return n?o=>j[o>>2]:o=>N[o>>2];default:throw new TypeError(`invalid integer width (${t}): ${e}`)}},xa=(e,t,n,o,s)=>{t=X(t);var u=S=>S;if(o===0){var f=32-8*n;u=S=>S<<f>>>f}var p=t.includes("unsigned"),y=(S,A)=>{},C;p?C=function(S,A){return y(A,this.name),A>>>0}:C=function(S,A){return y(A,this.name),A},Re(e,{name:t,fromWireType:u,toWireType:C,argPackAdvance:Fe,readValueFromPointer:_a(t,n,o!==0),destructorFunction:null})},Ca=(e,t,n)=>{var o=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],s=o[t];function u(f){var p=N[f>>2],y=N[f+4>>2];return new s(U.buffer,y,p)}n=X(n),Re(e,{name:n,fromWireType:u,argPackAdvance:Fe,readValueFromPointer:u},{ignoreDuplicateRegistrations:!0})},Mr=(e,t,n,o)=>{if(!(o>0))return 0;for(var s=n,u=n+o-1,f=0;f<e.length;++f){var p=e.charCodeAt(f);if(p>=55296&&p<=57343){var y=e.charCodeAt(++f);p=65536+((p&1023)<<10)|y&1023}if(p<=127){if(n>=u)break;t[n++]=p}else if(p<=2047){if(n+1>=u)break;t[n++]=192|p>>6,t[n++]=128|p&63}else if(p<=65535){if(n+2>=u)break;t[n++]=224|p>>12,t[n++]=128|p>>6&63,t[n++]=128|p&63}else{if(n+3>=u)break;t[n++]=240|p>>18,t[n++]=128|p>>12&63,t[n++]=128|p>>6&63,t[n++]=128|p&63}}return t[n]=0,n-s},$a=(e,t,n)=>Mr(e,Q,t,n),Ar=e=>{for(var t=0,n=0;n<e.length;++n){var o=e.charCodeAt(n);o<=127?t++:o<=2047?t+=2:o>=55296&&o<=57343?(t+=4,++n):t+=3}return t},jr=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,Ta=(e,t,n)=>{for(var o=t+n,s=t;e[s]&&!(s>=o);)++s;if(s-t>16&&e.buffer&&jr)return jr.decode(e.subarray(t,s));for(var u="";t<s;){var f=e[t++];if(!(f&128)){u+=String.fromCharCode(f);continue}var p=e[t++]&63;if((f&224)==192){u+=String.fromCharCode((f&31)<<6|p);continue}var y=e[t++]&63;if((f&240)==224?f=(f&15)<<12|p<<6|y:f=(f&7)<<18|p<<12|y<<6|e[t++]&63,f<65536)u+=String.fromCharCode(f);else{var C=f-65536;u+=String.fromCharCode(55296|C>>10,56320|C&1023)}}return u},fr=(e,t)=>e?Ta(Q,e,t):"",Pa=(e,t)=>{t=X(t);var n=t==="std::string";Re(e,{name:t,fromWireType(o){var s=N[o>>2],u=o+4,f;if(n)for(var p=u,y=0;y<=s;++y){var C=u+y;if(y==s||Q[C]==0){var S=C-p,A=fr(p,S);f===void 0?f=A:(f+="\0",f+=A),p=C+1}}else{for(var F=new Array(s),y=0;y<s;++y)F[y]=String.fromCharCode(Q[u+y]);f=F.join("")}return Ve(o),f},toWireType(o,s){s instanceof ArrayBuffer&&(s=new Uint8Array(s));var u,f=typeof s=="string";f||s instanceof Uint8Array||s instanceof Uint8ClampedArray||s instanceof Int8Array||R("Cannot pass non-string to std::string"),n&&f?u=Ar(s):u=s.length;var p=mr(4+u+1),y=p+4;if(N[p>>2]=u,n&&f)$a(s,y,u+1);else if(f)for(var C=0;C<u;++C){var S=s.charCodeAt(C);S>255&&(Ve(y),R("String has UTF-16 code units that do not fit in 8 bits")),Q[y+C]=S}else for(var C=0;C<u;++C)Q[y+C]=s[C];return o!==null&&o.push(Ve,p),p},argPackAdvance:Fe,readValueFromPointer:Tr,destructorFunction(o){Ve(o)}})},Rr=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,Sa=(e,t)=>{for(var n=e,o=n>>1,s=o+t/2;!(o>=s)&&J[o];)++o;if(n=o<<1,n-e>32&&Rr)return Rr.decode(Q.subarray(e,n));for(var u="",f=0;!(f>=t/2);++f){var p=ve[e+f*2>>1];if(p==0)break;u+=String.fromCharCode(p)}return u},ka=(e,t,n)=>{var o;if((o=n)!==null&&o!==void 0||(n=2147483647),n<2)return 0;n-=2;for(var s=t,u=n<e.length*2?n/2:e.length,f=0;f<u;++f){var p=e.charCodeAt(f);ve[t>>1]=p,t+=2}return ve[t>>1]=0,t-s},Ea=e=>e.length*2,Oa=(e,t)=>{for(var n=0,o="";!(n>=t/4);){var s=j[e+n*4>>2];if(s==0)break;if(++n,s>=65536){var u=s-65536;o+=String.fromCharCode(55296|u>>10,56320|u&1023)}else o+=String.fromCharCode(s)}return o},Da=(e,t,n)=>{var o;if((o=n)!==null&&o!==void 0||(n=2147483647),n<4)return 0;for(var s=t,u=s+n-4,f=0;f<e.length;++f){var p=e.charCodeAt(f);if(p>=55296&&p<=57343){var y=e.charCodeAt(++f);p=65536+((p&1023)<<10)|y&1023}if(j[t>>2]=p,t+=4,t+4>u)break}return j[t>>2]=0,t-s},Ma=e=>{for(var t=0,n=0;n<e.length;++n){var o=e.charCodeAt(n);o>=55296&&o<=57343&&++n,t+=4}return t},Aa=(e,t,n)=>{n=X(n);var o,s,u,f,p;t===2?(o=Sa,s=ka,f=Ea,u=()=>J,p=1):t===4&&(o=Oa,s=Da,f=Ma,u=()=>N,p=2),Re(e,{name:n,fromWireType:y=>{for(var C=N[y>>2],S=u(),A,F=y+4,L=0;L<=C;++L){var ee=y+4+L*t;if(L==C||S[ee>>p]==0){var se=ee-F,K=o(F,se);A===void 0?A=K:(A+="\0",A+=K),F=ee+t}}return Ve(y),A},toWireType:(y,C)=>{typeof C!="string"&&R(`Cannot pass non-string to C++ string type ${n}`);var S=f(C),A=mr(4+S+t);return N[A>>2]=S>>p,s(C,A+4,S+t),y!==null&&y.push(Ve,A),A},argPackAdvance:Fe,readValueFromPointer:bt,destructorFunction(y){Ve(y)}})},ja=(e,t,n,o,s,u)=>{we[e]={name:X(t),rawConstructor:Oe(n,o),rawDestructor:Oe(s,u),fields:[]}},Ra=(e,t,n,o,s,u,f,p,y,C)=>{we[e].fields.push({fieldName:X(t),getterReturnType:n,getter:Oe(o,s),getterContext:u,setterArgumentType:f,setter:Oe(p,y),setterContext:C})},Fa=(e,t)=>{t=X(t),Re(e,{isVoid:!0,name:t,argPackAdvance:0,fromWireType:()=>{},toWireType:(n,o)=>{}})},pr=[],Ia=(e,t,n,o)=>(e=pr[e],t=qe.toValue(t),e(null,t,n,o)),Ua={},Na=e=>{var t=Ua[e];return t===void 0?X(e):t},Fr=()=>{if(typeof globalThis=="object")return globalThis;function e(t){t.$$$embind_global$$$=t;var n=typeof $$$embind_global$$$=="object"&&t.$$$embind_global$$$==t;return n||delete t.$$$embind_global$$$,n}if(typeof $$$embind_global$$$=="object"||(typeof global=="object"&&e(global)?$$$embind_global$$$=global:typeof self=="object"&&e(self)&&($$$embind_global$$$=self),typeof $$$embind_global$$$=="object"))return $$$embind_global$$$;throw Error("unable to get global object.")},Wa=e=>e===0?qe.toHandle(Fr()):(e=Na(e),qe.toHandle(Fr()[e])),Ba=e=>{var t=pr.length;return pr.push(e),t},La=(e,t)=>{for(var n=new Array(e),o=0;o<e;++o)n[o]=cr(N[t+o*4>>2],"parameter "+o);return n},qa=Reflect.construct,Va=(e,t,n)=>{var o=[],s=e.toWireType(o,n);return o.length&&(N[t>>2]=qe.toHandle(o)),s},Ha=(e,t,n)=>{var o=La(e,t),s=o.shift();e--;var u=new Array(e),f=(y,C,S,A)=>{for(var F=0,L=0;L<e;++L)u[L]=o[L].readValueFromPointer(A+F),F+=o[L].argPackAdvance;for(var ee=n===1?qa(C,u):C.apply(y,u),L=0;L<e;++L){var se,K;(se=(K=o[L]).deleteObject)===null||se===void 0||se.call(K,u[L])}return Va(s,S,ee)},p=`methodCaller<(${o.map(y=>y.name).join(", ")}) => ${s.name}>`;return Ba(Tt(p,f))},za=e=>{e>4&&(Se.get(e).refcount+=1)},Ja=e=>{var t=qe.toValue(e);st(t),ur(e)},Ga=(e,t)=>{e=cr(e,"_emval_take_value");var n=e.readValueFromPointer(t);return qe.toHandle(n)},Qa=()=>{be("")},Ya=(e,t,n)=>Q.copyWithin(e,t,t+n),Ka=()=>2147483648,Xa=e=>{var t=M.buffer,n=(e-t.byteLength+65535)/65536;try{return M.grow(n),Je(),1}catch{}},Za=e=>{var t=Q.length;e>>>=0;var n=Ka();if(e>n)return!1;for(var o=(y,C)=>y+(C-y%C)%C,s=1;s<=4;s*=2){var u=t*(1+.2/s);u=Math.min(u,e+100663296);var f=Math.min(n,o(Math.max(e,u),65536)),p=Xa(f);if(p)return!0}return!1},vr={},eo=()=>g||"./this.program",Pt=()=>{if(!Pt.strings){var e=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:e,_:eo()};for(var n in vr)vr[n]===void 0?delete t[n]:t[n]=vr[n];var o=[];for(var n in t)o.push(`${n}=${t[n]}`);Pt.strings=o}return Pt.strings},to=(e,t)=>{for(var n=0;n<e.length;++n)U[t++>>0]=e.charCodeAt(n);U[t>>0]=0},ro=(e,t)=>{var n=0;return Pt().forEach((o,s)=>{var u=t+n;N[e+s*4>>2]=u,to(o,u),n+=o.length+1}),0},no=(e,t)=>{var n=Pt();N[e>>2]=n.length;var o=0;return n.forEach(s=>o+=s.length+1),N[t>>2]=o,0},ao=e=>e,Ut=e=>e%4===0&&(e%100!==0||e%400===0),oo=(e,t)=>{for(var n=0,o=0;o<=t;n+=e[o++]);return n},Ir=[31,29,31,30,31,30,31,31,30,31,30,31],Ur=[31,28,31,30,31,30,31,31,30,31,30,31],io=(e,t)=>{for(var n=new Date(e.getTime());t>0;){var o=Ut(n.getFullYear()),s=n.getMonth(),u=(o?Ir:Ur)[s];if(t>u-n.getDate())t-=u-n.getDate()+1,n.setDate(1),s<11?n.setMonth(s+1):(n.setMonth(0),n.setFullYear(n.getFullYear()+1));else return n.setDate(n.getDate()+t),n}return n};function so(e,t,n){var o=Ar(e)+1,s=new Array(o);return Mr(e,s,0,s.length),s}var lo=(e,t)=>{U.set(e,t)},uo=(e,t,n,o)=>{var s=N[o+40>>2],u={tm_sec:j[o>>2],tm_min:j[o+4>>2],tm_hour:j[o+8>>2],tm_mday:j[o+12>>2],tm_mon:j[o+16>>2],tm_year:j[o+20>>2],tm_wday:j[o+24>>2],tm_yday:j[o+28>>2],tm_isdst:j[o+32>>2],tm_gmtoff:j[o+36>>2],tm_zone:s?fr(s):""},f=fr(n),p={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var y in p)f=f.replace(new RegExp(y,"g"),p[y]);var C=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],S=["January","February","March","April","May","June","July","August","September","October","November","December"];function A(w,k,le){for(var de=typeof w=="number"?w.toString():w||"";de.length<k;)de=le[0]+de;return de}function F(w,k){return A(w,k,"0")}function L(w,k){function le(ut){return ut<0?-1:ut>0?1:0}var de;return(de=le(w.getFullYear()-k.getFullYear()))===0&&(de=le(w.getMonth()-k.getMonth()))===0&&(de=le(w.getDate()-k.getDate())),de}function ee(w){switch(w.getDay()){case 0:return new Date(w.getFullYear()-1,11,29);case 1:return w;case 2:return new Date(w.getFullYear(),0,3);case 3:return new Date(w.getFullYear(),0,2);case 4:return new Date(w.getFullYear(),0,1);case 5:return new Date(w.getFullYear()-1,11,31);case 6:return new Date(w.getFullYear()-1,11,30)}}function se(w){var k=io(new Date(w.tm_year+1900,0,1),w.tm_yday),le=new Date(k.getFullYear(),0,4),de=new Date(k.getFullYear()+1,0,4),ut=ee(le),Wt=ee(de);return L(ut,k)<=0?L(Wt,k)<=0?k.getFullYear()+1:k.getFullYear():k.getFullYear()-1}var K={"%a":w=>C[w.tm_wday].substring(0,3),"%A":w=>C[w.tm_wday],"%b":w=>S[w.tm_mon].substring(0,3),"%B":w=>S[w.tm_mon],"%C":w=>{var k=w.tm_year+1900;return F(k/100|0,2)},"%d":w=>F(w.tm_mday,2),"%e":w=>A(w.tm_mday,2," "),"%g":w=>se(w).toString().substring(2),"%G":w=>se(w),"%H":w=>F(w.tm_hour,2),"%I":w=>{var k=w.tm_hour;return k==0?k=12:k>12&&(k-=12),F(k,2)},"%j":w=>F(w.tm_mday+oo(Ut(w.tm_year+1900)?Ir:Ur,w.tm_mon-1),3),"%m":w=>F(w.tm_mon+1,2),"%M":w=>F(w.tm_min,2),"%n":()=>`
`,"%p":w=>w.tm_hour>=0&&w.tm_hour<12?"AM":"PM","%S":w=>F(w.tm_sec,2),"%t":()=>"	","%u":w=>w.tm_wday||7,"%U":w=>{var k=w.tm_yday+7-w.tm_wday;return F(Math.floor(k/7),2)},"%V":w=>{var k=Math.floor((w.tm_yday+7-(w.tm_wday+6)%7)/7);if((w.tm_wday+371-w.tm_yday-2)%7<=2&&k++,k){if(k==53){var le=(w.tm_wday+371-w.tm_yday)%7;le!=4&&(le!=3||!Ut(w.tm_year))&&(k=1)}}else{k=52;var de=(w.tm_wday+7-w.tm_yday-1)%7;(de==4||de==5&&Ut(w.tm_year%400-1))&&k++}return F(k,2)},"%w":w=>w.tm_wday,"%W":w=>{var k=w.tm_yday+7-(w.tm_wday+6)%7;return F(Math.floor(k/7),2)},"%y":w=>(w.tm_year+1900).toString().substring(2),"%Y":w=>w.tm_year+1900,"%z":w=>{var k=w.tm_gmtoff,le=k>=0;return k=Math.abs(k)/60,k=k/60*100+k%60,(le?"+":"-")+("0000"+k).slice(-4)},"%Z":w=>w.tm_zone,"%%":()=>"%"};f=f.replace(/%%/g,"\0\0");for(var y in K)f.includes(y)&&(f=f.replace(new RegExp(y,"g"),K[y](u)));f=f.replace(/\0\0/g,"%");var pe=so(f);return pe.length>t?0:(lo(pe,e),pe.length-1)},co=(e,t,n,o,s)=>uo(e,t,n,o);x=a.InternalError=class extends Error{constructor(e){super(e),this.name="InternalError"}},ne(),Y=a.BindingError=class extends Error{constructor(e){super(e),this.name="BindingError"}},Gn(),Vn(),ra(),kr=a.UnboundTypeError=ia(Error,"UnboundTypeError"),da(),pa();var fo={s:Gt,u:Qt,b:Kt,g:Xt,q:Zt,J:Mt,f:er,V:tr,d:Yt,da:te,Q:re,_:Un,ca:sa,ba:ua,w:ca,Y:va,x:ha,h:ya,L:ba,M:wa,t:xa,o:Ca,K:Pa,C:Aa,A:ja,ea:Ra,$:Fa,R:Ia,ha:ur,fa:Wa,Z:Ha,N:za,O:Ja,aa:Ga,B:Qa,X:Ya,W:Za,T:ro,U:no,E:ko,D:yo,F:So,n:Eo,a:po,e:bo,m:ho,k:_o,H:To,v:Co,G:Po,z:Do,P:Ao,l:wo,j:go,c:mo,p:vo,I:$o,r:Oo,i:xo,y:Mo,ga:ao,S:co},ce=Jt(),Ve=a._free=e=>(Ve=a._free=ce.ka)(e),mr=a._malloc=e=>(mr=a._malloc=ce.la)(e),Nr=e=>(Nr=ce.na)(e),Z=(e,t)=>(Z=ce.oa)(e,t),St=e=>(St=ce.pa)(e),oe=()=>(oe=ce.qa)(),ie=e=>(ie=ce.ra)(e),Wr=e=>(Wr=ce.sa)(e),Br=e=>(Br=ce.ta)(e),Lr=(e,t,n)=>(Lr=ce.ua)(e,t,n),qr=e=>(qr=ce.va)(e);a.dynCall_viijii=(e,t,n,o,s,u,f)=>(a.dynCall_viijii=ce.wa)(e,t,n,o,s,u,f);var Vr=a.dynCall_jiiii=(e,t,n,o,s)=>(Vr=a.dynCall_jiiii=ce.xa)(e,t,n,o,s);a.dynCall_iiiiij=(e,t,n,o,s,u,f)=>(a.dynCall_iiiiij=ce.ya)(e,t,n,o,s,u,f),a.dynCall_iiiiijj=(e,t,n,o,s,u,f,p,y)=>(a.dynCall_iiiiijj=ce.za)(e,t,n,o,s,u,f,p,y),a.dynCall_iiiiiijj=(e,t,n,o,s,u,f,p,y,C)=>(a.dynCall_iiiiiijj=ce.Aa)(e,t,n,o,s,u,f,p,y,C);function po(e,t){var n=oe();try{return ae(e)(t)}catch(o){if(ie(n),o!==o+0)throw o;Z(1,0)}}function vo(e,t,n,o){var s=oe();try{ae(e)(t,n,o)}catch(u){if(ie(s),u!==u+0)throw u;Z(1,0)}}function mo(e,t,n){var o=oe();try{ae(e)(t,n)}catch(s){if(ie(o),s!==s+0)throw s;Z(1,0)}}function ho(e,t,n,o){var s=oe();try{return ae(e)(t,n,o)}catch(u){if(ie(s),u!==u+0)throw u;Z(1,0)}}function yo(e,t,n,o,s){var u=oe();try{return ae(e)(t,n,o,s)}catch(f){if(ie(u),f!==f+0)throw f;Z(1,0)}}function go(e,t){var n=oe();try{ae(e)(t)}catch(o){if(ie(n),o!==o+0)throw o;Z(1,0)}}function bo(e,t,n){var o=oe();try{return ae(e)(t,n)}catch(s){if(ie(o),s!==s+0)throw s;Z(1,0)}}function wo(e){var t=oe();try{ae(e)()}catch(n){if(ie(t),n!==n+0)throw n;Z(1,0)}}function _o(e,t,n,o,s){var u=oe();try{return ae(e)(t,n,o,s)}catch(f){if(ie(u),f!==f+0)throw f;Z(1,0)}}function xo(e,t,n,o,s,u,f,p,y,C,S){var A=oe();try{ae(e)(t,n,o,s,u,f,p,y,C,S)}catch(F){if(ie(A),F!==F+0)throw F;Z(1,0)}}function Co(e,t,n,o,s,u,f){var p=oe();try{return ae(e)(t,n,o,s,u,f)}catch(y){if(ie(p),y!==y+0)throw y;Z(1,0)}}function $o(e,t,n,o,s){var u=oe();try{ae(e)(t,n,o,s)}catch(f){if(ie(u),f!==f+0)throw f;Z(1,0)}}function To(e,t,n,o,s,u){var f=oe();try{return ae(e)(t,n,o,s,u)}catch(p){if(ie(f),p!==p+0)throw p;Z(1,0)}}function Po(e,t,n,o,s,u,f,p){var y=oe();try{return ae(e)(t,n,o,s,u,f,p)}catch(C){if(ie(y),C!==C+0)throw C;Z(1,0)}}function So(e,t,n,o){var s=oe();try{return ae(e)(t,n,o)}catch(u){if(ie(s),u!==u+0)throw u;Z(1,0)}}function ko(e,t,n,o){var s=oe();try{return ae(e)(t,n,o)}catch(u){if(ie(s),u!==u+0)throw u;Z(1,0)}}function Eo(e){var t=oe();try{return ae(e)()}catch(n){if(ie(t),n!==n+0)throw n;Z(1,0)}}function Oo(e,t,n,o,s,u,f,p){var y=oe();try{ae(e)(t,n,o,s,u,f,p)}catch(C){if(ie(y),C!==C+0)throw C;Z(1,0)}}function Do(e,t,n,o,s,u,f,p,y,C,S,A){var F=oe();try{return ae(e)(t,n,o,s,u,f,p,y,C,S,A)}catch(L){if(ie(F),L!==L+0)throw L;Z(1,0)}}function Mo(e,t,n,o,s,u,f,p,y,C,S,A,F,L,ee,se){var K=oe();try{ae(e)(t,n,o,s,u,f,p,y,C,S,A,F,L,ee,se)}catch(pe){if(ie(K),pe!==pe+0)throw pe;Z(1,0)}}function Ao(e,t,n,o,s){var u=oe();try{return Vr(e,t,n,o,s)}catch(f){if(ie(u),f!==f+0)throw f;Z(1,0)}}var Nt;We=function e(){Nt||Hr(),Nt||(We=e)};function Hr(){if(ye>0||(Pe(),ye>0))return;function e(){Nt||(Nt=!0,a.calledRun=!0,!E&&(ke(),l(a),a.onRuntimeInitialized&&a.onRuntimeInitialized(),Ge()))}a.setStatus?(a.setStatus("Running..."),setTimeout(function(){setTimeout(function(){a.setStatus("")},1),e()},1)):e()}if(a.preInit)for(typeof a.preInit=="function"&&(a.preInit=[a.preInit]);a.preInit.length>0;)a.preInit.pop()();return Hr(),i.ready}})();function Wi(r){return gr(br,r)}async function Bi(r,i){return Ui(br,r,i)}async function Li(r,i){return Ni(br,r,i)}var Ot;class hr extends EventTarget{constructor(i={}){var a;super(),vi(this,Ot,void 0);try{const l=(a=i==null?void 0:i.formats)==null?void 0:a.filter(c=>c!=="unknown");if((l==null?void 0:l.length)===0)throw new TypeError("Hint option provided, but is empty.");l==null||l.forEach(c=>{if(!qt.has(c))throw new TypeError(`Failed to read the 'formats' property from 'BarcodeDetectorOptions': The provided value '${c}' is not a valid enum value of type BarcodeFormat.`)}),mi(this,Ot,l??[]),Wi().then(c=>{this.dispatchEvent(new CustomEvent("load",{detail:c}))}).catch(c=>{this.dispatchEvent(new CustomEvent("error",{detail:c}))})}catch(l){throw Zr(l,"Failed to construct 'BarcodeDetector'")}}static async getSupportedFormats(){return hi.filter(i=>i!=="unknown")}async detect(i){try{const a=await Ci(i);if(a===null)return[];let l;try{bn(a)?l=await Bi(a,{tryHarder:!0,formats:Xr(this,Ot).map(c=>qt.get(c))}):l=await Li(a,{tryHarder:!0,formats:Xr(this,Ot).map(c=>qt.get(c))})}catch(c){throw console.error(c),new DOMException("Barcode detection service unavailable.","NotSupportedError")}return l.map(c=>{const{topLeft:{x:v,y:g},topRight:{x:T,y:m},bottomLeft:{x:_,y:P},bottomRight:{x:$,y:H}}=c.position,W=Math.min(v,T,_,$),M=Math.min(g,m,P,H),E=Math.max(v,T,_,$),U=Math.max(g,m,P,H);return{boundingBox:new DOMRectReadOnly(W,M,E-W,U-M),rawValue:c.text,format:yi(c.format),cornerPoints:[{x:v,y:g},{x:T,y:m},{x:$,y:H},{x:_,y:P}]}})}catch(a){throw Zr(a,"Failed to execute 'detect' on 'BarcodeDetector'")}}}Ot=new WeakMap;const Cn=(r,i,a="error")=>{let l,c;const v=new Promise((g,T)=>{l=g,c=T,r.addEventListener(i,l),r.addEventListener(a,c)});return v.finally(()=>{r.removeEventListener(i,l),r.removeEventListener(a,c)}),v},nn=r=>new Promise(i=>setTimeout(i,r));class $n extends Error{constructor(){super("this browser has no Stream API support"),this.name="StreamApiNotSupportedError"}}class qi extends Error{constructor(){super("camera access is only permitted in secure context. Use HTTPS or localhost rather than HTTP."),this.name="InsecureContextError"}}class Vi extends Error{constructor(){super("Loading camera stream timed out after 6 seconds. If you are on iOS in PWA mode, this is a known issue (see https://github.com/gruhn/vue-qrcode-reader/issues/298)"),this.name="StreamLoadTimeoutError"}}const Hi=r=>{let i=!1,a;return(...l)=>(i||(a=r(l),i=!0),a)};function Ie(r,i){if(r===!1)throw new Error(i??"assertion failure")}function an(r){throw new Error("this code should be unreachable")}function zi(){return navigator.platform.toUpperCase().includes("MAC")}let Tn;async function Ji(r){if(window.BarcodeDetector===void 0)return console.debug("[vue-qrcode-reader] Native BarcodeDetector not supported. Will use polyfill."),new hr({formats:r});const i=await window.BarcodeDetector.getSupportedFormats(),a=r.filter(l=>!i.includes(l));return a.length>0?(console.debug(`[vue-qrcode-reader] Native BarcodeDetector does not support formats ${JSON.stringify(a)}. Will use polyfill.`),new hr({formats:r})):zi()&&r.includes("pdf417")?(console.debug("[vue-qrcode-reader] Native BarcodeDetector is buggy for PDF417 codes on MacOS. Will use polyfill."),new hr({formats:r})):(console.debug("[vue-qrcode-reader] Will use native BarcodeDetector."),new window.BarcodeDetector({formats:r}))}async function Pn(r){Tn=await Ji(r)}const Gi=async(r,{detectHandler:i,locateHandler:a,minDelay:l,formats:c})=>{console.debug("[vue-qrcode-reader] start scanning"),await Pn(c);const v=g=>async T=>{if(r.readyState===0)console.debug("[vue-qrcode-reader] stop scanning: video element readyState is 0");else{const{lastScanned:m,contentBefore:_,lastScanHadContent:P}=g;if(T-m<l)window.requestAnimationFrame(v(g));else{const $=await Tn.detect(r),H=$.some(E=>!_.includes(E.rawValue));H&&i($);const W=$.length>0;W&&a($),!W&&P&&a($);const M={lastScanned:T,lastScanHadContent:W,contentBefore:H?$.map(E=>E.rawValue):_};window.requestAnimationFrame(v(M))}}};v({lastScanned:performance.now(),contentBefore:[],lastScanHadContent:!1})(performance.now())};var Sn={},_e={};Object.defineProperty(_e,"__esModule",{value:!0});_e.compactObject=On;_e.deprecated=ns;var Qi=_e.detectBrowser=as;_e.disableLog=es;_e.disableWarnings=ts;_e.extractVersion=Vt;_e.filterStats=os;_e.log=rs;_e.walkStats=Ht;_e.wrapPeerConnectionEvent=Zi;function Yi(r,i,a){return i=Ki(i),i in r?Object.defineProperty(r,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):r[i]=a,r}function Ki(r){var i=Xi(r,"string");return Ke(i)==="symbol"?i:String(i)}function Xi(r,i){if(Ke(r)!=="object"||r===null)return r;var a=r[Symbol.toPrimitive];if(a!==void 0){var l=a.call(r,i);if(Ke(l)!=="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(r)}function Ke(r){"@babel/helpers - typeof";return Ke=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},Ke(r)}var kn=!0,En=!0;function Vt(r,i,a){var l=r.match(i);return l&&l.length>=a&&parseInt(l[a],10)}function Zi(r,i,a){if(r.RTCPeerConnection){var l=r.RTCPeerConnection.prototype,c=l.addEventListener;l.addEventListener=function(g,T){if(g!==i)return c.apply(this,arguments);var m=function(_){var P=a(_);P&&(T.handleEvent?T.handleEvent(P):T(P))};return this._eventMap=this._eventMap||{},this._eventMap[i]||(this._eventMap[i]=new Map),this._eventMap[i].set(T,m),c.apply(this,[g,m])};var v=l.removeEventListener;l.removeEventListener=function(g,T){if(g!==i||!this._eventMap||!this._eventMap[i])return v.apply(this,arguments);if(!this._eventMap[i].has(T))return v.apply(this,arguments);var m=this._eventMap[i].get(T);return this._eventMap[i].delete(T),this._eventMap[i].size===0&&delete this._eventMap[i],Object.keys(this._eventMap).length===0&&delete this._eventMap,v.apply(this,[g,m])},Object.defineProperty(l,"on"+i,{get:function(){return this["_on"+i]},set:function(g){this["_on"+i]&&(this.removeEventListener(i,this["_on"+i]),delete this["_on"+i]),g&&this.addEventListener(i,this["_on"+i]=g)},enumerable:!0,configurable:!0})}}function es(r){return typeof r!="boolean"?new Error("Argument type: "+Ke(r)+". Please use a boolean."):(kn=r,r?"adapter.js logging disabled":"adapter.js logging enabled")}function ts(r){return typeof r!="boolean"?new Error("Argument type: "+Ke(r)+". Please use a boolean."):(En=!r,"adapter.js deprecation warnings "+(r?"disabled":"enabled"))}function rs(){if((typeof window>"u"?"undefined":Ke(window))==="object"){if(kn)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function ns(r,i){En&&console.warn(r+" is deprecated, please use "+i+" instead.")}function as(r){var i={browser:null,version:null};if(typeof r>"u"||!r.navigator||!r.navigator.userAgent)return i.browser="Not a browser.",i;var a=r.navigator;if(a.mozGetUserMedia)i.browser="firefox",i.version=Vt(a.userAgent,/Firefox\/(\d+)\./,1);else if(a.webkitGetUserMedia||r.isSecureContext===!1&&r.webkitRTCPeerConnection)i.browser="chrome",i.version=Vt(a.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(r.RTCPeerConnection&&a.userAgent.match(/AppleWebKit\/(\d+)\./))i.browser="safari",i.version=Vt(a.userAgent,/AppleWebKit\/(\d+)\./,1),i.supportsUnifiedPlan=r.RTCRtpTransceiver&&"currentDirection"in r.RTCRtpTransceiver.prototype;else return i.browser="Not a supported browser.",i;return i}function on(r){return Object.prototype.toString.call(r)==="[object Object]"}function On(r){return on(r)?Object.keys(r).reduce(function(i,a){var l=on(r[a]),c=l?On(r[a]):r[a],v=l&&!Object.keys(c).length;return c===void 0||v?i:Object.assign(i,Yi({},a,c))},{}):r}function Ht(r,i,a){!i||a.has(i.id)||(a.set(i.id,i),Object.keys(i).forEach(function(l){l.endsWith("Id")?Ht(r,r.get(i[l]),a):l.endsWith("Ids")&&i[l].forEach(function(c){Ht(r,r.get(c),a)})}))}function os(r,i,a){var l=a?"outbound-rtp":"inbound-rtp",c=new Map;if(i===null)return c;var v=[];return r.forEach(function(g){g.type==="track"&&g.trackIdentifier===i.id&&v.push(g)}),v.forEach(function(g){r.forEach(function(T){T.type===l&&T.trackId===g.id&&Ht(r,T,c)})}),c}Object.defineProperty(Sn,"__esModule",{value:!0});var is=Sn.shimGetUserMedia=us,ss=ls(_e);function Dn(r){if(typeof WeakMap!="function")return null;var i=new WeakMap,a=new WeakMap;return(Dn=function(l){return l?a:i})(r)}function ls(r,i){if(r&&r.__esModule)return r;if(r===null||Ye(r)!=="object"&&typeof r!="function")return{default:r};var a=Dn(i);if(a&&a.has(r))return a.get(r);var l={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var v in r)if(v!=="default"&&Object.prototype.hasOwnProperty.call(r,v)){var g=c?Object.getOwnPropertyDescriptor(r,v):null;g&&(g.get||g.set)?Object.defineProperty(l,v,g):l[v]=r[v]}return l.default=r,a&&a.set(r,l),l}function Ye(r){"@babel/helpers - typeof";return Ye=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},Ye(r)}var sn=ss.log;function us(r,i){var a=r&&r.navigator;if(a.mediaDevices){var l=function(m){if(Ye(m)!=="object"||m.mandatory||m.optional)return m;var _={};return Object.keys(m).forEach(function(P){if(!(P==="require"||P==="advanced"||P==="mediaSource")){var $=Ye(m[P])==="object"?m[P]:{ideal:m[P]};$.exact!==void 0&&typeof $.exact=="number"&&($.min=$.max=$.exact);var H=function(M,E){return M?M+E.charAt(0).toUpperCase()+E.slice(1):E==="deviceId"?"sourceId":E};if($.ideal!==void 0){_.optional=_.optional||[];var W={};typeof $.ideal=="number"?(W[H("min",P)]=$.ideal,_.optional.push(W),W={},W[H("max",P)]=$.ideal,_.optional.push(W)):(W[H("",P)]=$.ideal,_.optional.push(W))}$.exact!==void 0&&typeof $.exact!="number"?(_.mandatory=_.mandatory||{},_.mandatory[H("",P)]=$.exact):["min","max"].forEach(function(M){$[M]!==void 0&&(_.mandatory=_.mandatory||{},_.mandatory[H(M,P)]=$[M])})}}),m.advanced&&(_.optional=(_.optional||[]).concat(m.advanced)),_},c=function(m,_){if(i.version>=61)return _(m);if(m=JSON.parse(JSON.stringify(m)),m&&Ye(m.audio)==="object"){var P=function(M,E,U){E in M&&!(U in M)&&(M[U]=M[E],delete M[E])};m=JSON.parse(JSON.stringify(m)),P(m.audio,"autoGainControl","googAutoGainControl"),P(m.audio,"noiseSuppression","googNoiseSuppression"),m.audio=l(m.audio)}if(m&&Ye(m.video)==="object"){var $=m.video.facingMode;$=$&&(Ye($)==="object"?$:{ideal:$});var H=i.version<66;if($&&($.exact==="user"||$.exact==="environment"||$.ideal==="user"||$.ideal==="environment")&&!(a.mediaDevices.getSupportedConstraints&&a.mediaDevices.getSupportedConstraints().facingMode&&!H)){delete m.video.facingMode;var W;if($.exact==="environment"||$.ideal==="environment"?W=["back","rear"]:($.exact==="user"||$.ideal==="user")&&(W=["front"]),W)return a.mediaDevices.enumerateDevices().then(function(M){M=M.filter(function(U){return U.kind==="videoinput"});var E=M.find(function(U){return W.some(function(Q){return U.label.toLowerCase().includes(Q)})});return!E&&M.length&&W.includes("back")&&(E=M[M.length-1]),E&&(m.video.deviceId=$.exact?{exact:E.deviceId}:{ideal:E.deviceId}),m.video=l(m.video),sn("chrome: "+JSON.stringify(m)),_(m)})}m.video=l(m.video)}return sn("chrome: "+JSON.stringify(m)),_(m)},v=function(m){return i.version>=64?m:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[m.name]||m.name,message:m.message,constraint:m.constraint||m.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}},g=function(m,_,P){c(m,function($){a.webkitGetUserMedia($,_,function(H){P&&P(v(H))})})};if(a.getUserMedia=g.bind(a),a.mediaDevices.getUserMedia){var T=a.mediaDevices.getUserMedia.bind(a.mediaDevices);a.mediaDevices.getUserMedia=function(m){return c(m,function(_){return T(_).then(function(P){if(_.audio&&!P.getAudioTracks().length||_.video&&!P.getVideoTracks().length)throw P.getTracks().forEach(function($){$.stop()}),new DOMException("","NotFoundError");return P},function(P){return Promise.reject(v(P))})})}}}}var Mn={};Object.defineProperty(Mn,"__esModule",{value:!0});var cs=Mn.shimGetUserMedia=ps,ds=fs(_e);function An(r){if(typeof WeakMap!="function")return null;var i=new WeakMap,a=new WeakMap;return(An=function(l){return l?a:i})(r)}function fs(r,i){if(r&&r.__esModule)return r;if(r===null||pt(r)!=="object"&&typeof r!="function")return{default:r};var a=An(i);if(a&&a.has(r))return a.get(r);var l={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var v in r)if(v!=="default"&&Object.prototype.hasOwnProperty.call(r,v)){var g=c?Object.getOwnPropertyDescriptor(r,v):null;g&&(g.get||g.set)?Object.defineProperty(l,v,g):l[v]=r[v]}return l.default=r,a&&a.set(r,l),l}function pt(r){"@babel/helpers - typeof";return pt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},pt(r)}function ps(r,i){var a=r&&r.navigator,l=r&&r.MediaStreamTrack;if(a.getUserMedia=function(m,_,P){ds.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),a.mediaDevices.getUserMedia(m).then(_,P)},!(i.version>55&&"autoGainControl"in a.mediaDevices.getSupportedConstraints())){var c=function(m,_,P){_ in m&&!(P in m)&&(m[P]=m[_],delete m[_])},v=a.mediaDevices.getUserMedia.bind(a.mediaDevices);if(a.mediaDevices.getUserMedia=function(m){return pt(m)==="object"&&pt(m.audio)==="object"&&(m=JSON.parse(JSON.stringify(m)),c(m.audio,"autoGainControl","mozAutoGainControl"),c(m.audio,"noiseSuppression","mozNoiseSuppression")),v(m)},l&&l.prototype.getSettings){var g=l.prototype.getSettings;l.prototype.getSettings=function(){var m=g.apply(this,arguments);return c(m,"mozAutoGainControl","autoGainControl"),c(m,"mozNoiseSuppression","noiseSuppression"),m}}if(l&&l.prototype.applyConstraints){var T=l.prototype.applyConstraints;l.prototype.applyConstraints=function(m){return this.kind==="audio"&&pt(m)==="object"&&(m=JSON.parse(JSON.stringify(m)),c(m,"autoGainControl","mozAutoGainControl"),c(m,"noiseSuppression","mozNoiseSuppression")),T.apply(this,[m])}}}}var Ne={};Object.defineProperty(Ne,"__esModule",{value:!0});Ne.shimAudioContext=Cs;Ne.shimCallbacksAPI=gs;Ne.shimConstraints=Fn;Ne.shimCreateOfferLegacy=xs;var vs=Ne.shimGetUserMedia=bs;Ne.shimLocalStreamsAPI=hs;Ne.shimRTCIceServerUrls=ws;Ne.shimRemoteStreamsAPI=ys;Ne.shimTrackEventTransceiver=_s;var jn=ms(_e);function Rn(r){if(typeof WeakMap!="function")return null;var i=new WeakMap,a=new WeakMap;return(Rn=function(l){return l?a:i})(r)}function ms(r,i){if(r&&r.__esModule)return r;if(r===null||Xe(r)!=="object"&&typeof r!="function")return{default:r};var a=Rn(i);if(a&&a.has(r))return a.get(r);var l={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var v in r)if(v!=="default"&&Object.prototype.hasOwnProperty.call(r,v)){var g=c?Object.getOwnPropertyDescriptor(r,v):null;g&&(g.get||g.set)?Object.defineProperty(l,v,g):l[v]=r[v]}return l.default=r,a&&a.set(r,l),l}function Xe(r){"@babel/helpers - typeof";return Xe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},Xe(r)}function hs(r){if(!(Xe(r)!=="object"||!r.RTCPeerConnection)){if("getLocalStreams"in r.RTCPeerConnection.prototype||(r.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in r.RTCPeerConnection.prototype)){var i=r.RTCPeerConnection.prototype.addTrack;r.RTCPeerConnection.prototype.addStream=function(a){var l=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(a)||this._localStreams.push(a),a.getAudioTracks().forEach(function(c){return i.call(l,c,a)}),a.getVideoTracks().forEach(function(c){return i.call(l,c,a)})},r.RTCPeerConnection.prototype.addTrack=function(a){for(var l=this,c=arguments.length,v=new Array(c>1?c-1:0),g=1;g<c;g++)v[g-1]=arguments[g];return v&&v.forEach(function(T){l._localStreams?l._localStreams.includes(T)||l._localStreams.push(T):l._localStreams=[T]}),i.apply(this,arguments)}}"removeStream"in r.RTCPeerConnection.prototype||(r.RTCPeerConnection.prototype.removeStream=function(a){var l=this;this._localStreams||(this._localStreams=[]);var c=this._localStreams.indexOf(a);if(c!==-1){this._localStreams.splice(c,1);var v=a.getTracks();this.getSenders().forEach(function(g){v.includes(g.track)&&l.removeTrack(g)})}})}}function ys(r){if(!(Xe(r)!=="object"||!r.RTCPeerConnection)&&("getRemoteStreams"in r.RTCPeerConnection.prototype||(r.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in r.RTCPeerConnection.prototype))){Object.defineProperty(r.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(a){var l=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=a),this.addEventListener("track",this._onaddstreampoly=function(c){c.streams.forEach(function(v){if(l._remoteStreams||(l._remoteStreams=[]),!l._remoteStreams.includes(v)){l._remoteStreams.push(v);var g=new Event("addstream");g.stream=v,l.dispatchEvent(g)}})})}});var i=r.RTCPeerConnection.prototype.setRemoteDescription;r.RTCPeerConnection.prototype.setRemoteDescription=function(){var a=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(l){l.streams.forEach(function(c){if(a._remoteStreams||(a._remoteStreams=[]),!(a._remoteStreams.indexOf(c)>=0)){a._remoteStreams.push(c);var v=new Event("addstream");v.stream=c,a.dispatchEvent(v)}})}),i.apply(a,arguments)}}}function gs(r){if(!(Xe(r)!=="object"||!r.RTCPeerConnection)){var i=r.RTCPeerConnection.prototype,a=i.createOffer,l=i.createAnswer,c=i.setLocalDescription,v=i.setRemoteDescription,g=i.addIceCandidate;i.createOffer=function(m,_){var P=arguments.length>=2?arguments[2]:arguments[0],$=a.apply(this,[P]);return _?($.then(m,_),Promise.resolve()):$},i.createAnswer=function(m,_){var P=arguments.length>=2?arguments[2]:arguments[0],$=l.apply(this,[P]);return _?($.then(m,_),Promise.resolve()):$};var T=function(m,_,P){var $=c.apply(this,[m]);return P?($.then(_,P),Promise.resolve()):$};i.setLocalDescription=T,T=function(m,_,P){var $=v.apply(this,[m]);return P?($.then(_,P),Promise.resolve()):$},i.setRemoteDescription=T,T=function(m,_,P){var $=g.apply(this,[m]);return P?($.then(_,P),Promise.resolve()):$},i.addIceCandidate=T}}function bs(r){var i=r&&r.navigator;if(i.mediaDevices&&i.mediaDevices.getUserMedia){var a=i.mediaDevices,l=a.getUserMedia.bind(a);i.mediaDevices.getUserMedia=function(c){return l(Fn(c))}}!i.getUserMedia&&i.mediaDevices&&i.mediaDevices.getUserMedia&&(i.getUserMedia=(function(c,v,g){i.mediaDevices.getUserMedia(c).then(v,g)}).bind(i))}function Fn(r){return r&&r.video!==void 0?Object.assign({},r,{video:jn.compactObject(r.video)}):r}function ws(r){if(r.RTCPeerConnection){var i=r.RTCPeerConnection;r.RTCPeerConnection=function(a,l){if(a&&a.iceServers){for(var c=[],v=0;v<a.iceServers.length;v++){var g=a.iceServers[v];g.urls===void 0&&g.url?(jn.deprecated("RTCIceServer.url","RTCIceServer.urls"),g=JSON.parse(JSON.stringify(g)),g.urls=g.url,delete g.url,c.push(g)):c.push(a.iceServers[v])}a.iceServers=c}return new i(a,l)},r.RTCPeerConnection.prototype=i.prototype,"generateCertificate"in i&&Object.defineProperty(r.RTCPeerConnection,"generateCertificate",{get:function(){return i.generateCertificate}})}}function _s(r){Xe(r)==="object"&&r.RTCTrackEvent&&"receiver"in r.RTCTrackEvent.prototype&&!("transceiver"in r.RTCTrackEvent.prototype)&&Object.defineProperty(r.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function xs(r){var i=r.RTCPeerConnection.prototype.createOffer;r.RTCPeerConnection.prototype.createOffer=function(a){if(a){typeof a.offerToReceiveAudio<"u"&&(a.offerToReceiveAudio=!!a.offerToReceiveAudio);var l=this.getTransceivers().find(function(v){return v.receiver.track.kind==="audio"});a.offerToReceiveAudio===!1&&l?l.direction==="sendrecv"?l.setDirection?l.setDirection("sendonly"):l.direction="sendonly":l.direction==="recvonly"&&(l.setDirection?l.setDirection("inactive"):l.direction="inactive"):a.offerToReceiveAudio===!0&&!l&&this.addTransceiver("audio",{direction:"recvonly"}),typeof a.offerToReceiveVideo<"u"&&(a.offerToReceiveVideo=!!a.offerToReceiveVideo);var c=this.getTransceivers().find(function(v){return v.receiver.track.kind==="video"});a.offerToReceiveVideo===!1&&c?c.direction==="sendrecv"?c.setDirection?c.setDirection("sendonly"):c.direction="sendonly":c.direction==="recvonly"&&(c.setDirection?c.setDirection("inactive"):c.direction="inactive"):a.offerToReceiveVideo===!0&&!c&&this.addTransceiver("video",{direction:"recvonly"})}return i.apply(this,arguments)}}function Cs(r){Xe(r)!=="object"||r.AudioContext||(r.AudioContext=r.webkitAudioContext)}const $s=Hi(()=>{const r=Qi(window);switch(r.browser){case"chrome":is(window,r);break;case"firefox":cs(window,r);break;case"safari":vs(window,r);break;default:throw new $n}});let vt=Promise.resolve({type:"stop",data:{}});async function ln(r,i,a){var l,c,v;if(console.debug("[vue-qrcode-reader] starting camera with constraints: ",JSON.stringify(i)),window.isSecureContext!==!0)throw new qi;if(((l=navigator==null?void 0:navigator.mediaDevices)==null?void 0:l.getUserMedia)===void 0)throw new $n;$s(),console.debug("[vue-qrcode-reader] calling getUserMedia");const g=await navigator.mediaDevices.getUserMedia({audio:!1,video:i});r.srcObject!==void 0?r.srcObject=g:r.mozSrcObject!==void 0?r.mozSrcObject=g:window.URL.createObjectURL?r.src=window.URL.createObjectURL(g):window.webkitURL?r.src=window.webkitURL.createObjectURL(g):r.src=g.id,r.play(),console.debug("[vue-qrcode-reader] waiting for video element to load"),await Promise.race([Cn(r,"loadeddata"),nn(6e3).then(()=>{throw new Vi})]),console.debug("[vue-qrcode-reader] video element loaded"),await nn(500);const[T]=g.getVideoTracks(),m=(v=(c=T==null?void 0:T.getCapabilities)==null?void 0:c.call(T))!=null?v:{};let _=!1;return a&&m.torch&&(await T.applyConstraints({advanced:[{torch:!0}]}),_=!0),console.debug("[vue-qrcode-reader] camera ready"),{type:"start",data:{videoEl:r,stream:g,capabilities:m,constraints:i,isTorchOn:_}}}async function Ts(r,{constraints:i,torch:a,restart:l=!1}){vt=vt.then(v=>{if(v.type==="start"){const{data:{videoEl:g,stream:T,constraints:m,isTorchOn:_}}=v;return!l&&r===g&&i===m&&a===_?v:In(g,T,_).then(()=>ln(r,i,a))}else if(v.type==="stop"||v.type==="failed")return ln(r,i,a);an()}).catch(v=>(console.debug(`[vue-qrcode-reader] starting camera failed with "${v}"`),{type:"failed",error:v}));const c=await vt;if(c.type==="stop")throw new Error("Something went wrong with the camera task queue (start task).");if(c.type==="failed")throw c.error;if(c.type==="start")return c.data.capabilities;an()}async function In(r,i,a){console.debug("[vue-qrcode-reader] stopping camera"),r.src="",r.srcObject=null,r.load(),await Cn(r,"error");for(const l of i.getTracks())a!=null||await l.applyConstraints({advanced:[{torch:!1}]}),i.removeTrack(l),l.stop();return{type:"stop",data:{}}}async function Lt(){if(vt=vt.then(r=>{if(r.type==="stop"||r.type==="failed")return r;const{data:{videoEl:i,stream:a,isTorchOn:l}}=r;return In(i,a,l)}),(await vt).type==="start")throw new Error("Something went wrong with the camera task queue (stop task).")}const Ps=zt({__name:"QrcodeStream",props:{constraints:{default:()=>({facingMode:"environment"})},formats:{default:()=>["qr_code"]},paused:{type:Boolean,default:!1},torch:{type:Boolean,default:!1},track:{type:Function,default:void 0}},emits:["detect","camera-on","camera-off","error"],setup(r,{emit:i}){const a=r,l=i,c=I(a.constraints),v=I(a.formats);dt(()=>a.constraints,(J,j)=>{JSON.stringify(J)!==JSON.stringify(j)&&(c.value=J)},{deep:!0}),dt(()=>a.formats,(J,j)=>{JSON.stringify(J)!==JSON.stringify(j)&&(v.value=J)},{deep:!0});const g=I(),T=I(),m=I(),_=I(!1),P=I(!1);Ro(()=>{P.value=!0}),Fo(()=>{Lt()});const $=Ue(()=>({torch:a.torch,constraints:c.value,shouldStream:P.value&&!a.paused}));dt($,async J=>{const j=m.value;Ie(j!==void 0,"cameraSettings watcher should never be triggered when component is not mounted. Thus video element should always be defined.");const N=g.value;Ie(N!==void 0,"cameraSettings watcher should never be triggered when component is not mounted. Thus canvas should always be defined.");const xe=N.getContext("2d");if(Ie(xe!==null,"if cavnas is defined, canvas 2d context should also be non-null"),J.shouldStream){Lt(),_.value=!1;try{const Ce=await Ts(j,J);P.value?(_.value=!0,l("camera-on",Ce)):await Lt()}catch(Ce){l("error",Ce)}}else N.width=j.videoWidth,N.height=j.videoHeight,xe.drawImage(j,0,0,j.videoWidth,j.videoHeight),Lt(),_.value=!1,l("camera-off")},{deep:!0}),dt(v,async J=>{P.value&&await Pn(J)});const H=Ue(()=>$.value.shouldStream&&_.value);dt(H,J=>{if(J){Ie(g.value!==void 0,"shouldScan watcher should only be triggered when component is mounted. Thus pause frame canvas is defined"),W(g.value),Ie(T.value!==void 0,"shouldScan watcher should only be triggered when component is mounted. Thus tracking canvas is defined"),W(T.value);const j=()=>a.track===void 0?500:40;Ie(m.value!==void 0,"shouldScan watcher should only be triggered when component is mounted. Thus video element is defined"),Gi(m.value,{detectHandler:N=>l("detect",N),formats:v.value,locateHandler:M,minDelay:j()})}});const W=J=>{const j=J.getContext("2d");Ie(j!==null,"canvas 2d context should always be non-null"),j.clearRect(0,0,J.width,J.height)},M=J=>{const j=T.value;Ie(j!==void 0,"onLocate handler should only be called when component is mounted. Thus tracking canvas is always defined.");const N=m.value;if(Ie(N!==void 0,"onLocate handler should only be called when component is mounted. Thus video element is always defined."),J.length===0||a.track===void 0)W(j);else{const xe=N.offsetWidth,Ce=N.offsetHeight,Je=N.videoWidth,De=N.videoHeight,Me=Math.max(xe/Je,Ce/De),Te=Je*Me,Pe=De*Me,ke=Te/Je,Ge=Pe/De,fe=(xe-Te)/2,nt=(Ce-Pe)/2,Ze=({x:ge,y:be})=>({x:Math.floor(ge*ke),y:Math.floor(be*Ge)}),ye=({x:ge,y:be})=>({x:Math.floor(ge+fe),y:Math.floor(be+nt)}),We=J.map(ge=>{const{boundingBox:be,cornerPoints:et}=ge,{x:at,y:je}=ye(Ze({x:be.x,y:be.y})),{x:ot,y:ht}=Ze({x:be.width,y:be.height});return{...ge,cornerPoints:et.map(Be=>ye(Ze(Be))),boundingBox:DOMRectReadOnly.fromRect({x:at,y:je,width:ot,height:ht})}});j.width=N.offsetWidth,j.height=N.offsetHeight;const Ae=j.getContext("2d");Ie(Ae!==null,"canvas 2d context should always be non-null"),a.track(We,Ae)}},E={width:"100%",height:"100%",position:"relative","z-index":"0"},U={width:"100%",height:"100%",position:"absolute",top:"0",left:"0"},Q={width:"100%",height:"100%","object-fit":"cover"},ve=Ue(()=>H.value?Q:{...Q,visibility:"hidden",position:"absolute"});return(J,j)=>(V(),z("div",{style:E},[h("video",{ref_key:"videoRef",ref:m,style:Io(ve.value),autoplay:"",muted:"",playsinline:""},null,4),ze(h("canvas",{id:"qrcode-stream-pause-frame",ref_key:"pauseFrameRef",ref:g,style:Q},null,512),[[Uo,!H.value]]),h("canvas",{id:"qrcode-stream-tracking-layer",ref_key:"trackingLayerRef",ref:T,style:U},null,512),h("div",{style:U},[un(J.$slots,"default")])]))}}),Ss={class:"min-h-screen space-y-4 bg-gray-50 p-2 md:p-4"},ks={class:"grid grid-cols-1 gap-3 md:grid-cols-5 md:gap-2"},Es={class:"flex flex-col md:col-span-2 lg:col-span-2"},Os={class:"mb-2 flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between"},Ds={class:"flex flex-col gap-2 md:gap-3"},Ms=["onClick"],As={class:"flex-shrink-0"},js=["src"],Rs={key:1,class:"flex h-16 w-16 select-none items-center justify-center rounded bg-gray-200 text-xs text-gray-400"},Fs={class:"flex min-w-0 flex-1 flex-col justify-between"},Is={class:"flex items-center gap-2"},Us={class:"flex-1 truncate text-xs font-semibold text-gray-900 md:text-sm"},Ns={key:0,class:"ml-1 rounded bg-orange-500 px-2 py-0.5 text-[14px] font-bold text-white md:text-xs"},Ws={class:"text-[10px] text-gray-400 md:text-xs"},Bs={class:"text-[10px] text-gray-400 line-through md:text-xs"},Ls={class:"text-xs font-semibold text-green-600 md:text-sm"},qs={class:"text-[10px] text-green-500 md:text-xs"},Vs={key:1,class:"text-xs font-semibold text-gray-700 md:text-sm"},Hs={class:"flex flex-col bg-gray-100 md:col-span-2 lg:col-span-3"},zs={class:"flex flex-wrap gap-1 p-2 md:gap-1"},Js={key:0,class:"select-none py-8 text-center text-xs text-gray-400"},Gs={class:"overflow-auto p-2"},Qs={class:"md-grid-cols-2 relative flex grid-cols-1 items-center justify-center"},Ys=["checked","onChange"],Ks={class:"max-w-[140px] truncate font-semibold text-gray-900"},Xs={key:0,class:"text-[10px] text-gray-400 line-through"},Zs={class:"block font-semibold text-gray-900"},el={key:1,class:"text-[11px] text-green-600"},tl=["onUpdate:modelValue","onChange"],rl={key:1,class:"mt-2 flex justify-between p-3"},nl={class:"text-xs font-bold"},al={class:"mt-2 rounded-lg p-1 shadow-sm gap-4 p-4"},ol=["value"],il={class:"mt-4 border-t pt-2 gap-4 p-4"},sl={class:"mb-2 flex justify-between text-xs font-semibold text-gray-700"},ll={class:"font-bold"},ul={key:0},cl={key:1},dl={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 p-4"},fl={class:"w-full max-w-xs rounded-xl bg-white p-6 shadow-lg"},pl={class:"flex justify-end gap-3"},vl={key:1,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 p-4"},ml={class:"w-full max-w-sm rounded-lg bg-white p-6 shadow-lg"},hl={class:"mb-4 flex justify-between"},yl={class:"font-semibold"},gl={class:"mb-4 flex justify-between"},bl={class:"font-semibold text-green-600"},wl={class:"flex justify-end space-x-3"},_l={class:"h-64 w-full"},xl={class:"space-y-2"},Cl=["value"],$l={class:"flex justify-end gap-2 mt-2"},Tl={key:0,class:"text-xs text-red-600 mt-1"},Pl={key:1,class:"text-xs text-red-600 mt-1"},Sl={key:2,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-30 p-4"},kl={class:"text-center"},El={class:"text-[12px] font-bold"},Ol={class:"mb-1"},Dl={class:"flex justify-between"},Ml={key:0},Al={class:"flex justify-between"},jl={class:"text-green-600"},Rl={class:"flex justify-between"},Fl={class:"flex justify-between"},Il={class:"flex justify-between"},Ul={class:"flex justify-between"},Nl={class:"flex justify-between"},Wl={class:"no-print mt-2 flex justify-end gap-2"},Bl=zt({__name:"POS",props:{user:{}},setup(r){const i=I(!1),a=I(!1),l=Yo(),c=I([]),v=I([]),g=I([]),T=I(null),m=I({placingOrder:!1}),_=I(""),P=I(1),$=I(1),H=I(0),W=I([]),M=I(!1),E=I(!1),U=I(null),Q=I(null),ve=I([]),J=I(0),j=I(""),N=I(""),xe=I(""),Ce=I(null),Je=I(null),De=I(!1),Me=I(""),Te=I(1),Pe=I(0),ke=I(""),Ge=I(!1),fe=I(null),nt=Ue(()=>fe.value===null?0:fe.value-we.value>0?fe.value-we.value:0);function Ze(){De.value=!0}function ye(){De.value=!1,Me.value="",Te.value=1,Pe.value=0,ke.value="",Ge.value=!1}function We(){ke.value="",Ge.value=!1;const x=c.value.find(d=>d.id===Me.value);if(!x){ke.value="Produk harus dipilih";return}if(!Te.value||Te.value<1){ke.value="Qty minimal 1";return}if(!Pe.value||Pe.value<0){ke.value="Harga retur harus diisi";return}v.value.push({...x,quantity:-Math.abs(Te.value),price:Pe.value,price_sell:Pe.value,isReturn:!0}),Ge.value=!0,setTimeout(()=>{ye()},1e3)}const Ae=I("TOKO ANINKA"),ge=I("Blok A lantai SLG Los F No 91-92"),et=No().props.auth.user,at=et==null?void 0:et.location_id;async function je(){if(at)try{const x=await rt.get("/api/locations/get");Ae.value=x.data.name||"TOKO ANINKA",ge.value=x.data.address||"Blok A lantai SLG Los F No 91-92"}catch{Ae.value="TOKO ANINKA",ge.value="Blok A lantai SLG Los F No 91-92"}}je();const ot=Ue(()=>ve.value.reduce((x,d)=>x+(d.discount??0)*d.quantity,0)),ht=Ue(()=>ve.value.reduce((x,d)=>x+d.price*d.quantity,0)),Be=I(!1),Dt=Ue(()=>{var x;return((x=r.user)==null?void 0:x.name)??"Kasir"}),Jt=x=>x?x.startsWith("storage/")?"/"+x:x.startsWith("/storage/")?x:"/storage/"+x:"",G=x=>typeof x!="number"||isNaN(x)?"0,00":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:2}).format(x),it=x=>{const d=W.value.indexOf(x);d===-1?W.value.push(x):W.value.splice(d,1)};async function tt(){try{const x=await rt.get(`/api/stock?page=${P.value}&search=${_.value}`);c.value=x.data.data,$.value=x.data.last_page}catch(x){console.error("Error fetching products:",x),l.error("Failed to fetch products")}}async function Gt(){try{const x=await rt.get("/api/payment-methods");g.value=x.data.data}catch{l.error("Failed to fetch payment methods")}}function Ee(){P.value=1,tt()}const Qt=x=>{if(x.qty_stock<=0){l.error("Stok tidak cukup");return}if(x.price<=0&&(x.price_sell===void 0||x.price_sell===null||x.price_sell<=0)){l.error("Harga produk belum ditentukan");return}const d=v.value.find(b=>b.id===x.product_id);d?d.quantity++:v.value.push({id:x.product_id||x.id,product_name:x.product_name,uom_id:x.uom_id,size_id:x.size_id||"",qty_stock:x.qty_stock,image_path:x.image_path,price:x.price,discount:x.discount,price_sell:x.price_sell,quantity:1}),Bo(()=>{Ce.value&&(Ce.value.scrollTop=Ce.value.scrollHeight)})};function yt(x){v.value=v.value.filter(d=>d.id!==x)}function Yt(x){var b;if(x.quantity<1){x.quantity=1,l.error("Minimal quantity 1");return}const d=((b=c.value.find(te=>te.id===x.id))==null?void 0:b.qty_stock)??0;x.quantity>d&&(l.error("Stock limit reached"),x.quantity=d)}function gt(){v.value.length!==0&&(i.value=!0)}function Kt(){v.value=v.value.map(x=>W.value.includes(x.id)?{...x,discount:H.value,price_sell:x.price-H.value}:x),W.value=[],i.value=!1,l.success("Discount applied successfully")}function Xt(){if(v.value.length===0){l.error("Please add items to the cart");return}if(!T.value){l.error("Please select a payment method");return}fe.value=null,Be.value=!0}async function Zt(){if(g.value.length===0){l.error("No payment methods available");return}const x=g.value.find(d=>d.id===T.value);if((!x||x.name!=="CREDIT")&&(fe.value===null||fe.value<we.value)){l.error("Paid amount must be at least total amount");return}Be.value=!1,await bt()}function Mt(){v.value=[],T.value=null,W.value=[]}const er=()=>{E.value=!0},tr=x=>{U.value=x.id,Q.value=x.name,E.value=!1},we=Ue(()=>v.value.reduce((x,d)=>x+d.price*d.quantity,0)),st=Ue(()=>`${G(we.value)}`);async function bt(){var x;if(v.value.length===0){l.error("Please add items to the cart");return}if(!T.value){l.error("Please select a payment method");return}m.value.placingOrder=!0;try{const d=v.value.map(re=>{const ne=re.discount||0;return{product_id:re.product_id??re.id,product_name:re.product_name,quantity:re.quantity,price:re.price,uom_id:re.uom_id,size_id:re.size_id||"PCS",qty_stock:0,image_path:"",discount:ne,price_sell:re.price_sell??re.price-ne}}),b={items:d,payment_method_id:T.value,total_amount:we.value,paid_amount:fe.value,customer_id:U.value},te=await rt.post("/api/pos/orders",b);ve.value=d.map(re=>{var ne;return{...re,uom_id:((ne=v.value.find(me=>(me.product_id??me.id)===re.product_id))==null?void 0:ne.uom_id)||""}}),J.value=te.data.total_amount,j.value=((x=g.value.find(re=>re.id===T.value))==null?void 0:x.name)||"",N.value=new Date(te.data.created_at).toLocaleString(),xe.value=te.data.transaction_number||"",M.value=!0}catch(d){console.error("Error placing order:",d),l.error("Failed to place order")}finally{m.value.placingOrder=!1}}function Qe(){M.value=!1,Mt(),T.value=null}const Le=async x=>{if(x.length>0){const d=x[0].rawValue;console.log("QR Code detected:",d),a.value=!1;try{const te=(await rt.get(`/api/orders/scan/${d}`)).data;if(te&&te.order_items){const re=[];te.order_items.forEach(ne=>{const me={id:ne.product_id,product_id:ne.product_id,product_name:ne.product_name,uom_id:ne.uom_id,size_id:ne.size_id||"PCS",qty_stock:ne.qty_stock,image_path:ne.image_path,price:ne.price,discount:ne.discount,price_sell:ne.price_sell,quantity:1};re.push(me)}),console.log("Produk dalam pesanan:",re)}}catch(b){console.error("Error scanning QR code:",b),l.error("Failed to scan QR code")}}};function lt(){const x=window.qz,d=name??name??"Kasir";if(x){const me=ve.value.reduce((R,wt)=>R+wt.quantity,0),X=(J.value||we.value)-(fe.value||0),Y=[];Y.push(`     ${Ae.value}`),Y.push(` ${ge.value}`),Y.push("----------------------------------------"),Y.push(`Kasir   : ${d}`),Y.push(`Tanggal : ${N.value}`),Y.push(`Nomor   : ${xe.value}`),Y.push("------------------------------------"),Y.push(`Customer: ${Q.value||"-"}`),Y.push("--------------------------------------"),ve.value.forEach(R=>{Y.push(`${R.product_name}`),Y.push(`${R.quantity} x ${G(R.price)}${" ".repeat(20-(R.quantity+"").length-G(R.price).length)}${G(R.quantity*R.price)}`)}),Y.push("--------------------------------"),Y.push(`Total QTY        ${me}`),Y.push(`Total Bayar      ${G(J.value||we.value)}`),Y.push(`Jenis Bayar      ${j.value||"-"}`),Y.push(`Bayar Cash       ${G(fe.value||0)}`),Y.push(`Sisa             ${G(X>0?X:0)}`),Y.push("--------------------------------------"),Y.push("      ---TERIMA KASIH---"),Y.push("     aninkafashion.com"),Y.push(`


`),x.websocket.connect().then(()=>x.printers.find()).then(R=>{const wt=x.configs.create(R);return x.print(wt,[{type:"raw",format:"plain",data:Y.join(`
`)}])}).catch(R=>{alert("Print error: "+R)}).finally(()=>{x.websocket.disconnect()});return}const b=ve.value.reduce((me,X)=>me+X.quantity,0),te=(J.value||we.value)-(fe.value||0),re=`
    <div style="font-family: 'Courier New', Courier, monospace; font-size: 12px; width: 80mm; padding: 0; margin: 0;">
      <div style="text-align:center; font-weight:bold;">${Ae.value}</div>
      <div style="text-align:center;">${ge.value}</div>
      <div style="text-align:center;">----------------------------------------</div>
      <div style="display:flex; justify-content:space-between;">
        <span>Kasir   : ${Dt.value}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Tanggal : ${N.value}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Nomor   : ${xe.value}</span>
      </div>
      <div style="text-align:center;">----------------------------------------</div>
      <div style="display:flex; justify-content:space-between;">
        <span>Customer</span>
        <span>${Q.value||"-"}</span>
      </div>
      <div style="text-align:center;">----------------------------------------</div>
      ${ve.value.map(me=>`
          <div>${me.product_name}</div>
          <div style="display:flex; justify-content:space-between;">
            <span>${me.quantity} x ${G(me.price)}</span>
            <span>${G(me.quantity*me.price)}</span>
          </div>
        `).join("")}
      <div style="text-align:center;">----------------------------------------</div>
      <div style="display:flex; justify-content:space-between;">
        <span>Total QTY</span>
        <span>${b}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Total Bayar</span>
        <span>${G(J.value||we.value)}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Jenis Bayar</span>
        <span>${j.value||"-"}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Bayar Cash</span>
        <span>${G(fe.value||0)}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Sisa</span>
        <span>${G(te>0?te:0)}</span>
      </div>
      <div style="text-align:center;">----------------------------------------</div>
      <div style="text-align:center; margin-top:8px;">---TERIMA KASIH---</div>
      <div style="text-align:center;">aninkafashion.com</div>
    </div>
  `,ne=window.open("","","height=600,width=400");if(!ne){alert("Please allow pop-ups for printing.");return}ne.document.write(`
    <html>
      <head>
        <title>Print Struk</title>
        <style>
          @media print {
            body { margin: 0; }
            div { font-family: 'Courier New', Courier, monospace; font-size: 12px; }
          }
        </style>
      </head>
      <body>
        ${re}
        <script>
          window.onload = function() {
            setTimeout(function() {
              window.print();
              window.onafterprint = function() { window.close(); };
            }, 100);
          };
        <\/script>
      </body>
    </html>
  `),ne.document.close()}return tt(),Gt(),(x,d)=>(V(),z(He,null,[D(O(Wo),{title:"Point of Sale"}),D(Qo,null,{default:q(()=>[h("div",Ss,[h("div",ks,[h("section",Es,[h("div",Os,[d[12]||(d[12]=h("h2",{class:"text-sm font-semibold text-gray-800"},"Produk Tersedia",-1)),ze(h("input",{type:"text","onUpdate:modelValue":d[0]||(d[0]=b=>_.value=b),onInput:Ee,placeholder:"Cari produk...",class:"focus:ring-primary-500 w-full max-w-xs rounded-md border border-gray-300 px-2 py-1 text-xs focus:outline-none focus:ring-2 md:text-sm"},null,544),[[ct,_.value]])]),h("div",Ds,[(V(!0),z(He,null,ft(c.value,b=>(V(),z("div",{key:b.id,onClick:te=>Qt(b),class:"flex cursor-pointer flex-row items-center gap-2 rounded-lg border border-gray-200 bg-white p-2 shadow-sm transition hover:shadow-md md:gap-3 md:p-3"},[h("div",As,[b.image_path?(V(),z("img",{key:0,src:Jt(b.image_path),alt:"Gambar produk",class:"h-16 w-16 rounded object-cover"},null,8,js)):(V(),z("div",Rs," Tidak Ada Gambar "))]),h("div",Fs,[h("div",Is,[h("p",Us,B(b.product_name),1),b.discount&&b.price?(V(),z(He,{key:0},[b.discount>0?(V(),z("span",Ns,B(Math.round(b.discount/b.price*100))+"% ",1)):$e("",!0)],64)):$e("",!0)]),h("p",Ws,"Stok: "+B(b.qty_stock)+" / "+B(b.uom_id),1),h("div",null,[b.discount&&b.discount>0?(V(),z(He,{key:0},[h("p",Bs,B(G(b.price)),1),h("p",Ls,B(G(b.price_sell??b.price-b.discount)),1),h("p",qs,"(Diskon "+B(G(b.discount))+")",1)],64)):(V(),z("p",Vs,B(G(b.price)),1))])])],8,Ms))),128))])]),h("section",Hs,[h("div",zs,[D(O(he),{variant:"outline",size:"sm",onClick:gt,disabled:W.value.length===0,class:"flex items-center gap-1 bg-indigo-100"},{default:q(()=>[D(O(ti),{class:"h-4 w-4"}),ue(" Disc ("+B(W.value.length)+") ",1)]),_:1},8,["disabled"]),D(O(he),{variant:"outline",size:"sm",onClick:d[1]||(d[1]=b=>a.value=!0),class:"flex items-center gap-1"},{default:q(()=>[D(O(ri),{class:"h-4 w-4"}),d[13]||(d[13]=ue(" QR "))]),_:1,__:[13]}),D(O(he),{variant:"outline",size:"sm",onClick:er,class:"flex items-center gap-1"},{default:q(()=>[D(O(ni),{class:"h-4 w-4"}),d[14]||(d[14]=ue(" Customer "))]),_:1,__:[14]}),D(O(he),{variant:"outline",size:"sm",onClick:Ze,class:"flex items-center gap-1"},{default:q(()=>[D(O(ai),{class:"h-4 w-4"}),d[15]||(d[15]=ue(" Retur "))]),_:1,__:[15]}),D(O(he),{variant:"outline",size:"sm",onClick:Mt,class:"flex items-center gap-1"},{default:q(()=>[D(O(Kr),{class:"h-4 w-4"}),d[16]||(d[16]=ue(" Clear "))]),_:1,__:[16]})]),v.value.length===0?(V(),z("div",Js," Tidak ada item di keranjang ")):$e("",!0),h("div",Gs,[D(O(zo),null,{default:q(()=>[D(O(Jo),null,{default:q(()=>[D(O(Yr),null,{default:q(()=>[D(O(kt),{class:"text-xs"},{default:q(()=>d[17]||(d[17]=[ue("#")])),_:1,__:[17]}),D(O(kt),{class:"text-xs"},{default:q(()=>d[18]||(d[18]=[ue("Nama")])),_:1,__:[18]}),D(O(kt),{class:"text-center text-xs"},{default:q(()=>d[19]||(d[19]=[ue("Qty")])),_:1,__:[19]}),D(O(kt),{class:"text-center text-xs"},{default:q(()=>d[20]||(d[20]=[ue("Total")])),_:1,__:[20]}),D(O(kt),{class:"text-center text-xs"},{default:q(()=>d[21]||(d[21]=[ue("Aksi")])),_:1,__:[21]})]),_:1})]),_:1}),D(O(Go),null,{default:q(()=>[(V(!0),z(He,null,ft(v.value,b=>(V(),yr(O(Yr),{key:b.id},{default:q(()=>[D(O(Et),null,{default:q(()=>[h("div",Qs,[h("input",{type:"checkbox",checked:W.value.includes(b.id),onChange:te=>it(b.id),class:"text-primary-600 focus:ring-primary-500 absolute left-0 top-0 rounded border-gray-300",title:"Pilih untuk diskon"},null,40,Ys)])]),_:2},1024),D(O(Et),{class:"text-xs"},{default:q(()=>[h("div",Ks,B(b.product_name),1),b.discount&&b.discount>0?(V(),z("span",Xs,B(G(b.price)),1)):$e("",!0),h("span",Zs,B(G(b.price_sell||b.price-(b.discount||0))),1),b.discount&&b.discount>0?(V(),z("div",el," Diskon: -"+B(G(b.discount)),1)):$e("",!0)]),_:2},1024),D(O(Et),{class:"text-center"},{default:q(()=>[ze(h("input",{type:"number",min:"1","onUpdate:modelValue":te=>b.quantity=te,onChange:te=>Yt(b),class:"w-12 rounded border px-1 py-0.5 text-center text-xs"},null,40,tl),[[ct,b.quantity,void 0,{number:!0}]])]),_:2},1024),D(O(Et),{class:"text-right text-xs font-semibold text-gray-900"},{default:q(()=>[ue(B(G(b.quantity*(b.price_sell||b.price))),1)]),_:2},1024),D(O(Et),{class:"text-center"},{default:q(()=>[D(O(he),{variant:"ghost",size:"icon",onClick:te=>yt(b.id),class:"hover:bg-gray-100"},{default:q(()=>[D(O(Kr),{class:"h-4 w-4"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),Q.value?(V(),z("div",rl,[d[22]||(d[22]=h("span",{class:"text-xs font-bold"},"Pelanggan:",-1)),h("span",nl,B(Q.value)+" (#"+B(U.value)+")",1)])):$e("",!0),h("div",al,[d[24]||(d[24]=h("label",{class:"mb-1 block text-xs font-medium text-gray-900"},"Metode Pembayaran",-1)),ze(h("select",{"onUpdate:modelValue":d[2]||(d[2]=b=>T.value=b),class:"focus:ring-primary-500 w-full rounded-lg border border-gray-300 p-1 text-xs focus:outline-none focus:ring-2"},[d[23]||(d[23]=h("option",{value:""},"Pilih metode pembayaran",-1)),(V(!0),z(He,null,ft(g.value,b=>(V(),z("option",{key:b.id,value:b.id},B(b.name),9,ol))),128))],512),[[Gr,T.value]])]),h("div",il,[h("div",sl,[d[25]||(d[25]=h("span",null,"Total",-1)),h("span",ll,B(st.value),1)]),D(O(he),{class:"w-full text-xs font-semibold rounded-md bg-indigo-600 py-2 text-white hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500",onClick:Xt,disabled:m.value.placingOrder},{default:q(()=>[m.value.placingOrder?(V(),z("span",ul,"Memproses...")):(V(),z("span",cl,"Bayar"))]),_:1},8,["disabled"])])])]),i.value?(V(),z("div",dl,[h("div",fl,[d[26]||(d[26]=h("h3",{class:"mb-4 text-lg font-semibold"},"Set Discount",-1)),d[27]||(d[27]=h("label",{class:"mb-2 block text-sm font-medium"},"Discount Price",-1)),ze(h("input",{type:"number","onUpdate:modelValue":d[3]||(d[3]=b=>H.value=b),class:"focus:ring-primary-500 mb-4 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2"},null,512),[[ct,H.value,void 0,{number:!0}]]),h("div",pl,[h("button",{onClick:Kt,class:"rounded bg-green-600 px-4 py-2 text-sm text-white hover:bg-green-700"},"Save"),h("button",{onClick:d[4]||(d[4]=b=>i.value=!1),class:"rounded bg-gray-300 px-4 py-2 text-sm text-gray-700 hover:bg-gray-400"}," Cancel ")])])])):$e("",!0),Be.value?(V(),z("div",vl,[h("div",ml,[d[32]||(d[32]=h("h3",{class:"mb-4 text-lg font-semibold"},"Masukkan Jumlah Bayar",-1)),ze(h("input",{type:"number",min:"0","onUpdate:modelValue":d[5]||(d[5]=b=>fe.value=b),class:"mb-4 w-full rounded border px-3 py-2 text-lg",placeholder:"Masukkan jumlah bayar"},null,512),[[ct,fe.value,void 0,{number:!0}]]),h("div",hl,[d[28]||(d[28]=h("div",null,"Total:",-1)),h("div",yl,B(st.value),1)]),h("div",gl,[d[29]||(d[29]=h("div",null,"Kembalian:",-1)),h("div",bl,B(G(nt.value)),1)]),h("div",wl,[D(O(he),{variant:"outline",onClick:d[6]||(d[6]=b=>Be.value=!1)},{default:q(()=>d[30]||(d[30]=[ue("Batal")])),_:1,__:[30]}),D(O(he),{onClick:Zt,class:"rounded-md bg-indigo-600 py-2 text-white hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:q(()=>d[31]||(d[31]=[ue("Konfirmasi")])),_:1,__:[31]})])])])):$e("",!0),D(Qr,{show:a.value,onClose:d[7]||(d[7]=b=>a.value=!1),title:"Scan QR Code"},{default:q(()=>[h("div",_l,[D(O(Ps),{onDetect:Le})])]),_:1},8,["show"]),D(Qr,{show:De.value,onClose:ye,title:"Retur Barang"},{default:q(()=>[h("div",xl,[d[36]||(d[36]=h("label",{class:"block text-xs font-medium"},"Produk",-1)),ze(h("select",{"onUpdate:modelValue":d[8]||(d[8]=b=>Me.value=b),class:"w-full border rounded p-1 text-xs"},[d[33]||(d[33]=h("option",{value:""},"Pilih Produk",-1)),(V(!0),z(He,null,ft(c.value,b=>(V(),z("option",{key:b.id,value:b.id},B(b.product_name)+" (Stok: "+B(b.qty_stock)+") ",9,Cl))),128))],512),[[Gr,Me.value]]),d[37]||(d[37]=h("label",{class:"block text-xs font-medium"},"Qty",-1)),ze(h("input",{type:"number","onUpdate:modelValue":d[9]||(d[9]=b=>Te.value=b),min:"1",class:"w-full border rounded p-1 text-xs"},null,512),[[ct,Te.value,void 0,{number:!0}]]),d[38]||(d[38]=h("label",{class:"block text-xs font-medium"},"Harga Retur",-1)),ze(h("input",{type:"number","onUpdate:modelValue":d[10]||(d[10]=b=>Pe.value=b),min:"0",class:"w-full border rounded p-1 text-xs"},null,512),[[ct,Pe.value,void 0,{number:!0}]]),h("div",$l,[D(O(he),{variant:"outline",onClick:ye},{default:q(()=>d[34]||(d[34]=[ue("Batal")])),_:1,__:[34]}),D(O(he),{class:"bg-red-600 text-white",onClick:We},{default:q(()=>d[35]||(d[35]=[ue("Simpan")])),_:1,__:[35]})]),ke.value?(V(),z("div",Tl,B(ke.value),1)):$e("",!0),Ge.value?(V(),z("div",Pl,"Retur berhasil ditambahkan ke keranjang!")):$e("",!0)])]),_:1},8,["show"]),M.value?(V(),z("div",Sl,[h("div",{class:"print-area w-[450px] max-w-full rounded bg-white p-2 font-mono text-[10px] leading-tight shadow",ref_key:"printArea",ref:Je},[h("div",kl,[h("p",El,B(Ae.value),1),h("p",null,B(ge.value),1)]),d[46]||(d[46]=h("hr",{class:"my-1 border-t border-dashed"},null,-1)),h("div",Ol,[h("p",null,"Tanggal: "+B(N.value),1),h("p",null,"Kasir: "+B(Dt.value),1),h("p",null,"Nomor: "+B(xe.value),1),h("p",null,"Customer: "+B(Q.value||"-"),1)]),d[47]||(d[47]=h("hr",{class:"my-1 border-t border-dashed"},null,-1)),(V(!0),z(He,null,ft(ve.value,(b,te)=>(V(),z("div",{key:b.product_id,class:"mb-1"},[h("p",null,B(te+1)+". "+B(b.product_name),1),h("div",Dl,[h("span",null,B(b.quantity)+" x "+B(G(b.price)),1),h("span",null,""+B(G(b.price*b.quantity)),1)]),b.discount?(V(),z("div",Ml,[h("div",Al,[h("span",jl,"- "+B(G(b.discount)),1),h("span",null,B(G(b.price*b.quantity-b.discount)),1)])])):$e("",!0)]))),128)),d[48]||(d[48]=h("hr",{class:"my-1 border-t border-dashed"},null,-1)),h("div",Rl,[d[39]||(d[39]=h("span",null,"Sub Total:",-1)),h("span",null,B(G(ht.value)),1)]),h("div",Fl,[d[40]||(d[40]=h("span",null,"Jumlah Bayar:",-1)),h("span",null,B(G(fe.value||0)),1)]),h("div",Il,[d[41]||(d[41]=h("span",null,"Kembalian:",-1)),h("span",null,B(G(nt.value)),1)]),h("div",Ul,[d[42]||(d[42]=h("span",null,"Total Disc:",-1)),h("span",null,B(G(ot.value)),1)]),h("div",Nl,[d[43]||(d[43]=h("span",null,"Metode:",-1)),h("span",null,B(j.value),1)]),d[49]||(d[49]=h("hr",{class:"my-1 border-t border-dashed"},null,-1)),d[50]||(d[50]=h("p",{class:"text-center"},"SELAMAT BERBELANJA",-1)),d[51]||(d[51]=h("hr",{class:"my-1 border-t border-dashed"},null,-1)),h("div",Wl,[D(O(he),{variant:"outline",onClick:Qe},{default:q(()=>d[44]||(d[44]=[ue("TUTUP")])),_:1,__:[44]}),D(O(he),{onClick:lt,class:"rounded-md bg-indigo-600 py-2 text-white hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:q(()=>d[45]||(d[45]=[ue("CETAK")])),_:1,__:[45]})])],512)])):$e("",!0)]),D(pi,{show:E.value,"onUpdate:show":d[11]||(d[11]=b=>E.value=b),onCustomerSelected:tr},null,8,["show"])]),_:1})],64))}}),Zl=Lo(Bl,[["__scopeId","data-v-8cb488c9"]]);export{Zl as default};
