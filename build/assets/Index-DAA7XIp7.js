import{d as J,a as x,b as K,r as N,G as Q,u as W,e as X,o as Y,g,j as _,q as o,x as t,y as Z,z as l,l as r,B as j,A as f,O as ee,F as P,D as I,H as te,k as S,N as ae,I as T}from"./app-C0ZtNFPV.js";import{_ as oe}from"./AppLayout.vue_vue_type_script_setup_true_lang-CxyMViV1.js";import{_ as b}from"./Button.vue_vue_type_script_setup_true_lang-B6TXREVN.js";import{_ as v}from"./Input.vue_vue_type_script_setup_true_lang-BWB1n0oK.js";import{_ as se,a as le,b as U,c as q,d as ie,e as F}from"./TableRow.vue_vue_type_script_setup_true_lang-CVJoN5Nr.js";import{u as ne}from"./useToast-DV2nGitA.js";import{P as re}from"./plus-jsIhsatj.js";import{S as de}from"./square-pen-Cj9XWA8y.js";import{T as ue}from"./trash-2-Bt8Dqp-q.js";import"./index-C2dazRLE.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BIT3zfbJ.js";const ce=J("location",{state:()=>({items:[],total:0,loaded:!1,loading:!1,currentPage:1,lastPage:1,filterName:""}),actions:{async fetchLocations(m=1,s=10){this.loading=!0;try{const d=await x.get("/api/locations",{params:{page:m,perPage:s,name:this.filterName}});this.items=d.data.data,this.total=d.data.total,this.currentPage=m,this.lastPage=d.data.last_page||1,this.loaded=!0}catch(d){console.error("Failed to fetch Locations",d)}},setFilter(m,s){m==="name"&&(this.filterName=s,this.currentPage=1,this.fetchLocations(1))},async createLocation(m,s){try{await x.post("/api/locations",{id:m,name:s}),await this.fetchLocations()}catch(d){throw d}},async updateLocation(m,s){try{await x.put(`/api/locations/${m}`,{name:s}),await this.fetchLocations()}catch(d){throw d}},async deleteLocation(m){try{await x.delete(`/api/locations/${m}`),await this.fetchLocations()}catch(s){throw s}}}}),me={class:"px-4 py-4"},fe={class:"flex justify-between items-center mb-6"},pe={class:"rounded-md border"},_e={class:"flex justify-end mt-4 space-x-2"},be=["disabled"],ge=["onClick","disabled"],ye=["disabled"],ve={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},he={class:"bg-white p-6 rounded-lg w-96"},we={class:"mb-4"},xe={class:"mb-4"},Le={class:"flex justify-end gap-2"},ke={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Ce={class:"bg-white p-6 rounded-lg w-96"},Ve={class:"mb-4"},$e={class:"mb-4"},Ne={class:"flex justify-end gap-2"},Me=K({__name:"Index",setup(m){const s=ne(),d=N(!1),h=N(!1),w=N(null),i=Q({id:"",name:""}),z=[{title:"Location",href:"/location"}],u=ce(),{items:E,currentPage:y,lastPage:B,loading:L,filterName:k}=W(u),C=X(()=>B.value||1),V=async n=>{n<1||n>C.value||await u.fetchLocations(n)},M=()=>V(y.value+1),A=()=>V(y.value-1),D=(n,e)=>{const a=e.target;u.setFilter(n,a.value)};Y(()=>{u.fetchLocations()});const R=async()=>{var n,e,a,c;if(!i.id)return s.error("Id is required");if(!i.name)return s.error("Name is required");try{await u.createLocation(i.id,i.name),s.success("location created successfully"),i.reset(),u.loaded=!1,await u.fetchLocations(),d.value=!1}catch(p){const $=(c=(a=(e=(n=p==null?void 0:p.response)==null?void 0:n.data)==null?void 0:e.errors)==null?void 0:a.name)==null?void 0:c[0];s.error($||"Failed to create location")}},G=n=>{w.value=n,i.id=n.id,i.name=n.name,h.value=!0},H=async()=>{var n,e,a,c;if(!w.value||!i.name)return s.error("Name is required");try{await u.updateLocation(w.value.id,i.name),s.success("Location updated successfully"),i.reset(),u.loaded=!1,await u.fetchLocations(),h.value=!1,w.value=null}catch(p){const $=(c=(a=(e=(n=p==null?void 0:p.response)==null?void 0:n.data)==null?void 0:e.errors)==null?void 0:a.name)==null?void 0:c[0];s.error($||"Failed to update Location")}},O=async n=>{var e,a;if(confirm("Are you sure you want to delete this location?"))try{await u.deleteLocation(n),s.success("location deleted successfully"),u.loaded=!1,await u.fetchLocations()}catch(c){s.error(((a=(e=c==null?void 0:c.response)==null?void 0:e.data)==null?void 0:a.message)??"Failed to delete Location")}};return(n,e)=>(_(),g(P,null,[o(t(Z),{title:"Location Management"}),o(oe,{breadcrumbs:z},{default:l(()=>[r("div",me,[r("div",fe,[o(t(b),{onClick:e[0]||(e[0]=a=>d.value=!0),class:"bg-indigo-600 text-white py-2 rounded-md hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:l(()=>[o(t(re),{class:"h-4 w-4"}),e[9]||(e[9]=f(" Add "))]),_:1,__:[9]}),o(t(v),{modelValue:t(k),"onUpdate:modelValue":e[1]||(e[1]=a=>ee(k)?k.value=a:null),placeholder:"Search",onInput:e[2]||(e[2]=a=>D("name",a)),class:"w-64","aria-label":"Search"},null,8,["modelValue"])]),r("div",pe,[o(t(se),null,{default:l(()=>[o(t(le),null,{default:l(()=>[o(t(U),{class:"bg-gray-100"},{default:l(()=>[o(t(q),null,{default:l(()=>e[10]||(e[10]=[f("Id")])),_:1,__:[10]}),o(t(q),null,{default:l(()=>e[11]||(e[11]=[f("Name")])),_:1,__:[11]}),o(t(q),{class:"w-24"},{default:l(()=>e[12]||(e[12]=[f("Actions")])),_:1,__:[12]})]),_:1})]),_:1}),o(t(ie),null,{default:l(()=>[(_(!0),g(P,null,I(t(E),a=>(_(),te(t(U),{key:a.id},{default:l(()=>[o(t(F),null,{default:l(()=>[f(S(a.id),1)]),_:2},1024),o(t(F),null,{default:l(()=>[f(S(a.name),1)]),_:2},1024),o(t(F),{class:"flex gap-2"},{default:l(()=>[o(t(b),{variant:"ghost",size:"icon",onClick:c=>G(a)},{default:l(()=>[o(t(de),{class:"h-4 w-4"})]),_:2},1032,["onClick"]),o(t(b),{variant:"ghost",size:"icon",onClick:c=>O(a.id)},{default:l(()=>[o(t(ue),{class:"h-4 w-4"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),r("div",_e,[r("button",{onClick:A,disabled:t(y)===1||t(L),class:"px-3 py-1 rounded border border-gray-300 text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed"}," Previous ",8,be),(_(!0),g(P,null,I(C.value,a=>(_(),g("button",{key:a,onClick:c=>V(a),class:ae(["px-3 py-1 rounded border text-sm",a===t(y)?"bg-blue-600 border-blue-600 text-white":"border-gray-300 text-gray-700 hover:bg-gray-100"]),disabled:t(L)},S(a),11,ge))),128)),r("button",{onClick:M,disabled:t(y)===C.value||t(L),class:"px-3 py-1 rounded border border-gray-300 text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed"}," Next ",8,ye)]),d.value?(_(),g("div",ve,[r("div",he,[e[15]||(e[15]=r("h2",{class:"text-lg font-semibold mb-4"},"Tambah data",-1)),r("form",{onSubmit:T(R,["prevent"])},[r("div",we,[o(t(v),{modelValue:t(i).id,"onUpdate:modelValue":e[3]||(e[3]=a=>t(i).id=a),placeholder:"location Id",required:""},null,8,["modelValue"])]),r("div",xe,[o(t(v),{modelValue:t(i).name,"onUpdate:modelValue":e[4]||(e[4]=a=>t(i).name=a),placeholder:"location Name",required:""},null,8,["modelValue"])]),r("div",Le,[o(t(b),{type:"button",variant:"outline",onClick:e[5]||(e[5]=a=>d.value=!1)},{default:l(()=>e[13]||(e[13]=[f("Cancel")])),_:1,__:[13]}),o(t(b),{type:"submit"},{default:l(()=>e[14]||(e[14]=[f("Create")])),_:1,__:[14]})])],32)])])):j("",!0),h.value?(_(),g("div",ke,[r("div",Ce,[e[18]||(e[18]=r("h2",{class:"text-lg font-semibold mb-4"},"Edit Location",-1)),r("form",{onSubmit:T(H,["prevent"])},[r("div",Ve,[o(t(v),{modelValue:t(i).id,"onUpdate:modelValue":e[6]||(e[6]=a=>t(i).id=a),placeholder:"ID",required:"",readonly:""},null,8,["modelValue"])]),r("div",$e,[o(t(v),{modelValue:t(i).name,"onUpdate:modelValue":e[7]||(e[7]=a=>t(i).name=a),placeholder:"location Name",required:""},null,8,["modelValue"])]),r("div",Ne,[o(t(b),{type:"button",variant:"outline",onClick:e[8]||(e[8]=a=>h.value=!1)},{default:l(()=>e[16]||(e[16]=[f("Cancel")])),_:1,__:[16]}),o(t(b),{type:"submit"},{default:l(()=>e[17]||(e[17]=[f("Update")])),_:1,__:[17]})])],32)])])):j("",!0)])]),_:1})],64))}});export{Me as default};
