import{_ as B}from"./AppLayout.vue_vue_type_script_setup_true_lang-CxyMViV1.js";import{r as x,a as L,b as M,o as R,e as p,g as _,j as d,q as a,x as s,y as j,z as n,l as e,k as u,N as y,A as c,F as D,D as I,H as O,X as z,Y as V,Z as E,$ as H}from"./app-C0ZtNFPV.js";import{_ as q,a as A,b as h,c as g,d as X,e as b}from"./TableRow.vue_vue_type_script_setup_true_lang-CVJoN5Nr.js";import"./Button.vue_vue_type_script_setup_true_lang-B6TXREVN.js";import"./index-C2dazRLE.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BIT3zfbJ.js";function Y(){const w=x([]),m=x(!0),v=x(null),r=x(null);return{orders:w,isLoading:m,error:v,pagination:r,fetchOrders:async()=>{m.value=!0,v.value=null;try{const f=await L.get("/api/orders/customer");r.value=f.data,w.value=f.data.data}catch(f){console.error("Error fetching orders:",f),v.value="Failed to load orders. Please try again later."}finally{m.value=!1}}}}const Z={class:"container mx-auto px-4 py-6"},G={class:"flex flex-wrap justify-between gap-2 mb-6"},J={class:"bg-indigo-100 shadow rounded-lg p-4 text-center w-[32%] min-w-[100px]"},K={class:"text-2xl font-bold text-indigo-900"},U={class:"bg-green-100 shadow rounded-lg p-4 text-center w-[30%] min-w-[100px]"},W={class:"text-2xl font-bold text-green-900"},tt={class:"bg-yellow-100 shadow rounded-lg p-4 text-center w-[32%] min-w-[100px]"},et={class:"text-2xl font-bold text-yellow-900"},st={class:"mb-4 flex flex-wrap gap-2 border-b"},at={key:0,class:"text-center text-gray-500"},lt={key:1,class:"text-center text-red-500"},nt={key:2,class:"text-center text-gray-500"},ot={key:3,class:"overflow-x-auto"},rt=["onClick"],dt={class:"space-y-1"},it={class:"p-4 flex justify-center"},vt=M({__name:"OrderHistory",setup(w){const m=x(!1),v=x(""),{orders:r,isLoading:$,error:f,fetchOrders:T}=Y(),i=x("pending");R(()=>{T()});const C=p(()=>i.value==="done"?r.value.filter(o=>o.status===2):i.value==="cancel"?r.value.filter(o=>o.status===3):r.value.filter(o=>o.status===1)),P=p(()=>r.value.reduce((o,t)=>{var l;return o+(((l=t.order_items)==null?void 0:l.length)||0)},0)),F=p(()=>r.value.length),N=p(()=>r.value.reduce((o,t)=>o+parseFloat(t.total_amount||"0"),0)),Q=p(()=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(N.value)),S=o=>{v.value=o,m.value=!0};return(o,t)=>(d(),_(D,null,[a(s(j),{title:"Riwayat Order"}),a(B,null,{default:n(()=>[e("div",Z,[e("div",G,[e("div",J,[t[4]||(t[4]=e("p",{class:"text-indigo-800 text-xs font-medium"},"Total Produk",-1)),e("p",K,u(P.value),1)]),e("div",U,[t[5]||(t[5]=e("p",{class:"text-green-800 text-xs font-medium"},"Total Order",-1)),e("p",W,u(F.value),1)]),e("div",tt,[t[6]||(t[6]=e("p",{class:"text-yellow-800 text-xs font-medium"},"Total Pembelian",-1)),e("p",et,u(Q.value),1)])]),e("div",st,[e("button",{onClick:t[0]||(t[0]=l=>i.value="pending"),class:y(["px-4 py-2 rounded-t text-sm md:text-base",i.value==="pending"?"border-b-2 border-indigo-600 font-semibold":"text-gray-500"])}," Pesanan ",2),e("button",{onClick:t[1]||(t[1]=l=>i.value="done"),class:y(["px-4 py-2 rounded-t text-sm md:text-base",i.value==="done"?"border-b-2 border-indigo-600 font-semibold":"text-gray-500"])}," Selesai ",2),e("button",{onClick:t[2]||(t[2]=l=>i.value="cancel"),class:y(["px-4 py-2 rounded-t text-sm md:text-base",i.value==="cancel"?"border-b-2 border-indigo-600 font-semibold":"text-gray-500"])}," Dibatalkan ",2)]),s($)?(d(),_("div",at,"Memuat pesanan...")):s(f)?(d(),_("div",lt,u(s(f)),1)):C.value.length===0?(d(),_("div",nt," Tidak ada pesanan ditemukan. ")):(d(),_("div",ot,[a(s(q),{class:"min-w-full"},{default:n(()=>[a(s(A),null,{default:n(()=>[a(s(h),null,{default:n(()=>[a(s(g),{class:"w-[10%]"},{default:n(()=>t[7]||(t[7]=[c("ID Order")])),_:1,__:[7]}),a(s(g),{class:"w-[10%]"},{default:n(()=>t[8]||(t[8]=[c("Tanggal")])),_:1,__:[8]}),a(s(g),{class:"w-[10%]"},{default:n(()=>t[9]||(t[9]=[c("Total")])),_:1,__:[9]}),a(s(g),{class:"w-[10%]"},{default:n(()=>t[10]||(t[10]=[c("Status")])),_:1,__:[10]}),a(s(g),{class:"w-[60%]"},{default:n(()=>t[11]||(t[11]=[c("Detail")])),_:1,__:[11]})]),_:1})]),_:1}),a(s(X),null,{default:n(()=>[(d(!0),_(D,null,I(C.value,l=>(d(),O(s(h),{key:l.id},{default:n(()=>[a(s(b),null,{default:n(()=>[e("button",{onClick:k=>S(l.id),class:"flex items-center gap-1 text-indigo-600 hover:underline"},[a(s(z),{class:"w-4 h-4"}),c(" "+u(l.id.slice(0,8))+"... ",1)],8,rt)]),_:2},1024),a(s(b),null,{default:n(()=>[c(u(new Date(l.created_at).toLocaleDateString("id-ID")),1)]),_:2},1024),a(s(b),null,{default:n(()=>[c(u(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(Number(l.total_amount))),1)]),_:2},1024),a(s(b),null,{default:n(()=>[e("span",{class:y({"text-yellow-600":l.status===1,"text-green-600":l.status===2,"text-red-600":l.status===3})},u(l.status===1?"Pending":l.status===2?"Selesai":"Dibatalkan"),3)]),_:2},1024),a(s(b),null,{default:n(()=>[e("div",null,[t[12]||(t[12]=e("h4",{class:"text-sm font-semibold mb-1"},"Item:",-1)),e("div",dt,[(d(!0),_(D,null,I(l.order_items,k=>(d(),O(V,{key:k.id,item:k},null,8,["item"]))),128))])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]))]),a(E,{show:m.value,onClose:t[3]||(t[3]=l=>m.value=!1)},{default:n(()=>[e("div",it,[a(H,{value:v.value,size:256},null,8,["value"])])]),_:1},8,["show"])]),_:1})],64))}});export{vt as default};
