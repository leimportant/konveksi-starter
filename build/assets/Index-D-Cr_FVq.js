import{d as O,a as v,b as K,r as $,G as Q,u as W,e as X,o as Y,g as p,j as y,q as s,x as t,y as Z,z as l,l as d,B as F,A as f,O as ee,F as N,D as S,H as te,k as j,N as ae,I as T}from"./app-C0ZtNFPV.js";import{_ as se}from"./AppLayout.vue_vue_type_script_setup_true_lang-CxyMViV1.js";import{_ as b}from"./Button.vue_vue_type_script_setup_true_lang-B6TXREVN.js";import{_ as V}from"./Input.vue_vue_type_script_setup_true_lang-BWB1n0oK.js";import{_ as oe,a as ne,b as U,c as q,d as le,e as z}from"./TableRow.vue_vue_type_script_setup_true_lang-CVJoN5Nr.js";import{u as de}from"./useToast-DV2nGitA.js";import{d as re}from"./debounce-BcZQbp_F.js";import{P as ie}from"./plus-jsIhsatj.js";import{T as me}from"./trash-2-Bt8Dqp-q.js";import"./index-C2dazRLE.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BIT3zfbJ.js";const ue=O("paymentMethod",{state:()=>({items:[],total:0,loaded:!1,loading:!1,currentPage:1,lastPage:1,filterName:"",error:null}),actions:{async fetchPaymentMethods(u=1,o=10){if(!this.loaded){this.loading=!0;try{const r=await v.get("/api/payment-methods",{params:{page:u,perPage:o,name:this.filterName}});this.items=r.data.data,this.total=r.data.total,this.currentPage=r.data.current_page,this.lastPage=r.data.last_page,this.loaded=!0,this.error=null}catch(r){console.error("Failed to fetch payment methods",r),this.error=r.message||"Unknown error"}finally{this.loading=!1}}},setFilter(u,o){u==="name"&&(this.filterName=o,this.currentPage=1,this.loaded=!1,this.fetchPaymentMethods(1))},async createPaymentMethod(u){try{await v.post("/api/payment-methods",{name:u}),this.loaded=!1,await this.fetchPaymentMethods()}catch(o){throw o}},async updatePaymentMethod(u,o){try{await v.put(`/api/payment-methods/${u}`,{name:o}),this.loaded=!1,await this.fetchPaymentMethods()}catch(r){throw r}},async deletePaymentMethod(u){try{await v.delete(`/api/payment-methods/${u}`),this.loaded=!1,await this.fetchPaymentMethods()}catch(o){throw o}}}}),ce={class:"px-4 py-4"},fe={class:"flex justify-between items-center mb-6"},he={class:"rounded-md border"},ye={class:"flex justify-end mt-4 space-x-2"},pe=["disabled"],be=["onClick","disabled"],_e=["disabled"],ge={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},ve={class:"bg-white p-6 rounded-lg w-96"},Pe={class:"mb-4"},Me={class:"flex justify-end gap-2"},we={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},xe={class:"bg-white p-6 rounded-lg w-96"},ke={class:"mb-4"},Ce={class:"flex justify-end gap-2"},Ee=K({__name:"Index",setup(u){const o=de(),r=$(!1),P=$(!1),M=$(null),c=Q({name:""}),B=[{title:"Payment Method",href:"/payment-methods"}],i=ue(),{items:E,currentPage:_,lastPage:A,loading:g,filterName:w}=W(i),x=X(()=>A.value||1),k=async n=>{n<1||n>x.value||await i.fetchPaymentMethods(n)},I=()=>k(_.value+1),D=()=>k(_.value-1),R=re((n,e)=>{i.setFilter(n,e)},400),G=n=>{const e=n.target;R("name",e.value)};Y(()=>{i.fetchPaymentMethods()});const H=async()=>{var n,e,a,m;if(!c.name)return o.error("Name is required");try{await i.createPaymentMethod(c.name),o.success("Payment Method created successfully"),c.reset(),i.loaded=!1,await i.fetchPaymentMethods(),r.value=!1}catch(h){const C=(m=(a=(e=(n=h==null?void 0:h.response)==null?void 0:n.data)==null?void 0:e.errors)==null?void 0:a.name)==null?void 0:m[0];o.error(C||"Failed to create Payment Method")}},J=async()=>{var n,e,a,m;if(!M.value||!c.name)return o.error("Name is required");try{await i.updatePaymentMethod(M.value.id,c.name),o.success("Payment Method updated successfully"),c.reset(),i.loaded=!1,await i.fetchPaymentMethods(),P.value=!1,M.value=null}catch(h){const C=(m=(a=(e=(n=h==null?void 0:h.response)==null?void 0:n.data)==null?void 0:e.errors)==null?void 0:a.name)==null?void 0:m[0];o.error(C||"Failed to update Payment Method")}},L=async n=>{var e,a;if(confirm("Are you sure you want to delete this Payment Method?"))try{await i.deletePaymentMethod(n),o.success("Payment Method deleted successfully"),i.loaded=!1,await i.fetchPaymentMethods()}catch(m){o.error(((a=(e=m==null?void 0:m.response)==null?void 0:e.data)==null?void 0:a.message)??"Failed to delete Payment Method")}};return(n,e)=>(y(),p(N,null,[s(t(Z),{title:"Payment Method Management"}),s(se,{breadcrumbs:B},{default:l(()=>[d("div",ce,[d("div",fe,[s(t(b),{onClick:e[0]||(e[0]=a=>r.value=!0),class:"bg-indigo-600 text-white py-2 rounded-md hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:l(()=>[s(t(ie),{class:"h-4 w-4"}),e[6]||(e[6]=f(" Add "))]),_:1,__:[6]}),s(t(V),{modelValue:t(w),"onUpdate:modelValue":e[1]||(e[1]=a=>ee(w)?w.value=a:null),placeholder:"Search",onInput:G,class:"w-64","aria-label":"Search",disabled:t(g)},null,8,["modelValue","disabled"])]),d("div",he,[s(t(oe),null,{default:l(()=>[s(t(ne),null,{default:l(()=>[s(t(U),{class:"bg-gray-100"},{default:l(()=>[s(t(q),null,{default:l(()=>e[7]||(e[7]=[f("Name")])),_:1,__:[7]}),s(t(q),{class:"w-24"},{default:l(()=>e[8]||(e[8]=[f("Actions")])),_:1,__:[8]})]),_:1})]),_:1}),s(t(le),null,{default:l(()=>[(y(!0),p(N,null,S(t(E),a=>(y(),te(t(U),{key:a.id},{default:l(()=>[s(t(z),null,{default:l(()=>[f(j(a.name),1)]),_:2},1024),s(t(z),{class:"flex gap-2"},{default:l(()=>[s(t(b),{variant:"ghost",size:"icon",onClick:m=>L(a.id)},{default:l(()=>[s(t(me),{class:"h-4 w-4"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),d("div",ye,[d("button",{onClick:D,disabled:t(_)===1||t(g),class:"px-3 py-1 rounded border border-gray-300 text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed"}," Previous ",8,pe),(y(!0),p(N,null,S(x.value,a=>(y(),p("button",{key:a,onClick:m=>k(a),class:ae(["px-3 py-1 rounded border text-sm",a===t(_)?"bg-blue-600 border-blue-600 text-white":"border-gray-300 text-gray-700 hover:bg-gray-100"]),disabled:t(g)},j(a),11,be))),128)),d("button",{onClick:I,disabled:t(_)===x.value||t(g),class:"px-3 py-1 rounded border border-gray-300 text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed"}," Next ",8,_e)]),r.value?(y(),p("div",ge,[d("div",ve,[e[11]||(e[11]=d("h2",{class:"text-lg font-semibold mb-4"},"Tambah Jenis Pembayaran",-1)),d("form",{onSubmit:T(H,["prevent"])},[d("div",Pe,[s(t(V),{modelValue:t(c).name,"onUpdate:modelValue":e[2]||(e[2]=a=>t(c).name=a),placeholder:"Payment Method Name",required:""},null,8,["modelValue"])]),d("div",Me,[s(t(b),{type:"button",variant:"outline",onClick:e[3]||(e[3]=a=>r.value=!1)},{default:l(()=>e[9]||(e[9]=[f("Cancel")])),_:1,__:[9]}),s(t(b),{type:"submit"},{default:l(()=>e[10]||(e[10]=[f("Create")])),_:1,__:[10]})])],32)])])):F("",!0),P.value?(y(),p("div",we,[d("div",xe,[e[14]||(e[14]=d("h2",{class:"text-lg font-semibold mb-4"},"Edit Payment Method",-1)),d("form",{onSubmit:T(J,["prevent"])},[d("div",ke,[s(t(V),{modelValue:t(c).name,"onUpdate:modelValue":e[4]||(e[4]=a=>t(c).name=a),placeholder:"Payment Method Name",required:""},null,8,["modelValue"])]),d("div",Ce,[s(t(b),{type:"button",variant:"outline",onClick:e[5]||(e[5]=a=>P.value=!1)},{default:l(()=>e[12]||(e[12]=[f("Cancel")])),_:1,__:[12]}),s(t(b),{type:"submit"},{default:l(()=>e[13]||(e[13]=[f("Update")])),_:1,__:[13]})])],32)])])):F("",!0)])]),_:1})],64))}});export{Ee as default};
