import{d as M,r as C,c as f,o as E,f as d,g as r,p as a,u as o,Z as L,x as l,k as u,D as z,y as i,j as m,F as P,B as S,E as A,z as $,C as O,J as k}from"./app-OChygklg.js";import{_ as D}from"./Input.vue_vue_type_script_setup_true_lang-CJBXtHtF.js";import{_ as j,a as U,b as T,c as p,d as H,e as y}from"./TableRow.vue_vue_type_script_setup_true_lang-DKI-NP62.js";import{_ as J}from"./AppLayout.vue_vue_type_script_setup_true_lang-BfK2xR03.js";import{u as Q}from"./useReportStore-CSxii2ju.js";import"./index-BXtxs2U3.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CIb7ob0q.js";const W={class:"py-2"},Y={class:"mx-auto max-w-7xl sm:px-2 lg:px-2"},Z={class:"overflow-hidden bg-white shadow-sm sm:rounded-lg"},q={class:"mb-4 flex space-x-4"},G={key:0},K={key:1,class:"text-red-500"},X={key:2},ee={class:"flex gap-1 items-end h-4"},te={class:"mt-4 flex items-center justify-between"},oe={class:"mt-4 flex justify-end space-x-2"},ae=["disabled"],se=["onClick"],le=["disabled"],_e=M({__name:"OmsetReport",setup(ne){const n=Q(),V=[{title:"Report Omset",href:"/reports/omzet"}],g=C(""),_=C(""),c=f(()=>n.currentPage),N=f(()=>n.lastPage),v=f(()=>n.perPage),b=async(s=1,e=10)=>{await n.fetchOmsetPerPayment(g.value,_.value,s,e),console.log("Current Page:",n.currentPage),console.log("Last Page:",n.lastPage),console.log("Total Omset Records:",n.totalOmsetRecords)},w=f(()=>Math.ceil(n.totalOmsetRecords/n.perPage)),B=()=>{h(c.value-1)},F=()=>{h(c.value+1)},h=s=>{console.log("Attempting to go to page:",s),console.log("Current Page (before check):",c.value),console.log("Last Page (before check):",N.value),b(s,v.value)},I=s=>{const e=parseFloat(s);return isNaN(e)?"Rp0,00":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:2}).format(e)},x=(s,e=5e5)=>{const t=typeof s=="string"?parseFloat(s):s,R=Math.min(t/e*100,100);return Math.round(R)};return E(()=>{const s=new Date,e=new Date(s.getFullYear(),s.getMonth(),1);g.value=e.toISOString().split("T")[0],_.value=s.toISOString().split("T")[0],b(c.value,v.value)}),(s,e)=>(r(),d(P,null,[a(o(L),{title:"Omset Report"}),a(J,{breadcrumbs:V},{default:l(()=>[u("div",W,[u("div",Y,[u("div",Z,[u("div",q,[a(o(D),{type:"date",modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=t=>g.value=t)},null,8,["modelValue"]),a(o(D),{type:"date",modelValue:_.value,"onUpdate:modelValue":e[1]||(e[1]=t=>_.value=t)},null,8,["modelValue"]),a(o(z),{onClick:e[2]||(e[2]=t=>b(1,v.value)),class:"bg-indigo-600 text-white py-2 h-10 rounded-md hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:l(()=>e[3]||(e[3]=[i("Tampilkan")])),_:1,__:[3]})]),o(n).loading?(r(),d("div",G,"Loading...")):o(n).error?(r(),d("div",K,"Error: "+m(o(n).error.message),1)):(r(),d("div",X,[a(o(j),null,{default:l(()=>[a(o(U),null,{default:l(()=>[a(o(T),{class:"bg-gray-100"},{default:l(()=>[a(o(p),null,{default:l(()=>e[4]||(e[4]=[i("Tanggal")])),_:1,__:[4]}),a(o(p),null,{default:l(()=>e[5]||(e[5]=[i("Payment Method")])),_:1,__:[5]}),a(o(p),null,{default:l(()=>e[6]||(e[6]=[i("Omset")])),_:1,__:[6]}),a(o(p),null,{default:l(()=>e[7]||(e[7]=[i("Bars")])),_:1,__:[7]})]),_:1})]),_:1}),a(o(H),null,{default:l(()=>[(r(!0),d(P,null,S(o(n).omsetSummary,t=>(r(),A(o(T),{key:t.tanggal,class:$(t.payment_method==="SUBTOTAL"?"bg-green-100 font-semibold":"")},{default:l(()=>[a(o(y),null,{default:l(()=>[i(m(t.tanggal),1)]),_:2},1024),a(o(y),null,{default:l(()=>[i(m(t.payment_method),1)]),_:2},1024),a(o(y),null,{default:l(()=>[i(m(I(t.total_omset.toString())),1)]),_:2},1024),a(o(y),null,{default:l(()=>[u("div",ee,[t.payment_method==="CASH"?(r(),d("div",{key:0,class:"bg-green-500 h-full",style:k({width:`${x(t.total_omset)}%`})},null,4)):O("",!0),t.payment_method==="QRIS"||t.payment_method==="TRANSFER"?(r(),d("div",{key:1,class:"bg-indigo-500 h-full",style:k({width:`${x(t.total_omset)}%`})},null,4)):t.payment_method==="CREDIT"?(r(),d("div",{key:2,class:"bg-blue-500 h-full",style:k({width:`${x(t.total_omset)}%`})},null,4)):O("",!0)])]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})]),_:1}),u("div",te,[u("div",oe,[u("button",{onClick:B,disabled:c.value===1,class:"rounded border border-gray-300 px-3 py-1 text-gray-700 hover:bg-gray-100 disabled:cursor-not-allowed disabled:opacity-50"}," Previous ",8,ae),(r(!0),d(P,null,S(w.value,t=>(r(),d("button",{key:t,onClick:R=>h(t),class:$(["rounded border px-3 py-1 text-sm",t===c.value?"border-blue-600 bg-blue-600 text-white":"border-gray-300 text-gray-700 hover:bg-gray-100"])},m(t),11,se))),128)),u("button",{onClick:F,disabled:c.value===w.value,class:"rounded border border-gray-300 px-3 py-1 text-gray-700 hover:bg-gray-100 disabled:cursor-not-allowed disabled:opacity-50"}," Next ",8,le)])])]))])])])]),_:1})],64))}});export{_e as default};
