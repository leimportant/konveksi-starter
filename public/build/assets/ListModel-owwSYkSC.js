import{d as W,q as A,r as T,W as G,w as H,o as V,a as K,f as i,g as d,p as a,u as e,Z as O,x as r,k as l,D as h,V as z,y as c,E as L,C as B,F as p,B as y,z as E,j as g,N as F}from"./app-C2bk1Yi_.js";import{_ as Q}from"./Input.vue_vue_type_script_setup_true_lang-GoHpMJcZ.js";import{_ as Z,a as J,b as w,c as C,d as X,e as x}from"./TableRow.vue_vue_type_script_setup_true_lang-C9Am_zOQ.js";import{u as ee}from"./useToast-Cxixi8ft.js";import{_ as te}from"./AppLayout.vue_vue_type_script_setup_true_lang-B11grxyU.js";import{u as se}from"./useModelStore-D40EVfaX.js";import{P as ae}from"./plus-C832kKr8.js";import{S as re}from"./square-pen-UjR0Da0H.js";import{T as oe}from"./trash-2-B2MLOyst.js";import"./index-B5fTECvZ.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BGA6kKAh.js";const de={class:"px-4 py-4"},le={class:"mb-6 flex flex-wrap items-center justify-between gap-3"},ne={class:"min-w-[180px] flex-1 sm:min-w-[240px] md:min-w-[280px]"},ie={class:"overflow-x-auto rounded-md bg-white shadow-sm dark:border-gray-700 dark:bg-gray-900"},ue={class:"font-semibold"},ce={class:"text-[10px] text-gray-500"},ge={key:0,class:"text-[10px] text-gray-500"},me={key:1,class:"flex flex-col gap-1 rounded-lg border border-gray-200 bg-gray-50 p-1 text-[10px] text-gray-700"},pe={class:"font-semibold"},xe={key:2,class:"text-xs italic text-gray-400"},fe={class:"mt-4 flex flex-wrap justify-center gap-2 sm:justify-end"},ye=["disabled"],_e=["onClick"],be=["disabled"],Ve=W({__name:"ListModel",setup(ke){const $=ee(),u=se(),{models:P,loading:_,currentPage:b,filters:j,lastPage:N}=A(u),I=[{title:"Konveksi",href:"/konveksi"},{title:"List Model",href:"/konveksi/model"}],k=T(j.value.search||""),D=async(n={})=>{var o,m;const{page:s=1,is_close:t="-"}=n;try{await u.fetchModels({search:k.value,is_close:t,page:s})}catch(f){$.error(((m=(o=f==null?void 0:f.response)==null?void 0:o.data)==null?void 0:m.message)??"Failed to fetch models")}},q=G.debounce(()=>D({page:1}),300);H(k,q),V(()=>{D()});const v=T(!1),M=()=>v.value=window.innerWidth<768;V(()=>{M(),window.addEventListener("resize",M)}),K(()=>window.removeEventListener("resize",M));const Y=async n=>{await u.updateCloseStatus(n)},R=async n=>{var s,t;if(confirm("Yakin hapus model ini?"))try{await u.deleteModel(n),$.success("Model berhasil dihapus"),D({page:b.value})}catch(o){$.error(((t=(s=o==null?void 0:o.response)==null?void 0:s.data)==null?void 0:t.message)??"Gagal menghapus model")}},U=n=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(n),S=n=>{if(!n)return"-";const s=new Date(n);return isNaN(s.getTime())?"-":s.toLocaleDateString("id-ID",{day:"2-digit",month:"long",year:"numeric"})};return(n,s)=>(d(),i(p,null,[a(e(O),{title:"List Model"}),a(te,{breadcrumbs:I},{default:r(()=>[l("div",de,[l("div",le,[a(e(h),{onClick:s[0]||(s[0]=t=>e(z).visit("/konveksi/model/create")),class:"flex items-center gap-2 rounded-md bg-indigo-600 px-3 py-2 text-sm text-white hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:r(()=>[a(e(ae),{class:"h-4 w-4"}),s[4]||(s[4]=c(" Tambah "))]),_:1,__:[4]}),l("div",ne,[a(e(Q),{modelValue:k.value,"onUpdate:modelValue":s[1]||(s[1]=t=>k.value=t),placeholder:"Cari model...",class:"w-full text-sm"},null,8,["modelValue"])])]),l("div",ie,[a(e(Z),{class:"w-full text-xs md:text-sm"},{default:r(()=>[a(e(J),null,{default:r(()=>[a(e(w),{class:"bg-gray-100 dark:bg-gray-800"},{default:r(()=>[a(e(C),{class:"px-2 py-2 text-left md:px-3"},{default:r(()=>s[5]||(s[5]=[c("Status")])),_:1,__:[5]}),a(e(C),{class:"px-2 py-2 text-left md:px-3"},{default:r(()=>s[6]||(s[6]=[c("Model")])),_:1,__:[6]}),a(e(C),{class:"hidden px-2 py-2 md:table-cell md:px-3"},{default:r(()=>s[7]||(s[7]=[c("Catatan")])),_:1,__:[7]}),a(e(C),{class:"px-2 py-2 text-right md:px-3"},{default:r(()=>s[8]||(s[8]=[c("Action")])),_:1,__:[8]})]),_:1})]),_:1}),a(e(X),null,{default:r(()=>[e(_)?(d(),i(p,{key:0},y(5,t=>a(e(w),{key:t,class:"animate-pulse"},{default:r(()=>[(d(),i(p,null,y(5,o=>a(e(x),{key:o,class:"py-2"},{default:r(()=>s[9]||(s[9]=[l("div",{class:"h-4 rounded bg-gray-200 dark:bg-gray-700"},null,-1)])),_:2,__:[9]},1024)),64))]),_:2},1024)),64)):(d(!0),i(p,{key:1},y(e(P),t=>(d(),L(e(w),{key:t.id,class:"border-b border-gray-100 hover:bg-gray-50 dark:border-gray-800 dark:hover:bg-gray-800"},{default:r(()=>[a(e(x),{class:"px-2 py-2 text-center align-top md:px-3"},{default:r(()=>[a(e(h),{onClick:o=>Y(t.id),disabled:e(u).loading,class:E(["rounded px-2 py-1 text-xs transition-all md:text-sm",t.is_close==="Y"?"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300":"bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300"])},{default:r(()=>[c(g(t.is_close==="Y"?"Close":"Open"),1)]),_:2},1032,["onClick","disabled","class"])]),_:2},1024),a(e(x),{class:"px-2 py-2 align-top font-medium"},{default:r(()=>{var o;return[l("div",ue,g(t.description),1),l("div",ce,g(v.value?S(t.start_date):`Mulai: ${S(t.start_date)}`),1),v.value?B("",!0):(d(),i("div",ge,g(v.value?t.start_date:`Estimasi Harga: ${U(t.estimation_price_pcs)}`),1)),(o=t.sizes)!=null&&o.length?(d(),i("div",me,[(d(!0),i(p,null,y(t.sizes,(m,f)=>(d(),i("div",{key:f,class:"flex items-center justify-between rounded-md bg-white px-1.5 py-0.5 shadow-sm"},[l("span",null,g(m.size_id)+" - "+g(m.variant),1),s[10]||(s[10]=c()),l("span",pe,g(m.qty),1)]))),128))])):(d(),i("span",xe,"-"))]}),_:2},1024),a(e(x),{class:"hidden px-2 py-2 text-gray-500 md:table-cell md:px-3"},{default:r(()=>[c(g(t.remark||"-"),1)]),_:2},1024),a(e(x),{class:"px-2 py-2 text-right md:px-3"},{default:r(()=>[a(e(h),{size:"icon",variant:"ghost",class:"hover:bg-gray-100 dark:hover:bg-gray-700",onClick:F(o=>e(z).visit(`/konveksi/model/${t.id}/edit`),["stop"])},{default:r(()=>[a(e(re),{class:"h-4 w-4"})]),_:2},1032,["onClick"]),a(e(h),{size:"icon",variant:"ghost",class:"hover:bg-gray-100 dark:hover:bg-gray-700",onClick:F(o=>R(t.id),["stop"])},{default:r(()=>[a(e(oe),{class:"h-4 w-4 text-red-500"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128)),!e(_)&&e(P).length===0?(d(),L(e(w),{key:2},{default:r(()=>[a(e(x),{colspan:"6",class:"py-6 text-center text-gray-500 dark:text-gray-400"},{default:r(()=>s[11]||(s[11]=[c(" Belum ada model ditemukan. ")])),_:1,__:[11]})]),_:1})):B("",!0)]),_:1})]),_:1})]),l("div",fe,[l("button",{onClick:s[2]||(s[2]=(...t)=>e(u).prevPage&&e(u).prevPage(...t)),disabled:e(b)===1||e(_),class:"rounded border border-gray-300 px-3 py-1 text-sm text-gray-700 hover:bg-gray-100 disabled:opacity-50"}," Previous ",8,ye),(d(!0),i(p,null,y(e(N),t=>(d(),i("button",{key:t,onClick:o=>e(u).goToPage(t),class:E(["rounded border px-3 py-1 text-sm",t===e(b)?"border-blue-600 bg-blue-600 text-white":"border-gray-300 text-gray-700 hover:bg-gray-100"])},g(t),11,_e))),128)),l("button",{onClick:s[3]||(s[3]=(...t)=>e(u).nextPage&&e(u).nextPage(...t)),disabled:e(b)===e(N)||e(_),class:"rounded border border-gray-300 px-3 py-1 text-sm text-gray-700 hover:bg-gray-100 disabled:opacity-50"}," Next ",8,be)])])]),_:1})],64))}});export{Ve as default};
