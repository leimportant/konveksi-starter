import{d as A,q as R,r as p,o as j,f as i,g as o,p as c,u as a,Z as q,x as y,k as e,D as _,y as L,G as M,F as m,B as w,j as d,E as $,C}from"./app-B5zXD0_k.js";import{_ as O}from"./Input.vue_vue_type_script_setup_true_lang-D1qgJ1A8.js";import{u as E}from"./useToast-BFlNbzbh.js";import{_ as K}from"./AppLayout.vue_vue_type_script_setup_true_lang-BJVCaRiP.js";import{u as Q}from"./useProductionStore-Dq7r_Kf6.js";import{P as G}from"./plus-CgF4f1C4.js";import{S as U}from"./square-pen-DBxHk1xW.js";import{T as Z}from"./trash-2-CepJggZK.js";import{V as H}from"./view-lT5gVhyY.js";import"./index-oGaICzzt.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-QcNWLwcl.js";const J={class:"px-3 py-4"},W={class:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3"},X={class:"flex flex-1 gap-2"},Y={key:0,class:"py-4 text-center text-sm text-gray-500"},tt={key:1,class:"space-y-2"},et={class:"overflow-x-auto rounded-md border border-gray-200 dark:border-gray-700"},st={class:"min-w-full table-auto text-sm text-left text-gray-800 dark:text-gray-100"},at={class:"px-3 py-2 max-w-[160px] truncate"},ot={class:"px-3 py-2 truncate"},rt={class:"px-3 py-2 whitespace-nowrap"},nt={key:0},it={key:1},ct={class:"px-3 py-2 max-w-[160px] truncate"},dt={class:"px-3 py-2 max-w-[160px] truncate"},lt={class:"px-3 py-2 whitespace-nowrap"},ut={class:"px-3 py-2 text-right"},pt={class:"flex justify-end gap-1 sm:gap-2"},$t=A({__name:"Index",props:{activity_role:{}},setup(P){const g=E(),h=Q(),{productions:S,loading:D}=R(h),V=p(1),F=p(10),T=p("created_at"),I=p("desc"),f=P,z=[{title:"Production",href:`/production/${f.activity_role}`}],x=p(""),b=p({from:null,to:null});function B(r){return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(r)}const v=async()=>{var r,s,t,n;try{await h.fetchProductions({page:V.value,per_page:F.value,sort_field:T.value,sort_order:I.value,activity_role_id:f.activity_role,search:x.value,date_from:(r=b.value.from)==null?void 0:r.toISOString(),date_to:(s=b.value.to)==null?void 0:s.toISOString()})}catch(l){g.error(((n=(t=l==null?void 0:l.response)==null?void 0:t.data)==null?void 0:n.message)??"Failed to fetch productions")}};j(v);const N=async r=>{var s,t;if(confirm("Are you sure you want to delete this production?"))try{await h.deleteProduction(r),g.success("Production deleted successfully"),await v()}catch(n){g.error(((t=(s=n==null?void 0:n.response)==null?void 0:s.data)==null?void 0:t.message)??"Failed to delete production")}};return(r,s)=>(o(),i(m,null,[c(a(q),{title:"Production Management"}),c(K,{breadcrumbs:z},{default:y(()=>[e("div",J,[e("div",W,[e("div",X,[c(a(_),{onClick:s[0]||(s[0]=t=>r.$inertia.visit(`/production/${f.activity_role}/create`)),class:"flex-shrink-0 flex items-center gap-2 rounded-md bg-indigo-600 px-3 py-2 text-sm font-medium text-white hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:y(()=>[c(a(G),{class:"h-4 w-4"}),s[2]||(s[2]=L(" Tambah Data "))]),_:1,__:[2]}),c(a(O),{modelValue:x.value,"onUpdate:modelValue":s[1]||(s[1]=t=>x.value=t),placeholder:"Search...",class:"flex-1 text-sm",onKeyup:M(v,["enter"])},null,8,["modelValue"])])]),a(D)?(o(),i("div",Y,"Loading...")):(o(),i("div",tt,[e("div",et,[e("table",st,[s[3]||(s[3]=e("thead",{class:"bg-gray-100 dark:bg-gray-800 text-xs font-semibold uppercase text-gray-600 dark:text-gray-300"},[e("tr",null,[e("th",{class:"px-3 py-2"},"Model"),e("th",{class:"px-3 py-2"},"Activity"),e("th",{class:"px-3 py-2"},"Size/Qty"),e("th",{class:"px-3 py-2 hidden"},"Price/PCS"),e("th",{class:"px-3 py-2 hidden"},"Total"),e("th",{class:"px-3 py-2"},"Created At"),e("th",{class:"px-3 py-2 text-right"},"Actions")])],-1)),e("tbody",null,[(o(!0),i(m,null,w(a(S),t=>{var n,l,k;return o(),i("tr",{key:t.id,class:"border-b border-gray-100 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800"},[e("td",at,d(((n=t.model)==null?void 0:n.description)||"-"),1),e("td",ot,d(((l=t.activity_role)==null?void 0:l.name)||"-"),1),e("td",rt,[(k=t.items)!=null&&k.length?(o(),i("div",nt,[(o(!0),i(m,null,w(t.items,u=>(o(),i("div",{key:u.id},d(u.size_id)+": "+d(u.qty),1))),128))])):(o(),i("div",it,"-"))]),e("td",ct,d(B((t==null?void 0:t.price_per_pcs)||0)),1),e("td",dt,d((t==null?void 0:t.total_price)||0),1),e("td",lt,d(t.created_at?new Date(t.created_at).toLocaleDateString():"-"),1),e("td",ut,[e("div",pt,[t.status===1||t.status===3?(o(),$(a(_),{key:0,variant:"ghost",size:"icon",class:"hover:bg-gray-100 dark:hover:bg-gray-700",onClick:u=>r.$inertia.visit(`/production/${t.activity_role_id}/edit/${t.id}`)},{default:y(()=>[c(a(U),{class:"h-4 w-4"})]),_:2},1032,["onClick"])):C("",!0),t.status===1||t.status===3?(o(),$(a(_),{key:1,variant:"ghost",size:"icon",class:"hover:bg-gray-100 dark:hover:bg-gray-700",onClick:u=>N(t.id)},{default:y(()=>[c(a(Z),{class:"h-4 w-4"})]),_:2},1032,["onClick"])):C("",!0),c(a(_),{variant:"ghost",size:"icon",class:"hover:bg-gray-100 dark:hover:bg-gray-700",onClick:u=>r.$inertia.visit(`/production/${t.activity_role_id}/view/${t.id}`)},{default:y(()=>[c(a(H),{class:"h-4 w-4"})]),_:2},1032,["onClick"])])])])}),128))])])])]))])]),_:1})],64))}});export{$t as default};
