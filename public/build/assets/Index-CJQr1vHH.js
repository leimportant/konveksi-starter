import{d as J,r as N,T as O,q as Q,c as W,o as X,f as _,g as b,p as s,u as e,Z as Y,x as l,k as r,C as E,D as y,y as m,S as ee,F as V,B as T,E as ae,j as M,z as te,N as j}from"./app-BThHDKz0.js";import{_ as se}from"./AppLayout.vue_vue_type_script_setup_true_lang-IfNrhM-z.js";import{_ as S}from"./Input.vue_vue_type_script_setup_true_lang-DK5N7fd1.js";import{_ as oe,a as le,b as B,c as F,d as re,e as q}from"./TableRow.vue_vue_type_script_setup_true_lang-urXAdF0Y.js";import{u as ie}from"./useToast-D9M_-ePB.js";import{u as ne}from"./useCategoryStore-D943bsJv.js";import{P as de}from"./plus-D6NF7240.js";import{S as ue}from"./square-pen-lbPPCNzT.js";import{T as ce}from"./trash-2-CGp8cszc.js";import"./index-CCxp805y.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-D7WqqqJ8.js";const me={class:"px-4 py-4"},ge={class:"flex justify-between items-center gap-2 mb-2"},fe={class:"rounded-md border"},be={class:"flex justify-end mt-4 space-x-2"},ye=["disabled"],_e=["onClick","disabled"],pe=["disabled"],ve={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Ce={class:"bg-white p-6 rounded-lg w-96"},he={class:"mb-4"},xe={class:"flex justify-end gap-2"},we={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},ke={class:"bg-white p-6 rounded-lg w-96"},Ne={class:"mb-4"},Ve={class:"flex justify-end gap-2"},Ue=J({__name:"Index",setup(Se){const u=ie(),v=N(!1),C=N(!1),p=N(null),i=O({name:""}),z=[{title:"Category",href:"/categories"}],d=ne(),{items:D,currentPage:c,lastPage:U,loading:g,filterName:h}=Q(d),x=W(()=>U.value||1),w=async o=>{o<1||o>x.value||await d.fetchCategories(o)},A=()=>w(c.value+1),I=()=>w(c.value-1),K=(o,a)=>{const t=a.target;d.setFilter(o,t.value)},R=()=>{i.reset(),v.value=!0},$=()=>{v.value=!1,i.reset()},P=()=>{C.value=!1,p.value=null,i.reset()};X(()=>{d.fetchCategories()});const L=async()=>{var o,a,t,n;if(!i.name)return u.error("Name is required");try{await d.createCategory(i.name),u.success("Category created successfully"),i.reset(),await d.fetchCategories(c.value),$()}catch(f){const k=(n=(t=(a=(o=f==null?void 0:f.response)==null?void 0:o.data)==null?void 0:a.errors)==null?void 0:t.name)==null?void 0:n[0];u.error(k||"Failed to create Category")}},Z=o=>{p.value=o,i.name=o.name,C.value=!0},G=async()=>{var o,a,t,n;if(!p.value||!i.name)return u.error("Name is required");try{await d.updateCategory(p.value.id,i.name),u.success("Category updated successfully"),i.reset(),await d.fetchCategories(c.value),P()}catch(f){const k=(n=(t=(a=(o=f==null?void 0:f.response)==null?void 0:o.data)==null?void 0:a.errors)==null?void 0:t.name)==null?void 0:n[0];u.error(k||"Failed to update Category")}},H=async o=>{var a,t;if(confirm("Are you sure you want to delete this Category?"))try{await d.deleteCategory(o),u.success("Category deleted successfully"),await d.fetchCategories(c.value)}catch(n){u.error(((t=(a=n==null?void 0:n.response)==null?void 0:a.data)==null?void 0:t.message)??"Failed to delete Category")}};return(o,a)=>(b(),_(V,null,[s(e(Y),{title:"Category Management"}),s(se,{breadcrumbs:z},{default:l(()=>[r("div",me,[r("div",ge,[s(e(y),{onClick:R,"aria-label":"Tambah Kategori Baru",disabled:e(g),class:"bg-indigo-600 text-white py-2 h-10 rounded-md hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:l(()=>[s(e(de),{class:"h-4 w-4"}),a[4]||(a[4]=m(" Add "))]),_:1,__:[4]},8,["disabled"]),s(e(S),{modelValue:e(h),"onUpdate:modelValue":a[0]||(a[0]=t=>ee(h)?h.value=t:null),placeholder:"Search Categories",onInput:a[1]||(a[1]=t=>K("name",t)),class:"w-64","aria-label":"Search Categories",disabled:e(g)},null,8,["modelValue","disabled"])]),r("div",fe,[s(e(oe),null,{default:l(()=>[s(e(le),null,{default:l(()=>[s(e(B),{class:"bg-gray-100"},{default:l(()=>[s(e(F),null,{default:l(()=>a[5]||(a[5]=[m("Name")])),_:1,__:[5]}),s(e(F),{class:"w-24"},{default:l(()=>a[6]||(a[6]=[m("Actions")])),_:1,__:[6]})]),_:1})]),_:1}),s(e(re),null,{default:l(()=>[(b(!0),_(V,null,T(e(D),t=>(b(),ae(e(B),{key:t.id},{default:l(()=>[s(e(q),null,{default:l(()=>[m(M(t.name),1)]),_:2},1024),s(e(q),{class:"flex gap-2"},{default:l(()=>[s(e(y),{variant:"ghost",size:"icon",onClick:n=>Z(t),"aria-label":"Edit category",disabled:e(g)},{default:l(()=>[s(e(ue),{class:"h-4 w-4"})]),_:2},1032,["onClick","disabled"]),s(e(y),{variant:"ghost",size:"icon",onClick:n=>H(t.id),"aria-label":"Delete category",disabled:e(g)},{default:l(()=>[s(e(ce),{class:"h-4 w-4"})]),_:2},1032,["onClick","disabled"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),r("div",be,[r("button",{onClick:I,disabled:e(c)===1||e(g),class:"px-3 py-1 rounded border border-gray-300 text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed"}," Previous ",8,ye),(b(!0),_(V,null,T(x.value,t=>(b(),_("button",{key:t,onClick:n=>w(t),class:te(["px-3 py-1 rounded border text-sm",t===e(c)?"bg-blue-600 border-blue-600 text-white":"border-gray-300 text-gray-700 hover:bg-gray-100"]),disabled:e(g)},M(t),11,_e))),128)),r("button",{onClick:A,disabled:e(c)===x.value||e(g),class:"px-3 py-1 rounded border border-gray-300 text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed"}," Next ",8,pe)]),v.value?(b(),_("div",ve,[r("div",Ce,[a[9]||(a[9]=r("h2",{class:"text-lg font-semibold mb-4"},"Tambah Kategori Baru",-1)),r("form",{onSubmit:j(L,["prevent"])},[r("div",he,[s(e(S),{modelValue:e(i).name,"onUpdate:modelValue":a[2]||(a[2]=t=>e(i).name=t),placeholder:"Category Name",required:"","aria-label":"Category Name"},null,8,["modelValue"])]),r("div",xe,[s(e(y),{type:"button",variant:"outline",onClick:$,class:"h-10"},{default:l(()=>a[7]||(a[7]=[m("Cancel")])),_:1,__:[7]}),s(e(y),{type:"submit",class:"bg-indigo-600 text-white py-2 h-10 rounded-md hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:l(()=>a[8]||(a[8]=[m("Simpan")])),_:1,__:[8]})])],32)])])):E("",!0),C.value?(b(),_("div",we,[r("div",ke,[a[12]||(a[12]=r("h2",{class:"text-lg font-semibold mb-4"},"Edit Category",-1)),r("form",{onSubmit:j(G,["prevent"])},[r("div",Ne,[s(e(S),{modelValue:e(i).name,"onUpdate:modelValue":a[3]||(a[3]=t=>e(i).name=t),placeholder:"Category Name",required:"","aria-label":"Category Name"},null,8,["modelValue"])]),r("div",Ve,[s(e(y),{type:"button",variant:"outline",onClick:P,class:"h-10"},{default:l(()=>a[10]||(a[10]=[m("Cancel")])),_:1,__:[10]}),s(e(y),{type:"submit",class:"bg-indigo-600 text-white py-2 h-10 rounded-md hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:l(()=>a[11]||(a[11]=[m("Simpan")])),_:1,__:[11]})])],32)])])):E("",!0)])]),_:1})],64))}});export{Ue as default};
