import{d as D,r as h,o as O,c as j,f as a,g as o,p as y,u as d,Z as C,x as b,k as s,D as M,y as P,j as i,F as u,B as m,C as R}from"./app-CldKTlvf.js";import{_ as w}from"./Input.vue_vue_type_script_setup_true_lang-DuVOjJR6.js";import{_ as T}from"./AppLayout.vue_vue_type_script_setup_true_lang-DZJtdNf_.js";import{u as q}from"./useReportStore-C2vyf8Dk.js";import"./index-DjXBdBm2.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CBXN1DQl.js";const B={class:"mx-auto max-w-7xl space-y-4 px-2 py-6"},N={class:"mb-4 flex flex-wrap items-end gap-2"},A={key:0,class:"py-4 text-center text-gray-500"},E={key:1,class:"py-4 text-center text-red-500"},F={key:2,class:"relative max-h-[500px] overflow-y-auto overflow-x-auto rounded-lg bg-white shadow"},U={class:"min-w-full text-sm text-gray-800 table-auto"},$={class:"sticky top-0 z-20 bg-gray-50 text-xs font-semibold uppercase text-gray-600"},I={class:"bg-gray-100 font-semibold hover:bg-gray-200"},L={class:"px-3 py-2",colspan:"2"},G={class:"px-3 py-1 align-top"},K={class:"min-w-[200px] px-3 py-1 align-top"},Q={key:0,class:"flex flex-col gap-1 rounded-lg border border-gray-200 bg-gray-50 p-1 text-[11px] text-gray-700"},Y={class:"font-semibold"},Z={class:"bg-gray-50 text-xs font-semibold text-gray-600"},ae=D({__name:"ProductionSummaryOri",setup(z){const c=q(),x=h(""),g=h(""),f=h(""),S=[{title:"Production Summary",href:"/reports/production-summary"}],k=()=>{c.fetchProductionSummary(x.value,g.value,f.value)};O(()=>{const r=new Date,e=new Date(r.getFullYear(),r.getMonth(),1);x.value=e.toISOString().split("T")[0],g.value=r.toISOString().split("T")[0],k()});const _=j(()=>{const r=new Map;return Object.values(c.productionSummary).forEach(e=>{Object.values(e.activities??{}).forEach(t=>{r.has(t.name)||r.set(t.name,t.name)})}),Array.from(r.entries()).map(([e])=>({id:e,name:e}))}),V=(r,e)=>r.activity_role_name===e?r.total_qty:0;return(r,e)=>(o(),a(u,null,[y(d(C),{title:"Production Summary Report"}),y(T,{breadcrumbs:S},{header:b(()=>e[3]||(e[3]=[s("h2",{class:"text-xl font-semibold text-gray-800"},"Production Summary Report",-1)])),default:b(()=>[s("div",B,[s("div",N,[y(d(w),{type:"date",modelValue:x.value,"onUpdate:modelValue":e[0]||(e[0]=t=>x.value=t),class:"w-40"},null,8,["modelValue"]),y(d(w),{type:"date",modelValue:g.value,"onUpdate:modelValue":e[1]||(e[1]=t=>g.value=t),class:"w-40"},null,8,["modelValue"]),y(d(w),{type:"text",modelValue:f.value,"onUpdate:modelValue":e[2]||(e[2]=t=>f.value=t),placeholder:"Search Model / Activity",class:"min-w-[200px] flex-1"},null,8,["modelValue"]),y(d(M),{class:"h-10 bg-indigo-600 text-white hover:bg-indigo-700",onClick:k},{default:b(()=>e[4]||(e[4]=[P("Tampilkan")])),_:1,__:[4]})]),d(c).loading?(o(),a("div",A,"Loading...")):d(c).error?(o(),a("div",E,i(d(c).error.message),1)):(o(),a("div",F,[s("table",U,[s("thead",$,[s("tr",null,[e[5]||(e[5]=s("th",{class:"px-3 py-2",colspan:"2"},"Model",-1)),(o(!0),a(u,null,m(_.value,t=>(o(),a("th",{key:"header-role-"+t.id,class:"px-2 py-1 text-center"},i(t.name),1))),128))])]),s("tbody",null,[(o(!0),a(u,null,m(d(c).productionSummary,t=>(o(),a(u,{key:t.model_id},[s("tr",I,[s("td",L,i(t.description),1),(o(!0),a(u,null,m(_.value,l=>{var p;return o(),a("td",{key:"summary-"+l.id+"-"+t.model_id,class:"px-2 py-1 text-center"},i(((p=Object.values(t.activities).find(n=>n.name===l.name))==null?void 0:p.qty)??"-"),1)}),128))]),(o(!0),a(u,null,m(t.details,l=>{var p;return o(),a("tr",{key:l.production_id,class:"hover:bg-gray-50"},[s("td",G,i(l.employee_name),1),s("td",K,[(p=l.items)!=null&&p.length?(o(),a("div",Q,[(o(!0),a(u,null,m(l.items,(n,v)=>(o(),a("div",{key:v,class:"flex items-center justify-between rounded-md bg-white px-1.5 py-0.5 shadow-sm"},[s("span",null,i(n.size_id)+" - "+i(n.variant),1),s("span",Y,i(n.qty),1)]))),128))])):R("",!0)]),(o(!0),a(u,null,m(_.value,n=>(o(),a("td",{key:"detail-"+n.id+"-"+l.production_id,class:"px-2 py-1 text-center align-top"},i(V(l,n.name)||"-"),1))),128))])}),128))],64))),128))]),s("tfoot",Z,[s("tr",null,[e[6]||(e[6]=s("td",{colspan:"2",class:"px-3 py-2 text-right"},"Grand Total:",-1)),(o(!0),a(u,null,m(_.value,t=>(o(),a("td",{key:"footer-role-"+t.id,class:"px-2 py-1 text-center"},i(Object.values(d(c).productionSummary).reduce((l,p)=>{var n;return l+(((n=Object.values(p.activities).find(v=>v.name===t.name))==null?void 0:n.qty)??0)},0)),1))),128))])])])]))])]),_:1})],64))}});export{ae as default};
