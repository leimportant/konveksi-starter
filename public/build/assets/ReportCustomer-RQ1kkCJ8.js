import{d as I,r as b,Q as N,c as S,o as B,f as m,g as d,p as a,u as t,Z as F,x as s,k as i,D as O,y as r,j as u,F as T,B as R,E as L,z as U}from"./app-0U1VUouX.js";import{_ as x}from"./Input.vue_vue_type_script_setup_true_lang-DRddhaah.js";import{_ as j,a as E,b as V,c as p,d as M,e as f}from"./TableRow.vue_vue_type_script_setup_true_lang-C1Qc-8DG.js";import{_ as z}from"./AppLayout.vue_vue_type_script_setup_true_lang-BUoA2bSc.js";import{u as A}from"./useReportStore-DQ7jRDGm.js";import"./index-zcIcvFws.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-Adv47xyj.js";const Q={class:"space-y-4 p-4"},q={class:"flex flex-col gap-3 sm:flex-row sm:items-center"},H={key:0},K={key:1,class:"text-red-500"},Y={key:2,class:"text-gray-500"},Z={key:3,class:"overflow-auto"},G={class:"mt-4 flex justify-end space-x-2"},J=["disabled"],W={class:"py-1"},X=["disabled"],ue=I({__name:"ReportCustomer",setup(h){const o=A(),_=b(""),g=b(""),c=b(""),y=N().props.auth.user,$=y==null?void 0:y.id,C=S(()=>o.currentPage),P=S(()=>o.perPage),v=async(n=1,e=10)=>{const l=$||0;await o.fetchOmsetPerCustomer(l,c.value,_.value,g.value,n,e)},k=n=>{o.currentPage=n,v(n,P.value)},w=n=>{const e=parseFloat(n);return isNaN(e)?"Rp0,00":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:2}).format(e)};return B(()=>{const n=new Date,e=new Date(n.getFullYear(),n.getMonth(),1);_.value=e.toISOString().split("T")[0],g.value=n.toISOString().split("T")[0],v(C.value,P.value)}),(n,e)=>(d(),m(T,null,[a(t(F),{title:"Laporan Pembelian"}),a(z,null,{header:s(()=>e[6]||(e[6]=[i("h2",{class:"text-lg font-semibold text-gray-800"},"Laporan Pembelian",-1)])),default:s(()=>[i("div",Q,[i("div",q,[a(t(x),{type:"date",modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=l=>_.value=l),class:"w-full sm:w-auto"},null,8,["modelValue"]),a(t(x),{type:"date",modelValue:g.value,"onUpdate:modelValue":e[1]||(e[1]=l=>g.value=l),class:"w-full sm:w-auto"},null,8,["modelValue"]),a(t(x),{type:"text",modelValue:c.value,"onUpdate:modelValue":e[2]||(e[2]=l=>c.value=l),placeholder:"Cari produk...",class:"flex-1"},null,8,["modelValue"]),a(t(O),{onClick:e[3]||(e[3]=l=>v(1,10)),class:"bg-indigo-600 text-white transition hover:bg-indigo-700"},{default:s(()=>e[7]||(e[7]=[r(" Tampilkan ")])),_:1,__:[7]})]),t(o).loading?(d(),m("div",H,"Loading...")):t(o).error?(d(),m("div",K,"Error: "+u(t(o).error.message),1)):t(o).omsetSummaryPerCustomer.length===0?(d(),m("div",Y,"Tidak ada data ditampilkan.")):(d(),m("div",Z,[a(t(j),null,{default:s(()=>[a(t(E),null,{default:s(()=>[a(t(V),{class:"bg-gray-100 text-sm font-bold"},{default:s(()=>[a(t(p),null,{default:s(()=>e[8]||(e[8]=[r("Tanggal")])),_:1,__:[8]}),a(t(p),null,{default:s(()=>e[9]||(e[9]=[r("Produk ID")])),_:1,__:[9]}),a(t(p),null,{default:s(()=>e[10]||(e[10]=[r("Produk")])),_:1,__:[10]}),a(t(p),null,{default:s(()=>e[11]||(e[11]=[r("Qty")])),_:1,__:[11]}),a(t(p),null,{default:s(()=>e[12]||(e[12]=[r("Harga")])),_:1,__:[12]}),a(t(p),null,{default:s(()=>e[13]||(e[13]=[r("Total")])),_:1,__:[13]})]),_:1})]),_:1}),a(t(M),null,{default:s(()=>[(d(!0),m(T,null,R(t(o).omsetSummaryPerCustomer,(l,D)=>(d(),L(t(V),{key:D,class:U(["text-sm",l.product==="SUBTOTAL"||l.product==="TOTAL"?"bg-green-100 font-semibold":""].join(" "))},{default:s(()=>[a(t(f),null,{default:s(()=>[r(u(l.tanggal||""),1)]),_:2},1024),a(t(f),null,{default:s(()=>[r(u(l.product_id||""),1)]),_:2},1024),a(t(f),null,{default:s(()=>[r(u(l.product||""),1)]),_:2},1024),a(t(f),null,{default:s(()=>[r(u(l.qty||""),1)]),_:2},1024),a(t(f),null,{default:s(()=>[r(u(l.price?w(l.price.toString()):""),1)]),_:2},1024),a(t(f),null,{default:s(()=>[r(u(l.total?w(l.total.toString()):""),1)]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})]),_:1}),i("div",G,[i("button",{onClick:e[4]||(e[4]=l=>k(t(o).currentPage-1)),disabled:t(o).currentPage<=1,class:"rounded border bg-gray-100 px-3 py-1 hover:bg-gray-200 disabled:opacity-50"}," Previous ",8,J),i("span",W,"Page "+u(t(o).currentPage)+" of "+u(t(o).lastPage),1),i("button",{onClick:e[5]||(e[5]=l=>k(t(o).currentPage+1)),disabled:t(o).currentPage>=t(o).lastPage,class:"rounded border bg-gray-100 px-3 py-1 hover:bg-gray-200 disabled:opacity-50"}," Next ",8,X)])]))])]),_:1})],64))}});export{ue as default};
