import{d as De,q as Qe,T as Ut,o as Ze,f as d,g as u,k as t,l as D,C,m as I,u as l,j as i,U as Se,F as N,B as K,N as Mt,r as p,c as H,p as n,G as Xe,D as P,x as r,y as m,M as ie,Q as It,w as Te,Z as Vt,E as je,z as Ge,b as ae,n as Bt,_ as Rt}from"./app-B8MH_BKJ.js";import{_ as Lt}from"./Input.vue_vue_type_script_setup_true_lang-TmjqPyNx.js";import{_ as He,a as We,b as me,c as O,d as Je,e as M}from"./TableRow.vue_vue_type_script_setup_true_lang-D2qKlrpR.js";import{u as Ae}from"./useToast-hRwd_jMa.js";import{_ as Ot}from"./AppLayout.vue_vue_type_script_setup_true_lang-CYZORenQ.js";import{A as Kt}from"./vue3-select-CDUdqJhK.js";import{U as Et,_ as Ft}from"./vue-qrcode-reader-DNL-R4xH.js";import{u as et}from"./useProductStore-Cs1SrElz.js";import{u as Qt}from"./useCategoryStore-DP2OqDsi.js";import{u as Gt}from"./useSizeStore-B3Beuzpk.js";import{S as Ht}from"./shopping-bag-C-4Xecbw.js";import{u as Wt}from"./useCurrencyInput-BocOKZFJ.js";import{P as Jt}from"./plus-BBcfUCe7.js";import{P as Yt,S as Zt,U as Xt,R as es}from"./user-plus-D44JCuOG.js";import{P as ts}from"./printer-check-DEuKCwQL.js";import{T as Ye}from"./trash-2-27PZufTP.js";import"./index-CoQIryJP.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-C3y0p-PW.js";const ss={class:"p-4 bg-white rounded-lg shadow-md"},as={class:"mb-3"},ls={key:0,class:"mt-1 text-sm text-red-600"},ns={class:"mb-3"},os=["value"],is={key:0,class:"mt-1 text-sm text-red-600"},rs={class:"mb-4 mt-6 border-t pt-4"},us={class:"mb-4 rounded-md bg-gray-50 p-3 shadow-sm"},ds={class:"grid grid-cols-1 gap-3 md:grid-cols-2 lg:grid-cols-3"},cs=["value"],ps={key:0,class:"mt-1 text-sm text-red-600"},vs={key:0,class:"mt-1 text-sm text-red-600"},fs={key:0,class:"mt-1 text-sm text-red-600"},ms={key:0,class:"mt-1 text-sm text-red-600"},gs={key:0,class:"mt-1 text-sm text-red-600"},_s={class:"flex justify-end mt-6"},ys=["disabled"],tt=De({__name:"AddProductUnlisted",setup(Ne){const Y=et(),E=Ae(),Z=Qt(),W=Gt(),{items:k}=Qe(Z),{sizes:V}=Qe(W),g=Ut({name:"",category_id:"",size_id:null,variant:"",qty:1,price_store:0,price_grosir:0}),w=async()=>{try{await Y.saveProductUnlisted(g.data()),E.success("Produk custom berhasil disimpan!"),g.reset()}catch(j){E.error(j.message||"Gagal menyimpan produk custom.")}};return Ze(async()=>{await Z.fetchCategories(),await W.fetchSizes()}),(j,c)=>(u(),d("div",ss,[c[17]||(c[17]=t("h3",{class:"text-lg font-semibold mb-4"},"Tambah Produk Custom",-1)),t("form",{onSubmit:Mt(w,["prevent"])},[t("div",as,[c[7]||(c[7]=t("label",{for:"name",class:"block text-sm font-medium text-gray-700"},"Nama Produk",-1)),D(t("input",{type:"text",id:"name","onUpdate:modelValue":c[0]||(c[0]=b=>l(g).name=b),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:""},null,512),[[I,l(g).name]]),l(g).errors.name?(u(),d("p",ls,i(l(g).errors.name),1)):C("",!0)]),t("div",ns,[c[9]||(c[9]=t("label",{for:"category_id",class:"block text-sm font-medium text-gray-700"},"Category",-1)),D(t("select",{id:"category_id","onUpdate:modelValue":c[1]||(c[1]=b=>l(g).category_id=b),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:""},[c[8]||(c[8]=t("option",{value:"",disabled:""},"Pilih Kategori",-1)),(u(!0),d(N,null,K(l(k),b=>(u(),d("option",{key:b.id,value:b.id},i(b.name),9,os))),128))],512),[[Se,l(g).category_id]]),l(g).errors.category_id?(u(),d("p",is,i(l(g).errors.category_id),1)):C("",!0)]),t("div",rs,[c[16]||(c[16]=t("h4",{class:"text-md font-semibold mb-3"},"Detail Produk (Ukuran & Harga)",-1)),t("div",us,[t("div",ds,[t("div",null,[c[11]||(c[11]=t("label",{for:"size_id",class:"block text-sm font-medium text-gray-700"},"Size",-1)),D(t("select",{id:"size_id","onUpdate:modelValue":c[2]||(c[2]=b=>l(g).size_id=b),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:""},[c[10]||(c[10]=t("option",{value:"",disabled:""},"Pilih Ukuran",-1)),(u(!0),d(N,null,K(l(V),b=>(u(),d("option",{key:b.id,value:b.id},i(b.name),9,cs))),128))],512),[[Se,l(g).size_id]]),l(g).errors.size_id?(u(),d("p",ps,i(l(g).errors.size_id),1)):C("",!0)]),t("div",null,[c[12]||(c[12]=t("label",{for:"variant",class:"block text-sm font-medium text-gray-700"},"Variant",-1)),D(t("input",{type:"text",id:"variant","onUpdate:modelValue":c[3]||(c[3]=b=>l(g).variant=b),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:""},null,512),[[I,l(g).variant]]),l(g).errors.variant?(u(),d("p",vs,i(l(g).errors.variant),1)):C("",!0)]),t("div",null,[c[13]||(c[13]=t("label",{for:"qty",class:"block text-sm font-medium text-gray-700"},"Quantity",-1)),D(t("input",{type:"number",id:"qty","onUpdate:modelValue":c[4]||(c[4]=b=>l(g).qty=b),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:""},null,512),[[I,l(g).qty,void 0,{number:!0}]]),l(g).errors.qty?(u(),d("p",fs,i(l(g).errors.qty),1)):C("",!0)]),t("div",null,[c[14]||(c[14]=t("label",{for:"price_store",class:"block text-sm font-medium text-gray-700"},"Harga Toko",-1)),D(t("input",{type:"number",id:"price_store","onUpdate:modelValue":c[5]||(c[5]=b=>l(g).price_store=b),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:""},null,512),[[I,l(g).price_store,void 0,{number:!0}]]),l(g).errors.price_store?(u(),d("p",ms,i(l(g).errors.price_store),1)):C("",!0)]),t("div",null,[c[15]||(c[15]=t("label",{for:"price_grosir",class:"block text-sm font-medium text-gray-700"},"Harga Grosir",-1)),D(t("input",{type:"number",id:"price_grosir","onUpdate:modelValue":c[6]||(c[6]=b=>l(g).price_grosir=b),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:""},null,512),[[I,l(g).price_grosir,void 0,{number:!0}]]),l(g).errors.price_grosir?(u(),d("p",gs,i(l(g).errors.price_grosir),1)):C("",!0)])])])]),t("div",_s,[t("button",{type:"submit",class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",disabled:l(g).processing},i(l(g).processing?"Saving...":"Simpan Produk"),9,ys)])],32)]))}}),xs={class:"p-6 bg-white rounded-xl shadow-md border border-gray-200"},bs={class:"mb-4 flex flex-col sm:flex-row justify-between items-center gap-3"},hs={key:0,class:"py-8 text-center text-purple-600 text-lg font-medium"},ks={key:1,class:"py-8 text-center text-gray-500"},ws={key:2,class:"overflow-x-auto rounded-lg border border-gray-200"},$s={class:"min-w-full divide-y divide-gray-200"},Cs={class:"bg-white divide-y divide-gray-200"},qs={class:"px-4 py-4 align-top"},zs={class:"border-b border-gray-100 hover:bg-gray-50 dark:border-gray-700 dark:hover:bg-gray-800"},Ps={class:"flex flex-col gap-3 w-full text-sm bg-gradient-to-br from-gray-50 to-purple-50 rounded-xl p-4 border border-gray-200 shadow-sm backdrop-blur-sm"},Ts={class:"flex justify-between items-center"},js={class:"font-semibold text-gray-900"},Ss={class:"flex justify-between items-center"},Ds={class:"font-semibold"},As={class:"flex justify-between items-center font-sm"},Ns={class:"font-sm"},Us={class:"flex justify-between items-center font-xs"},Ms={class:"font-bold text-purple-700"},Is={class:"px-4 py-4 text-right align-top"},Vs={class:"mt-6 flex items-center justify-between"},Bs={class:"text-sm text-gray-600"},Rs={class:"flex items-center gap-2"},Ls=De({__name:"ListProductUnlisted",emits:["add-unlisted-to-cart"],setup(Ne,{emit:Y}){const E=Ae(),Z=et(),W=Y,k=p([]),V=p(!1),g=p(""),w=p(!1),j=p({current_page:1,per_page:50,total:0}),c=H(()=>Math.ceil(j.value.total/j.value.per_page)),b=async(F=1)=>{V.value=!0;try{const _=await Z.fetchProductUnlisted(F,j.value.per_page,g.value);k.value=_.data.map(h=>({...h,category:{name:h.category_name},size:{name:h.size_id}})),j.value.current_page=_.current_page,j.value.per_page=_.per_page,j.value.total=_.total}catch(_){console.log(_),E.error("Failed to fetch unlisted products.")}finally{V.value=!1}},ge=F=>{F>=1&&F<=c.value&&b(F)},ce=F=>{W("add-unlisted-to-cart",{...F,is_unlisted:!0})},_e=()=>{w.value=!1,b(j.value.current_page),E.success("Produk tanpa master berhasil ditambahkan.")};return Ze(()=>b()),(F,_)=>(u(),d("div",xs,[_[12]||(_[12]=t("h3",{class:"text-xl font-semibold mb-4 text-gray-800"},"Daftar Produk Tanpa Master",-1)),t("div",bs,[D(t("input",{"onUpdate:modelValue":_[0]||(_[0]=h=>g.value=h),type:"text",placeholder:"Cari produk...",class:"w-full sm:w-64 rounded-lg border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500",onKeyup:_[1]||(_[1]=Xe(h=>b(),["enter"]))},null,544),[[I,g.value]]),n(l(P),{onClick:_[2]||(_[2]=h=>w.value=!0),class:"w-full sm:w-auto flex items-center gap-2 bg-purple-600 text-white hover:bg-purple-700 transition rounded-md"},{default:r(()=>_[6]||(_[6]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),m(" Tambah Produk Baru ")])),_:1,__:[6]})]),V.value?(u(),d("div",hs," Loading products... ")):k.value.length?(u(),d("div",ws,[t("table",$s,[_[8]||(_[8]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-3 py-2"},"Produk"),t("th",{class:"px-3 py-2"},"Detail"),t("th",{class:"px-3 py-2"})])],-1)),t("tbody",Cs,[(u(!0),d(N,null,K(k.value,h=>{var X;return u(),d("tr",{key:h.id,class:"hover:bg-gray-50 transition"},[t("td",qs,i(h.name),1),t("td",zs,[t("div",Ps,[t("div",Ts,[t("span",js,i(((X=h.category)==null?void 0:X.name)||"-"),1)]),t("div",Ss,[t("span",Ds,i(h.variant||"-")+" - "+i(h.size_id),1)]),t("div",As,[t("span",Ns," Harga Toko "+i(Number(h.price_store).toLocaleString()),1)]),t("div",Us,[_[7]||(_[7]=m(" Harga Grosir ")),t("span",Ms,i(Number(h.price_grosir).toLocaleString()),1)])])]),t("td",Is,[n(l(P),{onClick:$=>ce(h),size:"sm",class:"bg-green-600 hover:bg-green-700 text-white rounded-md shadow-sm px-3 py-1 text-xs"},{default:r(()=>[n(l(Ht),{class:"h-4 w-4"})]),_:2},1032,["onClick"])])])}),128))])])])):(u(),d("div",ks," Tidak ada produk tanpa master ditemukan. ")),t("div",Vs,[t("span",Bs," Page "+i(j.value.current_page)+" dari "+i(c.value),1),t("div",Rs,[n(l(P),{onClick:_[3]||(_[3]=h=>ge(j.value.current_page-1)),disabled:j.value.current_page===1||V.value,variant:"outline",class:"px-4 py-2 border border-gray-300 text-sm text-gray-700 disabled:opacity-50"},{default:r(()=>_[9]||(_[9]=[m(" Previous ")])),_:1,__:[9]},8,["disabled"]),n(l(P),{onClick:_[4]||(_[4]=h=>ge(j.value.current_page+1)),disabled:j.value.current_page>=c.value||V.value,variant:"outline",class:"px-4 py-2 border border-gray-300 text-sm text-gray-700 disabled:opacity-50"},{default:r(()=>_[10]||(_[10]=[m(" Next ")])),_:1,__:[10]},8,["disabled"])])]),n(ie,{show:w.value,onClose:_[5]||(_[5]=h=>w.value=!1)},{header:r(()=>_[11]||(_[11]=[t("h3",{class:"text-lg font-medium text-gray-900"},"Tambah Produk Tanpa Master",-1)])),default:r(()=>[n(tt,{onProductSaved:_e})]),_:1},8,["show"])]))}}),Os={class:"min-h-screen space-y-4 bg-gray-50 p-2 md:p-4"},Ks={class:"grid grid-cols-1 gap-3 md:grid-cols-5 md:gap-2"},Es={class:"flex flex-col md:col-span-2 lg:col-span-2"},Fs={class:"mb-2 flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between"},Qs={class:"flex flex-col gap-2 md:gap-3"},Gs=["onClick"],Hs={class:"flex-shrink-0"},Ws=["src"],Js={key:1,class:"flex h-16 w-16 select-none items-center justify-center rounded bg-gray-200 text-xs text-gray-400"},Ys={class:"flex min-w-0 flex-1 flex-col justify-between"},Zs={class:"flex items-center gap-2"},Xs={class:"flex-1 truncate text-xs font-semibold text-gray-900 md:text-sm"},ea={key:0,class:"ml-1 rounded bg-orange-500 px-2 py-0.5 text-[14px] font-bold text-white md:text-xs"},ta={class:"text-[10px] text-gray-400 md:text-xs"},sa={key:0,class:"mt-2"},aa={class:"mt-1 flex flex-wrap gap-2"},la={class:"text-[10px] text-gray-400 line-through md:text-xs"},na={class:"text-xs font-semibold text-green-600 md:text-sm"},oa={class:"text-[10px] text-green-500 md:text-xs"},ia={key:1,class:"text-xs font-semibold text-gray-700 md:text-sm"},ra={class:"flex flex-col bg-gray-100 md:col-span-2 lg:col-span-3"},ua={class:"flex flex-wrap gap-1 p-2 md:gap-1"},da={key:0,class:"select-none py-8 text-center text-xs text-gray-400"},ca={class:"overflow-auto p-2"},pa={class:"md-grid-cols-2 relative flex grid-cols-1 items-center justify-center"},va=["checked","onChange"],fa={class:"max-w-[140px] truncate font-semibold text-gray-900"},ma={class:"max-w-[140px] truncate font-semibold text-gray-900"},ga={key:0,class:"text-[10px] text-gray-400 line-through"},_a={class:"block font-semibold text-gray-900"},ya={class:"text-[11px] text-gray-600"},xa={key:1,class:"text-[11px] text-green-600"},ba=["max","onUpdate:modelValue"],ha={key:1,class:"mt-4 flex flex-col items-start gap-2 rounded-xl bg-gray-100 p-4 shadow-sm sm:flex-row sm:items-center sm:justify-between"},ka={class:"text-xs text-gray-800"},wa={class:"text-xs text-gray-600"},$a={class:"text-xs text-gray-800"},Ca={class:"mt-2 gap-4 rounded-lg p-1 p-4 shadow-sm"},qa=["value"],za={class:"mt-4 gap-4 border-t p-4 pt-2"},Pa={class:"mb-2 flex justify-between text-xs font-semibold text-gray-700"},Ta={class:"font-bold"},ja={key:0},Sa={key:1},Da={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 p-4"},Aa={class:"w-full max-w-xs rounded-xl bg-white p-6 shadow-lg"},Na={class:"flex justify-end gap-3"},Ua={key:1,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 p-4"},Ma={class:"w-full max-w-sm rounded-lg bg-white p-6 shadow-lg"},Ia={class:"mb-4 flex justify-between"},Va={class:"font-semibold"},Ba={class:"mb-4 flex justify-between"},Ra={class:"font-semibold text-green-600"},La={class:"flex justify-end space-x-3"},Oa={class:"h-64 w-full"},Ka={key:0,class:"space-y-4"},Ea={class:"flex items-center gap-4"},Fa=["src"],Qa={key:1,class:"flex h-24 w-24 select-none items-center justify-center rounded bg-gray-200 text-xs text-gray-400"},Ga={class:"text-lg font-semibold"},Ha={class:"flex flex-wrap gap-2"},Wa=["onClick"],Ja=["onClick"],Ya={key:0,class:"mb-4"},Za={class:"flex flex-wrap gap-2"},Xa=["onClick"],el={class:"mb-4"},tl={key:0,class:"mb-4 text-sm text-gray-700"},sl={key:0,class:"mr-2 text-gray-400 line-through"},al={class:"font-bold"},ll={key:1,class:"text-xs text-green-600"},nl={class:"flex justify-end gap-2"},ol={class:"mb-4 flex flex-col items-stretch gap-2 sm:flex-row sm:items-center"},il={class:"max-h-[60vh] overflow-auto rounded-lg border border-gray-200 shadow-sm"},rl={class:"space-y-2"},ul={class:"mt-2 flex justify-end gap-2"},dl={key:0,class:"mt-1 text-xs text-red-600"},cl={key:1,class:"mt-1 text-xs text-red-600"},pl={key:2,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-30 p-4"},vl={class:"text-center"},fl={class:"text-[12px] font-bold"},ml={class:"mb-1"},gl={class:"font-bold"},_l={class:"flex justify-between p-1"},yl={key:0},xl={class:"flex justify-between"},bl={class:"text-green-600"},hl={class:"flex justify-between"},kl={class:"flex justify-between"},wl={class:"flex justify-between"},$l={class:"flex justify-between"},Cl={class:"flex justify-between"},ql={class:"no-print mt-2 flex justify-end gap-2"},zl=De({__name:"POS",setup(Ne){const Y=p(!1),E=p(!1),Z=p(!1),W=p(!1),k=Ae(),V=p([]),g=p([]),w=p([]),j=p([]),c=p(null),b=p({placingOrder:!1}),ge=Wt(0),ce=p(""),_e=p(1),F=p(1),_=p(0),h=p([]),X=p(!1),$=p(null);function st(s){$.value=s,G.value=null,A.value=null,$.value.variant==="all"&&$.value.sizes&&$.value.sizes.length>0&&(A.value=$.value.sizes[0].size_id),X.value=!0}const ye=p(!1),xe=p(!1),B=p(null),U=p(null),R=p([]),ee=p(0),re=p(""),ue=p(""),Q=p(""),we=p(null),at=p(null),$e=p(!1),Ce=p(!1),pe=p(""),ve=p([]),Ue=p(null),fe=p(null),de=p(1),le=p(0),te=p(""),be=p(!1),G=p(null),A=p(null);async function lt(){try{const s=await ae.get("/api/orders/search",{params:{search:pe.value}});ve.value=s.data.data}catch(s){console.error("Error searching transactions:",s),alert("Failed to search transactions.")}}async function nt(s){confirm("Yakin mau tampilkan struk untuk dicetak ulang?")&&(Ue.value=s,ue.value=Pe(s.created_at),Q.value=s.id,U.value=s.customer,R.value=s.order_items.map(e=>({product_id:e.product_id,product_name:e.product_name,quantity:Number(e.quantity),price:Number(e.price),discount:Number(e.discount),price_sell:Number(e.price_sell),variant:e.variant||"",uom_id:e.uom_id,size_id:e.size_id,qty_stock:e.qty_stock,image_path:e.image_path})),ee.value=s.total_amount,re.value=s.payment_method,S.value=s.paid_amount,ye.value=!0,Ie())}const S=p(null),Me=H(()=>S.value===null?0:S.value-L.value>0?S.value-L.value:0),ot=H(()=>{var e;if(!((e=$.value)!=null&&e.sizes))return[];const s=$.value.sizes.map(a=>a.variant);return[...new Set(s)]}),it=async s=>{if(s.length<2){V.value=[];return}try{const e=await ae.get("/api/product-with-size",{params:{search:s}});g.value=e.data.data}catch(e){console.error("Search error:",e),k.error("Failed to search products")}};function rt(s,e){return s?s.filter(a=>a.variant===e):[]}function ut(s,e){s&&(s.size_id=e.size_id,A.value=e.size_id),$.value&&($.value.price=e.price,$.value.price_sell=e.price_sell)}function dt(){$e.value=!0}function ct(){Ce.value=!0,ve.value=[],pe.value=""}const pt=H(()=>$.value?$.value.variant==="all"?$.value.sizes.map(s=>s):G.value?$.value.sizes.filter(s=>s.variant===G.value):[]:[]);function qe(){$e.value=!1,fe.value=null,de.value=1,le.value=0,te.value="",be.value=!1}function Ie(){Ce.value=!1,pe.value="",ve.value=[],Ue.value=null}async function vt(){if(te.value="",be.value=!1,!fe.value){te.value="Produk harus dipilih";return}const s=fe.value;if(!s||!s.id){te.value="Produk harus dipilih";return}if(!de.value||de.value<1){te.value="Qty minimal 1";return}if(!le.value||le.value<0){te.value="Harga retur harus diisi";return}w.value.push({id:s.id,product_id:s.id,product_name:s.product_name??"",size_id:s.size_id??"",uom_id:s.uom_id??"",qty_stock:0,qty_available:0,image_path:"",sizes:[],variant:null,quantity:-Math.abs(de.value),price:le.value,price_sell:le.value,isReturn:!0}),be.value=!0,setTimeout(()=>{qe()},1e3)}const ne=p("TOKO ANINKA"),oe=p("Blok A lantai SLG Los F No 91-92"),he=It().props.auth.user,ft=he==null?void 0:he.location_id;async function mt(){if(ft)try{const s=await ae.get("/api/locations/get");ne.value=s.data.name||"TOKO ANINKA",oe.value=s.data.address||"Blok A lantai SLG Los F No 91-92"}catch{ne.value="TOKO ANINKA",oe.value="Blok A lantai SLG Los F No 91-92"}}mt();const gt=H(()=>R.value.reduce((s,e)=>s+(e.discount??0)*e.quantity,0)),_t=H(()=>R.value.reduce((s,e)=>s+e.price*e.quantity,0)),ke=p(!1),ze=H(()=>he.name??"Kasir"),Ve=s=>s?s.startsWith("storage/")?"/"+s:s.startsWith("/storage/")?s:"/storage/"+s:"",y=s=>typeof s!="number"||isNaN(s)?"0,00":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s),yt=s=>{const e=h.value.indexOf(s);e===-1?h.value.push(s):h.value.splice(e,1)},se=H(()=>!A.value||!$.value?null:$.value.variant==="all"?$.value.sizes.find(s=>s.size_id===A.value):G.value?$.value.sizes.find(s=>s.variant===G.value&&s.size_id===A.value):null);async function Be(){try{const s=await ae.get(`/api/stock?page=${_e.value}&search=${ce.value}`);V.value=s.data.data,F.value=s.data.last_page}catch(s){console.error("Error fetching products:",s),k.error("Failed to fetch products")}}async function xt(){try{const s=await ae.get("/api/payment-methods");j.value=s.data.data}catch{k.error("Failed to fetch payment methods")}}function bt(){_e.value=1,Be()}const Re=s=>{if(!s.is_unlisted&&s.qty_stock<=0){k.error("Stok tidak cukup");return}if(s.price<=0&&(!s.price_sell||s.price_sell<=0)){k.error("Harga produk belum ditentukan");return}let e;if(s.sizes&&s.sizes.length>0){if(!A.value){k.error("Silahkan pilih ukuran terlebih dahulu");return}if(e=s.sizes.find(o=>o.size_id===A.value&&(G.value===null||o.variant===G.value)),!s.is_unlisted&&(!e||e.qty_stock<=0)){k.error("Stok ukuran ini tidak tersedia");return}}const a=1,f=e==null?void 0:e.price_retail,v=e==null?void 0:e.price_sell_retail,T=e==null?void 0:e.discount_retail;if(s.sizes.length&&!e){k.error("Ukuran tidak valid.");return}const x={id:s.product_id||s.id,product_id:s.product_id||s.id,product_name:s.product_name,uom_id:s.uom_id,size_id:(e==null?void 0:e.size_id)??"",qty_stock:(e==null?void 0:e.qty_stock)??s.qty_stock,qty_available:((e==null?void 0:e.qty_stock)??s.qty_stock)-a,image_path:s.image_path??"",price:f??s.price,price_sell:v??s.price_sell??s.price,discount:T??s.discount??0,quantity:a,variant:(e==null?void 0:e.variant)??s.variant??null,sizes:e?[{...e,qty_in_cart:a,qty_available:e.qty_stock-a}]:[],is_unlisted:s.is_unlisted||!1},q=w.value.find(o=>o.id===x.id&&o.size_id===x.size_id&&o.variant===x.variant);if(q){q.quantity+=a;const o=q.quantity>1;e&&(q.price=e[o?"price_grosir":"price_retail"]??q.price,q.price_sell=e[o?"price_sell_grosir":"price_sell_retail"]??q.price_sell,q.discount=e[o?"discount_grosir":"discount_retail"]??q.discount)}else w.value.push(x);X.value=!1,Bt(()=>{we.value&&(we.value.scrollTop=we.value.scrollHeight)})};function ht(s){w.value=w.value.filter(e=>e.id!==s)}function kt(){w.value.length!==0&&(Y.value=!0)}function wt(){w.value=w.value.map(s=>h.value.includes(s.id+s.size_id)?{...s,discount:_.value,price_sell:s.price-_.value}:s),h.value=[],Y.value=!1,k.success("Discount applied successfully")}function $t(s){const e={id:s.id,product_id:s.id,product_name:s.name,uom_id:s.uom_id||"PCS",size_id:s.size_id,qty_stock:s.qty||1,qty_available:s.qty||1,image_path:s.image_path||"",price:s.price_store,price_sell:s.price_store,discount:0,variant:s.variant,is_unlisted:!0,sizes:[{size_id:s.size_id,variant:s.variant,qty_stock:s.qty||1,qty_in_cart:0,qty_available:s.qty||1,price:s.price_store,price_sell:s.price_store,discount:0,price_retail:s.price_store,discount_retail:0,price_sell_retail:s.price_store,price_grosir:s.price_grosir,discount_grosir:0,price_sell_grosir:s.price_grosir}]};A.value=e.size_id,Re(e),W.value=!1,A.value=null}function Ct(){if(w.value.length===0){k.error("Please add items to the cart");return}if(!c.value){k.error("Please select a payment method");return}S.value=null,ke.value=!0}async function Le(){if(j.value.length===0){k.error("No payment methods available");return}const s=j.value.find(e=>e.id===c.value);if((!s||s.name!=="CREDIT")&&(S.value===null||S.value<L.value)){k.error("Paid amount must be at least total amount");return}ke.value=!1,await zt()}function Oe(){w.value=[],c.value=null,U.value="",Q.value="",h.value=[]}async function Ke(s=null){if(typeof s=="number"&&(B.value=s),typeof B.value=="number")try{const e=await ae.get(`/api/customers/get/${B.value}`);U.value=e.data.name,k.success(`Pelanggan ${U.value} berhasil ditambahkan.`)}catch(e){console.error("Error fetching customer details:",e),k.error("Gagal mengambil detail pelanggan."),B.value=null,U.value=null}else xe.value=!0}const qt=s=>{B.value=s.id,U.value=s.name,xe.value=!1},L=H(()=>w.value.reduce((s,e)=>s+e.price*e.quantity,0)),Ee=H(()=>`${y(L.value)}`);async function zt(){var s;if(w.value.length===0){k.error("Please add items to the cart");return}if(!c.value){k.error("Please select a payment method");return}b.value.placingOrder=!0;try{const e=w.value.map(v=>{const T=v.discount||0;return{product_id:v.product_id??v.id,product_name:v.product_name,quantity:v.quantity,price:v.price,uom_id:v.uom_id,size_id:v.size_id||null,qty_stock:0,image_path:"",discount:T,price_sell:v.price_sell??v.price-T,variant:v.variant||"all"}}),a={items:e,payment_method_id:c.value,total_amount:L.value,paid_amount:S.value,customer_id:B.value,transaction_number:Q.value||""},f=await ae.post("/api/pos/orders",a);R.value=e.map(v=>{var T;return{...v,uom_id:((T=w.value.find(x=>(x.product_id??x.id)===v.product_id))==null?void 0:T.uom_id)||""}}),ee.value=f.data.total_amount,re.value=((s=j.value.find(v=>v.id===c.value))==null?void 0:s.name)||"",ue.value=Pe(f.data.created_at),Q.value=f.data.transaction_number||"",B.value=null,ye.value=!0}catch(e){console.error("Error placing order:",e),k.error("Failed to place order")}finally{b.value.placingOrder=!1}}function Pt(){ye.value=!1,Oe(),c.value=null}const Tt=async s=>{var a;if(s.length===0)return;const e=s[0].rawValue;console.log("QR Code detected:",e),E.value=!1;try{const f=e.split(",").map(o=>o.trim()),T=(await ae.get("/api/orders/scan",{params:{ids:f.join(",")}})).data,x=[];if(T.length>0&&(B.value=T[0].customer_id,U.value=((a=T[0].customer)==null?void 0:a.name)||"Guest",Q.value=f.join(",")),T.forEach(o=>{var z;(z=o==null?void 0:o.order_items)!=null&&z.length&&x.push(...o.order_items)}),x.length===0){k.error("No order items found for the scanned QR code(s).");return}const q=x.map(o=>({id:o.product_id,product_id:o.product_id,product_name:o.product_name,uom_id:o.uom_id,size_id:o.size_id||"",qty_stock:o.qty_stock,image_path:o.image_path,price:o.price,price_sell:o.price_sell,discount:o.discount,quantity:o.quantity??1,variant:o.variant||"all",sizes:o.size_id?[{size_id:o.size_id,variant:o.variant||"all",qty_stock:o.qty_stock,qty_in_cart:o.quantity??1,qty_available:o.qty_stock,price:o.price,price_sell:o.price_sell,discount:o.discount,price_retail:o.price,price_sell_retail:o.price_sell,discount_retail:o.discount,price_grosir:o.price,price_sell_grosir:o.price_sell,discount_grosir:o.discount}]:[]}));console.log("Produk dalam pesanan:",q),q.forEach(o=>{const z=w.value.findIndex(J=>(J.product_id??J.id)===(o.product_id??o.id)&&J.size_id===o.size_id);z>-1?w.value[z].quantity+=o.quantity:w.value.push({...o})}),k.success("Order items added to cart!"),B.value&&Ke(B.value)}catch(f){console.error("Error scanning QR code:",f),k.error("Failed to scan QR code or retrieve order details.")}},Fe=new WeakMap;Te(w,s=>{s.forEach(e=>{Fe.has(e)||(Fe.set(e,!0),Te(()=>e.quantity,a=>{if(!e.sizes||e.sizes.length===0)return;const f=e.sizes[0],v=a>1;e.price=v?f.price_grosir:f.price_retail,e.price_sell=v?f.price_sell_grosir:f.price_sell_retail,e.discount=v?f.discount_grosir:f.discount_retail,f.qty_in_cart=a,f.qty_available=f.qty_stock-a}))})},{deep:!0}),Te(ge.internalValue,s=>{S.value=s});function jt(){const s=window.qz,e=ze.value;if(s){const x=R.value.reduce((z,J)=>z+J.quantity,0),q=(ee.value||L.value)-(S.value||0),o=[];o.push(`     ${ne.value}`),o.push(` ${oe.value}`),o.push("----------------------------------------"),o.push(`Kasir   : ${e}`),o.push(`Tanggal : ${ue.value}`),o.push(`Nomor   : ${Q.value}`),o.push("------------------------------------"),o.push(`Customer: ${U.value||"-"}`),o.push("--------------------------------------"),R.value.forEach(z=>{o.push(`${z.product_name}${z.size_id?" - "+z.size_id:""} ${z.variant?" "+z.variant:""}`),o.push(`${z.quantity} x ${y(z.price)}${" ".repeat(20-(z.quantity+"").length-y(z.price).length)}${y(z.quantity*z.price)}`)}),o.push("--------------------------------"),o.push(`Total QTY        ${x}`),o.push(`Total Bayar      ${y(ee.value||L.value)}`),o.push(`Jenis Bayar      ${re.value||"-"}`),o.push(`Bayar Cash       ${y(S.value||0)}`),o.push(`Sisa             ${y(q>0?q:0)}`),o.push("--------------------------------------"),o.push("      ---TERIMA KASIH---"),o.push("     aninkafashion.com"),o.push(`


`),s.websocket.connect().then(()=>s.printers.find()).then(z=>{const J=s.configs.create(z);return s.print(J,[{type:"raw",format:"plain",data:o.join(`
`)}])}).catch(z=>{alert("Print error: "+z)}).finally(()=>{s.websocket.disconnect()});return}const a=R.value.reduce((x,q)=>x+q.quantity,0),f=(ee.value||L.value)-(S.value||0),v=`
    <div style="font-family: 'Courier New', Courier, monospace; font-size: 12px; width: 80mm; padding: 0; margin: 0;">
      <div style="text-align:center; font-weight:bold;">${ne.value}</div>
      <div style="text-align:center;">${oe.value}</div>
      <div style="text-align:center;">----------------------------------------</div>
      <div style="display:flex; justify-content:space-between;">
        <span>Kasir   : ${e}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Tanggal : ${ue.value}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Nomor   : ${Q.value}</span>
      </div>
      <div style="text-align:center;">----------------------------------------</div>
      <div style="display:flex; justify-content:space-between;">
        <span>Customer</span>
        <span>${U.value||"-"}</span>
      </div>
      <div style="text-align:center;">----------------------------------------</div>
      ${R.value.map(x=>`
          <div>${x.product_name} - ${x.size_id} ${x.variant} </div>
          <div style="display:flex; justify-content:space-between;">
            <span>${x.quantity} x ${y(x.price)}</span>
            <span>${y(x.quantity*x.price)}</span>
          </div>
        `).join("")}
      <div style="text-align:center;">----------------------------------------</div>
      <div style="display:flex; justify-content:space-between;">
        <span>Total QTY</span>
        <span>${a}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Total Bayar</span>
        <span>${y(ee.value||L.value)}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Jenis Bayar</span>
        <span>${re.value||"-"}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Bayar Cash</span>
        <span>${y(S.value||0)}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Sisa</span>
        <span>${y(f>0?f:0)}</span>
      </div>
      <div style="text-align:center;">----------------------------------------</div>
      <div style="text-align:center; margin-top:8px;">---TERIMA KASIH---</div>
      <div style="text-align:center;">aninkafashion.com</div>
    </div>
  `,T=window.open("","","height=600,width=400");if(!T){alert("Please allow pop-ups for printing.");return}T.document.write(`
    <html>
      <head>
        <title>Print Struk</title>
        <style>
          @media print {
            body { margin: 0; }
            div { font-family: 'Courier New', Courier, monospace; font-size: 12px; }
          }
        </style>
      </head>
      <body>
        ${v}
        <script>
          window.onload = function() {
            setTimeout(function() {
              window.print();
              window.onafterprint = function() { window.close(); };
            }, 100);
          };
        <\/script>
      </body>
    </html>
  `),T.document.close()}function St(){const e="-".repeat(46),f=[ne.value.padStart(Math.floor((46+ne.value.length)/2)),oe.value.padStart(Math.floor((46+oe.value.length)/2)),e,`Kasir   : ${ze.value}`,`Tanggal : ${ue.value}`,`Nomor   : ${Q.value}`,e,`Customer: ${U.value||"-"}`,e,...R.value.flatMap(x=>{const q=x.product_name+" - "+x.size_id+(x.variant?" "+x.variant:""),o=`${x.quantity} x ${y(x.price)}`,z=y(x.quantity*x.price),J=o.padEnd(23),Nt=z.padStart(23);return[q.length>46?q.slice(0,46):q,`${J}${Nt}`]}),e,`Total QTY   : ${R.value.reduce((x,q)=>x+q.quantity,0)}`,`Total Bayar : ${y(ee.value||L.value)}`,`Jenis Bayar : ${re.value||"-"}`,`Bayar Cash  : ${y(S.value||0)}`,`Sisa        : ${y((ee.value||L.value)-(S.value||0))}`,e,"---TERIMA KASIH---".padStart(Math.floor(64/2)),"aninkafashion.com".padStart(Math.floor(65/2)),`


`].join(`
`),T=`intent://${encodeURIComponent(f).replace(/'/g,"%27").replace(/"/g,"%22")}#Intent;scheme=rawbt;package=ru.a402d.rawbtprinter;end;`;window.location.href=T}function Dt(){At()?St():jt()}function At(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}const Pe=s=>{if(!s)return"-";const e=new Date(s),f=new Intl.DateTimeFormat("id-ID",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"Asia/Jakarta"}).formatToParts(e),v=T=>{var x;return((x=f.find(q=>q.type===T))==null?void 0:x.value)||""};return`${v("day")}/${v("month")}/${v("year")} ${v("hour")}:${v("minute")} WIB`};return Be(),xt(),(s,e)=>(u(),d(N,null,[n(l(Vt),{title:"Point of Sale"}),n(Ot,null,{default:r(()=>[t("div",Os,[t("div",Ks,[t("section",Es,[t("div",Fs,[e[24]||(e[24]=t("h2",{class:"text-sm font-semibold text-gray-800"},"Produk Tersedia",-1)),D(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=a=>ce.value=a),onInput:bt,placeholder:"Cari produk...",class:"focus:ring-primary-500 w-full max-w-xs rounded-md border border-gray-300 px-2 py-1 text-xs focus:outline-none focus:ring-2 md:text-sm"},null,544),[[I,ce.value]]),n(l(P),{onClick:e[1]||(e[1]=a=>W.value=!0),class:"flex items-center justify-center rounded-md bg-purple-600 p-2 text-white hover:bg-purple-700",title:"Tambah Produk"},{default:r(()=>[n(l(Jt),{class:"h-4 w-4"}),e[23]||(e[23]=m(" Tambah Produk "))]),_:1,__:[23]})]),t("div",Qs,[(u(!0),d(N,null,K(V.value,a=>(u(),d("div",{key:a.id,onClick:f=>st(a),class:"flex cursor-pointer flex-row items-center gap-2 rounded-lg border border-gray-200 bg-white p-2 shadow-sm transition hover:shadow-md md:gap-3 md:p-3"},[t("div",Hs,[a.image_path?(u(),d("img",{key:0,src:Ve(a.image_path),alt:"Gambar produk",class:"h-16 w-16 rounded object-cover"},null,8,Ws)):(u(),d("div",Js," Tidak Ada Gambar "))]),t("div",Ys,[t("div",Zs,[t("p",Xs,i(a.product_name),1),a.discount&&a.price?(u(),d(N,{key:0},[a.discount>0?(u(),d("span",ea,i(Math.round(a.discount/a.price*100))+"% ",1)):C("",!0)],64)):C("",!0)]),t("p",ta,"Stok: "+i(a.qty_available)+" / "+i(a.uom_id),1),a.variant?(u(),d("div",sa,[e[25]||(e[25]=t("p",{class:"text-xs text-gray-500"},"Tersedia Ukuran:",-1)),t("div",aa,[(u(!0),d(N,null,K(rt(a.sizes,a.variant),f=>(u(),d("div",{class:"rounded-full border px-3 py-1 text-xs font-medium",key:f.size_id},i(f.size_id),1))),128))])])):C("",!0),t("div",null,[a.discount&&a.discount>0?(u(),d(N,{key:0},[t("p",la,i(y(a.price)),1),t("p",na,i(y(a.price_sell??a.price-a.discount)),1),t("p",oa,"(Diskon "+i(y(a.discount))+")",1)],64)):(u(),d("p",ia,i(y(a.price)),1))])])],8,Gs))),128))])]),t("section",ra,[t("div",ua,[n(l(P),{variant:"outline",size:"sm",onClick:kt,disabled:h.value.length===0,class:"flex items-center gap-1 bg-indigo-100"},{default:r(()=>[n(l(Yt),{class:"h-4 w-4"}),m(" Disc ("+i(h.value.length)+") ",1)]),_:1},8,["disabled"]),n(l(P),{variant:"outline",size:"sm",onClick:e[2]||(e[2]=a=>E.value=!0),class:"flex items-center gap-1"},{default:r(()=>[n(l(Zt),{class:"h-4 w-4"}),e[26]||(e[26]=m(" QR "))]),_:1,__:[26]}),n(l(P),{variant:"outline",size:"sm",onClick:e[3]||(e[3]=()=>Ke()),class:"flex items-center gap-1"},{default:r(()=>[n(l(Xt),{class:"h-4 w-4"}),e[27]||(e[27]=m(" Cust "))]),_:1,__:[27]}),n(l(P),{variant:"outline",size:"sm",onClick:dt,class:"flex items-center gap-1"},{default:r(()=>[n(l(es),{class:"h-4 w-4"}),e[28]||(e[28]=m(" Retur "))]),_:1,__:[28]}),n(l(P),{variant:"outline",size:"sm",onClick:e[4]||(e[4]=a=>ct()),class:"flex items-center gap-1"},{default:r(()=>[n(l(ts),{class:"h-4 w-4"}),e[29]||(e[29]=m(" RePrint "))]),_:1,__:[29]}),n(l(P),{variant:"outline",size:"sm",onClick:Oe,class:"flex items-center gap-1"},{default:r(()=>[n(l(Ye),{class:"h-4 w-4"}),e[30]||(e[30]=m(" Clear "))]),_:1,__:[30]})]),w.value.length===0?(u(),d("div",da," Tidak ada item di keranjang ")):C("",!0),t("div",ca,[n(l(He),null,{default:r(()=>[n(l(We),null,{default:r(()=>[n(l(me),null,{default:r(()=>[n(l(O),{class:"text-xs"},{default:r(()=>e[31]||(e[31]=[m("#")])),_:1,__:[31]}),n(l(O),{class:"text-xs"},{default:r(()=>e[32]||(e[32]=[m("Nama")])),_:1,__:[32]}),n(l(O),{class:"text-center text-xs"},{default:r(()=>e[33]||(e[33]=[m("Qty")])),_:1,__:[33]}),n(l(O),{class:"text-center text-xs"},{default:r(()=>e[34]||(e[34]=[m("Total")])),_:1,__:[34]}),n(l(O),{class:"text-center text-xs"},{default:r(()=>e[35]||(e[35]=[m("Aksi")])),_:1,__:[35]})]),_:1})]),_:1}),n(l(Je),null,{default:r(()=>[(u(!0),d(N,null,K(w.value,a=>(u(),je(l(me),{key:a.id},{default:r(()=>[n(l(M),null,{default:r(()=>[t("div",pa,[t("input",{type:"checkbox",checked:h.value.includes(a.id+a.size_id),onChange:f=>yt(a.id+a.size_id),class:"text-primary-600 focus:ring-primary-500 absolute left-0 top-0 rounded border-gray-300",title:"Pilih untuk diskon"},null,40,va)])]),_:2},1024),n(l(M),{class:"text-xs"},{default:r(()=>[t("div",fa,i(a.product_name),1),t("div",ma,"Ukuran : "+i(a.size_id),1),a.discount&&a.discount>0?(u(),d("span",ga,i(y(a.price)),1)):C("",!0),t("span",_a,i(y(a.price_sell||a.price-(a.discount||0))),1),t("span",ya,"Variant: "+i(a.variant||""),1),a.discount&&a.discount>0?(u(),d("div",xa," Diskon: -"+i(y(a.discount)),1)):C("",!0)]),_:2},1024),n(l(M),{class:"text-center"},{default:r(()=>[D(t("input",{type:"number",min:"1",max:a.qty_available,"onUpdate:modelValue":f=>a.quantity=f,class:"w-12 rounded border px-1 py-0.5 text-center text-xs"},null,8,ba),[[I,a.quantity,void 0,{number:!0}]])]),_:2},1024),n(l(M),{class:"text-right text-xs font-semibold text-gray-900"},{default:r(()=>[m(i(y(a.quantity*(a.price_sell||a.price))),1)]),_:2},1024),n(l(M),{class:"text-center"},{default:r(()=>[n(l(P),{variant:"ghost",size:"icon",onClick:f=>ht(a.id),class:"hover:bg-gray-100"},{default:r(()=>[n(l(Ye),{class:"h-4 w-4"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),U.value?(u(),d("div",ha,[t("div",null,[e[36]||(e[36]=t("p",{class:"text-sm font-medium text-gray-500"},"Pelanggan",-1)),t("p",ka,[m(i(U.value)+" ",1),t("span",wa,"(#"+i(B.value)+")",1)])]),t("div",null,[e[37]||(e[37]=t("p",{class:"text-sm font-medium text-gray-500"},"Transaksi Online",-1)),t("p",$a,i(Q.value),1)])])):C("",!0),t("div",Ca,[e[39]||(e[39]=t("label",{class:"mb-1 block text-xs font-medium text-gray-900"},"Metode Pembayaran",-1)),D(t("select",{"onUpdate:modelValue":e[5]||(e[5]=a=>c.value=a),class:"focus:ring-primary-500 w-full rounded-lg border border-gray-300 p-1 text-xs focus:outline-none focus:ring-2"},[e[38]||(e[38]=t("option",{value:""},"Pilih metode pembayaran",-1)),(u(!0),d(N,null,K(j.value,a=>(u(),d("option",{key:a.id,value:a.id},i(a.name),9,qa))),128))],512),[[Se,c.value]])]),t("div",za,[t("div",Pa,[e[40]||(e[40]=t("span",null,"Total",-1)),t("span",Ta,i(Ee.value),1)]),n(l(P),{class:"w-full rounded-md bg-indigo-600 py-2 text-xs font-semibold text-white hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500",onClick:Ct,disabled:b.value.placingOrder},{default:r(()=>[b.value.placingOrder?(u(),d("span",ja,"Memproses...")):(u(),d("span",Sa,"Bayar"))]),_:1},8,["disabled"])])])]),Y.value?(u(),d("div",Da,[t("div",Aa,[e[41]||(e[41]=t("h3",{class:"mb-4 text-lg font-semibold"},"Set Discount",-1)),e[42]||(e[42]=t("label",{class:"mb-2 block text-sm font-medium"},"Discount Price",-1)),D(t("input",{type:"number","onUpdate:modelValue":e[6]||(e[6]=a=>_.value=a),class:"focus:ring-primary-500 mb-4 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2"},null,512),[[I,_.value,void 0,{number:!0}]]),t("div",Na,[t("button",{onClick:wt,class:"rounded bg-green-600 px-4 py-2 text-sm text-white hover:bg-green-700"},"Save"),t("button",{onClick:e[7]||(e[7]=a=>Y.value=!1),class:"rounded bg-gray-300 px-4 py-2 text-sm text-gray-700 hover:bg-gray-400"}," Cancel ")])])])):C("",!0),ke.value?(u(),d("div",Ua,[t("div",Ma,[e[47]||(e[47]=t("h3",{class:"mb-4 text-lg font-semibold"},"Masukkan Jumlah Bayar",-1)),D(t("input",{type:"number",min:"0","onUpdate:modelValue":e[8]||(e[8]=a=>S.value=a),onKeypress:Xe(Le,["enter"]),class:"mb-4 w-full rounded border px-3 py-2 text-lg",placeholder:"Masukkan jumlah bayar"},null,544),[[I,S.value,void 0,{number:!0}]]),t("div",Ia,[e[43]||(e[43]=t("div",null,"Total:",-1)),t("div",Va,i(Ee.value),1)]),t("div",Ba,[e[44]||(e[44]=t("div",null,"Kembalian:",-1)),t("div",Ra,i(y(Me.value)),1)]),t("div",La,[n(l(P),{variant:"outline",onClick:e[9]||(e[9]=a=>ke.value=!1)},{default:r(()=>e[45]||(e[45]=[m("Batal")])),_:1,__:[45]}),n(l(P),{onClick:Le,class:"rounded-md bg-indigo-600 py-2 text-white hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:r(()=>e[46]||(e[46]=[m("Konfirmasi")])),_:1,__:[46]})])])])):C("",!0),n(ie,{show:E.value,onClose:e[10]||(e[10]=a=>E.value=!1),title:"Scan QR Code"},{default:r(()=>[t("div",Oa,[n(l(Et),{onDetect:Tt})])]),_:1},8,["show"]),n(ie,{show:X.value,onClose:e[13]||(e[13]=a=>X.value=!1),title:"Detail Produk"},{default:r(()=>{var a,f;return[$.value?(u(),d("div",Ka,[t("div",Ea,[$.value.image_path?(u(),d("img",{key:0,src:Ve($.value.image_path),alt:"Gambar produk",class:"h-24 w-24 rounded object-cover"},null,8,Fa)):(u(),d("div",Qa," Tidak Ada Gambar ")),t("div",null,[t("h3",Ga,i($.value.product_name),1),e[49]||(e[49]=t("span",{class:"mb-1 text-sm font-semibold text-gray-700"},"Pilih Ukuran ",-1)),t("div",Ha,[e[48]||(e[48]=t("br",null,null,-1)),(u(!0),d(N,null,K(pt.value,v=>(u(),d("button",{key:v.size_id,onClick:T=>A.value=v.size_id,class:Ge(["rounded-full border px-3 py-1 text-sm font-semibold transition",A.value===v.size_id?"border-green-600 bg-green-600 text-white":"border-gray-300 bg-gray-200 text-gray-800 hover:bg-gray-300"])},[t("div",{onClick:T=>ut($.value,v)},i(v.size_id),9,Ja)],10,Wa))),128))])])]),((a=$.value)==null?void 0:a.variant)!=="all"?(u(),d("div",Ya,[e[50]||(e[50]=t("h4",{class:"mb-1 text-sm font-semibold text-gray-700"},"Variant",-1)),t("div",Za,[(u(!0),d(N,null,K(ot.value,v=>(u(),d("button",{key:v,onClick:()=>{G.value=v,A.value=null},class:Ge(["rounded-full border px-3 py-1 text-sm font-semibold transition",G.value===v?"border-indigo-600 bg-indigo-600 text-white":"border-gray-300 bg-gray-200 text-gray-800 hover:bg-gray-300"])},i(v),11,Xa))),128))])])):C("",!0),t("div",el,[se.value?(u(),d("div",tl,[t("p",null,[e[51]||(e[51]=m(" Stok: ")),t("strong",null,i(se.value.qty_available),1)]),(se.value.discount??0)>0?(u(),d("span",sl," Harga "+i(y(se.value.price)),1)):C("",!0),e[52]||(e[52]=t("br",null,null,-1)),t("span",al," Harga Diskon "+i(y(se.value.price_sell||se.value.price)),1),e[53]||(e[53]=t("br",null,null,-1)),(se.value.discount??0)>0?(u(),d("span",ll," (Diskon: "+i(y(se.value.discount??0))+") ",1)):C("",!0)])):C("",!0)]),t("div",nl,[n(l(P),{variant:"outline",onClick:e[11]||(e[11]=v=>X.value=!1)},{default:r(()=>e[54]||(e[54]=[m("Batal")])),_:1,__:[54]}),n(l(P),{onClick:e[12]||(e[12]=v=>Re($.value)),disabled:!A.value||!G.value&&((f=$.value)==null?void 0:f.variant)!=="all"},{default:r(()=>e[55]||(e[55]=[m("Tambah ke Keranjang")])),_:1,__:[55]},8,["disabled"])])])):C("",!0)]}),_:1},8,["show"]),n(ie,{show:Ce.value,onClose:Ie,title:"RePrint Struk"},{default:r(()=>[t("div",ol,[n(l(Lt),{modelValue:pe.value,"onUpdate:modelValue":e[14]||(e[14]=a=>pe.value=a),class:"w-full text-sm sm:w-64",placeholder:"Cari transaksi...","aria-label":"Search"},null,8,["modelValue"]),n(l(P),{onClick:e[15]||(e[15]=a=>lt()),class:"w-full px-4 py-2 text-sm sm:w-auto"},{default:r(()=>e[56]||(e[56]=[m(" Cari ")])),_:1,__:[56]})]),t("div",il,[n(l(He),{class:"min-w-full text-sm"},{default:r(()=>[n(l(We),null,{default:r(()=>[n(l(me),{class:"bg-gray-100 text-xs uppercase text-gray-600"},{default:r(()=>[n(l(O),{class:"whitespace-nowrap px-2 py-2"},{default:r(()=>e[57]||(e[57]=[m("Aksi")])),_:1,__:[57]}),n(l(O),{class:"whitespace-nowrap px-2 py-2"},{default:r(()=>e[58]||(e[58]=[m("Tanggal")])),_:1,__:[58]}),n(l(O),{class:"whitespace-nowrap px-2 py-2"},{default:r(()=>e[59]||(e[59]=[m("Customer")])),_:1,__:[59]}),n(l(O),{class:"whitespace-nowrap px-2 py-2"},{default:r(()=>e[60]||(e[60]=[m("Total")])),_:1,__:[60]}),n(l(O),{class:"whitespace-nowrap px-2 py-2"},{default:r(()=>e[61]||(e[61]=[m("Pembayaran")])),_:1,__:[61]}),n(l(O),{class:"whitespace-nowrap px-2 py-2"},{default:r(()=>e[62]||(e[62]=[m("Status")])),_:1,__:[62]})]),_:1})]),_:1}),n(l(Je),null,{default:r(()=>[(u(!0),d(N,null,K(ve.value,a=>(u(),je(l(me),{key:a.id,class:"cursor-pointer transition hover:bg-gray-50"},{default:r(()=>[n(l(M),{class:"px-2 py-1"},{default:r(()=>[n(l(P),{variant:"outline",size:"sm",onClick:f=>nt(a)},{default:r(()=>e[63]||(e[63]=[m(" Cetak ")])),_:2,__:[63]},1032,["onClick"])]),_:2},1024),n(l(M),{class:"px-2 py-1"},{default:r(()=>[m(i(Pe(a.created_at)),1)]),_:2},1024),n(l(M),{class:"px-2 py-1"},{default:r(()=>[m(i(a.customer),1)]),_:2},1024),n(l(M),{class:"px-2 py-1"},{default:r(()=>[m(i(y(Number(a.total_amount))),1)]),_:2},1024),n(l(M),{class:"px-2 py-1"},{default:r(()=>[m(i(a.payment_method),1)]),_:2},1024),n(l(M),{class:"px-2 py-1"},{default:r(()=>[m(i(a.status),1)]),_:2},1024)]),_:2},1024))),128)),ve.value.length===0?(u(),je(l(me),{key:0},{default:r(()=>[n(l(M),{colspan:"6",class:"py-3 text-center text-xs text-gray-400"},{default:r(()=>e[64]||(e[64]=[m(" Tidak ada transaksi ditemukan. ")])),_:1,__:[64]})]),_:1})):C("",!0)]),_:1})]),_:1})])]),_:1},8,["show"]),n(ie,{show:$e.value,onClose:qe,title:"Retur Barang"},{default:r(()=>[t("div",rl,[e[67]||(e[67]=t("label",{class:"block text-xs font-medium"},"Produk",-1)),n(l(Kt),{modelValue:fe.value,"onUpdate:modelValue":e[16]||(e[16]=a=>fe.value=a),options:g.value,label:"product_title",value:"id",onSearch:it,reduce:a=>({...a,name:a.product_name,product_name:a.product_name,size_id:a.size_id,uom_id:a.uom_id,qty_available:0}),placeholder:"Pilih Produk"},null,8,["modelValue","options","reduce"]),e[68]||(e[68]=t("label",{class:"block text-xs font-medium"},"Qty",-1)),D(t("input",{type:"number","onUpdate:modelValue":e[17]||(e[17]=a=>de.value=a),min:"1",class:"w-full rounded border p-1 text-xs"},null,512),[[I,de.value,void 0,{number:!0}]]),e[69]||(e[69]=t("label",{class:"block text-xs font-medium"},"Harga Retur",-1)),D(t("input",{type:"number","onUpdate:modelValue":e[18]||(e[18]=a=>le.value=a),min:"0",class:"w-full rounded border p-1 text-xs"},null,512),[[I,le.value,void 0,{number:!0}]]),t("div",ul,[n(l(P),{variant:"outline",onClick:qe},{default:r(()=>e[65]||(e[65]=[m("Batal")])),_:1,__:[65]}),n(l(P),{class:"bg-red-600 text-white",onClick:vt},{default:r(()=>e[66]||(e[66]=[m("Simpan")])),_:1,__:[66]})]),te.value?(u(),d("div",dl,i(te.value),1)):C("",!0),be.value?(u(),d("div",cl,"Retur berhasil ditambahkan ke keranjang!")):C("",!0)])]),_:1},8,["show"]),ye.value?(u(),d("div",pl,[t("div",{class:"print-area w-[450px] max-w-full rounded bg-white p-2 font-mono text-[10px] leading-tight shadow",ref_key:"printArea",ref:at},[t("div",vl,[t("p",fl,i(ne.value),1),t("p",null,i(oe.value),1)]),e[77]||(e[77]=t("hr",{class:"my-1 border-t border-dashed"},null,-1)),t("div",ml,[t("p",null,"Tanggal : "+i(ue.value),1),t("p",null,"Kasir     : "+i(ze.value),1),t("p",null,"Nomor     : "+i(Q.value),1),t("p",null,"Customer  : "+i(U.value||"-"),1)]),e[78]||(e[78]=t("hr",{class:"my-1 border-t border-dashed"},null,-1)),(u(!0),d(N,null,K(R.value,(a,f)=>(u(),d("div",{key:a.product_id,class:"mb-1"},[t("p",gl,i(f+1)+". "+i(a.product_name)+"   - "+i(a.size_id)+" "+i(a.variant),1),t("div",_l,[t("span",null,i(a.quantity)+" x "+i(y(a.price)),1),t("span",null,"  "+i(y(a.price*a.quantity)),1)]),Number(a.discount)>0?(u(),d("div",yl,[t("div",xl,[t("span",bl,"- "+i(y(a.discount)),1),t("span",null,i(y(a.price*a.quantity-a.discount)),1)])])):C("",!0)]))),128)),e[79]||(e[79]=t("hr",{class:"my-1 border-t border-dashed"},null,-1)),t("div",hl,[e[70]||(e[70]=t("span",null,"Sub Total    :",-1)),t("span",null,i(y(_t.value)),1)]),t("div",kl,[e[71]||(e[71]=t("span",null,"Jumlah Bayar :",-1)),t("span",null,i(y(S.value||0)),1)]),t("div",wl,[e[72]||(e[72]=t("span",null,"Kembalian    :",-1)),t("span",null,i(y(Me.value)),1)]),t("div",$l,[e[73]||(e[73]=t("span",null,"Total Disc   :",-1)),t("span",null,i(y(gt.value)),1)]),t("div",Cl,[e[74]||(e[74]=t("span",null,"Metode       :",-1)),t("span",null,i(re.value),1)]),e[80]||(e[80]=t("hr",{class:"my-1 border-t border-dashed"},null,-1)),e[81]||(e[81]=t("p",{class:"text-center"},"SELAMAT BERBELANJA",-1)),e[82]||(e[82]=t("hr",{class:"my-1 border-t border-dashed"},null,-1)),t("div",ql,[n(l(P),{variant:"outline",onClick:Pt},{default:r(()=>e[75]||(e[75]=[m("TUTUP")])),_:1,__:[75]}),n(l(P),{onClick:Dt,class:"rounded-md bg-indigo-600 py-2 text-white hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:r(()=>e[76]||(e[76]=[m("CETAK")])),_:1,__:[76]})])],512)])):C("",!0)]),n(Ft,{show:xe.value,"onUpdate:show":e[19]||(e[19]=a=>xe.value=a),onCustomerSelected:qt},null,8,["show"]),n(ie,{show:Z.value,onClose:e[21]||(e[21]=a=>Z.value=!1),title:"Tambah Produk Custom"},{default:r(()=>[n(tt,{onCancel:e[20]||(e[20]=a=>Z.value=!1)})]),_:1},8,["show"]),n(ie,{show:W.value,onClose:e[22]||(e[22]=a=>W.value=!1),title:"Daftar Produk Tanpa Master"},{default:r(()=>[n(Ls,{onAddUnlistedToCart:$t})]),_:1},8,["show"])]),_:1})],64))}}),Gl=Rt(zl,[["__scopeId","data-v-f74d39a6"]]);export{Gl as default};
