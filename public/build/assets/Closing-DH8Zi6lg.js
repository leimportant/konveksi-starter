import{r as b,w as v,d as N,Q as R,f as T,g as k,p,u as a,Z as D,x as F,k as r,K as U,l as q,m as K,D as B,y as I,F as M,P as O}from"./app-DiFJObDm.js";import{_ as c}from"./AppLayout.vue_vue_type_script_setup_true_lang-CUkq1tMm.js";import{_ as V}from"./Input.vue_vue_type_script_setup_true_lang-DHjRIqoe.js";import{u as j}from"./useCashBalanceStore-CmROIr4F.js";import{u as P}from"./useToast-D0aidzOw.js";import"./index-BotdtPMh.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CE4OZocD.js";function x($=0){const f=b($),s=b(""),g=t=>{if(t==null||t==="")return"";const n=typeof t=="string"?parseFloat(t.replace(/[^\d,-]/g,"").replace(/,/g,".")):t;return isNaN(n)?"":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(n)},y=t=>{const n=parseFloat(t.replace(/[^\d,-]/g,"").replace(/,/g,"."));return isNaN(n)?0:n};return s.value=g($),v(f,t=>{s.value=g(t)}),v(s,t=>{const n=y(t);n!==f.value&&(f.value=n)}),{internalValue:f,formattedValue:s,formatRupiah:g,parseRupiah:y}}const A={class:"w-full px-4 py-6"},E={class:"space-y-4"},G={class:"mt-6 flex justify-end gap-2"},X=N({__name:"Closing",setup($){const f=j(),s=P(),y=R().props.id,t=x(0),n=x(0),o=x(0),i=x(0),d=x(0),m=b({cash_sales_total:t.internalValue.value,cash_in:n.internalValue.value,cash_out:o.internalValue.value,closing_balance:i.internalValue.value,discrepancy:d.internalValue.value,notes:""});v(t.internalValue,l=>{m.value.cash_sales_total=l}),v(n.internalValue,l=>{m.value.cash_in=l}),v(o.internalValue,l=>{m.value.cash_out=l}),v(i.internalValue,l=>{m.value.closing_balance=l}),v(d.internalValue,l=>{m.value.discrepancy=l});const S=b(!1),w=async()=>{S.value=!0;try{await f.closing(y,m.value),s.success("Shift berhasil ditutup"),O.visit("/sales")}catch(l){if(l.response&&l.response.data&&l.response.data.errors)for(const e in l.response.data.errors)s.error(l.response.data.errors[e][0]);else l.response&&l.response.data&&l.response.data.message?s.error(l.response.data.message):(s.error("Gagal menutup shift"),console.error(l))}finally{S.value=!1}},C=[{title:"Close Shift",href:"/close-shift"}];return(l,e)=>(k(),T(M,null,[p(a(D),{title:"Tutup Shift Kasir"}),p(c,{breadcrumbs:C},{default:F(()=>[r("div",A,[r("form",{onSubmit:U(w,["prevent"])},[r("div",E,[r("div",null,[e[17]||(e[17]=r("label",{class:"text-[14px]"},"Total Penjualan Tunai",-1)),p(a(V),{modelValue:a(t).formattedValue.value,"onUpdate:modelValue":e[0]||(e[0]=u=>a(t).formattedValue.value=u),onBlur:e[1]||(e[1]=u=>a(t).formattedValue.value=a(t).formatRupiah(a(t).internalValue.value)),onFocus:e[2]||(e[2]=u=>a(t).formattedValue.value=a(t).internalValue.value.toString()),type:"text",required:""},null,8,["modelValue"])]),r("div",null,[e[18]||(e[18]=r("label",{class:"text-[14px]"},"Kas Masuk (Cash In)",-1)),p(a(V),{modelValue:a(n).formattedValue.value,"onUpdate:modelValue":e[3]||(e[3]=u=>a(n).formattedValue.value=u),onBlur:e[4]||(e[4]=u=>a(n).formattedValue.value=a(n).formatRupiah(a(n).internalValue.value)),onFocus:e[5]||(e[5]=u=>a(n).formattedValue.value=a(n).internalValue.value.toString()),type:"text",required:""},null,8,["modelValue"])]),r("div",null,[e[19]||(e[19]=r("label",{class:"text-[14px]"},"Kas Keluar (Cash Out)",-1)),p(a(V),{modelValue:a(o).formattedValue.value,"onUpdate:modelValue":e[6]||(e[6]=u=>a(o).formattedValue.value=u),onBlur:e[7]||(e[7]=u=>a(o).formattedValue.value=a(o).formatRupiah(a(o).internalValue.value)),onFocus:e[8]||(e[8]=u=>a(o).formattedValue.value=a(o).internalValue.value.toString()),type:"text",required:""},null,8,["modelValue"])]),r("div",null,[e[20]||(e[20]=r("label",{class:"text-[14px]"},"Saldo Akhir",-1)),p(a(V),{modelValue:a(i).formattedValue.value,"onUpdate:modelValue":e[9]||(e[9]=u=>a(i).formattedValue.value=u),onBlur:e[10]||(e[10]=u=>a(i).formattedValue.value=a(i).formatRupiah(a(i).internalValue.value)),onFocus:e[11]||(e[11]=u=>a(i).formattedValue.value=a(i).internalValue.value.toString()),type:"text",required:""},null,8,["modelValue"])]),r("div",null,[e[21]||(e[21]=r("label",{class:"text-[14px]"},"Selisih",-1)),p(a(V),{modelValue:a(d).formattedValue.value,"onUpdate:modelValue":e[12]||(e[12]=u=>a(d).formattedValue.value=u),onBlur:e[13]||(e[13]=u=>a(d).formattedValue.value=a(d).formatRupiah(a(d).internalValue.value)),onFocus:e[14]||(e[14]=u=>a(d).formattedValue.value=a(d).internalValue.value.toString()),type:"text",required:""},null,8,["modelValue"])]),r("div",null,[e[22]||(e[22]=r("label",{class:"text-[14px]"},"Catatan",-1)),q(r("textarea",{"onUpdate:modelValue":e[15]||(e[15]=u=>m.value.notes=u),class:"w-full border rounded px-3 py-2",rows:"3",placeholder:"Opsional"},null,512),[[K,m.value.notes]])])]),r("div",G,[p(a(B),{type:"submit",disabled:S.value},{default:F(()=>e[23]||(e[23]=[I("Tutup Shift")])),_:1,__:[23]},8,["disabled"]),p(a(B),{type:"button",variant:"outline",onClick:e[16]||(e[16]=u=>l.$inertia.visit("/cash-balances"))},{default:F(()=>e[24]||(e[24]=[I(" Batal ")])),_:1,__:[24]})])],32)])]),_:1})],64))}});export{X as default};
