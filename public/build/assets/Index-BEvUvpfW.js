import{d as U,q as G,r as A,aS as Q,o as Z,w as D,c as N,Q as H,f as c,g as n,p as o,u as s,Z as J,x as r,k as i,l as O,G as W,m as X,D as b,y,F as _,B as w,E as k,j as m,C as x,z as Y}from"./app-BVpg1Md5.js";import{_ as ee,a as te,b as z,c as $,d as se,e as S}from"./TableRow.vue_vue_type_script_setup_true_lang-MPqDoUPG.js";import{u as ae}from"./useToast-dc7ou10L.js";import{_ as oe}from"./AppLayout.vue_vue_type_script_setup_true_lang-BoGnX1If.js";import{u as le}from"./useTransferStockStore-CbueRp2K.js";import{d as re}from"./debounce-BcZQbp_F.js";import{A as ie}from"./vue3-select-DVgd-hQx.js";import{S as ne}from"./search-CltGoRiN.js";import{E as de}from"./eye-CzQklzm1.js";import{S as ce}from"./square-pen-CFraYpg6.js";import{T as ue}from"./trash-2-BcJJ14D2.js";import"./index-CwjgKOBI.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-Cs930JZ8.js";const me={class:"px-4 py-4"},pe={class:"mb-4 flex flex-col sm:flex-row items-center justify-between gap-3"},fe={class:"flex items-center gap-3 w-full sm:w-auto"},_e={class:"overflow-x-auto"},ge={class:"text-xs text-gray-500"},ye={key:0,class:"mt-1 space-y-1"},xe={class:"flex flex-col gap-0.5 rounded-lg border border-gray-200 bg-gray-50 p-1 text-[10px] text-gray-700"},he={class:"truncate"},ve={class:"ml-2 font-semibold flex-shrink-0"},be={key:0,class:"order-t mt-0.5 flex items-center justify-between rounded-md border-gray-300 bg-white px-1.5 pt-0.5 font-semibold text-[10px] text-gray-800 shadow-sm"},we={class:"ml-2 flex-shrink-0"},ke={class:"flex justify-end space-x-1"},Te={class:"mt-4 flex flex-wrap justify-end gap-1"},Ce=["disabled"],Pe=["onClick"],$e=["disabled"],Ue=U({__name:"Index",setup(Se){const j=ae(),u=le(),{transfers:R,currentPage:p,lastPage:B}=G(u),h=A(50),g=A({label:"Pending",value:"Pending"}),E=re(()=>{u.fetchTransfers(1,h.value)},500),v=Q({search:"",status:""}),V=()=>{var t;const l=typeof g.value=="string"?g.value:((t=g.value)==null?void 0:t.value)??"";u.filters.productName=v.search,u.filters.status=l,u.fetchTransfers(1,h.value)};Z(()=>{u.fetchTransfers(p.value,h.value)}),D(()=>v.search,E),D(p,async l=>{await u.fetchTransfers(l,h.value)});const T=N(()=>B.value||1),q=N(()=>{const l=new Map;return R.value.forEach(t=>{var e;const a=t.created_at?new Date(t.created_at).toLocaleDateString("id-ID"):"-";l.has(a)||l.set(a,[]),(e=l.get(a))==null||e.push(t)}),Array.from(l.entries()).map(([t,a])=>({key:t,items:a}))}),C=async l=>{l<1||l>T.value||(p.value=l)},F=()=>C(p.value+1),I=()=>C(p.value-1),L=async l=>{var t,a;if(confirm("Are you sure you want to delete this transfer?"))try{await u.deleteTransfer(l),await u.fetchTransfers(),j.success("Transfer deleted successfully")}catch(e){j.error(((a=(t=e==null?void 0:e.response)==null?void 0:t.data)==null?void 0:a.message)??"Failed to delete transfer")}},M=H().props.auth.user.location_id,K=[{title:"Transfer Stocks",href:"/transfer-stocks"}];return(l,t)=>(n(),c(_,null,[o(s(J),{title:"Transfer Stocks"}),o(oe,{breadcrumbs:K},{default:r(()=>[i("div",me,[i("div",pe,[i("div",fe,[o(s(ie),{modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=a=>g.value=a),options:[{label:"Semua",value:""},{label:"Pending",value:"Pending"},{label:"Approve",value:"Approved"},{label:"Reject",value:"Rejected"}],placeholder:"Pilih Status",class:"w-full text-sm sm:w-[150px]"},null,8,["modelValue"]),O(i("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>v.search=a),type:"text",placeholder:"Cari data...",onKeyup:W(V,["enter"]),class:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 sm:w-48"},null,544),[[X,v.search]]),o(s(b),{onClick:V,class:"flex items-center gap-1 bg-indigo-600 text-white hover:bg-indigo-700"},{default:r(()=>[o(s(ne),{class:"h-4 w-4"}),t[2]||(t[2]=y(" Cari "))]),_:1,__:[2]})]),i("div",_e,[o(s(ee),null,{default:r(()=>[o(s(te),null,{default:r(()=>[o(s(z),{class:"bg-gray-100"},{default:r(()=>[o(s($),{class:"py-2 text-xs font-semibold text-gray-700"},{default:r(()=>t[3]||(t[3]=[y("Lokasi Tujuan")])),_:1,__:[3]}),o(s($),{class:"py-2 text-xs font-semibold text-gray-700"},{default:r(()=>t[4]||(t[4]=[y("Detail")])),_:1,__:[4]}),o(s($),{class:"py-2 text-xs font-semibold text-gray-700"},{default:r(()=>t[5]||(t[5]=[y("Actions")])),_:1,__:[5]})]),_:1})]),_:1}),o(s(se),null,{default:r(()=>[(n(!0),c(_,null,w(q.value,a=>(n(),c(_,{key:a.key},[(n(!0),c(_,null,w(a.items,e=>(n(),k(s(z),{key:e.id,class:"border-b hover:bg-gray-50"},{default:r(()=>[o(s(S),{class:"whitespace-nowrap py-2 text-sm"},{default:r(()=>{var f;return[y(m(((f=e.location_destination)==null?void 0:f.name)||"-")+" ",1),i("div",ge,[i("span",null,m(a.key),1)])]}),_:2},1024),o(s(S),{class:"py-2 text-sm"},{default:r(()=>{var f;return[(f=e.transfer_detail)!=null&&f.length?(n(),c("div",ye,[i("div",xe,[(n(!0),c(_,null,w(e.transfer_detail,(d,P)=>(n(),c("div",{key:P,class:"flex items-center justify-between rounded-md bg-white px-1.5 py-0.5 shadow-sm"},[i("span",he,m(d.product_id)+" - "+m(d.size_id)+" - "+m(d.variant),1),i("span",ve,m(d.qty)+" "+m(d.uom_id),1)]))),128)),e.transfer_detail.length>1?(n(),c("div",be,[t[6]||(t[6]=i("span",null,"Total",-1)),i("span",we,m(e.transfer_detail.reduce((d,P)=>d+Number(P.qty||0),0)),1)])):x("",!0)])])):x("",!0)]}),_:2},1024),o(s(S),{class:"w-1/12 py-2 text-right"},{default:r(()=>{var f;return[i("div",ke,[e!=null&&e.id&&(e.status==="Accepted"||e.status==="Rejected")||((f=e.location_destination)==null?void 0:f.id)===s(M)?(n(),k(s(b),{key:0,variant:"ghost",size:"icon",class:"h-7 w-7 hover:bg-gray-100",onClick:d=>l.$inertia.visit(`/transfer-stock/${e.id}/view`)},{default:r(()=>[o(s(de),{class:"h-4 w-4"})]),_:2},1032,["onClick"])):x("",!0),e!=null&&e.id&&(e.status==="Pending"||e.status==="Rejected")?(n(),k(s(b),{key:1,variant:"ghost",size:"icon",class:"h-7 w-7 hover:bg-gray-100",onClick:d=>l.$inertia.visit(`/transfer-stock/${e.id}/edit`)},{default:r(()=>[o(s(ce),{class:"h-4 w-4"})]),_:2},1032,["onClick"])):x("",!0),e!=null&&e.id&&(e.status==="Pending"||e.status==="Rejected")?(n(),k(s(b),{key:2,variant:"ghost",size:"icon",class:"h-7 w-7 hover:bg-gray-100",onClick:d=>L(e.id)},{default:r(()=>[o(s(ue),{class:"h-4 w-4"})]),_:2},1032,["onClick"])):x("",!0)])]}),_:2},1024)]),_:2},1024))),128))],64))),128))]),_:1})]),_:1})]),i("div",Te,[i("button",{onClick:I,disabled:s(p)===1,class:"rounded border border-gray-300 px-2 py-1 text-xs text-gray-700 hover:bg-gray-100 disabled:opacity-50"}," Previous ",8,Ce),(n(!0),c(_,null,w(T.value,a=>(n(),c("button",{key:a,onClick:e=>C(a),class:Y(["rounded border px-2 py-1 text-xs",a===s(p)?"border-blue-600 bg-blue-600 text-white":"border-gray-300 text-gray-700 hover:bg-gray-100"])},m(a),11,Pe))),128)),i("button",{onClick:F,disabled:s(p)===T.value,class:"rounded border border-gray-300 px-2 py-1 text-xs text-gray-700 hover:bg-gray-100 disabled:opacity-50"}," Next ",8,$e)])])])]),_:1})],64))}});export{Ue as default};
