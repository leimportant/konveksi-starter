import{d as m,J as y,r as d,o as S,aK as b,f as u,g as l,k as a,C as v,z as p,j as f,u as h,_ as w,c as _}from"./app-s_VUL-pL.js";import{u as k}from"./useToast-YNm_Db7-.js";import{u as z}from"./usePushNotificationStore-d1IlPDgk.js";const C={class:"push-notification-toggle"},E={class:"toggle-container"},T={key:0,class:"unsupported-message"},$={key:1,class:"error-message"},x=m({__name:"PushNotificationToggle",setup(P){const{t:s}=y(),r=k(),o=d(!1),e=d(!1),t=d(!1),i=d("");S(async()=>{try{if(t.value=!0,i.value="",o.value="serviceWorker"in navigator&&"PushManager"in window,!o.value){console.log("Push notifications are not supported by this browser");return}await b.initialize()?(e.value=await b.checkSubscription(),console.log("Push notification status:",e.value?"Subscribed":"Not subscribed")):i.value=s("pushNotifications.initFailed")}catch(c){console.error("Error initializing push notifications:",c),i.value=s("pushNotifications.errorOccurred")}finally{t.value=!1}});async function g(){if(!(!o.value||t.value))try{t.value=!0,i.value="",e.value?await b.unsubscribe()?(e.value=!1,console.log("Successfully unsubscribed from push notifications"),r.success(s("pushNotifications.unsubscribeSuccess"))):(i.value=s("pushNotifications.unsubscribeFailed"),r.error(s("pushNotifications.error"))):await b.subscribe()?(e.value=!0,console.log("Successfully subscribed to push notifications"),r.success(s("pushNotifications.subscribeSuccess"))):(i.value=s("pushNotifications.subscribeFailed"),r.error(s("pushNotifications.error")))}catch(c){console.error("Error toggling push notification subscription:",c),i.value=s("pushNotifications.errorOccurred"),r.error(s("pushNotifications.error"))}finally{t.value=!1}}return(c,n)=>(l(),u("div",C,[a("div",E,[a("label",{class:p(["toggle-label",{disabled:!o.value}])},[a("span",null,f(h(s)("pushNotifications.title")),1),a("div",{class:p(["toggle-switch",{disabled:!o.value,loading:t.value}]),onClick:g},[a("div",{class:p(["toggle-slider",{active:e.value}])},n[0]||(n[0]=[a("div",{class:"toggle-button"},null,-1)]),2)],2)],2)]),o.value?v("",!0):(l(),u("p",T,f(h(s)("pushNotifications.unsupported")),1)),i.value?(l(),u("p",$,f(i.value),1)):v("",!0)]))}}),D=w(x,[["__scopeId","data-v-0039df7b"]]),M={class:"push-notification-toggle"},B={class:"toggle-container"},F={key:0,class:"unsupported-message"},I={key:1,class:"error-message"},O=m({__name:"PushNotificationToggleStore",setup(P){const{t:s}=y(),r=k(),o=z(),e=d(!1),t=_(()=>"serviceWorker"in navigator&&"PushManager"in window),i=_(()=>o.isSubscribed),g=_(()=>o.error);S(async()=>{try{if(e.value=!0,!t.value){console.log("Push notifications are not supported by this browser");return}await o.checkSubscription(),console.log("Push notification status:",i.value?"Subscribed":"Not subscribed")}catch(n){console.error("Error initializing push notifications:",n)}finally{e.value=!1}});async function c(){if(!(!t.value||e.value))try{e.value=!0,i.value?(await o.unsubscribe(),r.success(s("pushNotifications.unsubscribeSuccess"))):(await o.subscribe(),r.success(s("pushNotifications.subscribeSuccess")))}catch(n){console.error("Error toggling push notification subscription:",n),r.error(s("pushNotifications.error"))}finally{e.value=!1}}return(n,N)=>(l(),u("div",M,[a("div",B,[a("label",{class:p(["toggle-label",{disabled:!t.value}])},[a("span",null,f(h(s)("pushNotifications.title")),1),a("div",{class:p(["toggle-switch",{disabled:!t.value,loading:e.value}]),onClick:c},[a("div",{class:p(["toggle-slider",{active:i.value}])},N[0]||(N[0]=[a("div",{class:"toggle-button"},null,-1)]),2)],2)],2)]),t.value?v("",!0):(l(),u("p",F,f(h(s)("pushNotifications.unsupported")),1)),g.value?(l(),u("p",I,f(g.value),1)):v("",!0)]))}}),J=w(O,[["__scopeId","data-v-7979409a"]]);export{D as P,J as a};
