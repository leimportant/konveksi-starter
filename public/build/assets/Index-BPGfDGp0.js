import{d as L,q,r as I,o as M,w as T,c as Q,Q as U,f as b,g as u,p as s,u as t,Z,x as a,k as r,D as g,y as n,F as h,B as P,E as p,j as _,z as S,C as $}from"./app-sx78ipwT.js";import{_ as G,a as H,b as N,c as m,d as J,e as f}from"./TableRow.vue_vue_type_script_setup_true_lang-C_gbZbzj.js";import{u as K}from"./useToast-ob4_XLsP.js";import{_ as O}from"./AppLayout.vue_vue_type_script_setup_true_lang-CPvcl6RI.js";import{u as W}from"./useTransferStockStore-uxgaK-mK.js";import{_ as X}from"./Input.vue_vue_type_script_setup_true_lang-CZSnNRhC.js";import{d as Y}from"./debounce-BcZQbp_F.js";import{P as ee}from"./plus-_r0zrbMj.js";import{E as te}from"./eye-BWz_o2ek.js";import{S as se}from"./square-pen-B1jqeV_C.js";import{T as ae}from"./trash-2-B_CQUH2k.js";import"./index-C9SKcOQs.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BVuCrQ3W.js";const oe={class:"px-4 py-4"},le={class:"mb-6 flex items-center justify-between"},de={class:"rounded-md border"},ne={class:"mt-4 flex justify-end space-x-2"},ie=["disabled"],ue=["onClick"],re=["disabled"],Pe=L({__name:"Index",setup(ce){const w=K(),c=W(),{transfers:D,filters:y,loading:V,currentPage:i,lastPage:j}=q(c),v=I(10),z=Y(()=>{c.fetchTransfers(1,v.value)},500);M(()=>{c.fetchTransfers(i.value,v.value)}),T(()=>y.value.productName,z),T(i,async d=>{await c.fetchTransfers(d,v.value)});const k=Q(()=>j.value||1),x=async d=>{d<1||d>k.value||(i.value=d)},B=()=>x(i.value+1),A=()=>x(i.value-1),E=async d=>{var o,e;if(confirm("Are you sure you want to delete this transfer?"))try{await c.deleteTransfer(d),await c.fetchTransfers(),w.success("Transfer deleted successfully")}catch(l){w.error(((e=(o=l==null?void 0:l.response)==null?void 0:o.data)==null?void 0:e.message)??"Failed to delete transfer")}},F=U().props.auth.user.location_id,R=[{title:"Transfer Stocks",href:"/transfer-stocks"}];return(d,o)=>(u(),b(h,null,[s(t(Z),{title:"Transfer Stocks"}),s(O,{breadcrumbs:R},{default:a(()=>[r("div",oe,[r("div",le,[s(t(g),{onClick:o[0]||(o[0]=e=>d.$inertia.visit("/transfer-stock/create")),class:"gap-2 bg-blue-600 text-white hover:bg-blue-700"},{default:a(()=>[s(t(ee),{class:"h-4 w-4"}),o[2]||(o[2]=n(" Add "))]),_:1,__:[2]}),s(t(X),{modelValue:t(y).productName,"onUpdate:modelValue":o[1]||(o[1]=e=>t(y).productName=e),placeholder:"Search",class:"w-64 border-gray-300 focus:border-blue-500 focus:ring-blue-500","aria-label":"Search",disabled:t(V)},null,8,["modelValue","disabled"])]),r("div",de,[s(t(G),null,{default:a(()=>[s(t(H),null,{default:a(()=>[s(t(N),{class:"bg-gray-100"},{default:a(()=>[s(t(m),null,{default:a(()=>o[3]||(o[3]=[n("Location")])),_:1,__:[3]}),s(t(m),null,{default:a(()=>o[4]||(o[4]=[n("Destination")])),_:1,__:[4]}),s(t(m),null,{default:a(()=>o[5]||(o[5]=[n("Sloc")])),_:1,__:[5]}),s(t(m),null,{default:a(()=>o[6]||(o[6]=[n("Date")])),_:1,__:[6]}),s(t(m),null,{default:a(()=>o[7]||(o[7]=[n("Status")])),_:1,__:[7]}),s(t(m),{class:"w-24"},{default:a(()=>o[8]||(o[8]=[n("Actions")])),_:1,__:[8]})]),_:1})]),_:1}),s(t(J),null,{default:a(()=>[(u(!0),b(h,null,P(t(D),e=>(u(),p(t(N),{key:e.id},{default:a(()=>[s(t(f),null,{default:a(()=>{var l;return[n(_((l=e.location)==null?void 0:l.name),1)]}),_:2},1024),s(t(f),null,{default:a(()=>{var l;return[n(_((l=e.location_destination)==null?void 0:l.name),1)]}),_:2},1024),s(t(f),null,{default:a(()=>[n(_(e.sloc_id),1)]),_:2},1024),s(t(f),null,{default:a(()=>[n(_(e.created_at?new Date(e.created_at).toLocaleDateString():"-"),1)]),_:2},1024),s(t(f),null,{default:a(()=>[r("span",{class:S([e.status=="Pending"?"bg-green-100 text-green-800":"bg-red-100 text-red-800","rounded-full px-2 py-1 text-xs font-semibold"])},_(e.status),3)]),_:2},1024),s(t(f),{class:"flex gap-2"},{default:a(()=>{var l;return[e!=null&&e.id&&(e.status==="Accepted"||e.status==="Rejected")||((l=e.location_destination)==null?void 0:l.id)===t(F)?(u(),p(t(g),{key:0,variant:"ghost",size:"icon",class:"hover:bg-gray-100",onClick:C=>d.$inertia.visit(`/transfer-stock/${e.id}/view`)},{default:a(()=>[s(t(te),{class:"h-4 w-4"})]),_:2},1032,["onClick"])):$("",!0),e!=null&&e.id&&(e.status==="Pending"||e.status==="Rejected")?(u(),p(t(g),{key:1,variant:"ghost",size:"icon",class:"hover:bg-gray-100",onClick:C=>d.$inertia.visit(`/transfer-stock/${e.id}/edit`)},{default:a(()=>[s(t(se),{class:"h-4 w-4"})]),_:2},1032,["onClick"])):$("",!0),e!=null&&e.id&&(e.status==="Pending"||e.status==="Rejected")?(u(),p(t(g),{key:2,variant:"ghost",size:"icon",class:"hover:bg-gray-100",onClick:C=>E(e.id)},{default:a(()=>[s(t(ae),{class:"h-4 w-4"})]),_:2},1032,["onClick"])):$("",!0)]}),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),r("div",ne,[r("button",{onClick:A,disabled:t(i)===1,class:"rounded border border-gray-300 px-3 py-1 text-gray-700 hover:bg-gray-100 disabled:opacity-50"}," Previous ",8,ie),(u(!0),b(h,null,P(k.value,e=>(u(),b("button",{key:e,onClick:l=>x(e),class:S(["rounded border px-3 py-1 text-sm",e===t(i)?"border-blue-600 bg-blue-600 text-white":"border-gray-300 text-gray-700 hover:bg-gray-100"])},_(e),11,ue))),128)),r("button",{onClick:B,disabled:t(i)===k.value,class:"rounded border border-gray-300 px-3 py-1 text-gray-700 hover:bg-gray-100 disabled:opacity-50"}," Next ",8,re)])])]),_:1})],64))}});export{Pe as default};
