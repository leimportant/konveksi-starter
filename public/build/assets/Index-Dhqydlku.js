import{d as E,r as k,T as Y,q as H,c as L,o as R,f as _,g as i,p as a,u as t,Z,x as r,k as n,C as G,D as g,y as o,F as S,B as V,E as J,j as c,z as K,O as Q}from"./app-BgMP0dw7.js";import{_ as W}from"./AppLayout.vue_vue_type_script_setup_true_lang-BHQ3aX0E.js";import{_ as h}from"./Input.vue_vue_type_script_setup_true_lang-DPtsXuzK.js";import{_ as X,a as ee,b as O,c as m,d as te,e as f}from"./TableRow.vue_vue_type_script_setup_true_lang-DsMJY-pL.js";import{u as se}from"./useToast-CSITSKnD.js";import{u as ae}from"./usePurchaseOrder-dNN6tio8.js";import{P as re}from"./plus-DTHWV1Fo.js";import{S as le}from"./square-pen-pc5lVL6a.js";import{T as oe}from"./trash-2-Df80hrsU.js";import"./index-C5jpTHQl.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-ghChzUf9.js";const ne={class:"px-4 py-4"},ue={class:"flex justify-between items-center gap-2 mb-2"},de={class:"rounded-md border"},ie={class:"flex justify-end mt-4 space-x-2"},ce=["disabled"],me=["onClick"],fe=["disabled"],pe={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},_e={class:"bg-white p-6 rounded-lg w-96"},ge={class:"mb-4"},be={class:"mb-4"},he={class:"mb-4"},ve={class:"flex justify-end gap-2"},Te=E({__name:"Index",setup(ye){const b=se(),D=l=>{if(!l)return"N/A";const e=new Date(l);if(isNaN(e.getTime())){const s=new Date;return`${String(s.getDate()).padStart(2,"0")}/${String(s.getMonth()+1).padStart(2,"0")}/${s.getFullYear()} ${String(s.getHours()).padStart(2,"0")}:${String(s.getMinutes()).padStart(2,"0")}`}return`${String(e.getDate()).padStart(2,"0")}/${String(e.getMonth()+1).padStart(2,"0")}/${e.getFullYear()}`},v=k(!1),u=Y({id:"",purchase_date:"",supplier:"",nota_number:"",status:"",items:[]}),w=ae(),{items:N,loading:y,currentPage:p,lastPage:T}=H(w),{fetchPurchaseOrders:C,createPurchaseOrder:F,deletePurchaseOrder:M,setFilter:j}=w,x=k(""),$=L(()=>T.value||1),P=async l=>{l<1||l>$.value||await C(l)},q=()=>P(p.value+1),z=()=>P(p.value-1),B=()=>{j("search",x.value)};R(()=>{C()});const A=async()=>{var l,e;try{await F(u),b.success("Purchase Order created successfully"),u.reset(),v.value=!1}catch(s){b.error(((e=(l=s==null?void 0:s.response)==null?void 0:l.data)==null?void 0:e.message)||"Failed to create Purchase Order")}},U=async l=>{var e,s;if(confirm("Are you sure you want to delete this Purchase Order?"))try{await M(l),b.success("Purchase Order deleted successfully")}catch(d){b.error(((s=(e=d==null?void 0:d.response)==null?void 0:e.data)==null?void 0:s.message)||"Failed to delete Purchase Order")}},I=[{title:"Purchase Orders",href:"/purchase-orders"}];return(l,e)=>(i(),_(S,null,[a(t(Z),{title:"Purchase Orders"}),a(W,{breadcrumbs:I},{default:r(()=>[n("div",ne,[n("div",ue,[a(t(g),{onClick:e[0]||(e[0]=s=>l.$inertia.visit("/purchase-order/create")),class:"bg-indigo-600 text-white py-2 h-10 rounded-md hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:r(()=>[a(t(re),{class:"h-4 w-4"}),e[6]||(e[6]=o(" Add "))]),_:1,__:[6]}),a(t(h),{modelValue:x.value,"onUpdate:modelValue":e[1]||(e[1]=s=>x.value=s),placeholder:"Search",onInput:B,class:"w-64","aria-label":"Search"},null,8,["modelValue"])]),n("div",de,[a(t(X),null,{default:r(()=>[a(t(ee),null,{default:r(()=>[a(t(O),{class:"bg-gray-100"},{default:r(()=>[a(t(m),null,{default:r(()=>e[7]||(e[7]=[o("ID")])),_:1,__:[7]}),a(t(m),null,{default:r(()=>e[8]||(e[8]=[o("Date")])),_:1,__:[8]}),a(t(m),null,{default:r(()=>e[9]||(e[9]=[o("Supplier")])),_:1,__:[9]}),a(t(m),null,{default:r(()=>e[10]||(e[10]=[o("Nota Number")])),_:1,__:[10]}),a(t(m),null,{default:r(()=>e[11]||(e[11]=[o("Status")])),_:1,__:[11]}),a(t(m),{class:"w-24"},{default:r(()=>e[12]||(e[12]=[o("Actions")])),_:1,__:[12]})]),_:1})]),_:1}),a(t(te),null,{default:r(()=>[(i(!0),_(S,null,V(t(N),s=>(i(),J(t(O),{key:s.id},{default:r(()=>[a(t(f),null,{default:r(()=>[o(c(s.id),1)]),_:2},1024),a(t(f),null,{default:r(()=>[o(c(D(s.purchase_date)),1)]),_:2},1024),a(t(f),null,{default:r(()=>[o(c(s.supplier),1)]),_:2},1024),a(t(f),null,{default:r(()=>[o(c(s.nota_number),1)]),_:2},1024),a(t(f),null,{default:r(()=>[o(c(s.status),1)]),_:2},1024),a(t(f),{class:"flex gap-2"},{default:r(()=>[a(t(g),{variant:"ghost",size:"icon",onClick:d=>l.$inertia.visit(`/purchase-order/${s.id}/edit`)},{default:r(()=>[a(t(le),{class:"h-4 w-4"})]),_:2},1032,["onClick"]),a(t(g),{variant:"ghost",size:"icon",onClick:d=>U(s.id),disabled:t(y)||s.status==="completed"},{default:r(()=>[a(t(oe),{class:"h-4 w-4"})]),_:2},1032,["onClick","disabled"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),n("div",ie,[n("button",{onClick:z,disabled:t(p)===1||t(y),class:"px-3 py-1 rounded border text-gray-700 hover:bg-gray-100"}," Previous ",8,ce),(i(!0),_(S,null,V($.value,s=>(i(),_("button",{key:s,onClick:d=>P(s),class:K(["px-3 py-1 rounded border text-sm",s===t(p)?"bg-blue-600 border-blue-600 text-white":"border-gray-300 text-gray-700 hover:bg-gray-100"])},c(s),11,me))),128)),n("button",{onClick:q,disabled:t(p)===$.value||t(y),class:"px-3 py-1 rounded border text-gray-700 hover:bg-gray-100"}," Next ",8,fe)]),v.value?(i(),_("div",pe,[n("div",_e,[e[15]||(e[15]=n("h2",{class:"text-lg font-semibold mb-4"},"Create Purchase Order",-1)),n("form",{onSubmit:Q(A,["prevent"])},[n("div",ge,[a(t(h),{modelValue:t(u).purchase_date,"onUpdate:modelValue":e[2]||(e[2]=s=>t(u).purchase_date=s),type:"date",placeholder:"Date",required:""},null,8,["modelValue"])]),n("div",be,[a(t(h),{modelValue:t(u).supplier,"onUpdate:modelValue":e[3]||(e[3]=s=>t(u).supplier=s),placeholder:"Supplier",required:""},null,8,["modelValue"])]),n("div",he,[a(t(h),{modelValue:t(u).status,"onUpdate:modelValue":e[4]||(e[4]=s=>t(u).status=s),placeholder:"Status",required:""},null,8,["modelValue"])]),n("div",ve,[a(t(g),{type:"button",variant:"outline",onClick:e[5]||(e[5]=s=>v.value=!1),class:"h-10"},{default:r(()=>e[13]||(e[13]=[o("Cancel")])),_:1,__:[13]}),a(t(g),{type:"submit",class:"bg-indigo-600 text-white"},{default:r(()=>e[14]||(e[14]=[o("Create")])),_:1,__:[14]})])],32)])])):G("",!0)])]),_:1})],64))}});export{Te as default};
