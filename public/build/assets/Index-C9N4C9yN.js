import{M as H,b as x,d as J,r as N,T as O,q as Q,c as W,o as X,f as _,g,p as o,u as t,Z as Y,x as i,k as r,C as T,D as b,y as f,N as ee,F as P,B as j,E as te,j as S,z as ae,K as E}from"./app-DLPGG9ip.js";import{_ as oe}from"./AppLayout.vue_vue_type_script_setup_true_lang-jY_tTzzq.js";import{_ as h}from"./Input.vue_vue_type_script_setup_true_lang-J7eywKQe.js";import{_ as se,a as ie,b as U,c as q,d as le,e as F}from"./TableRow.vue_vue_type_script_setup_true_lang-CN4U8teA.js";import{u as ne}from"./useToast-C_MTCQMf.js";import{P as re}from"./plus-s9cHAh9C.js";import{S as de}from"./square-pen-Dr4xt6Bb.js";import{T as ue}from"./trash-2-Bb9fzXT7.js";import"./index-DhuvfouN.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DDHXcYGj.js";const ce=H("location",{state:()=>({items:[],total:0,loaded:!1,loading:!1,currentPage:1,lastPage:1,filterName:""}),actions:{async fetchLocations(m=1,s=10){this.loading=!0;try{const d=await x.get("/api/locations",{params:{page:m,perPage:s,name:this.filterName}});this.items=d.data.data,this.total=d.data.total,this.currentPage=m,this.lastPage=d.data.last_page||1,this.loaded=!0}catch(d){console.error("Failed to fetch Locations",d)}},setFilter(m,s){m==="name"&&(this.filterName=s,this.currentPage=1,this.fetchLocations(1))},async createLocation(m,s){try{await x.post("/api/locations",{id:m,name:s}),await this.fetchLocations()}catch(d){throw d}},async updateLocation(m,s){try{await x.put(`/api/locations/${m}`,{name:s}),await this.fetchLocations()}catch(d){throw d}},async deleteLocation(m){try{await x.delete(`/api/locations/${m}`),await this.fetchLocations()}catch(s){throw s}}}}),me={class:"px-4 py-4"},fe={class:"flex justify-between items-center gap-2 mb-2"},pe={class:"rounded-md border"},ge={class:"flex justify-end mt-4 space-x-2"},be=["disabled"],_e=["onClick","disabled"],ye=["disabled"],he={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},ve={class:"bg-white p-6 rounded-lg w-96"},we={class:"mb-4"},xe={class:"mb-4"},Le={class:"flex justify-end gap-2"},ke={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Ce={class:"bg-white p-6 rounded-lg w-96"},Ve={class:"mb-4"},$e={class:"mb-4"},Ne={class:"flex justify-end gap-2"},Me=J({__name:"Index",setup(m){const s=ne(),d=N(!1),v=N(!1),w=N(null),l=O({id:"",name:""}),z=[{title:"Location",href:"/location"}],u=ce(),{items:I,currentPage:y,lastPage:M,loading:L,filterName:k}=Q(u),C=W(()=>M.value||1),V=async n=>{n<1||n>C.value||await u.fetchLocations(n)},B=()=>V(y.value+1),D=()=>V(y.value-1),A=(n,e)=>{const a=e.target;u.setFilter(n,a.value)};X(()=>{u.fetchLocations()});const R=async()=>{var n,e,a,c;if(!l.id)return s.error("Id is required");if(!l.name)return s.error("Name is required");try{await u.createLocation(l.id,l.name),s.success("location created successfully"),l.reset(),u.loaded=!1,await u.fetchLocations(),d.value=!1}catch(p){const $=(c=(a=(e=(n=p==null?void 0:p.response)==null?void 0:n.data)==null?void 0:e.errors)==null?void 0:a.name)==null?void 0:c[0];s.error($||"Failed to create location")}},K=n=>{w.value=n,l.id=n.id,l.name=n.name,v.value=!0},Z=async()=>{var n,e,a,c;if(!w.value||!l.name)return s.error("Name is required");try{await u.updateLocation(w.value.id,l.name),s.success("Location updated successfully"),l.reset(),u.loaded=!1,await u.fetchLocations(),v.value=!1,w.value=null}catch(p){const $=(c=(a=(e=(n=p==null?void 0:p.response)==null?void 0:n.data)==null?void 0:e.errors)==null?void 0:a.name)==null?void 0:c[0];s.error($||"Failed to update Location")}},G=async n=>{var e,a;if(confirm("Are you sure you want to delete this location?"))try{await u.deleteLocation(n),s.success("location deleted successfully"),u.loaded=!1,await u.fetchLocations()}catch(c){s.error(((a=(e=c==null?void 0:c.response)==null?void 0:e.data)==null?void 0:a.message)??"Failed to delete Location")}};return(n,e)=>(g(),_(P,null,[o(t(Y),{title:"Location Management"}),o(oe,{breadcrumbs:z},{default:i(()=>[r("div",me,[r("div",fe,[o(t(b),{onClick:e[0]||(e[0]=a=>d.value=!0),class:"bg-indigo-600 text-white py-2 h-10 rounded-md hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:i(()=>[o(t(re),{class:"h-4 w-4"}),e[9]||(e[9]=f(" Add "))]),_:1,__:[9]}),o(t(h),{modelValue:t(k),"onUpdate:modelValue":e[1]||(e[1]=a=>ee(k)?k.value=a:null),placeholder:"Search",onInput:e[2]||(e[2]=a=>A("name",a)),class:"w-64","aria-label":"Search"},null,8,["modelValue"])]),r("div",pe,[o(t(se),null,{default:i(()=>[o(t(ie),null,{default:i(()=>[o(t(U),{class:"bg-gray-100"},{default:i(()=>[o(t(q),null,{default:i(()=>e[10]||(e[10]=[f("Id")])),_:1,__:[10]}),o(t(q),null,{default:i(()=>e[11]||(e[11]=[f("Name")])),_:1,__:[11]}),o(t(q),{class:"w-24"},{default:i(()=>e[12]||(e[12]=[f("Actions")])),_:1,__:[12]})]),_:1})]),_:1}),o(t(le),null,{default:i(()=>[(g(!0),_(P,null,j(t(I),a=>(g(),te(t(U),{key:a.id},{default:i(()=>[o(t(F),null,{default:i(()=>[f(S(a.id),1)]),_:2},1024),o(t(F),null,{default:i(()=>[f(S(a.name),1)]),_:2},1024),o(t(F),{class:"flex gap-2"},{default:i(()=>[o(t(b),{variant:"ghost",size:"icon",onClick:c=>K(a)},{default:i(()=>[o(t(de),{class:"h-4 w-4"})]),_:2},1032,["onClick"]),o(t(b),{variant:"ghost",size:"icon",onClick:c=>G(a.id)},{default:i(()=>[o(t(ue),{class:"h-4 w-4"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),r("div",ge,[r("button",{onClick:D,disabled:t(y)===1||t(L),class:"px-3 py-1 rounded border border-gray-300 text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed"}," Previous ",8,be),(g(!0),_(P,null,j(C.value,a=>(g(),_("button",{key:a,onClick:c=>V(a),class:ae(["px-3 py-1 rounded border text-sm",a===t(y)?"bg-blue-600 border-blue-600 text-white":"border-gray-300 text-gray-700 hover:bg-gray-100"]),disabled:t(L)},S(a),11,_e))),128)),r("button",{onClick:B,disabled:t(y)===C.value||t(L),class:"px-3 py-1 rounded border border-gray-300 text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed"}," Next ",8,ye)]),d.value?(g(),_("div",he,[r("div",ve,[e[15]||(e[15]=r("h2",{class:"text-lg font-semibold mb-4"},"Tambah data",-1)),r("form",{onSubmit:E(R,["prevent"])},[r("div",we,[o(t(h),{modelValue:t(l).id,"onUpdate:modelValue":e[3]||(e[3]=a=>t(l).id=a),placeholder:"location Id",required:""},null,8,["modelValue"])]),r("div",xe,[o(t(h),{modelValue:t(l).name,"onUpdate:modelValue":e[4]||(e[4]=a=>t(l).name=a),placeholder:"location Name",required:""},null,8,["modelValue"])]),r("div",Le,[o(t(b),{type:"button",variant:"outline",onClick:e[5]||(e[5]=a=>d.value=!1),class:"h-10"},{default:i(()=>e[13]||(e[13]=[f("Cancel")])),_:1,__:[13]}),o(t(b),{type:"submit",class:"bg-indigo-600 text-white py-2 h-10 rounded-md hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:i(()=>e[14]||(e[14]=[f("Create")])),_:1,__:[14]})])],32)])])):T("",!0),v.value?(g(),_("div",ke,[r("div",Ce,[e[18]||(e[18]=r("h2",{class:"text-lg font-semibold mb-4"},"Edit Location",-1)),r("form",{onSubmit:E(Z,["prevent"])},[r("div",Ve,[o(t(h),{modelValue:t(l).id,"onUpdate:modelValue":e[6]||(e[6]=a=>t(l).id=a),placeholder:"ID",required:"",readonly:""},null,8,["modelValue"])]),r("div",$e,[o(t(h),{modelValue:t(l).name,"onUpdate:modelValue":e[7]||(e[7]=a=>t(l).name=a),placeholder:"location Name",required:""},null,8,["modelValue"])]),r("div",Ne,[o(t(b),{type:"button",variant:"outline",onClick:e[8]||(e[8]=a=>v.value=!1),class:"h-10"},{default:i(()=>e[16]||(e[16]=[f("Cancel")])),_:1,__:[16]}),o(t(b),{type:"submit",class:"bg-indigo-600 text-white py-2 h-10 rounded-md hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:i(()=>e[17]||(e[17]=[f("Update")])),_:1,__:[17]})])],32)])])):T("",!0)])]),_:1})],64))}});export{Me as default};
