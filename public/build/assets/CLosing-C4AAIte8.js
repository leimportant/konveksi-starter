import{d as q,q as A,r as F,o as I,f as g,g as n,p as d,u as l,Z as R,x as r,k as t,l as w,S as P,m as S,D as C,y as b,j as i,P as G,E as m,C as $,F as p,B as D,z as B}from"./app-BjS9V559.js";import{_ as K,a as Q,b as V,c as E,d as Z,e as M}from"./TableRow.vue_vue_type_script_setup_true_lang-iAlIABgh.js";import{_ as H}from"./AppLayout.vue_vue_type_script_setup_true_lang-DZvDN96H.js";import{u as J}from"./usePayrollStore-CV7Eok6e.js";import{C as N,D as W}from"./dollar-sign-011VUj5k.js";import"./index-CPQH5Eah.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-Cx1FFA3U.js";const X={class:"space-y-4 p-6"},Y={class:"grid grid-cols-2 gap-3 sm:grid-cols-2"},ee={class:"flex flex-col"},te={class:"flex flex-col"},se={class:"flex items-center gap-2"},le={class:"flex items-center gap-2"},oe={class:"ml-4 flex items-center"},ae={class:"relative inline-flex cursor-pointer items-center"},ne={class:"overflow-hidden rounded-md border"},re={class:"flex items-center justify-between rounded bg-gray-200 p-2 font-bold dark:bg-gray-700"},de=["checked","onChange"],ie={class:"flex-1 text-sm font-bold text-gray-800"},ue={class:"flex justify-between"},ce={class:"font-bold text-gray-800"},ge={class:"flex justify-between"},pe={class:"font-bold text-gray-800"},fe={class:"flex justify-between"},be={class:"font-bold text-gray-800"},_e={class:"flex items-center"},ye=["onUpdate:modelValue","onChange"],me={class:"flex justify-between border-t pt-1 sm:border-t-0 sm:pt-0"},xe={class:"font-bold text-gray-900"},he={class:"mt-2 flex gap-1"},ve={class:"w-full text-xs"},ke={class:"bg-gray-200 font-bold dark:bg-gray-700"},we={colspan:"4",class:"px-3 py-2"},Ce={class:"bg-blue-50 font-semibold"},De={colspan:"4",class:"px-3 py-2"},Se={class:"p-2"},$e={class:"p-2 text-right"},Te={key:0},je={class:"flex justify-end"},Ue=q({__name:"CLosing",setup(Pe){const c=J(),{employees:T,startDate:x,endDate:h,selectedEmployees:_}=A(c),y=F(!0),z=u=>{const e=u.target;c.selectedEmployees=e.checked?T.value.map(s=>s.employee_id):[]},L=[{title:"Payroll Closing Management",href:"/payroll/closing"}];I(()=>{const u=new Date,e=new Date;e.setDate(u.getDate()-60),x.value=e.toISOString().split("T")[0],h.value=u.toISOString().split("T")[0],c.loadPayrollData()});const U=u=>{if(!u)return"-";const e=u.split("T")[0],[s,o,a]=e.split("-");return`${a}/${o}/${s}`},O=u=>{if(!u.details)return{};const e={};u.details.forEach(o=>{var v;const a=((v=o.created_at)==null?void 0:v.split("T")[0])||"-",f=o.model_desc||"-";e[a]||(e[a]={}),e[a][f]||(e[a][f]=[]),e[a][f].push(o)});const s={};return Object.keys(e).sort((o,a)=>a.localeCompare(o)).forEach(o=>{s[o]={},Object.keys(e[o]).sort().forEach(a=>{s[o][a]=e[o][a]})}),s};return(u,e)=>(n(),g(p,null,[d(l(R),{title:"Payroll Management"}),d(H,{breadcrumbs:L},{default:r(()=>[t("div",X,[t("div",Y,[t("div",ee,[e[3]||(e[3]=t("label",{class:"mb-1 text-xs font-medium"},"Start Date",-1)),w(t("input",{type:"date","onUpdate:modelValue":e[0]||(e[0]=s=>P(x)?x.value=s:null),class:"rounded-md border px-3 py-1.5 text-sm shadow-sm focus:border-indigo-500 focus:ring"},null,512),[[S,l(x),void 0,{lazy:!0}]])]),t("div",te,[e[4]||(e[4]=t("label",{class:"mb-1 text-xs font-medium"},"End Date",-1)),w(t("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=s=>P(h)?h.value=s:null),class:"rounded-md border px-3 py-1.5 text-sm shadow-sm focus:border-indigo-500 focus:ring"},null,512),[[S,l(h),void 0,{lazy:!0}]])])]),t("div",se,[d(l(C),{onClick:l(c).loadPayrollData,size:"sm",class:"rounded bg-blue-600 px-4 py-2 text-sm text-white hover:bg-blue-700"},{default:r(()=>e[5]||(e[5]=[b(" Tampilkan ")])),_:1,__:[5]},8,["onClick"])]),t("div",le,[d(l(C),{onClick:l(c).closePayroll,disabled:l(_).length===0,class:"bg-green-600 text-white hover:bg-green-700 disabled:cursor-not-allowed disabled:opacity-50"},{default:r(()=>[d(l(N),{class:"h-4 w-4"}),b(" Bayar ("+i(l(_).length)+") ",1)]),_:1},8,["onClick","disabled"]),t("div",oe,[t("label",ae,[w(t("input",{id:"detailToggle",type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=s=>y.value=s),class:"peer sr-only"},null,512),[[G,y.value]]),e[6]||(e[6]=t("div",{class:"peer h-6 w-11 rounded-full bg-gray-200 after:absolute after:left-[2px] after:top-[2px] after:h-5 after:w-5 after:rounded-full after:border after:border-gray-300 after:bg-white after:transition-all after:content-[''] peer-checked:bg-blue-600 peer-checked:after:translate-x-full peer-checked:after:border-white"},null,-1)),e[7]||(e[7]=t("span",{class:"ml-3 text-sm"},"Tutup Detail",-1))])])]),t("div",ne,[d(l(K),null,{default:r(()=>[d(l(Q),null,{default:r(()=>[d(l(V),{class:"bg-gray-50"},{default:r(()=>[d(l(E),null,{default:r(()=>[t("input",{type:"checkbox",onChange:z},null,32),e[8]||(e[8]=b(" Karyawan"))]),_:1,__:[8]}),y.value?(n(),m(l(E),{key:0},{default:r(()=>e[9]||(e[9]=[b("Detail")])),_:1,__:[9]})):$("",!0)]),_:1})]),_:1}),d(l(Z),null,{default:r(()=>[(n(!0),g(p,null,D(l(T),s=>(n(),m(l(V),{key:s.employee_id,class:"bg-white align-top hover:bg-gray-50"},{default:r(()=>[d(l(M),{class:"align-top"},{default:r(()=>[t("div",re,[t("input",{type:"checkbox",checked:l(_).includes(s.employee_id),onChange:()=>l(c).toggleSelect(s.employee_id),class:"mr-2 h-4 w-4"},null,40,de),t("span",ie,i(s.employee_name),1),t("span",{class:B(["rounded-md border px-2 py-0.5 text-[10px] font-semibold capitalize",s.status==="closed"?"border-green-300 bg-green-50 text-green-700":"border-yellow-300 bg-yellow-50 text-yellow-700"])},i(s.status),3)]),t("div",{class:B(["text-[11px] text-gray-700",y.value?"space-y-1":"grid sm:grid-cols-2 sm:gap-x-4"])},[t("div",ue,[e[10]||(e[10]=t("span",null,"Qty",-1)),t("span",ce,i(s.total_qty),1)]),t("div",ge,[e[11]||(e[11]=t("span",null,"Upah",-1)),t("span",pe,i(Number(s.total_upah).toLocaleString()),1)]),t("div",fe,[e[12]||(e[12]=t("span",null,"Makan",-1)),t("span",be,i(Number(s.uang_makan).toLocaleString()),1)]),t("div",_e,[e[13]||(e[13]=t("span",null,"Potongan",-1)),e[14]||(e[14]=t("div",{class:"mx-2 flex-grow border-b border-dotted"},null,-1)),w(t("input",{type:"number","onUpdate:modelValue":o=>s.potongan=o,onChange:o=>l(c).updatePotongan(s.employee_id,s.potongan),class:"w-20 border-b border-gray-300 bg-transparent text-right text-[11px] outline-none focus:border-gray-900"},null,40,ye),[[S,s.potongan,void 0,{number:!0}]])]),t("div",me,[e[15]||(e[15]=t("span",{class:"font-semibold text-gray-800"},"Total Gaji",-1)),t("span",xe,i(Number(s.total_gaji).toLocaleString()),1)])],2),t("div",he,[d(l(C),{variant:"outline",onClick:o=>l(c).closeSingle(s),disabled:s.status==="closed",class:"flex items-center gap-1 rounded bg-green-600 px-2 py-1 text-white hover:bg-green-700"},{default:r(()=>[s.status!=="closed"?(n(),m(l(W),{key:0,class:"h-4 w-4"})):(n(),m(l(N),{key:1,class:"h-4 w-4"})),e[16]||(e[16]=b(" Bayar "))]),_:2,__:[16]},1032,["onClick","disabled"])])]),_:2},1024),y.value?(n(),m(l(M),{key:0,class:"p-0 align-top sm:p-2"},{default:r(()=>{var o;return[t("table",ve,[(n(!0),g(p,null,D(O(s),(a,f)=>(n(),g(p,{key:f},[t("tr",ke,[t("td",we,"ðŸ“… "+i(U(f)),1)]),(n(!0),g(p,null,D(a,(v,j)=>(n(),g(p,{key:j},[t("tr",Ce,[t("td",De,"ðŸ§µ Model: "+i(j),1)]),(n(!0),g(p,null,D(v,k=>(n(),g("tr",{key:k.id,class:"border-b bg-white"},[t("td",Se,i(k.size_id)+" - "+i(k.variant),1),t("td",$e,i(Number(k.qty).toLocaleString()),1)]))),128))],64))),128))],64))),128)),(o=s.details)!=null&&o.length?$("",!0):(n(),g("tr",Te,e[17]||(e[17]=[t("td",{colspan:"4",class:"p-4 text-center text-gray-500"},"Tidak ada data rincian aktivitas.",-1)])))])]}),_:2},1024)):$("",!0)]),_:2},1024))),128))]),_:1})]),_:1})]),t("div",je,[d(l(C),{onClick:l(c).closePayroll,disabled:l(_).length===0,class:"bg-green-600 text-white"},{default:r(()=>[b(" Close Selected ("+i(l(_).length)+") ",1)]),_:1},8,["onClick","disabled"])])])]),_:1})],64))}});export{Ue as default};
