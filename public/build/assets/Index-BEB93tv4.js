import{R as J,b as w,d as K,r as N,T as O,q as Q,c as W,o as X,f as _,g,p as s,u as t,Z as Y,x as o,k as d,C as j,D as b,y as f,S as ee,F as P,B as E,E as te,j as q,z as ae,N as U}from"./app-iXEbDu6P.js";import{_ as se}from"./AppLayout.vue_vue_type_script_setup_true_lang-Dlsu-OXM.js";import{_ as h}from"./Input.vue_vue_type_script_setup_true_lang-DaxiX7n3.js";import{_ as le,a as oe,b as z,c as F,d as re,e as T}from"./TableRow.vue_vue_type_script_setup_true_lang-C-E4hGSa.js";import{u as ie}from"./useToast-DqVlk_ZM.js";import{P as de}from"./plus-De74T98i.js";import{S as ne}from"./square-pen-Dowy35T2.js";import{T as ue}from"./trash-2-CSHRcKDU.js";import"./index-C0GW4J6Q.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CrRI2qc5.js";const ce=J("sloc",{state:()=>({items:[],total:0,loaded:!1,loading:!1,currentPage:1,lastPage:1,filterName:""}),actions:{async fetchSlocs(m=1,l=50){this.loading=!0;try{const n=await w.get("/api/slocs",{params:{page:m,perPage:l,name:this.filterName}});this.items=n.data.data,this.total=n.data.total,this.currentPage=m,this.lastPage=n.data.last_page||1,this.loaded=!0}catch(n){console.error("Failed to fetch Slocs",n)}},setFilter(m,l){m==="name"&&(this.filterName=l,this.currentPage=1,this.fetchSlocs(1))},async createSloc(m,l){try{await w.post("/api/slocs",{id:m,name:l}),await this.fetchSlocs()}catch(n){throw n}},async updateSloc(m,l){try{await w.put(`/api/slocs/${m}`,{name:l}),await this.fetchSlocs()}catch(n){throw n}},async deleteSloc(m){try{await w.delete(`/api/slocs/${m}`),await this.fetchSlocs()}catch(l){throw l}}}}),me={class:"px-4 py-4"},fe={class:"flex justify-between items-center gap-2 mb-2"},pe={class:"rounded-md border"},ge={class:"flex justify-end mt-4 space-x-2"},be=["disabled"],_e=["onClick","disabled"],ye=["disabled"],he={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},ve={class:"bg-white p-6 rounded-lg w-96"},Se={class:"mb-4"},we={class:"mb-4"},xe={class:"flex justify-end gap-2"},ke={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Ce={class:"bg-white p-6 rounded-lg w-96"},Ve={class:"mb-4"},$e={class:"mb-4"},Ne={class:"flex justify-end gap-2"},De=K({__name:"Index",setup(m){const l=ie(),n=N(!1),v=N(!1),S=N(null),r=O({id:"",name:""}),I=[{title:"Sloc",href:"/slocs"}],u=ce(),{items:B,currentPage:y,lastPage:D,loading:x,filterName:k}=Q(u),C=W(()=>D.value||1),V=async i=>{i<1||i>C.value||await u.fetchSlocs(i)},M=()=>V(y.value+1),A=()=>V(y.value-1),R=async(i,e)=>{const a=e.target;u.setFilter(i,a.value),await u.fetchSlocs()};X(()=>{u.fetchSlocs()});const L=async()=>{var i,e,a,c;if(!r.id)return l.error("Id is required");if(!r.name)return l.error("Name is required");try{await u.createSloc(r.id,r.name),l.success("Sloc created successfully"),r.reset(),u.loaded=!1,await u.fetchSlocs(),n.value=!1}catch(p){const $=(c=(a=(e=(i=p==null?void 0:p.response)==null?void 0:i.data)==null?void 0:e.errors)==null?void 0:a.name)==null?void 0:c[0];l.error($||"Failed to create Sloc")}},Z=i=>{S.value=i,r.id=i.id,r.name=i.name,v.value=!0},G=async()=>{var i,e,a,c;if(!S.value||!r.name)return l.error("Name is required");try{await u.updateSloc(S.value.id,r.name),l.success("Sloc updated successfully"),r.reset(),u.loaded=!1,await u.fetchSlocs(),v.value=!1,S.value=null}catch(p){const $=(c=(a=(e=(i=p==null?void 0:p.response)==null?void 0:i.data)==null?void 0:e.errors)==null?void 0:a.name)==null?void 0:c[0];l.error($||"Failed to update Sloc")}},H=async i=>{var e,a;if(confirm("Are you sure you want to delete this Sloc?"))try{await u.deleteSloc(i),l.success("Sloc deleted successfully"),u.loaded=!1,await u.fetchSlocs()}catch(c){l.error(((a=(e=c==null?void 0:c.response)==null?void 0:e.data)==null?void 0:a.message)??"Failed to delete Sloc")}};return(i,e)=>(g(),_(P,null,[s(t(Y),{title:"Sloc Management"}),s(se,{breadcrumbs:I},{default:o(()=>[d("div",me,[d("div",fe,[s(t(b),{onClick:e[0]||(e[0]=a=>n.value=!0),class:"bg-indigo-600 text-white py-2 h-10 rounded-md hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:o(()=>[s(t(de),{class:"h-4 w-4"}),e[9]||(e[9]=f(" Add "))]),_:1,__:[9]}),s(t(h),{modelValue:t(k),"onUpdate:modelValue":e[1]||(e[1]=a=>ee(k)?k.value=a:null),placeholder:"Search",onInput:e[2]||(e[2]=a=>R("name",a)),class:"w-64","aria-label":"Search"},null,8,["modelValue"])]),d("div",pe,[s(t(le),null,{default:o(()=>[s(t(oe),null,{default:o(()=>[s(t(z),{class:"bg-gray-100"},{default:o(()=>[s(t(F),null,{default:o(()=>e[10]||(e[10]=[f("Id")])),_:1,__:[10]}),s(t(F),null,{default:o(()=>e[11]||(e[11]=[f("Name")])),_:1,__:[11]}),s(t(F),{class:"w-24"},{default:o(()=>e[12]||(e[12]=[f("Actions")])),_:1,__:[12]})]),_:1})]),_:1}),s(t(re),null,{default:o(()=>[(g(!0),_(P,null,E(t(B),a=>(g(),te(t(z),{key:a.id},{default:o(()=>[s(t(T),null,{default:o(()=>[f(q(a.id),1)]),_:2},1024),s(t(T),null,{default:o(()=>[f(q(a.name),1)]),_:2},1024),s(t(T),{class:"flex gap-2"},{default:o(()=>[s(t(b),{variant:"ghost",size:"icon",onClick:c=>Z(a)},{default:o(()=>[s(t(ne),{class:"h-4 w-4"})]),_:2},1032,["onClick"]),s(t(b),{variant:"ghost",size:"icon",onClick:c=>H(a.id)},{default:o(()=>[s(t(ue),{class:"h-4 w-4"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),d("div",ge,[d("button",{onClick:A,disabled:t(y)===1||t(x),class:"px-3 py-1 rounded border border-gray-300 text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed"}," Previous ",8,be),(g(!0),_(P,null,E(C.value,a=>(g(),_("button",{key:a,onClick:c=>V(a),class:ae(["px-3 py-1 rounded border text-sm",a===t(y)?"bg-blue-600 border-blue-600 text-white":"border-gray-300 text-gray-700 hover:bg-gray-100"]),disabled:t(x)},q(a),11,_e))),128)),d("button",{onClick:M,disabled:t(y)===C.value||t(x),class:"px-3 py-1 rounded border border-gray-300 text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed"}," Next ",8,ye)]),n.value?(g(),_("div",he,[d("div",ve,[e[15]||(e[15]=d("h2",{class:"text-lg font-semibold mb-4"},"Tambah Data",-1)),d("form",{onSubmit:U(L,["prevent"])},[d("div",Se,[s(t(h),{modelValue:t(r).id,"onUpdate:modelValue":e[3]||(e[3]=a=>t(r).id=a),placeholder:"Sloc Id",required:""},null,8,["modelValue"])]),d("div",we,[s(t(h),{modelValue:t(r).name,"onUpdate:modelValue":e[4]||(e[4]=a=>t(r).name=a),placeholder:"Sloc Name",required:""},null,8,["modelValue"])]),d("div",xe,[s(t(b),{type:"button",variant:"outline",onClick:e[5]||(e[5]=a=>n.value=!1),class:"h-10"},{default:o(()=>e[13]||(e[13]=[f("Cancel")])),_:1,__:[13]}),s(t(b),{type:"submit",class:"bg-indigo-600 text-white py-2 h-10 rounded-md hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:o(()=>e[14]||(e[14]=[f("Create")])),_:1,__:[14]})])],32)])])):j("",!0),v.value?(g(),_("div",ke,[d("div",Ce,[e[18]||(e[18]=d("h2",{class:"text-lg font-semibold mb-4"},"Edit Sloc",-1)),d("form",{onSubmit:U(G,["prevent"])},[d("div",Ve,[s(t(h),{modelValue:t(r).id,"onUpdate:modelValue":e[6]||(e[6]=a=>t(r).id=a),placeholder:"ID",required:"",readonly:""},null,8,["modelValue"])]),d("div",$e,[s(t(h),{modelValue:t(r).name,"onUpdate:modelValue":e[7]||(e[7]=a=>t(r).name=a),placeholder:"Sloc Name",required:""},null,8,["modelValue"])]),d("div",Ne,[s(t(b),{type:"button",variant:"outline",onClick:e[8]||(e[8]=a=>v.value=!1),class:"h-10"},{default:o(()=>e[16]||(e[16]=[f("Cancel")])),_:1,__:[16]}),s(t(b),{type:"submit",class:"bg-indigo-600 text-white py-2 h-10 rounded-md hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:o(()=>e[17]||(e[17]=[f("Update")])),_:1,__:[17]})])],32)])])):j("",!0)])]),_:1})],64))}});export{De as default};
