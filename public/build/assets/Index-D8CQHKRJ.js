import{d as M,q as O,r as y,c as E,o as K,f as d,g as r,p as i,u as s,Z as Q,x as g,k as e,D as v,y as G,G as U,F as x,B as C,j as l,E as T,C as z,z as Z}from"./app-BGUw9NKa.js";import{_ as H}from"./Input.vue_vue_type_script_setup_true_lang-pQNImMyg.js";import{u as J}from"./useToast-eTzcmQHW.js";import{_ as W}from"./AppLayout.vue_vue_type_script_setup_true_lang--tbvp-Gs.js";import{u as X}from"./useProductionStore-Chu0WdQ9.js";import{P as Y}from"./plus-BPeqLBzg.js";import{S as tt}from"./square-pen-CXY2zrPi.js";import{T as et}from"./trash-2-DZ0MP6yH.js";import{V as st}from"./view-BMvKPf7e.js";import"./index-Buhm6de5.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-Mt7YJZb_.js";const at={class:"px-3 py-4"},ot={class:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3"},rt={class:"flex flex-1 gap-2"},dt={key:0,class:"py-4 text-center text-sm text-gray-500"},nt={key:1,class:"space-y-2"},it={class:"overflow-x-auto rounded-md border border-gray-200 dark:border-gray-700"},lt={class:"min-w-full table-auto text-sm text-left text-gray-800 dark:text-gray-100"},ct={class:"px-3 py-2 max-w-[160px] truncate"},ut={class:"px-3 py-2 truncate"},pt={class:"px-3 py-2 whitespace-nowrap"},yt={key:0},gt={key:1},_t={class:"px-3 py-2 max-w-[160px] truncate"},ht={class:"px-3 py-2 max-w-[160px] truncate"},vt={class:"px-3 py-2 whitespace-nowrap"},xt={class:"px-3 py-2 text-right"},ft={class:"flex justify-end gap-1 sm:gap-2"},bt={class:"flex justify-end mt-4 space-x-2"},mt=["disabled"],kt=["onClick","disabled"],wt=["disabled"],Bt=M({__name:"Index",props:{activity_role:{}},setup(F){const f=J(),_=X(),{productions:I,currentPage:c,lastPage:N,loading:h}=O(_),$=y(10),S=y("created_at"),B=y("desc"),b=F,j=[{title:"Production",href:`/production/${b.activity_role}`}],m=E(()=>N.value||1),k=async a=>{a<1||a>m.value||await _.fetchProductions({page:a,per_page:$.value,sort_field:S.value})},A=()=>k(c.value+1),R=()=>k(c.value-1),w=y(""),D=y({from:null,to:null});function q(a){return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a)}const P=async()=>{var a,o,t,n;try{await _.fetchProductions({page:c.value,per_page:$.value,sort_field:S.value,sort_order:B.value,activity_role_id:b.activity_role,search:w.value,date_from:(a=D.value.from)==null?void 0:a.toISOString(),date_to:(o=D.value.to)==null?void 0:o.toISOString()})}catch(u){f.error(((n=(t=u==null?void 0:u.response)==null?void 0:t.data)==null?void 0:n.message)??"Failed to fetch productions")}};K(P);const L=async a=>{var o,t;if(confirm("Are you sure you want to delete this production?"))try{await _.deleteProduction(a),f.success("Production deleted successfully"),await P()}catch(n){f.error(((t=(o=n==null?void 0:n.response)==null?void 0:o.data)==null?void 0:t.message)??"Failed to delete production")}};return(a,o)=>(r(),d(x,null,[i(s(Q),{title:"Production Management"}),i(W,{breadcrumbs:j},{default:g(()=>[e("div",at,[e("div",ot,[e("div",rt,[i(s(v),{onClick:o[0]||(o[0]=t=>a.$inertia.visit(`/production/${b.activity_role}/create`)),class:"flex-shrink-0 flex items-center gap-2 rounded-md bg-indigo-600 px-3 py-2 text-sm font-medium text-white hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:g(()=>[i(s(Y),{class:"h-4 w-4"}),o[2]||(o[2]=G(" Tambah Data "))]),_:1,__:[2]}),i(s(H),{modelValue:w.value,"onUpdate:modelValue":o[1]||(o[1]=t=>w.value=t),placeholder:"Search...",class:"flex-1 text-sm",onKeyup:U(P,["enter"])},null,8,["modelValue"])])]),s(h)?(r(),d("div",dt,"Loading...")):(r(),d("div",nt,[e("div",it,[e("table",lt,[o[3]||(o[3]=e("thead",{class:"bg-gray-100 dark:bg-gray-800 text-xs font-semibold uppercase text-gray-600 dark:text-gray-300"},[e("tr",null,[e("th",{class:"px-3 py-2"},"Model"),e("th",{class:"px-3 py-2"},"Activity"),e("th",{class:"px-3 py-2"},"Size/Qty"),e("th",{class:"px-3 py-2"},"Price/PCS"),e("th",{class:"px-3 py-2"},"Total"),e("th",{class:"px-3 py-2"},"Created At"),e("th",{class:"px-3 py-2 text-right"},"Actions")])],-1)),e("tbody",null,[(r(!0),d(x,null,C(s(I),t=>{var n,u,V;return r(),d("tr",{key:t.id,class:"border-b border-gray-100 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800"},[e("td",ct,l(((n=t.model)==null?void 0:n.description)||"-"),1),e("td",ut,l(((u=t.activity_role)==null?void 0:u.name)||"-"),1),e("td",pt,[(V=t.items)!=null&&V.length?(r(),d("div",yt,[(r(!0),d(x,null,C(t.items,p=>(r(),d("div",{key:p.id},l(p.size_id)+": "+l(p.qty),1))),128))])):(r(),d("div",gt,"-"))]),e("td",_t,l(q((t==null?void 0:t.price_per_pcs)||0)),1),e("td",ht,l((t==null?void 0:t.total_price)||0),1),e("td",vt,l(t.created_at?new Date(t.created_at).toLocaleDateString():"-"),1),e("td",xt,[e("div",ft,[t.status===1||t.status===3?(r(),T(s(v),{key:0,variant:"ghost",size:"icon",class:"hover:bg-gray-100 dark:hover:bg-gray-700",onClick:p=>a.$inertia.visit(`/production/${t.activity_role_id}/edit/${t.id}`)},{default:g(()=>[i(s(tt),{class:"h-4 w-4"})]),_:2},1032,["onClick"])):z("",!0),t.status===1||t.status===3?(r(),T(s(v),{key:1,variant:"ghost",size:"icon",class:"hover:bg-gray-100 dark:hover:bg-gray-700",onClick:p=>L(t.id)},{default:g(()=>[i(s(et),{class:"h-4 w-4"})]),_:2},1032,["onClick"])):z("",!0),i(s(v),{variant:"ghost",size:"icon",class:"hover:bg-gray-100 dark:hover:bg-gray-700",onClick:p=>a.$inertia.visit(`/production/${t.activity_role_id}/view/${t.id}`)},{default:g(()=>[i(s(st),{class:"h-4 w-4"})]),_:2},1032,["onClick"])])])])}),128))])])]),e("div",bt,[e("button",{onClick:R,disabled:s(c)===1||s(h),class:"px-3 py-1 rounded border border-gray-300 text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed"}," Previous ",8,mt),(r(!0),d(x,null,C(m.value,t=>(r(),d("button",{key:t,onClick:n=>k(t),class:Z(["px-3 py-1 rounded border text-sm",t===s(c)?"bg-blue-600 border-blue-600 text-white":"border-gray-300 text-gray-700 hover:bg-gray-100"]),disabled:s(h)},l(t),11,kt))),128)),e("button",{onClick:A,disabled:s(c)===m.value||s(h),class:"px-3 py-1 rounded border border-gray-300 text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed"}," Next ",8,wt)])]))])]),_:1})],64))}});export{Bt as default};
