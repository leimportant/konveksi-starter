import{d as De,q as Ge,T as Ut,o as Xe,f as d,g as u,k as t,l as A,C as $,m as V,u as l,j as i,U as Se,F as N,B as E,N as Mt,r as p,c as H,e as It,p as n,G as et,D as P,x as r,y as m,M as ie,Q as Vt,w as Te,Z as Bt,E as je,z as We,b as ae,n as Rt,_ as Lt}from"./app-qn_G01E-.js";import{_ as Ot}from"./Input.vue_vue_type_script_setup_true_lang-CHQ8paVZ.js";import{_ as He,a as Je,b as me,c as K,d as Ye,e as I}from"./TableRow.vue_vue_type_script_setup_true_lang-D72T-OV-.js";import{u as Ae}from"./useToast-D8jireKc.js";import{_ as Kt}from"./AppLayout.vue_vue_type_script_setup_true_lang-DiAO8Iln.js";import{A as Et}from"./vue3-select-CmMvCLoQ.js";import{U as Ft,_ as Qt}from"./vue-qrcode-reader-BqYIQDT_.js";import{u as tt}from"./useProductStore-CiGezJgj.js";import{u as Gt}from"./useCategoryStore-DILZCiUC.js";import{u as Wt}from"./useSizeStore-DVjvTO8g.js";import{S as Ht,L as Jt,a as Yt,P as Zt}from"./store-BiY8QGAr.js";import{u as Xt}from"./useCurrencyInput-eyDD4hNO.js";import{P as es}from"./plus-B8Zn3E8m.js";import{P as ts,S as ss,U as as,R as ls}from"./user-plus-DHooyQ_W.js";import{P as ns}from"./printer-check-CzG5_vcE.js";import{T as Ze}from"./trash-2-CXZyBmVY.js";import"./index-BlHW5UyZ.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CwZMcTec.js";const os={class:"p-4 bg-white rounded-lg shadow-md"},is={class:"mb-3"},rs={key:0,class:"mt-1 text-sm text-red-600"},us={class:"mb-3"},ds=["value"],cs={key:0,class:"mt-1 text-sm text-red-600"},ps={class:"mb-4 mt-6 border-t pt-4"},vs={class:"mb-4 rounded-md bg-gray-50 p-3 shadow-sm"},fs={class:"grid grid-cols-1 gap-3 md:grid-cols-2 lg:grid-cols-3"},ms=["value"],gs={key:0,class:"mt-1 text-sm text-red-600"},_s={key:0,class:"mt-1 text-sm text-red-600"},ys={key:0,class:"mt-1 text-sm text-red-600"},xs={key:0,class:"mt-1 text-sm text-red-600"},bs={key:0,class:"mt-1 text-sm text-red-600"},hs={class:"flex justify-end mt-6"},ws=["disabled"],st=De({__name:"AddProductUnlisted",setup(Ne){const Z=tt(),F=Ae(),X=Gt(),J=Wt(),{items:w}=Ge(X),{sizes:B}=Ge(J),_=Ut({name:"",category_id:"",size_id:null,variant:"",qty:1,price_store:0,price_grosir:0}),k=async()=>{try{await Z.saveProductUnlisted(_.data()),F.success("Produk custom berhasil disimpan!"),_.reset()}catch(T){F.error(T.message||"Gagal menyimpan produk custom.")}};return Xe(async()=>{await X.fetchCategories(),await J.fetchSizes()}),(T,c)=>(u(),d("div",os,[c[17]||(c[17]=t("h3",{class:"text-lg font-semibold mb-4"},"Tambah Produk Custom",-1)),t("form",{onSubmit:Mt(k,["prevent"])},[t("div",is,[c[7]||(c[7]=t("label",{for:"name",class:"block text-sm font-medium text-gray-700"},"Nama Produk",-1)),A(t("input",{type:"text",id:"name","onUpdate:modelValue":c[0]||(c[0]=b=>l(_).name=b),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:""},null,512),[[V,l(_).name]]),l(_).errors.name?(u(),d("p",rs,i(l(_).errors.name),1)):$("",!0)]),t("div",us,[c[9]||(c[9]=t("label",{for:"category_id",class:"block text-sm font-medium text-gray-700"},"Category",-1)),A(t("select",{id:"category_id","onUpdate:modelValue":c[1]||(c[1]=b=>l(_).category_id=b),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:""},[c[8]||(c[8]=t("option",{value:"",disabled:""},"Pilih Kategori",-1)),(u(!0),d(N,null,E(l(w),b=>(u(),d("option",{key:b.id,value:b.id},i(b.name),9,ds))),128))],512),[[Se,l(_).category_id]]),l(_).errors.category_id?(u(),d("p",cs,i(l(_).errors.category_id),1)):$("",!0)]),t("div",ps,[c[16]||(c[16]=t("h4",{class:"text-md font-semibold mb-3"},"Detail Produk (Ukuran & Harga)",-1)),t("div",vs,[t("div",fs,[t("div",null,[c[11]||(c[11]=t("label",{for:"size_id",class:"block text-sm font-medium text-gray-700"},"Size",-1)),A(t("select",{id:"size_id","onUpdate:modelValue":c[2]||(c[2]=b=>l(_).size_id=b),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:""},[c[10]||(c[10]=t("option",{value:"",disabled:""},"Pilih Ukuran",-1)),(u(!0),d(N,null,E(l(B),b=>(u(),d("option",{key:b.id,value:b.id},i(b.name),9,ms))),128))],512),[[Se,l(_).size_id]]),l(_).errors.size_id?(u(),d("p",gs,i(l(_).errors.size_id),1)):$("",!0)]),t("div",null,[c[12]||(c[12]=t("label",{for:"variant",class:"block text-sm font-medium text-gray-700"},"Variant",-1)),A(t("input",{type:"text",id:"variant","onUpdate:modelValue":c[3]||(c[3]=b=>l(_).variant=b),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:""},null,512),[[V,l(_).variant]]),l(_).errors.variant?(u(),d("p",_s,i(l(_).errors.variant),1)):$("",!0)]),t("div",null,[c[13]||(c[13]=t("label",{for:"qty",class:"block text-sm font-medium text-gray-700"},"Quantity",-1)),A(t("input",{type:"number",id:"qty","onUpdate:modelValue":c[4]||(c[4]=b=>l(_).qty=b),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:""},null,512),[[V,l(_).qty,void 0,{number:!0}]]),l(_).errors.qty?(u(),d("p",ys,i(l(_).errors.qty),1)):$("",!0)]),t("div",null,[c[14]||(c[14]=t("label",{for:"price_store",class:"block text-sm font-medium text-gray-700"},"Harga Toko",-1)),A(t("input",{type:"number",id:"price_store","onUpdate:modelValue":c[5]||(c[5]=b=>l(_).price_store=b),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:""},null,512),[[V,l(_).price_store,void 0,{number:!0}]]),l(_).errors.price_store?(u(),d("p",xs,i(l(_).errors.price_store),1)):$("",!0)]),t("div",null,[c[15]||(c[15]=t("label",{for:"price_grosir",class:"block text-sm font-medium text-gray-700"},"Harga Grosir",-1)),A(t("input",{type:"number",id:"price_grosir","onUpdate:modelValue":c[6]||(c[6]=b=>l(_).price_grosir=b),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:""},null,512),[[V,l(_).price_grosir,void 0,{number:!0}]]),l(_).errors.price_grosir?(u(),d("p",bs,i(l(_).errors.price_grosir),1)):$("",!0)])])])]),t("div",hs,[t("button",{type:"submit",class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",disabled:l(_).processing},i(l(_).processing?"Saving...":"Simpan Produk"),9,ws)])],32)]))}}),ks={class:"p-6 bg-white rounded-xl shadow-md border border-gray-200"},$s={class:"mb-4 flex flex-col sm:flex-row justify-between items-center gap-3"},Cs={key:0,class:"py-8 text-center text-purple-600 text-lg font-medium"},qs={key:1,class:"py-8 text-center text-gray-500"},Ps={key:2,class:"overflow-x-auto rounded-lg border border-gray-200"},zs={class:"min-w-full divide-y divide-gray-200"},Ts={class:"bg-white divide-y divide-gray-200"},js={class:"px-4 py-4 align-top"},Ss={class:"px-4 py-4 align-top"},Ds={class:"flex flex-col gap-3 w-full text-sm bg-gradient-to-br from-gray-50 to-purple-50 rounded-xl p-4 border border-gray-200 shadow-sm backdrop-blur-sm"},As={class:"flex justify-between items-center"},Ns={class:"font-semibold text-gray-900"},Us={class:"flex justify-between items-center"},Ms={class:"font-semibold text-gray-900"},Is={class:"flex justify-between items-center"},Vs={class:"font-semibold text-gray-900"},Bs={class:"flex justify-between items-center"},Rs={class:"font-bold text-purple-700"},Ls={class:"flex justify-between items-center"},Os={class:"font-bold text-purple-700"},Ks={class:"px-4 py-4 text-right align-top"},Es={class:"mt-6 flex items-center justify-between"},Fs={class:"text-sm text-gray-600"},Qs={class:"flex items-center gap-2"},Gs=De({__name:"ListProductUnlisted",emits:["add-unlisted-to-cart"],setup(Ne,{emit:Z}){const F=Ae(),X=tt(),J=Z,w=p([]),B=p(!1),_=p(""),k=p(!1),T=p({current_page:1,per_page:50,total:0}),c=H(()=>Math.ceil(T.value.total/T.value.per_page)),b=async(Q=1)=>{B.value=!0;try{const g=await X.fetchProductUnlisted(Q,T.value.per_page,_.value);w.value=g.data.map(D=>({...D,category:{name:D.category_name},size:{name:D.size_id}})),T.value.current_page=g.current_page,T.value.per_page=g.per_page,T.value.total=g.total}catch(g){console.log(g),F.error("Failed to fetch unlisted products.")}finally{B.value=!1}},ge=Q=>{Q>=1&&Q<=c.value&&b(Q)},ce=Q=>{J("add-unlisted-to-cart",{...Q,is_unlisted:!0})},_e=()=>{k.value=!1,b(T.value.current_page),F.success("Produk tanpa master berhasil ditambahkan.")};return Xe(()=>b()),(Q,g)=>{const D=It("Category");return u(),d("div",ks,[g[13]||(g[13]=t("h3",{class:"text-xl font-semibold mb-4 text-gray-800"},"Daftar Produk Tanpa Master",-1)),t("div",$s,[A(t("input",{"onUpdate:modelValue":g[0]||(g[0]=j=>_.value=j),type:"text",placeholder:"Cari produk...",class:"w-full sm:w-64 rounded-lg border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500",onKeyup:g[1]||(g[1]=et(j=>b(),["enter"]))},null,544),[[V,_.value]]),n(l(P),{onClick:g[2]||(g[2]=j=>k.value=!0),class:"w-full sm:w-auto flex items-center gap-2 bg-purple-600 text-white hover:bg-purple-700 transition rounded-md"},{default:r(()=>g[6]||(g[6]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),m(" Tambah Produk Baru ")])),_:1,__:[6]})]),B.value?(u(),d("div",Cs," Loading products... ")):w.value.length?(u(),d("div",Ps,[t("table",zs,[g[9]||(g[9]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-semibold text-gray-600"},"Produk"),t("th",{class:"px-4 py-3 text-left text-xs font-semibold text-gray-600"},"Detail"),t("th",{class:"px-4 py-3"})])],-1)),t("tbody",Ts,[(u(!0),d(N,null,E(w.value,j=>{var h;return u(),d("tr",{key:j.id,class:"hover:bg-gray-50 transition"},[t("td",js,i(j.name),1),t("td",Ss,[t("div",Ds,[t("div",As,[n(D,{class:"w-4 h-4 text-purple-600"}),t("span",Ns,i(((h=j.category)==null?void 0:h.name)||"-"),1)]),t("div",Us,[n(l(Ht),{class:"w-4 h-4 text-blue-600"}),t("span",Ms,i(j.size_id),1)]),t("div",Is,[n(l(Jt),{class:"w-4 h-4 text-green-600"}),t("span",Vs,i(j.variant||"-"),1)]),g[7]||(g[7]=t("div",{class:"border-t my-2"},null,-1)),t("div",Bs,[n(l(Yt),{class:"w-4 h-4 text-purple-700"}),t("span",Rs,i(Number(j.price_store).toLocaleString()),1)]),t("div",Ls,[n(l(Zt),{class:"w-4 h-4 text-purple-700"}),t("span",Os,i(Number(j.price_grosir).toLocaleString()),1)])])]),t("td",Ks,[n(l(P),{onClick:Ue=>ce(j),size:"sm",class:"bg-green-600 hover:bg-green-700 text-white rounded-md shadow-sm px-3 py-1 text-xs"},{default:r(()=>g[8]||(g[8]=[m(" Tambah ")])),_:2,__:[8]},1032,["onClick"])])])}),128))])])])):(u(),d("div",qs," Tidak ada produk tanpa master ditemukan. ")),t("div",Es,[t("span",Fs," Page "+i(T.value.current_page)+" dari "+i(c.value),1),t("div",Qs,[n(l(P),{onClick:g[3]||(g[3]=j=>ge(T.value.current_page-1)),disabled:T.value.current_page===1||B.value,variant:"outline",class:"px-4 py-2 border border-gray-300 text-sm text-gray-700 disabled:opacity-50"},{default:r(()=>g[10]||(g[10]=[m(" Previous ")])),_:1,__:[10]},8,["disabled"]),n(l(P),{onClick:g[4]||(g[4]=j=>ge(T.value.current_page+1)),disabled:T.value.current_page>=c.value||B.value,variant:"outline",class:"px-4 py-2 border border-gray-300 text-sm text-gray-700 disabled:opacity-50"},{default:r(()=>g[11]||(g[11]=[m(" Next ")])),_:1,__:[11]},8,["disabled"])])]),n(ie,{show:k.value,onClose:g[5]||(g[5]=j=>k.value=!1)},{header:r(()=>g[12]||(g[12]=[t("h3",{class:"text-lg font-medium text-gray-900"},"Tambah Produk Tanpa Master",-1)])),default:r(()=>[n(st,{onProductSaved:_e})]),_:1},8,["show"])])}}}),Ws={class:"min-h-screen space-y-4 bg-gray-50 p-2 md:p-4"},Hs={class:"grid grid-cols-1 gap-3 md:grid-cols-5 md:gap-2"},Js={class:"flex flex-col md:col-span-2 lg:col-span-2"},Ys={class:"mb-2 flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between"},Zs={class:"flex flex-col gap-2 md:gap-3"},Xs=["onClick"],ea={class:"flex-shrink-0"},ta=["src"],sa={key:1,class:"flex h-16 w-16 select-none items-center justify-center rounded bg-gray-200 text-xs text-gray-400"},aa={class:"flex min-w-0 flex-1 flex-col justify-between"},la={class:"flex items-center gap-2"},na={class:"flex-1 truncate text-xs font-semibold text-gray-900 md:text-sm"},oa={key:0,class:"ml-1 rounded bg-orange-500 px-2 py-0.5 text-[14px] font-bold text-white md:text-xs"},ia={class:"text-[10px] text-gray-400 md:text-xs"},ra={key:0,class:"mt-2"},ua={class:"mt-1 flex flex-wrap gap-2"},da={class:"text-[10px] text-gray-400 line-through md:text-xs"},ca={class:"text-xs font-semibold text-green-600 md:text-sm"},pa={class:"text-[10px] text-green-500 md:text-xs"},va={key:1,class:"text-xs font-semibold text-gray-700 md:text-sm"},fa={class:"flex flex-col bg-gray-100 md:col-span-2 lg:col-span-3"},ma={class:"flex flex-wrap gap-1 p-2 md:gap-1"},ga={key:0,class:"select-none py-8 text-center text-xs text-gray-400"},_a={class:"overflow-auto p-2"},ya={class:"md-grid-cols-2 relative flex grid-cols-1 items-center justify-center"},xa=["checked","onChange"],ba={class:"max-w-[140px] truncate font-semibold text-gray-900"},ha={class:"max-w-[140px] truncate font-semibold text-gray-900"},wa={key:0,class:"text-[10px] text-gray-400 line-through"},ka={class:"block font-semibold text-gray-900"},$a={class:"text-[11px] text-gray-600"},Ca={key:1,class:"text-[11px] text-green-600"},qa=["max","onUpdate:modelValue"],Pa={key:1,class:"mt-4 flex flex-col items-start gap-2 rounded-xl bg-gray-100 p-4 shadow-sm sm:flex-row sm:items-center sm:justify-between"},za={class:"text-xs text-gray-800"},Ta={class:"text-xs text-gray-600"},ja={class:"text-xs text-gray-800"},Sa={class:"mt-2 gap-4 rounded-lg p-1 p-4 shadow-sm"},Da=["value"],Aa={class:"mt-4 gap-4 border-t p-4 pt-2"},Na={class:"mb-2 flex justify-between text-xs font-semibold text-gray-700"},Ua={class:"font-bold"},Ma={key:0},Ia={key:1},Va={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 p-4"},Ba={class:"w-full max-w-xs rounded-xl bg-white p-6 shadow-lg"},Ra={class:"flex justify-end gap-3"},La={key:1,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 p-4"},Oa={class:"w-full max-w-sm rounded-lg bg-white p-6 shadow-lg"},Ka={class:"mb-4 flex justify-between"},Ea={class:"font-semibold"},Fa={class:"mb-4 flex justify-between"},Qa={class:"font-semibold text-green-600"},Ga={class:"flex justify-end space-x-3"},Wa={class:"h-64 w-full"},Ha={key:0,class:"space-y-4"},Ja={class:"flex items-center gap-4"},Ya=["src"],Za={key:1,class:"flex h-24 w-24 select-none items-center justify-center rounded bg-gray-200 text-xs text-gray-400"},Xa={class:"text-lg font-semibold"},el={class:"flex flex-wrap gap-2"},tl=["onClick"],sl=["onClick"],al={key:0,class:"mb-4"},ll={class:"flex flex-wrap gap-2"},nl=["onClick"],ol={class:"mb-4"},il={key:0,class:"mb-4 text-sm text-gray-700"},rl={key:0,class:"mr-2 text-gray-400 line-through"},ul={class:"font-bold"},dl={key:1,class:"text-xs text-green-600"},cl={class:"flex justify-end gap-2"},pl={class:"mb-4 flex flex-col items-stretch gap-2 sm:flex-row sm:items-center"},vl={class:"max-h-[60vh] overflow-auto rounded-lg border border-gray-200 shadow-sm"},fl={class:"space-y-2"},ml={class:"mt-2 flex justify-end gap-2"},gl={key:0,class:"mt-1 text-xs text-red-600"},_l={key:1,class:"mt-1 text-xs text-red-600"},yl={key:2,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-30 p-4"},xl={class:"text-center"},bl={class:"text-[12px] font-bold"},hl={class:"mb-1"},wl={class:"font-bold"},kl={class:"flex justify-between p-1"},$l={key:0},Cl={class:"flex justify-between"},ql={class:"text-green-600"},Pl={class:"flex justify-between"},zl={class:"flex justify-between"},Tl={class:"flex justify-between"},jl={class:"flex justify-between"},Sl={class:"flex justify-between"},Dl={class:"no-print mt-2 flex justify-end gap-2"},Al=De({__name:"POS",setup(Ne){const Z=p(!1),F=p(!1),X=p(!1),J=p(!1),w=Ae(),B=p([]),_=p([]),k=p([]),T=p([]),c=p(null),b=p({placingOrder:!1}),ge=Xt(0),ce=p(""),_e=p(1),Q=p(1),g=p(0),D=p([]),j=p(!1),h=p(null);function Ue(s){h.value=s,W.value=null,M.value=null,h.value.variant==="all"&&h.value.sizes&&h.value.sizes.length>0&&(M.value=h.value.sizes[0].size_id),j.value=!0}const ye=p(!1),xe=p(!1),R=p(null),U=p(null),L=p([]),ee=p(0),re=p(""),ue=p(""),G=p(""),ke=p(null),at=p(null),$e=p(!1),Ce=p(!1),pe=p(""),ve=p([]),Me=p(null),fe=p(null),de=p(1),le=p(0),te=p(""),be=p(!1),W=p(null),M=p(null);async function lt(){try{const s=await ae.get("/api/orders/search",{params:{search:pe.value}});ve.value=s.data.data}catch(s){console.error("Error searching transactions:",s),alert("Failed to search transactions.")}}async function nt(s){confirm("Yakin mau tampilkan struk untuk dicetak ulang?")&&(Me.value=s,ue.value=ze(s.created_at),G.value=s.id,U.value=s.customer,L.value=s.order_items.map(e=>({product_id:e.product_id,product_name:e.product_name,quantity:Number(e.quantity),price:Number(e.price),discount:Number(e.discount),price_sell:Number(e.price_sell),variant:e.variant||"",uom_id:e.uom_id,size_id:e.size_id,qty_stock:e.qty_stock,image_path:e.image_path})),ee.value=s.total_amount,re.value=s.payment_method,S.value=s.paid_amount,ye.value=!0,Ve())}const S=p(null),Ie=H(()=>S.value===null?0:S.value-O.value>0?S.value-O.value:0),ot=H(()=>{var e;if(!((e=h.value)!=null&&e.sizes))return[];const s=h.value.sizes.map(a=>a.variant);return[...new Set(s)]}),it=async s=>{if(s.length<2){B.value=[];return}try{const e=await ae.get("/api/product-with-size",{params:{search:s}});_.value=e.data.data}catch(e){console.error("Search error:",e),w.error("Failed to search products")}};function rt(s,e){return s?s.filter(a=>a.variant===e):[]}function ut(s,e){s&&(s.size_id=e.size_id,M.value=e.size_id),h.value&&(h.value.price=e.price,h.value.price_sell=e.price_sell)}function dt(){$e.value=!0}function ct(){Ce.value=!0,ve.value=[],pe.value=""}const pt=H(()=>h.value?h.value.variant==="all"?h.value.sizes.map(s=>s):W.value?h.value.sizes.filter(s=>s.variant===W.value):[]:[]);function qe(){$e.value=!1,fe.value=null,de.value=1,le.value=0,te.value="",be.value=!1}function Ve(){Ce.value=!1,pe.value="",ve.value=[],Me.value=null}async function vt(){if(te.value="",be.value=!1,!fe.value){te.value="Produk harus dipilih";return}const s=fe.value;if(!s||!s.id){te.value="Produk harus dipilih";return}if(!de.value||de.value<1){te.value="Qty minimal 1";return}if(!le.value||le.value<0){te.value="Harga retur harus diisi";return}k.value.push({id:s.id,product_id:s.id,product_name:s.product_name??"",size_id:s.size_id??"",uom_id:s.uom_id??"",qty_stock:0,qty_available:0,image_path:"",sizes:[],variant:null,quantity:-Math.abs(de.value),price:le.value,price_sell:le.value,isReturn:!0}),be.value=!0,setTimeout(()=>{qe()},1e3)}const ne=p("TOKO ANINKA"),oe=p("Blok A lantai SLG Los F No 91-92"),he=Vt().props.auth.user,ft=he==null?void 0:he.location_id;async function mt(){if(ft)try{const s=await ae.get("/api/locations/get");ne.value=s.data.name||"TOKO ANINKA",oe.value=s.data.address||"Blok A lantai SLG Los F No 91-92"}catch{ne.value="TOKO ANINKA",oe.value="Blok A lantai SLG Los F No 91-92"}}mt();const gt=H(()=>L.value.reduce((s,e)=>s+(e.discount??0)*e.quantity,0)),_t=H(()=>L.value.reduce((s,e)=>s+e.price*e.quantity,0)),we=p(!1),Pe=H(()=>he.name??"Kasir"),Be=s=>s?s.startsWith("storage/")?"/"+s:s.startsWith("/storage/")?s:"/storage/"+s:"",y=s=>typeof s!="number"||isNaN(s)?"0,00":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s),yt=s=>{const e=D.value.indexOf(s);e===-1?D.value.push(s):D.value.splice(e,1)},se=H(()=>!M.value||!h.value?null:h.value.variant==="all"?h.value.sizes.find(s=>s.size_id===M.value):W.value?h.value.sizes.find(s=>s.variant===W.value&&s.size_id===M.value):null);async function Re(){try{const s=await ae.get(`/api/stock?page=${_e.value}&search=${ce.value}`);B.value=s.data.data,Q.value=s.data.last_page}catch(s){console.error("Error fetching products:",s),w.error("Failed to fetch products")}}async function xt(){try{const s=await ae.get("/api/payment-methods");T.value=s.data.data}catch{w.error("Failed to fetch payment methods")}}function bt(){_e.value=1,Re()}const Le=s=>{if(!s.is_unlisted&&s.qty_stock<=0){w.error("Stok tidak cukup");return}if(s.price<=0&&(!s.price_sell||s.price_sell<=0)){w.error("Harga produk belum ditentukan");return}let e;if(s.sizes&&s.sizes.length>0){if(!M.value){w.error("Silahkan pilih ukuran terlebih dahulu");return}if(e=s.sizes.find(o=>o.size_id===M.value&&(W.value===null||o.variant===W.value)),!s.is_unlisted&&(!e||e.qty_stock<=0)){w.error("Stok ukuran ini tidak tersedia");return}}const a=1,f=e==null?void 0:e.price_retail,v=e==null?void 0:e.price_sell_retail,z=e==null?void 0:e.discount_retail;if(s.sizes.length&&!e){w.error("Ukuran tidak valid.");return}const x={id:s.product_id||s.id,product_id:s.product_id||s.id,product_name:s.product_name,uom_id:s.uom_id,size_id:(e==null?void 0:e.size_id)??"",qty_stock:(e==null?void 0:e.qty_stock)??s.qty_stock,qty_available:((e==null?void 0:e.qty_stock)??s.qty_stock)-a,image_path:s.image_path??"",price:f??s.price,price_sell:v??s.price_sell??s.price,discount:z??s.discount??0,quantity:a,variant:(e==null?void 0:e.variant)??s.variant??null,sizes:e?[{...e,qty_in_cart:a,qty_available:e.qty_stock-a}]:[],is_unlisted:s.is_unlisted||!1},C=k.value.find(o=>o.id===x.id&&o.size_id===x.size_id&&o.variant===x.variant);if(C){C.quantity+=a;const o=C.quantity>1;e&&(C.price=e[o?"price_grosir":"price_retail"]??C.price,C.price_sell=e[o?"price_sell_grosir":"price_sell_retail"]??C.price_sell,C.discount=e[o?"discount_grosir":"discount_retail"]??C.discount)}else k.value.push(x);j.value=!1,Rt(()=>{ke.value&&(ke.value.scrollTop=ke.value.scrollHeight)})};function ht(s){k.value=k.value.filter(e=>e.id!==s)}function wt(){k.value.length!==0&&(Z.value=!0)}function kt(){k.value=k.value.map(s=>D.value.includes(s.id+s.size_id)?{...s,discount:g.value,price_sell:s.price-g.value}:s),D.value=[],Z.value=!1,w.success("Discount applied successfully")}function $t(s){const e={id:s.id,product_id:s.id,product_name:s.name,uom_id:s.uom_id||"PCS",size_id:s.size_id,qty_stock:s.qty||1,qty_available:s.qty||1,image_path:s.image_path||"",price:s.price_store,price_sell:s.price_store,discount:0,variant:s.variant,is_unlisted:!0,sizes:[{size_id:s.size_id,variant:s.variant,qty_stock:s.qty||1,qty_in_cart:0,qty_available:s.qty||1,price:s.price_store,price_sell:s.price_store,discount:0,price_retail:s.price_store,discount_retail:0,price_sell_retail:s.price_store,price_grosir:s.price_grosir,discount_grosir:0,price_sell_grosir:s.price_grosir}]};Le(e),J.value=!1}function Ct(){if(k.value.length===0){w.error("Please add items to the cart");return}if(!c.value){w.error("Please select a payment method");return}S.value=null,we.value=!0}async function Oe(){if(T.value.length===0){w.error("No payment methods available");return}const s=T.value.find(e=>e.id===c.value);if((!s||s.name!=="CREDIT")&&(S.value===null||S.value<O.value)){w.error("Paid amount must be at least total amount");return}we.value=!1,await Pt()}function Ke(){k.value=[],c.value=null,U.value="",G.value="",D.value=[]}async function Ee(s=null){if(typeof s=="number"&&(R.value=s),typeof R.value=="number")try{const e=await ae.get(`/api/customers/get/${R.value}`);U.value=e.data.name,w.success(`Pelanggan ${U.value} berhasil ditambahkan.`)}catch(e){console.error("Error fetching customer details:",e),w.error("Gagal mengambil detail pelanggan."),R.value=null,U.value=null}else xe.value=!0}const qt=s=>{R.value=s.id,U.value=s.name,xe.value=!1},O=H(()=>k.value.reduce((s,e)=>s+e.price*e.quantity,0)),Fe=H(()=>`${y(O.value)}`);async function Pt(){var s;if(k.value.length===0){w.error("Please add items to the cart");return}if(!c.value){w.error("Please select a payment method");return}b.value.placingOrder=!0;try{const e=k.value.map(v=>{const z=v.discount||0;return{product_id:v.product_id??v.id,product_name:v.product_name,quantity:v.quantity,price:v.price,uom_id:v.uom_id,size_id:v.size_id||null,qty_stock:0,image_path:"",discount:z,price_sell:v.price_sell??v.price-z,variant:v.variant||"all"}}),a={items:e,payment_method_id:c.value,total_amount:O.value,paid_amount:S.value,customer_id:R.value,transaction_number:G.value||""},f=await ae.post("/api/pos/orders",a);L.value=e.map(v=>{var z;return{...v,uom_id:((z=k.value.find(x=>(x.product_id??x.id)===v.product_id))==null?void 0:z.uom_id)||""}}),ee.value=f.data.total_amount,re.value=((s=T.value.find(v=>v.id===c.value))==null?void 0:s.name)||"",ue.value=ze(f.data.created_at),G.value=f.data.transaction_number||"",R.value=null,ye.value=!0}catch(e){console.error("Error placing order:",e),w.error("Failed to place order")}finally{b.value.placingOrder=!1}}function zt(){ye.value=!1,Ke(),c.value=null}const Tt=async s=>{var a;if(s.length===0)return;const e=s[0].rawValue;console.log("QR Code detected:",e),F.value=!1;try{const f=e.split(",").map(o=>o.trim()),z=(await ae.get("/api/orders/scan",{params:{ids:f.join(",")}})).data,x=[];if(z.length>0&&(R.value=z[0].customer_id,U.value=((a=z[0].customer)==null?void 0:a.name)||"Guest",G.value=f.join(",")),z.forEach(o=>{var q;(q=o==null?void 0:o.order_items)!=null&&q.length&&x.push(...o.order_items)}),x.length===0){w.error("No order items found for the scanned QR code(s).");return}const C=x.map(o=>({id:o.product_id,product_id:o.product_id,product_name:o.product_name,uom_id:o.uom_id,size_id:o.size_id||"",qty_stock:o.qty_stock,image_path:o.image_path,price:o.price,price_sell:o.price_sell,discount:o.discount,quantity:o.quantity??1,variant:o.variant||"all",sizes:o.size_id?[{size_id:o.size_id,variant:o.variant||"all",qty_stock:o.qty_stock,qty_in_cart:o.quantity??1,qty_available:o.qty_stock,price:o.price,price_sell:o.price_sell,discount:o.discount,price_retail:o.price,price_sell_retail:o.price_sell,discount_retail:o.discount,price_grosir:o.price,price_sell_grosir:o.price_sell,discount_grosir:o.discount}]:[]}));console.log("Produk dalam pesanan:",C),C.forEach(o=>{const q=k.value.findIndex(Y=>(Y.product_id??Y.id)===(o.product_id??o.id)&&Y.size_id===o.size_id);q>-1?k.value[q].quantity+=o.quantity:k.value.push({...o})}),w.success("Order items added to cart!"),R.value&&Ee(R.value)}catch(f){console.error("Error scanning QR code:",f),w.error("Failed to scan QR code or retrieve order details.")}},Qe=new WeakMap;Te(k,s=>{s.forEach(e=>{Qe.has(e)||(Qe.set(e,!0),Te(()=>e.quantity,a=>{if(!e.sizes||e.sizes.length===0)return;const f=e.sizes[0],v=a>1;e.price=v?f.price_grosir:f.price_retail,e.price_sell=v?f.price_sell_grosir:f.price_sell_retail,e.discount=v?f.discount_grosir:f.discount_retail,f.qty_in_cart=a,f.qty_available=f.qty_stock-a}))})},{deep:!0}),Te(ge.internalValue,s=>{S.value=s});function jt(){const s=window.qz,e=Pe.value;if(s){const x=L.value.reduce((q,Y)=>q+Y.quantity,0),C=(ee.value||O.value)-(S.value||0),o=[];o.push(`     ${ne.value}`),o.push(` ${oe.value}`),o.push("----------------------------------------"),o.push(`Kasir   : ${e}`),o.push(`Tanggal : ${ue.value}`),o.push(`Nomor   : ${G.value}`),o.push("------------------------------------"),o.push(`Customer: ${U.value||"-"}`),o.push("--------------------------------------"),L.value.forEach(q=>{o.push(`${q.product_name}${q.size_id?" - "+q.size_id:""} ${q.variant?" "+q.variant:""}`),o.push(`${q.quantity} x ${y(q.price)}${" ".repeat(20-(q.quantity+"").length-y(q.price).length)}${y(q.quantity*q.price)}`)}),o.push("--------------------------------"),o.push(`Total QTY        ${x}`),o.push(`Total Bayar      ${y(ee.value||O.value)}`),o.push(`Jenis Bayar      ${re.value||"-"}`),o.push(`Bayar Cash       ${y(S.value||0)}`),o.push(`Sisa             ${y(C>0?C:0)}`),o.push("--------------------------------------"),o.push("      ---TERIMA KASIH---"),o.push("     aninkafashion.com"),o.push(`


`),s.websocket.connect().then(()=>s.printers.find()).then(q=>{const Y=s.configs.create(q);return s.print(Y,[{type:"raw",format:"plain",data:o.join(`
`)}])}).catch(q=>{alert("Print error: "+q)}).finally(()=>{s.websocket.disconnect()});return}const a=L.value.reduce((x,C)=>x+C.quantity,0),f=(ee.value||O.value)-(S.value||0),v=`
    <div style="font-family: 'Courier New', Courier, monospace; font-size: 12px; width: 80mm; padding: 0; margin: 0;">
      <div style="text-align:center; font-weight:bold;">${ne.value}</div>
      <div style="text-align:center;">${oe.value}</div>
      <div style="text-align:center;">----------------------------------------</div>
      <div style="display:flex; justify-content:space-between;">
        <span>Kasir   : ${e}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Tanggal : ${ue.value}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Nomor   : ${G.value}</span>
      </div>
      <div style="text-align:center;">----------------------------------------</div>
      <div style="display:flex; justify-content:space-between;">
        <span>Customer</span>
        <span>${U.value||"-"}</span>
      </div>
      <div style="text-align:center;">----------------------------------------</div>
      ${L.value.map(x=>`
          <div>${x.product_name} - ${x.size_id} ${x.variant} </div>
          <div style="display:flex; justify-content:space-between;">
            <span>${x.quantity} x ${y(x.price)}</span>
            <span>${y(x.quantity*x.price)}</span>
          </div>
        `).join("")}
      <div style="text-align:center;">----------------------------------------</div>
      <div style="display:flex; justify-content:space-between;">
        <span>Total QTY</span>
        <span>${a}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Total Bayar</span>
        <span>${y(ee.value||O.value)}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Jenis Bayar</span>
        <span>${re.value||"-"}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Bayar Cash</span>
        <span>${y(S.value||0)}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Sisa</span>
        <span>${y(f>0?f:0)}</span>
      </div>
      <div style="text-align:center;">----------------------------------------</div>
      <div style="text-align:center; margin-top:8px;">---TERIMA KASIH---</div>
      <div style="text-align:center;">aninkafashion.com</div>
    </div>
  `,z=window.open("","","height=600,width=400");if(!z){alert("Please allow pop-ups for printing.");return}z.document.write(`
    <html>
      <head>
        <title>Print Struk</title>
        <style>
          @media print {
            body { margin: 0; }
            div { font-family: 'Courier New', Courier, monospace; font-size: 12px; }
          }
        </style>
      </head>
      <body>
        ${v}
        <script>
          window.onload = function() {
            setTimeout(function() {
              window.print();
              window.onafterprint = function() { window.close(); };
            }, 100);
          };
        <\/script>
      </body>
    </html>
  `),z.document.close()}function St(){const e="-".repeat(46),f=[ne.value.padStart(Math.floor((46+ne.value.length)/2)),oe.value.padStart(Math.floor((46+oe.value.length)/2)),e,`Kasir   : ${Pe.value}`,`Tanggal : ${ue.value}`,`Nomor   : ${G.value}`,e,`Customer: ${U.value||"-"}`,e,...L.value.flatMap(x=>{const C=x.product_name+" - "+x.size_id+(x.variant?" "+x.variant:""),o=`${x.quantity} x ${y(x.price)}`,q=y(x.quantity*x.price),Y=o.padEnd(23),Nt=q.padStart(23);return[C.length>46?C.slice(0,46):C,`${Y}${Nt}`]}),e,`Total QTY   : ${L.value.reduce((x,C)=>x+C.quantity,0)}`,`Total Bayar : ${y(ee.value||O.value)}`,`Jenis Bayar : ${re.value||"-"}`,`Bayar Cash  : ${y(S.value||0)}`,`Sisa        : ${y((ee.value||O.value)-(S.value||0))}`,e,"---TERIMA KASIH---".padStart(Math.floor(64/2)),"aninkafashion.com".padStart(Math.floor(65/2)),`


`].join(`
`),z=`intent://${encodeURIComponent(f).replace(/'/g,"%27").replace(/"/g,"%22")}#Intent;scheme=rawbt;package=ru.a402d.rawbtprinter;end;`;window.location.href=z}function Dt(){At()?St():jt()}function At(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}const ze=s=>{if(!s)return"-";const e=new Date(s),f=new Intl.DateTimeFormat("id-ID",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"Asia/Jakarta"}).formatToParts(e),v=z=>{var x;return((x=f.find(C=>C.type===z))==null?void 0:x.value)||""};return`${v("day")}/${v("month")}/${v("year")} ${v("hour")}:${v("minute")} WIB`};return Re(),xt(),(s,e)=>(u(),d(N,null,[n(l(Bt),{title:"Point of Sale"}),n(Kt,null,{default:r(()=>[t("div",Ws,[t("div",Hs,[t("section",Js,[t("div",Ys,[e[24]||(e[24]=t("h2",{class:"text-sm font-semibold text-gray-800"},"Produk Tersedia",-1)),A(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=a=>ce.value=a),onInput:bt,placeholder:"Cari produk...",class:"focus:ring-primary-500 w-full max-w-xs rounded-md border border-gray-300 px-2 py-1 text-xs focus:outline-none focus:ring-2 md:text-sm"},null,544),[[V,ce.value]]),n(l(P),{onClick:e[1]||(e[1]=a=>J.value=!0),class:"flex items-center justify-center rounded-md bg-purple-600 p-2 text-white hover:bg-purple-700",title:"Tambah Produk"},{default:r(()=>[n(l(es),{class:"h-4 w-4"}),e[23]||(e[23]=m(" Tambah Produk "))]),_:1,__:[23]})]),t("div",Zs,[(u(!0),d(N,null,E(B.value,a=>(u(),d("div",{key:a.id,onClick:f=>Ue(a),class:"flex cursor-pointer flex-row items-center gap-2 rounded-lg border border-gray-200 bg-white p-2 shadow-sm transition hover:shadow-md md:gap-3 md:p-3"},[t("div",ea,[a.image_path?(u(),d("img",{key:0,src:Be(a.image_path),alt:"Gambar produk",class:"h-16 w-16 rounded object-cover"},null,8,ta)):(u(),d("div",sa," Tidak Ada Gambar "))]),t("div",aa,[t("div",la,[t("p",na,i(a.product_name),1),a.discount&&a.price?(u(),d(N,{key:0},[a.discount>0?(u(),d("span",oa,i(Math.round(a.discount/a.price*100))+"% ",1)):$("",!0)],64)):$("",!0)]),t("p",ia,"Stok: "+i(a.qty_available)+" / "+i(a.uom_id),1),a.variant?(u(),d("div",ra,[e[25]||(e[25]=t("p",{class:"text-xs text-gray-500"},"Tersedia Ukuran:",-1)),t("div",ua,[(u(!0),d(N,null,E(rt(a.sizes,a.variant),f=>(u(),d("div",{class:"rounded-full border px-3 py-1 text-xs font-medium",key:f.size_id},i(f.size_id),1))),128))])])):$("",!0),t("div",null,[a.discount&&a.discount>0?(u(),d(N,{key:0},[t("p",da,i(y(a.price)),1),t("p",ca,i(y(a.price_sell??a.price-a.discount)),1),t("p",pa,"(Diskon "+i(y(a.discount))+")",1)],64)):(u(),d("p",va,i(y(a.price)),1))])])],8,Xs))),128))])]),t("section",fa,[t("div",ma,[n(l(P),{variant:"outline",size:"sm",onClick:wt,disabled:D.value.length===0,class:"flex items-center gap-1 bg-indigo-100"},{default:r(()=>[n(l(ts),{class:"h-4 w-4"}),m(" Disc ("+i(D.value.length)+") ",1)]),_:1},8,["disabled"]),n(l(P),{variant:"outline",size:"sm",onClick:e[2]||(e[2]=a=>F.value=!0),class:"flex items-center gap-1"},{default:r(()=>[n(l(ss),{class:"h-4 w-4"}),e[26]||(e[26]=m(" QR "))]),_:1,__:[26]}),n(l(P),{variant:"outline",size:"sm",onClick:e[3]||(e[3]=()=>Ee()),class:"flex items-center gap-1"},{default:r(()=>[n(l(as),{class:"h-4 w-4"}),e[27]||(e[27]=m(" Cust "))]),_:1,__:[27]}),n(l(P),{variant:"outline",size:"sm",onClick:dt,class:"flex items-center gap-1"},{default:r(()=>[n(l(ls),{class:"h-4 w-4"}),e[28]||(e[28]=m(" Retur "))]),_:1,__:[28]}),n(l(P),{variant:"outline",size:"sm",onClick:e[4]||(e[4]=a=>ct()),class:"flex items-center gap-1"},{default:r(()=>[n(l(ns),{class:"h-4 w-4"}),e[29]||(e[29]=m(" RePrint "))]),_:1,__:[29]}),n(l(P),{variant:"outline",size:"sm",onClick:Ke,class:"flex items-center gap-1"},{default:r(()=>[n(l(Ze),{class:"h-4 w-4"}),e[30]||(e[30]=m(" Clear "))]),_:1,__:[30]})]),k.value.length===0?(u(),d("div",ga," Tidak ada item di keranjang ")):$("",!0),t("div",_a,[n(l(He),null,{default:r(()=>[n(l(Je),null,{default:r(()=>[n(l(me),null,{default:r(()=>[n(l(K),{class:"text-xs"},{default:r(()=>e[31]||(e[31]=[m("#")])),_:1,__:[31]}),n(l(K),{class:"text-xs"},{default:r(()=>e[32]||(e[32]=[m("Nama")])),_:1,__:[32]}),n(l(K),{class:"text-center text-xs"},{default:r(()=>e[33]||(e[33]=[m("Qty")])),_:1,__:[33]}),n(l(K),{class:"text-center text-xs"},{default:r(()=>e[34]||(e[34]=[m("Total")])),_:1,__:[34]}),n(l(K),{class:"text-center text-xs"},{default:r(()=>e[35]||(e[35]=[m("Aksi")])),_:1,__:[35]})]),_:1})]),_:1}),n(l(Ye),null,{default:r(()=>[(u(!0),d(N,null,E(k.value,a=>(u(),je(l(me),{key:a.id},{default:r(()=>[n(l(I),null,{default:r(()=>[t("div",ya,[t("input",{type:"checkbox",checked:D.value.includes(a.id+a.size_id),onChange:f=>yt(a.id+a.size_id),class:"text-primary-600 focus:ring-primary-500 absolute left-0 top-0 rounded border-gray-300",title:"Pilih untuk diskon"},null,40,xa)])]),_:2},1024),n(l(I),{class:"text-xs"},{default:r(()=>[t("div",ba,i(a.product_name),1),t("div",ha,"Ukuran : "+i(a.size_id),1),a.discount&&a.discount>0?(u(),d("span",wa,i(y(a.price)),1)):$("",!0),t("span",ka,i(y(a.price_sell||a.price-(a.discount||0))),1),t("span",$a,"Variant: "+i(a.variant||""),1),a.discount&&a.discount>0?(u(),d("div",Ca," Diskon: -"+i(y(a.discount)),1)):$("",!0)]),_:2},1024),n(l(I),{class:"text-center"},{default:r(()=>[A(t("input",{type:"number",min:"1",max:a.qty_available,"onUpdate:modelValue":f=>a.quantity=f,class:"w-12 rounded border px-1 py-0.5 text-center text-xs"},null,8,qa),[[V,a.quantity,void 0,{number:!0}]])]),_:2},1024),n(l(I),{class:"text-right text-xs font-semibold text-gray-900"},{default:r(()=>[m(i(y(a.quantity*(a.price_sell||a.price))),1)]),_:2},1024),n(l(I),{class:"text-center"},{default:r(()=>[n(l(P),{variant:"ghost",size:"icon",onClick:f=>ht(a.id),class:"hover:bg-gray-100"},{default:r(()=>[n(l(Ze),{class:"h-4 w-4"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),U.value?(u(),d("div",Pa,[t("div",null,[e[36]||(e[36]=t("p",{class:"text-sm font-medium text-gray-500"},"Pelanggan",-1)),t("p",za,[m(i(U.value)+" ",1),t("span",Ta,"(#"+i(R.value)+")",1)])]),t("div",null,[e[37]||(e[37]=t("p",{class:"text-sm font-medium text-gray-500"},"Transaksi Online",-1)),t("p",ja,i(G.value),1)])])):$("",!0),t("div",Sa,[e[39]||(e[39]=t("label",{class:"mb-1 block text-xs font-medium text-gray-900"},"Metode Pembayaran",-1)),A(t("select",{"onUpdate:modelValue":e[5]||(e[5]=a=>c.value=a),class:"focus:ring-primary-500 w-full rounded-lg border border-gray-300 p-1 text-xs focus:outline-none focus:ring-2"},[e[38]||(e[38]=t("option",{value:""},"Pilih metode pembayaran",-1)),(u(!0),d(N,null,E(T.value,a=>(u(),d("option",{key:a.id,value:a.id},i(a.name),9,Da))),128))],512),[[Se,c.value]])]),t("div",Aa,[t("div",Na,[e[40]||(e[40]=t("span",null,"Total",-1)),t("span",Ua,i(Fe.value),1)]),n(l(P),{class:"w-full rounded-md bg-indigo-600 py-2 text-xs font-semibold text-white hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500",onClick:Ct,disabled:b.value.placingOrder},{default:r(()=>[b.value.placingOrder?(u(),d("span",Ma,"Memproses...")):(u(),d("span",Ia,"Bayar"))]),_:1},8,["disabled"])])])]),Z.value?(u(),d("div",Va,[t("div",Ba,[e[41]||(e[41]=t("h3",{class:"mb-4 text-lg font-semibold"},"Set Discount",-1)),e[42]||(e[42]=t("label",{class:"mb-2 block text-sm font-medium"},"Discount Price",-1)),A(t("input",{type:"number","onUpdate:modelValue":e[6]||(e[6]=a=>g.value=a),class:"focus:ring-primary-500 mb-4 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2"},null,512),[[V,g.value,void 0,{number:!0}]]),t("div",Ra,[t("button",{onClick:kt,class:"rounded bg-green-600 px-4 py-2 text-sm text-white hover:bg-green-700"},"Save"),t("button",{onClick:e[7]||(e[7]=a=>Z.value=!1),class:"rounded bg-gray-300 px-4 py-2 text-sm text-gray-700 hover:bg-gray-400"}," Cancel ")])])])):$("",!0),we.value?(u(),d("div",La,[t("div",Oa,[e[47]||(e[47]=t("h3",{class:"mb-4 text-lg font-semibold"},"Masukkan Jumlah Bayar",-1)),A(t("input",{type:"number",min:"0","onUpdate:modelValue":e[8]||(e[8]=a=>S.value=a),onKeypress:et(Oe,["enter"]),class:"mb-4 w-full rounded border px-3 py-2 text-lg",placeholder:"Masukkan jumlah bayar"},null,544),[[V,S.value,void 0,{number:!0}]]),t("div",Ka,[e[43]||(e[43]=t("div",null,"Total:",-1)),t("div",Ea,i(Fe.value),1)]),t("div",Fa,[e[44]||(e[44]=t("div",null,"Kembalian:",-1)),t("div",Qa,i(y(Ie.value)),1)]),t("div",Ga,[n(l(P),{variant:"outline",onClick:e[9]||(e[9]=a=>we.value=!1)},{default:r(()=>e[45]||(e[45]=[m("Batal")])),_:1,__:[45]}),n(l(P),{onClick:Oe,class:"rounded-md bg-indigo-600 py-2 text-white hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:r(()=>e[46]||(e[46]=[m("Konfirmasi")])),_:1,__:[46]})])])])):$("",!0),n(ie,{show:F.value,onClose:e[10]||(e[10]=a=>F.value=!1),title:"Scan QR Code"},{default:r(()=>[t("div",Wa,[n(l(Ft),{onDetect:Tt})])]),_:1},8,["show"]),n(ie,{show:j.value,onClose:e[13]||(e[13]=a=>j.value=!1),title:"Detail Produk"},{default:r(()=>{var a,f;return[h.value?(u(),d("div",Ha,[t("div",Ja,[h.value.image_path?(u(),d("img",{key:0,src:Be(h.value.image_path),alt:"Gambar produk",class:"h-24 w-24 rounded object-cover"},null,8,Ya)):(u(),d("div",Za," Tidak Ada Gambar ")),t("div",null,[t("h3",Xa,i(h.value.product_name),1),e[49]||(e[49]=t("span",{class:"mb-1 text-sm font-semibold text-gray-700"},"Pilih Ukuran ",-1)),t("div",el,[e[48]||(e[48]=t("br",null,null,-1)),(u(!0),d(N,null,E(pt.value,v=>(u(),d("button",{key:v.size_id,onClick:z=>M.value=v.size_id,class:We(["rounded-full border px-3 py-1 text-sm font-semibold transition",M.value===v.size_id?"border-green-600 bg-green-600 text-white":"border-gray-300 bg-gray-200 text-gray-800 hover:bg-gray-300"])},[t("div",{onClick:z=>ut(h.value,v)},i(v.size_id),9,sl)],10,tl))),128))])])]),((a=h.value)==null?void 0:a.variant)!=="all"?(u(),d("div",al,[e[50]||(e[50]=t("h4",{class:"mb-1 text-sm font-semibold text-gray-700"},"Variant",-1)),t("div",ll,[(u(!0),d(N,null,E(ot.value,v=>(u(),d("button",{key:v,onClick:()=>{W.value=v,M.value=null},class:We(["rounded-full border px-3 py-1 text-sm font-semibold transition",W.value===v?"border-indigo-600 bg-indigo-600 text-white":"border-gray-300 bg-gray-200 text-gray-800 hover:bg-gray-300"])},i(v),11,nl))),128))])])):$("",!0),t("div",ol,[se.value?(u(),d("div",il,[t("p",null,[e[51]||(e[51]=m(" Stok: ")),t("strong",null,i(se.value.qty_available),1)]),(se.value.discount??0)>0?(u(),d("span",rl," Harga "+i(y(se.value.price)),1)):$("",!0),e[52]||(e[52]=t("br",null,null,-1)),t("span",ul," Harga Diskon "+i(y(se.value.price_sell||se.value.price)),1),e[53]||(e[53]=t("br",null,null,-1)),(se.value.discount??0)>0?(u(),d("span",dl," (Diskon: "+i(y(se.value.discount??0))+") ",1)):$("",!0)])):$("",!0)]),t("div",cl,[n(l(P),{variant:"outline",onClick:e[11]||(e[11]=v=>j.value=!1)},{default:r(()=>e[54]||(e[54]=[m("Batal")])),_:1,__:[54]}),n(l(P),{onClick:e[12]||(e[12]=v=>Le(h.value)),disabled:!M.value||!W.value&&((f=h.value)==null?void 0:f.variant)!=="all"},{default:r(()=>e[55]||(e[55]=[m("Tambah ke Keranjang")])),_:1,__:[55]},8,["disabled"])])])):$("",!0)]}),_:1},8,["show"]),n(ie,{show:Ce.value,onClose:Ve,title:"RePrint Struk"},{default:r(()=>[t("div",pl,[n(l(Ot),{modelValue:pe.value,"onUpdate:modelValue":e[14]||(e[14]=a=>pe.value=a),class:"w-full text-sm sm:w-64",placeholder:"Cari transaksi...","aria-label":"Search"},null,8,["modelValue"]),n(l(P),{onClick:e[15]||(e[15]=a=>lt()),class:"w-full px-4 py-2 text-sm sm:w-auto"},{default:r(()=>e[56]||(e[56]=[m(" Cari ")])),_:1,__:[56]})]),t("div",vl,[n(l(He),{class:"min-w-full text-sm"},{default:r(()=>[n(l(Je),null,{default:r(()=>[n(l(me),{class:"bg-gray-100 text-xs uppercase text-gray-600"},{default:r(()=>[n(l(K),{class:"whitespace-nowrap px-2 py-2"},{default:r(()=>e[57]||(e[57]=[m("Aksi")])),_:1,__:[57]}),n(l(K),{class:"whitespace-nowrap px-2 py-2"},{default:r(()=>e[58]||(e[58]=[m("Tanggal")])),_:1,__:[58]}),n(l(K),{class:"whitespace-nowrap px-2 py-2"},{default:r(()=>e[59]||(e[59]=[m("Customer")])),_:1,__:[59]}),n(l(K),{class:"whitespace-nowrap px-2 py-2"},{default:r(()=>e[60]||(e[60]=[m("Total")])),_:1,__:[60]}),n(l(K),{class:"whitespace-nowrap px-2 py-2"},{default:r(()=>e[61]||(e[61]=[m("Pembayaran")])),_:1,__:[61]}),n(l(K),{class:"whitespace-nowrap px-2 py-2"},{default:r(()=>e[62]||(e[62]=[m("Status")])),_:1,__:[62]})]),_:1})]),_:1}),n(l(Ye),null,{default:r(()=>[(u(!0),d(N,null,E(ve.value,a=>(u(),je(l(me),{key:a.id,class:"cursor-pointer transition hover:bg-gray-50"},{default:r(()=>[n(l(I),{class:"px-2 py-1"},{default:r(()=>[n(l(P),{variant:"outline",size:"sm",onClick:f=>nt(a)},{default:r(()=>e[63]||(e[63]=[m(" Cetak ")])),_:2,__:[63]},1032,["onClick"])]),_:2},1024),n(l(I),{class:"px-2 py-1"},{default:r(()=>[m(i(ze(a.created_at)),1)]),_:2},1024),n(l(I),{class:"px-2 py-1"},{default:r(()=>[m(i(a.customer),1)]),_:2},1024),n(l(I),{class:"px-2 py-1"},{default:r(()=>[m(i(y(Number(a.total_amount))),1)]),_:2},1024),n(l(I),{class:"px-2 py-1"},{default:r(()=>[m(i(a.payment_method),1)]),_:2},1024),n(l(I),{class:"px-2 py-1"},{default:r(()=>[m(i(a.status),1)]),_:2},1024)]),_:2},1024))),128)),ve.value.length===0?(u(),je(l(me),{key:0},{default:r(()=>[n(l(I),{colspan:"6",class:"py-3 text-center text-xs text-gray-400"},{default:r(()=>e[64]||(e[64]=[m(" Tidak ada transaksi ditemukan. ")])),_:1,__:[64]})]),_:1})):$("",!0)]),_:1})]),_:1})])]),_:1},8,["show"]),n(ie,{show:$e.value,onClose:qe,title:"Retur Barang"},{default:r(()=>[t("div",fl,[e[67]||(e[67]=t("label",{class:"block text-xs font-medium"},"Produk",-1)),n(l(Et),{modelValue:fe.value,"onUpdate:modelValue":e[16]||(e[16]=a=>fe.value=a),options:_.value,label:"product_title",value:"id",onSearch:it,reduce:a=>({...a,name:a.product_name,product_name:a.product_name,size_id:a.size_id,uom_id:a.uom_id,qty_available:0}),placeholder:"Pilih Produk"},null,8,["modelValue","options","reduce"]),e[68]||(e[68]=t("label",{class:"block text-xs font-medium"},"Qty",-1)),A(t("input",{type:"number","onUpdate:modelValue":e[17]||(e[17]=a=>de.value=a),min:"1",class:"w-full rounded border p-1 text-xs"},null,512),[[V,de.value,void 0,{number:!0}]]),e[69]||(e[69]=t("label",{class:"block text-xs font-medium"},"Harga Retur",-1)),A(t("input",{type:"number","onUpdate:modelValue":e[18]||(e[18]=a=>le.value=a),min:"0",class:"w-full rounded border p-1 text-xs"},null,512),[[V,le.value,void 0,{number:!0}]]),t("div",ml,[n(l(P),{variant:"outline",onClick:qe},{default:r(()=>e[65]||(e[65]=[m("Batal")])),_:1,__:[65]}),n(l(P),{class:"bg-red-600 text-white",onClick:vt},{default:r(()=>e[66]||(e[66]=[m("Simpan")])),_:1,__:[66]})]),te.value?(u(),d("div",gl,i(te.value),1)):$("",!0),be.value?(u(),d("div",_l,"Retur berhasil ditambahkan ke keranjang!")):$("",!0)])]),_:1},8,["show"]),ye.value?(u(),d("div",yl,[t("div",{class:"print-area w-[450px] max-w-full rounded bg-white p-2 font-mono text-[10px] leading-tight shadow",ref_key:"printArea",ref:at},[t("div",xl,[t("p",bl,i(ne.value),1),t("p",null,i(oe.value),1)]),e[77]||(e[77]=t("hr",{class:"my-1 border-t border-dashed"},null,-1)),t("div",hl,[t("p",null,"Tanggal : "+i(ue.value),1),t("p",null,"Kasir     : "+i(Pe.value),1),t("p",null,"Nomor     : "+i(G.value),1),t("p",null,"Customer  : "+i(U.value||"-"),1)]),e[78]||(e[78]=t("hr",{class:"my-1 border-t border-dashed"},null,-1)),(u(!0),d(N,null,E(L.value,(a,f)=>(u(),d("div",{key:a.product_id,class:"mb-1"},[t("p",wl,i(f+1)+". "+i(a.product_name)+"   - "+i(a.size_id)+" "+i(a.variant),1),t("div",kl,[t("span",null,i(a.quantity)+" x "+i(y(a.price)),1),t("span",null,"  "+i(y(a.price*a.quantity)),1)]),Number(a.discount)>0?(u(),d("div",$l,[t("div",Cl,[t("span",ql,"- "+i(y(a.discount)),1),t("span",null,i(y(a.price*a.quantity-a.discount)),1)])])):$("",!0)]))),128)),e[79]||(e[79]=t("hr",{class:"my-1 border-t border-dashed"},null,-1)),t("div",Pl,[e[70]||(e[70]=t("span",null,"Sub Total    :",-1)),t("span",null,i(y(_t.value)),1)]),t("div",zl,[e[71]||(e[71]=t("span",null,"Jumlah Bayar :",-1)),t("span",null,i(y(S.value||0)),1)]),t("div",Tl,[e[72]||(e[72]=t("span",null,"Kembalian    :",-1)),t("span",null,i(y(Ie.value)),1)]),t("div",jl,[e[73]||(e[73]=t("span",null,"Total Disc   :",-1)),t("span",null,i(y(gt.value)),1)]),t("div",Sl,[e[74]||(e[74]=t("span",null,"Metode       :",-1)),t("span",null,i(re.value),1)]),e[80]||(e[80]=t("hr",{class:"my-1 border-t border-dashed"},null,-1)),e[81]||(e[81]=t("p",{class:"text-center"},"SELAMAT BERBELANJA",-1)),e[82]||(e[82]=t("hr",{class:"my-1 border-t border-dashed"},null,-1)),t("div",Dl,[n(l(P),{variant:"outline",onClick:zt},{default:r(()=>e[75]||(e[75]=[m("TUTUP")])),_:1,__:[75]}),n(l(P),{onClick:Dt,class:"rounded-md bg-indigo-600 py-2 text-white hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:r(()=>e[76]||(e[76]=[m("CETAK")])),_:1,__:[76]})])],512)])):$("",!0)]),n(Qt,{show:xe.value,"onUpdate:show":e[19]||(e[19]=a=>xe.value=a),onCustomerSelected:qt},null,8,["show"]),n(ie,{show:X.value,onClose:e[21]||(e[21]=a=>X.value=!1),title:"Tambah Produk Custom"},{default:r(()=>[n(st,{onCancel:e[20]||(e[20]=a=>X.value=!1)})]),_:1},8,["show"]),n(ie,{show:J.value,onClose:e[22]||(e[22]=a=>J.value=!1),title:"Daftar Produk Tanpa Master"},{default:r(()=>[n(Gs,{onAddUnlistedToCart:$t})]),_:1},8,["show"])]),_:1})],64))}}),Xl=Lt(Al,[["__scopeId","data-v-c66adca9"]]);export{Xl as default};
