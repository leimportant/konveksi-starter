import{U as x,Q as y,c as h,d as b,o as w,a0 as C,f as s,g as o,p as d,u as a,Z as P,x as c,k as r,C as f,F as p,B as T,j as u,O as j,y as k,D as B,N as L}from"./app-CCxV7F73.js";import{_ as N}from"./AppLayout.vue_vue_type_script_setup_true_lang-CIoevcAO.js";import{u as S}from"./useCartStore-DfZQrjGR.js";import{u as M}from"./useToast-BsW2pVCa.js";import"./index-WbVS-gjC.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DsghXOI_.js";const V=x("auth",()=>{const g=y(),i=h(()=>{var e;return((e=g.props.auth)==null?void 0:e.user)??null}),l=h(()=>!!i.value);return{user:i,isLoggedIn:l}}),A={class:"px-4 py-4"},D={key:0,class:"text-center text-gray-500"},E={key:1,class:"text-center text-gray-500"},$={key:2,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},F={class:"aspect-video overflow-hidden rounded-lg bg-gray-100 mb-4"},G=["src"],H=["src"],I={class:"text-lg font-semibold mb-1 truncate"},U={class:"text-gray-700 mb-2 text-sm"},z={class:"text-orange-600 font-semibold mb-4"},O={class:"flex justify-between gap-2"},Q={key:3,class:"text-center py-4 text-gray-500"},X=b({__name:"Shopping",setup(g){const i=M(),l=V(),e=S(),m=async()=>{!e.loading&&e.currentPage<e.lastPage&&window.innerHeight+window.scrollY>=document.body.offsetHeight-200&&await e.fetchProducts(e.currentPage+1)};w(()=>{e.fetchProducts(1),window.addEventListener("scroll",m)}),C(()=>{window.removeEventListener("scroll",m)});const v=async _=>{try{await e.addToCart(_),i.success("Produk ditambahkan ke keranjang."),l.isLoggedIn||setTimeout(()=>{L.visit(route("login"))},1200)}catch(n){console.error(n),i.error("Gagal menambahkan produk.")}};return(_,n)=>(o(),s(p,null,[d(a(P),{title:"Belanja Produk"}),d(N,null,{default:c(()=>[r("div",A,[n[2]||(n[2]=r("h1",{class:"text-3xl font-semibold mb-6"},"Produk Tersedia",-1)),a(e).loading&&a(e).products.length===0?(o(),s("div",D," Memuat produk... ")):a(e).products.length===0?(o(),s("div",E," Tidak ada produk tersedia. ")):(o(),s("div",$,[(o(!0),s(p,null,T(a(e).products,t=>(o(),s("div",{key:t.id,class:"border rounded-xl p-4 shadow hover:shadow-md transition"},[r("div",F,[t.image?(o(),s("img",{key:0,src:t.image,alt:"Gambar produk",class:"w-full h-full object-cover"},null,8,G)):t.video?(o(),s("video",{key:1,src:t.video,controls:"",class:"w-full h-full object-cover"},null,8,H)):f("",!0)]),r("h2",I,u(t.name),1),r("p",U,u(t.short_description),1),r("p",z," Rp "+u(t.price?t.price.toLocaleString():"0"),1),r("div",O,[d(a(j),{class:"text-sm text-blue-600 hover:underline"},{default:c(()=>n[0]||(n[0]=[k(" Detail ")])),_:1,__:[0]}),d(a(B),{onClick:R=>v(t.id),size:"sm",class:"bg-indigo-600 text-white py-2 h-10 rounded-md hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:c(()=>n[1]||(n[1]=[k(" Add to Cart ")])),_:2,__:[1]},1032,["onClick"])])]))),128))])),a(e).loading&&a(e).products.length>0?(o(),s("div",Q," Memuat lebih banyak produk... ")):f("",!0)])]),_:1})],64))}});export{X as default};
