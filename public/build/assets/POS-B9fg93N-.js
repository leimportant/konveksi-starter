import{d as De,q as He,T as Ut,o as Xe,f as d,g as u,k as t,l as A,C as q,m as B,u as l,j as i,U as Se,F as M,B as E,N as It,r as p,c as Q,p as n,G as et,D as T,x as r,y as _,M as ue,Q as Vt,w as Te,Z as Bt,E as je,z as Qe,b as ne,n as Rt,_ as Lt}from"./app-ClGkS6MK.js";import{_ as Ot}from"./Input.vue_vue_type_script_setup_true_lang-fgUur11n.js";import{_ as We,a as Je,b as _e,c as K,d as Ye,e as V}from"./TableRow.vue_vue_type_script_setup_true_lang-hndQhsnA.js";import{u as Ae}from"./useToast-nAVZhaIg.js";import{_ as Kt}from"./AppLayout.vue_vue_type_script_setup_true_lang-CRchkaQF.js";import{A as Et}from"./vue3-select-CgfLMQDH.js";import{U as Ft,_ as Gt}from"./vue-qrcode-reader-CTrhCFzt.js";import{u as tt}from"./useProductStore-sCeBdKe6.js";import{u as Ht}from"./useCategoryStore-VLqKbhHI.js";import{u as Qt}from"./useSizeStore-D7pJND5i.js";import{S as Wt}from"./shopping-bag-CZEz61U7.js";import{u as Jt}from"./useCurrencyInput-BO2aytxo.js";import{P as Yt}from"./plus-BJy2_HPj.js";import{P as Zt,S as Xt,U as es,R as ts}from"./user-plus-DY5KqIIi.js";import{P as ss}from"./printer-check-DCW2b5vy.js";import{T as Ze}from"./trash-2-DiU-R2y5.js";import"./index-CWqKQ2IK.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DWRrx08k.js";const as={class:"p-4 bg-white rounded-lg shadow-md"},ls={class:"mb-3"},ns={key:0,class:"mt-1 text-sm text-red-600"},os={class:"mb-3"},is=["value"],rs={key:0,class:"mt-1 text-sm text-red-600"},us={class:"mb-4 mt-6 border-t pt-4"},ds={class:"mb-4 rounded-md bg-gray-50 p-3 shadow-sm"},cs={class:"grid grid-cols-1 gap-3 md:grid-cols-2 lg:grid-cols-3"},ps=["value"],vs={key:0,class:"mt-1 text-sm text-red-600"},fs={key:0,class:"mt-1 text-sm text-red-600"},ms={key:0,class:"mt-1 text-sm text-red-600"},_s={key:0,class:"mt-1 text-sm text-red-600"},gs={key:0,class:"mt-1 text-sm text-red-600"},ys={class:"flex justify-end mt-6"},xs=["disabled"],st=De({__name:"AddProductUnlisted",emits:["product-saved"],setup(Me,{emit:Y}){const W=tt(),Z=Ae(),X=Y,h=Ht(),U=Qt(),{items:ee}=He(h),{sizes:k}=He(U),c=Ut({name:"",category_id:"",size_id:"",variant:"",qty:1,price_store:0,price_grosir:0}),S=async()=>{try{await W.saveProductUnlisted(c.data()),Z.success("Produk custom berhasil disimpan!"),c.reset(),X("product-saved")}catch(I){Z.error(I.message||"Gagal menyimpan produk custom.")}};return Xe(async()=>{await h.fetchCategories(),await U.fetchSizes()}),(I,m)=>(u(),d("div",as,[m[17]||(m[17]=t("h3",{class:"text-lg font-semibold mb-4"},"Tambah Produk Custom",-1)),t("form",{onSubmit:It(S,["prevent"])},[t("div",ls,[m[7]||(m[7]=t("label",{for:"name",class:"block text-sm font-medium text-gray-700"},"Nama Produk",-1)),A(t("input",{type:"text",id:"name","onUpdate:modelValue":m[0]||(m[0]=w=>l(c).name=w),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:""},null,512),[[B,l(c).name]]),l(c).errors.name?(u(),d("p",ns,i(l(c).errors.name),1)):q("",!0)]),t("div",os,[m[9]||(m[9]=t("label",{for:"category_id",class:"block text-sm font-medium text-gray-700"},"Category",-1)),A(t("select",{id:"category_id","onUpdate:modelValue":m[1]||(m[1]=w=>l(c).category_id=w),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:""},[m[8]||(m[8]=t("option",{value:"",disabled:""},"Pilih Kategori",-1)),(u(!0),d(M,null,E(l(ee),w=>(u(),d("option",{key:w.id,value:w.id},i(w.name),9,is))),128))],512),[[Se,l(c).category_id]]),l(c).errors.category_id?(u(),d("p",rs,i(l(c).errors.category_id),1)):q("",!0)]),t("div",us,[m[16]||(m[16]=t("h4",{class:"text-md font-semibold mb-3"},"Detail Produk (Ukuran & Harga)",-1)),t("div",ds,[t("div",cs,[t("div",null,[m[11]||(m[11]=t("label",{for:"size_id",class:"block text-sm font-medium text-gray-700"},"Size",-1)),A(t("select",{id:"size_id","onUpdate:modelValue":m[2]||(m[2]=w=>l(c).size_id=w),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:""},[m[10]||(m[10]=t("option",{value:"",disabled:""},"Pilih Ukuran",-1)),(u(!0),d(M,null,E(l(k),w=>(u(),d("option",{key:w.id,value:w.id},i(w.name),9,ps))),128))],512),[[Se,l(c).size_id]]),l(c).errors.size_id?(u(),d("p",vs,i(l(c).errors.size_id),1)):q("",!0)]),t("div",null,[m[12]||(m[12]=t("label",{for:"variant",class:"block text-sm font-medium text-gray-700"},"Variant",-1)),A(t("input",{type:"text",id:"variant","onUpdate:modelValue":m[3]||(m[3]=w=>l(c).variant=w),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:""},null,512),[[B,l(c).variant]]),l(c).errors.variant?(u(),d("p",fs,i(l(c).errors.variant),1)):q("",!0)]),t("div",null,[m[13]||(m[13]=t("label",{for:"qty",class:"block text-sm font-medium text-gray-700"},"Quantity",-1)),A(t("input",{type:"number",id:"qty","onUpdate:modelValue":m[4]||(m[4]=w=>l(c).qty=w),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:""},null,512),[[B,l(c).qty,void 0,{number:!0}]]),l(c).errors.qty?(u(),d("p",ms,i(l(c).errors.qty),1)):q("",!0)]),t("div",null,[m[14]||(m[14]=t("label",{for:"price_store",class:"block text-sm font-medium text-gray-700"},"Harga Toko",-1)),A(t("input",{type:"number",id:"price_store","onUpdate:modelValue":m[5]||(m[5]=w=>l(c).price_store=w),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:""},null,512),[[B,l(c).price_store,void 0,{number:!0}]]),l(c).errors.price_store?(u(),d("p",_s,i(l(c).errors.price_store),1)):q("",!0)]),t("div",null,[m[15]||(m[15]=t("label",{for:"price_grosir",class:"block text-sm font-medium text-gray-700"},"Harga Grosir",-1)),A(t("input",{type:"number",id:"price_grosir","onUpdate:modelValue":m[6]||(m[6]=w=>l(c).price_grosir=w),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:""},null,512),[[B,l(c).price_grosir,void 0,{number:!0}]]),l(c).errors.price_grosir?(u(),d("p",gs,i(l(c).errors.price_grosir),1)):q("",!0)])])])]),t("div",ys,[t("button",{type:"submit",class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",disabled:l(c).processing},i(l(c).processing?"Saving...":"Simpan Produk"),9,xs)])],32)]))}}),bs={class:"p-6 bg-white rounded-xl shadow-md border border-gray-200"},hs={class:"mb-4 flex flex-col sm:flex-row justify-between items-center gap-3"},ks={key:0,class:"py-8 text-center text-purple-600 text-lg font-medium"},ws={key:1,class:"py-8 text-center text-gray-500"},$s={key:2,class:"overflow-x-auto rounded-lg border border-gray-200"},Cs={class:"min-w-full divide-y divide-gray-200"},qs={class:"bg-white divide-y divide-gray-200"},zs={class:"px-4 py-4 align-top"},Ps={class:"border-b border-gray-100 hover:bg-gray-50 dark:border-gray-700 dark:hover:bg-gray-800"},Ts={class:"flex flex-col gap-3 w-full text-sm bg-gradient-to-br from-gray-50 to-purple-50 rounded-xl p-4 border border-gray-200 shadow-sm backdrop-blur-sm"},js={class:"flex justify-between items-center"},Ss={class:"font-semibold text-gray-900"},Ds={class:"flex justify-between items-center"},As={class:"font-semibold"},Ms={class:"flex justify-between items-center font-sm"},Ns={class:"font-sm"},Us={class:"flex justify-between items-center font-xs"},Is={class:"font-bold text-purple-700"},Vs={class:"px-4 py-4 text-right align-top"},Bs={class:"mt-6 flex items-center justify-between"},Rs={class:"text-sm text-gray-600"},Ls={class:"flex items-center gap-2"},Os=De({__name:"ListProductUnlisted",emits:["add-unlisted-to-cart"],setup(Me,{emit:Y}){const W=Ae(),Z=tt(),X=Y,h=p([]),U=p(!1),ee=p(""),k=p(!1),c=p({current_page:1,per_page:50,total:0}),S=Q(()=>Math.ceil(c.value.total/c.value.per_page)),I=async(F=1)=>{U.value=!0;try{const g=await Z.fetchProductUnlisted(F,c.value.per_page,ee.value);h.value=g.data.map(b=>({...b,category:{name:b.category_name},size:{name:b.size_id}})),c.value.current_page=g.current_page,c.value.per_page=g.per_page,c.value.total=g.total}catch(g){console.log(g),W.error("Failed to fetch unlisted products.")}finally{U.value=!1}},m=F=>{F>=1&&F<=S.value&&I(F)},w=F=>{X("add-unlisted-to-cart",{...F,is_unlisted:!0})},ge=()=>{k.value=!1,I(c.value.current_page),W.success("Produk tanpa master berhasil ditambahkan.")};return Xe(()=>I()),(F,g)=>(u(),d("div",bs,[g[12]||(g[12]=t("h3",{class:"text-xl font-semibold mb-4 text-gray-800"},"Daftar Produk Tanpa Master",-1)),t("div",hs,[A(t("input",{"onUpdate:modelValue":g[0]||(g[0]=b=>ee.value=b),type:"text",placeholder:"Cari produk...",class:"w-full sm:w-64 rounded-lg border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500",onKeyup:g[1]||(g[1]=et(b=>I(),["enter"]))},null,544),[[B,ee.value]]),n(l(T),{onClick:g[2]||(g[2]=b=>k.value=!0),class:"w-full sm:w-auto flex items-center gap-2 bg-purple-600 text-white hover:bg-purple-700 transition rounded-md"},{default:r(()=>g[6]||(g[6]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),_(" Tambah Produk Baru ")])),_:1,__:[6]})]),U.value?(u(),d("div",ks," Loading products... ")):h.value.length?(u(),d("div",$s,[t("table",Cs,[g[8]||(g[8]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-3 py-2"},"Produk"),t("th",{class:"px-3 py-2"},"Detail"),t("th",{class:"px-3 py-2"})])],-1)),t("tbody",qs,[(u(!0),d(M,null,E(h.value,b=>{var te;return u(),d("tr",{key:b.id,class:"hover:bg-gray-50 transition"},[t("td",zs,i(b.name),1),t("td",Ps,[t("div",Ts,[t("div",js,[t("span",Ss,i(((te=b.category)==null?void 0:te.name)||"-"),1)]),t("div",Ds,[t("span",As,i(b.variant||"-")+" - "+i(b.size_id),1)]),t("div",Ms,[t("span",Ns," Harga Toko "+i(Number(b.price_store).toLocaleString()),1)]),t("div",Us,[g[7]||(g[7]=_(" Harga Grosir ")),t("span",Is,i(Number(b.price_grosir).toLocaleString()),1)])])]),t("td",Vs,[n(l(T),{onClick:$=>w(b),size:"sm",class:"bg-green-600 hover:bg-green-700 text-white rounded-md shadow-sm px-3 py-1 text-xs"},{default:r(()=>[n(l(Wt),{class:"h-4 w-4"})]),_:2},1032,["onClick"])])])}),128))])])])):(u(),d("div",ws," Tidak ada produk tanpa master ditemukan. ")),t("div",Bs,[t("span",Rs," Page "+i(c.value.current_page)+" dari "+i(S.value),1),t("div",Ls,[n(l(T),{onClick:g[3]||(g[3]=b=>m(c.value.current_page-1)),disabled:c.value.current_page===1||U.value,variant:"outline",class:"px-4 py-2 border border-gray-300 text-sm text-gray-700 disabled:opacity-50"},{default:r(()=>g[9]||(g[9]=[_(" Previous ")])),_:1,__:[9]},8,["disabled"]),n(l(T),{onClick:g[4]||(g[4]=b=>m(c.value.current_page+1)),disabled:c.value.current_page>=S.value||U.value,variant:"outline",class:"px-4 py-2 border border-gray-300 text-sm text-gray-700 disabled:opacity-50"},{default:r(()=>g[10]||(g[10]=[_(" Next ")])),_:1,__:[10]},8,["disabled"])])]),n(ue,{show:k.value,onClose:g[5]||(g[5]=b=>k.value=!1)},{header:r(()=>g[11]||(g[11]=[t("h3",{class:"text-lg font-medium text-gray-900"},"Tambah Produk Tanpa Master",-1)])),default:r(()=>[n(st,{onProductSaved:ge})]),_:1},8,["show"])]))}}),Ks={class:"min-h-screen space-y-4 bg-gray-50 p-2 md:p-4"},Es={class:"grid grid-cols-1 gap-3 md:grid-cols-5 md:gap-2"},Fs={class:"flex flex-col md:col-span-2 lg:col-span-2"},Gs={class:"mb-2 flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between"},Hs={class:"flex flex-col gap-2 md:gap-3"},Qs=["onClick"],Ws={class:"flex-shrink-0"},Js=["src"],Ys={key:1,class:"flex h-16 w-16 select-none items-center justify-center rounded bg-gray-200 text-xs text-gray-400"},Zs={class:"flex min-w-0 flex-1 flex-col justify-between"},Xs={class:"flex items-center gap-2"},ea={class:"flex-1 truncate text-xs font-semibold text-gray-900 md:text-sm"},ta={key:0,class:"ml-1 rounded bg-orange-500 px-2 py-0.5 text-[14px] font-bold text-white md:text-xs"},sa={class:"text-[10px] text-gray-400 md:text-xs"},aa={key:0,class:"mt-2"},la={class:"mt-1 flex flex-wrap gap-2"},na={class:"text-[10px] text-gray-400 line-through md:text-xs"},oa={class:"text-xs font-semibold text-green-600 md:text-sm"},ia={class:"text-[10px] text-green-500 md:text-xs"},ra={key:1,class:"text-xs font-semibold text-gray-700 md:text-sm"},ua={class:"flex flex-col bg-gray-100 md:col-span-2 lg:col-span-3"},da={class:"flex flex-wrap gap-1 p-2 md:gap-1"},ca={key:0,class:"select-none py-8 text-center text-xs text-gray-400"},pa={class:"overflow-auto p-2"},va={class:"md-grid-cols-2 relative flex grid-cols-1 items-center justify-center"},fa=["checked","onChange"],ma={class:"max-w-[140px] truncate font-semibold text-gray-900"},_a={class:"max-w-[140px] truncate font-semibold text-gray-900"},ga={key:0,class:"text-[10px] text-gray-400 line-through"},ya={class:"block font-semibold text-gray-900"},xa={class:"text-[11px] text-gray-600"},ba={key:1,class:"text-[11px] text-green-600"},ha=["max","onUpdate:modelValue"],ka={key:1,class:"mt-4 flex flex-col items-start gap-2 rounded-xl bg-gray-100 p-4 shadow-sm sm:flex-row sm:items-center sm:justify-between"},wa={class:"text-xs text-gray-800"},$a={class:"text-xs text-gray-600"},Ca={class:"text-xs text-gray-800"},qa={class:"mt-2 gap-4 rounded-lg p-1 p-4 shadow-sm"},za=["value"],Pa={class:"mt-4 gap-4 border-t p-4 pt-2"},Ta={class:"mb-2 flex justify-between text-xs font-semibold text-gray-700"},ja={class:"font-bold"},Sa={key:0},Da={key:1},Aa={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 p-4"},Ma={class:"w-full max-w-xs rounded-xl bg-white p-6 shadow-lg"},Na={class:"flex justify-end gap-3"},Ua={key:1,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 p-4"},Ia={class:"w-full max-w-sm rounded-lg bg-white p-6 shadow-lg"},Va={class:"mb-4 flex justify-between"},Ba={class:"font-semibold"},Ra={class:"mb-4 flex justify-between"},La={class:"font-semibold text-green-600"},Oa={class:"flex justify-end space-x-3"},Ka={class:"h-64 w-full"},Ea={key:0,class:"space-y-4"},Fa={class:"flex items-center gap-4"},Ga=["src"],Ha={key:1,class:"flex h-24 w-24 select-none items-center justify-center rounded bg-gray-200 text-xs text-gray-400"},Qa={class:"text-lg font-semibold"},Wa={class:"flex flex-wrap gap-2"},Ja=["onClick"],Ya=["onClick"],Za={key:0,class:"mb-4"},Xa={class:"flex flex-wrap gap-2"},el=["onClick"],tl={class:"mb-4"},sl={key:0,class:"mb-4 text-sm text-gray-700"},al={key:0,class:"mr-2 text-gray-400 line-through"},ll={class:"font-bold"},nl={key:1,class:"text-xs text-green-600"},ol={class:"flex justify-end gap-2"},il={class:"mb-4 flex flex-col items-stretch gap-2 sm:flex-row sm:items-center"},rl={class:"max-h-[60vh] overflow-auto rounded-lg border border-gray-200 shadow-sm"},ul={class:"space-y-2"},dl={class:"mt-2 flex justify-end gap-2"},cl={key:0,class:"mt-1 text-xs text-red-600"},pl={key:1,class:"mt-1 text-xs text-red-600"},vl={key:2,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-30 p-4"},fl={class:"text-center"},ml={class:"text-[12px] font-bold"},_l={class:"mb-1"},gl={class:"font-bold"},yl={class:"flex justify-between p-1"},xl={key:0},bl={class:"flex justify-between"},hl={class:"text-green-600"},kl={class:"flex justify-between"},wl={class:"flex justify-between"},$l={class:"flex justify-between"},Cl={class:"flex justify-between"},ql={class:"flex justify-between"},zl={class:"no-print mt-2 flex justify-end gap-2"},Pl=De({__name:"POS",setup(Me){const Y=p(!1),W=p(!1),Z=p(!1),X=p(!1),h=Ae(),U=p([]),ee=p([]),k=p([]),c=p([]),S=p(null),I=p({placingOrder:!1}),m=Jt(0),w=p(""),ge=p(1),F=p(1),g=p(0),b=p([]),te=p(!1),$=p(null);function at(s){$.value=s,H.value=null,D.value=null,$.value.variant==="all"&&$.value.sizes&&$.value.sizes.length>0&&(D.value=$.value.sizes[0].size_id),te.value=!0}const ye=p(!1),xe=p(!1),R=p(null),N=p(null),L=p([]),se=p(0),de=p(""),ce=p(""),G=p(""),we=p(null),lt=p(null),$e=p(!1),Ce=p(!1),ve=p(""),fe=p([]),Ne=p(null),me=p(null),pe=p(1),oe=p(0),ae=p(""),be=p(!1),H=p(null),D=p(null);async function nt(){try{const s=await ne.get("/api/orders/search",{params:{search:ve.value}});fe.value=s.data.data}catch(s){console.error("Error searching transactions:",s),alert("Failed to search transactions.")}}async function ot(s){confirm("Yakin mau tampilkan struk untuk dicetak ulang?")&&(Ne.value=s,ce.value=Pe(s.created_at),G.value=s.id,N.value=s.customer,L.value=s.order_items.map(e=>({product_id:e.product_id,product_name:e.product_name,quantity:Number(e.quantity),price:Number(e.price),discount:Number(e.discount),price_sell:Number(e.price_sell),variant:e.variant||"",uom_id:e.uom_id,size_id:e.size_id,qty_stock:e.qty_stock,image_path:e.image_path})),se.value=s.total_amount,de.value=s.payment_method,j.value=s.paid_amount,ye.value=!0,Ve())}const j=p(null),Ue=Q(()=>j.value!==null&&j.value>O.value?j.value-O.value:0),it=Q(()=>{var e;if(!((e=$.value)!=null&&e.sizes))return[];const s=$.value.sizes.map(a=>a.variant);return[...new Set(s)]}),rt=async s=>{if(s.length<2){U.value=[];return}try{const e=await ne.get("/api/product-with-size",{params:{search:s}});ee.value=e.data.data}catch(e){console.error("Search error:",e),h.error("Failed to search products")}};function ut(s,e){return s?s.filter(a=>a.variant===e):[]}function dt(s){H.value=s,Ie.value.some(a=>a.size_id===D.value)||(D.value=null)}function ct(s,e){s&&(s.size_id=e.size_id,D.value=e.size_id),$.value&&($.value.price=e.price,$.value.price_sell=e.price_sell)}function pt(){$e.value=!0}function vt(){Ce.value=!0,fe.value=[],ve.value=""}const Ie=Q(()=>$.value?$.value.variant==="all"?$.value.sizes.map(s=>s):H.value?$.value.sizes.filter(s=>s.variant===H.value):[]:[]);function qe(){$e.value=!1,me.value=null,pe.value=1,oe.value=0,ae.value="",be.value=!1}function Ve(){Ce.value=!1,ve.value="",fe.value=[],Ne.value=null}async function ft(){if(ae.value="",be.value=!1,!me.value){ae.value="Produk harus dipilih";return}const s=me.value;if(!s||!s.id){ae.value="Produk harus dipilih";return}if(!pe.value||pe.value<1){ae.value="Qty minimal 1";return}if(!oe.value||oe.value<0){ae.value="Harga retur harus diisi";return}k.value.push({id:s.id,product_id:s.id,product_name:s.product_name??"",size_id:s.size_id??"",uom_id:s.uom_id??"",qty_stock:0,qty_available:0,image_path:"",sizes:[],variant:null,quantity:-Math.abs(pe.value),price:oe.value,price_sell:oe.value,isReturn:!0}),be.value=!0,setTimeout(()=>{qe()},1e3)}const ie=p("TOKO ANINKA"),re=p("Blok A lantai SLG Los F No 91-92"),he=Vt().props.auth.user,mt=he==null?void 0:he.location_id;async function _t(){if(mt)try{const s=await ne.get("/api/locations/get");ie.value=s.data.name||"TOKO ANINKA",re.value=s.data.address||"Blok A lantai SLG Los F No 91-92"}catch{ie.value="TOKO ANINKA",re.value="Blok A lantai SLG Los F No 91-92"}}_t();const gt=Q(()=>L.value.reduce((s,e)=>s+(e.discount??0)*e.quantity,0)),yt=Q(()=>L.value.reduce((s,e)=>s+e.price*e.quantity,0)),ke=p(!1),ze=Q(()=>he.name??"Kasir"),Be=s=>s?s.startsWith("storage/")?"/"+s:s.startsWith("/storage/")?s:"/storage/"+s:"",y=s=>typeof s!="number"||isNaN(s)?"0,00":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s),xt=s=>{const e=b.value.indexOf(s);e===-1?b.value.push(s):b.value.splice(e,1)},le=Q(()=>!D.value||!$.value?null:$.value.variant==="all"?$.value.sizes.find(s=>s.size_id===D.value):H.value?$.value.sizes.find(s=>s.variant===H.value&&s.size_id===D.value):null);async function Re(){try{const s=await ne.get(`/api/stock?page=${ge.value}&search=${w.value}`);U.value=s.data.data,F.value=s.data.last_page}catch(s){console.error("Error fetching products:",s),h.error("Failed to fetch products")}}async function bt(){try{const s=await ne.get("/api/payment-methods");c.value=s.data.data}catch{h.error("Failed to fetch payment methods")}}function ht(){ge.value=1,Re()}const Le=s=>{if(!s.is_unlisted&&s.qty_stock<=0){h.error("Stok tidak cukup");return}if(s.price<=0&&(!s.price_sell||s.price_sell<=0)){h.error("Harga produk belum ditentukan");return}let e;if(s.sizes&&s.sizes.length>0){if(!D.value){h.error("Silahkan pilih ukuran terlebih dahulu");return}if(e=s.sizes.find(o=>o.size_id===D.value&&(H.value===null||o.variant===H.value)),!s.is_unlisted&&(!e||e.qty_stock<=0)){h.error("Stok ukuran ini tidak tersedia");return}}const a=1,v=e==null?void 0:e.price_retail,f=e==null?void 0:e.price_sell_retail,P=e==null?void 0:e.discount_retail;if(s.sizes.length&&!e){h.error("Ukuran tidak valid.");return}const x={id:s.product_id||s.id,product_id:s.product_id||s.id,product_name:s.product_name,uom_id:s.uom_id,size_id:(e==null?void 0:e.size_id)??"",qty_stock:(e==null?void 0:e.qty_stock)??s.qty_stock,qty_available:((e==null?void 0:e.qty_stock)??s.qty_stock)-a,image_path:s.image_path??"",price:v??s.price,price_sell:f??s.price_sell??s.price,discount:P??s.discount??0,quantity:a,variant:(e==null?void 0:e.variant)??s.variant??null,sizes:e?[{...e,qty_in_cart:a,qty_available:e.qty_stock-a}]:[],is_unlisted:s.is_unlisted||!1,isManualDiscount:!1},C=k.value.find(o=>o.id===x.id&&o.size_id===x.size_id&&o.variant===x.variant);if(C){C.quantity+=a;const o=C.quantity>1;!C.isManualDiscount&&e&&(C.price=e[o?"price_grosir":"price_retail"]??C.price,C.price_sell=e[o?"price_sell_grosir":"price_sell_retail"]??C.price_sell,C.discount=e[o?"discount_grosir":"discount_retail"]??C.discount)}else k.value.push(x);te.value=!1,Rt(()=>{we.value&&(we.value.scrollTop=we.value.scrollHeight)})};function kt(s){k.value=k.value.filter(e=>e.id!==s)}function wt(){k.value.length!==0&&(Y.value=!0)}function $t(){k.value=k.value.map(s=>b.value.includes(s.id+s.size_id)?{...s,discount:g.value,price_sell:s.price-g.value,isManualDiscount:!0}:s),b.value=[],Y.value=!1,h.success("Discount applied successfully")}function Ct(s){const e={id:s.id,product_id:s.id,product_name:s.name,uom_id:s.uom_id||"PCS",size_id:s.size_id,qty_stock:s.qty||1,qty_available:s.qty||1,image_path:s.image_path||"",price:s.price_store,price_sell:s.price_store,discount:0,variant:s.variant,is_unlisted:!0,sizes:[{size_id:s.size_id,variant:s.variant,qty_stock:s.qty||1,qty_in_cart:0,qty_available:s.qty||1,price:s.price_store,price_sell:s.price_store,discount:0,price_retail:s.price_store,discount_retail:0,price_sell_retail:s.price_store,price_grosir:s.price_grosir,discount_grosir:0,price_sell_grosir:s.price_grosir}]};D.value=e.size_id,Le(e),X.value=!1,D.value=null}function qt(){if(k.value.length===0){h.error("Please add items to the cart");return}if(!S.value){h.error("Please select a payment method");return}j.value=null,ke.value=!0}async function Oe(){if(c.value.length===0){h.error("No payment methods available");return}const s=c.value.find(e=>e.id===S.value);if((!s||s.name!=="CREDIT")&&(j.value===null||j.value<O.value)){h.error("Paid amount must be at least total amount");return}ke.value=!1,await Pt()}function Ke(){k.value=[],S.value=null,N.value="",G.value="",b.value=[]}async function Ee(s=null){if(typeof s=="number"&&(R.value=s),typeof R.value=="number")try{const e=await ne.get(`/api/customers/get/${R.value}`);N.value=e.data.name,h.success(`Pelanggan ${N.value} berhasil ditambahkan.`)}catch(e){console.error("Error fetching customer details:",e),h.error("Gagal mengambil detail pelanggan."),R.value=null,N.value=null}else xe.value=!0}const zt=s=>{R.value=s.id,N.value=s.name,xe.value=!1},O=Q(()=>k.value.reduce((s,e)=>s+(e.price_sell??e.price)*e.quantity,0)),Fe=Q(()=>`${y(O.value)}`);async function Pt(){var s;if(k.value.length===0){h.error("Please add items to the cart");return}if(!S.value){h.error("Please select a payment method");return}I.value.placingOrder=!0;try{const e=k.value.map(f=>{const P=f.discount||0;return{product_id:f.product_id??f.id,product_name:f.product_name,quantity:f.quantity,price:f.price,uom_id:f.uom_id,size_id:f.size_id||null,qty_stock:0,image_path:"",discount:P,price_sell:f.price_sell??f.price-P,variant:f.variant||"all"}}),a={items:e,payment_method_id:S.value,total_amount:O.value,paid_amount:j.value,customer_id:R.value,transaction_number:G.value||""},v=await ne.post("/api/pos/orders",a);L.value=e.map(f=>{var P;return{...f,uom_id:((P=k.value.find(x=>(x.product_id??x.id)===f.product_id))==null?void 0:P.uom_id)||""}}),se.value=v.data.total_amount,de.value=((s=c.value.find(f=>f.id===S.value))==null?void 0:s.name)||"",ce.value=Pe(v.data.created_at),G.value=v.data.transaction_number||"",R.value=null,ye.value=!0}catch(e){console.error("Error placing order:",e),h.error("Failed to place order")}finally{I.value.placingOrder=!1}}function Tt(){ye.value=!1,Ke(),S.value=null}const jt=async s=>{var a;if(s.length===0)return;const e=s[0].rawValue;console.log("QR Code detected:",e),W.value=!1;try{const v=e.split(",").map(o=>o.trim()),P=(await ne.get("/api/orders/scan",{params:{ids:v.join(",")}})).data,x=[];if(P.length>0&&(R.value=P[0].customer_id,N.value=((a=P[0].customer)==null?void 0:a.name)||"Guest",G.value=v.join(",")),P.forEach(o=>{var z;(z=o==null?void 0:o.order_items)!=null&&z.length&&x.push(...o.order_items)}),x.length===0){h.error("No order items found for the scanned QR code(s).");return}const C=x.map(o=>({id:o.product_id,product_id:o.product_id,product_name:o.product_name,uom_id:o.uom_id,size_id:o.size_id||"",qty_stock:o.qty_stock,image_path:o.image_path,price:o.price,price_sell:o.price_sell,discount:o.discount,quantity:o.quantity??1,variant:o.variant||"all",sizes:o.size_id?[{size_id:o.size_id,variant:o.variant||"all",qty_stock:o.qty_stock,qty_in_cart:o.quantity??1,qty_available:o.qty_stock,price:o.price,price_sell:o.price_sell,discount:o.discount,price_retail:o.price,price_sell_retail:o.price_sell,discount_retail:o.discount,price_grosir:o.price,price_sell_grosir:o.price_sell,discount_grosir:o.discount}]:[]}));console.log("Produk dalam pesanan:",C),C.forEach(o=>{const z=k.value.findIndex(J=>(J.product_id??J.id)===(o.product_id??o.id)&&J.size_id===o.size_id);z>-1?k.value[z].quantity+=o.quantity:k.value.push({...o})}),h.success("Order items added to cart!"),R.value&&Ee(R.value)}catch(v){console.error("Error scanning QR code:",v),h.error("Failed to scan QR code or retrieve order details.")}},Ge=new WeakMap;Te(k,s=>{s.forEach(e=>{Ge.has(e)||(Ge.set(e,!0),Te(()=>e.quantity,a=>{if(!(!e.sizes||e.sizes.length===0))if(e.isManualDiscount){const v=e.sizes[0],f=a>1;e.price=f?v.price_grosir:v.price_retail,e.price_sell=e.price-(e.discount||0),v.qty_in_cart=a,v.qty_available=v.qty_stock-a}else{const v=e.sizes[0],f=a>1;e.price=f?v.price_grosir:v.price_retail,e.price_sell=f?v.price_sell_grosir:v.price_sell_retail,e.discount=f?v.discount_grosir:v.discount_retail,v.qty_in_cart=a,v.qty_available=v.qty_stock-a}}))})},{deep:!0}),Te(m.internalValue,s=>{j.value=s});function St(){const s=window.qz,e=ze.value;if(s){const x=L.value.reduce((z,J)=>z+J.quantity,0),C=(se.value||O.value)-(j.value||0),o=[];o.push(`     ${ie.value}`),o.push(` ${re.value}`),o.push("----------------------------------------"),o.push(`Kasir   : ${e}`),o.push(`Tanggal : ${ce.value}`),o.push(`Nomor   : ${G.value}`),o.push("------------------------------------"),o.push(`Customer: ${N.value||"-"}`),o.push("--------------------------------------"),L.value.forEach(z=>{o.push(`${z.product_name}${z.size_id?" - "+z.size_id:""} ${z.variant?" "+z.variant:""}`),o.push(`${z.quantity} x ${y(z.price)}${" ".repeat(20-(z.quantity+"").length-y(z.price).length)}${y(z.quantity*z.price)}`)}),o.push("--------------------------------"),o.push(`Total QTY        ${x}`),o.push(`Total Bayar      ${y(se.value||O.value)}`),o.push(`Jenis Bayar      ${de.value||"-"}`),o.push(`Bayar Cash       ${y(j.value||0)}`),o.push(`Sisa             ${y(C>0?C:0)}`),o.push("--------------------------------------"),o.push("      ---TERIMA KASIH---"),o.push("     aninkafashion.com"),o.push(`


`),s.websocket.connect().then(()=>s.printers.find()).then(z=>{const J=s.configs.create(z);return s.print(J,[{type:"raw",format:"plain",data:o.join(`
`)}])}).catch(z=>{alert("Print error: "+z)}).finally(()=>{s.websocket.disconnect()});return}const a=L.value.reduce((x,C)=>x+C.quantity,0),v=(se.value||O.value)-(j.value||0),f=`
    <div style="font-family: 'Courier New', Courier, monospace; font-size: 12px; width: 80mm; padding: 0; margin: 0;">
      <div style="text-align:center; font-weight:bold;">${ie.value}</div>
      <div style="text-align:center;">${re.value}</div>
      <div style="text-align:center;">----------------------------------------</div>
      <div style="display:flex; justify-content:space-between;">
        <span>Kasir   : ${e}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Tanggal : ${ce.value}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Nomor   : ${G.value}</span>
      </div>
      <div style="text-align:center;">----------------------------------------</div>
      <div style="display:flex; justify-content:space-between;">
        <span>Customer</span>
        <span>${N.value||"-"}</span>
      </div>
      <div style="text-align:center;">----------------------------------------</div>
      ${L.value.map(x=>`
          <div>${x.product_name} - ${x.size_id} ${x.variant} </div>
          <div style="display:flex; justify-content:space-between;">
            <span>${x.quantity} x ${y(x.price)}</span>
            <span>${y(x.quantity*x.price)}</span>
          </div>
        `).join("")}
      <div style="text-align:center;">----------------------------------------</div>
      <div style="display:flex; justify-content:space-between;">
        <span>Total QTY</span>
        <span>${a}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Total Bayar</span>
        <span>${y(se.value||O.value)}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Jenis Bayar</span>
        <span>${de.value||"-"}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Bayar Cash</span>
        <span>${y(j.value||0)}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Sisa</span>
        <span>${y(v>0?v:0)}</span>
      </div>
      <div style="text-align:center;">----------------------------------------</div>
      <div style="text-align:center; margin-top:8px;">---TERIMA KASIH---</div>
      <div style="text-align:center;">aninkafashion.com</div>
    </div>
  `,P=window.open("","","height=600,width=400");if(!P){alert("Please allow pop-ups for printing.");return}P.document.write(`
    <html>
      <head>
        <title>Print Struk</title>
        <style>
          @media print {
            body { margin: 0; }
            div { font-family: 'Courier New', Courier, monospace; font-size: 12px; }
          }
        </style>
      </head>
      <body>
        ${f}
        <script>
          window.onload = function() {
            setTimeout(function() {
              window.print();
              window.onafterprint = function() { window.close(); };
            }, 100);
          };
        <\/script>
      </body>
    </html>
  `),P.document.close()}function Dt(){const e="-".repeat(46),v=[ie.value.padStart(Math.floor((46+ie.value.length)/2)),re.value.padStart(Math.floor((46+re.value.length)/2)),e,`Kasir   : ${ze.value}`,`Tanggal : ${ce.value}`,`Nomor   : ${G.value}`,e,`Customer: ${N.value||"-"}`,e,...L.value.flatMap(x=>{const C=x.product_name+" - "+x.size_id+(x.variant?" "+x.variant:""),o=`${x.quantity} x ${y(x.price)}`,z=y(x.quantity*x.price),J=o.padEnd(23),Nt=z.padStart(23);return[C.length>46?C.slice(0,46):C,`${J}${Nt}`]}),e,`Total QTY   : ${L.value.reduce((x,C)=>x+C.quantity,0)}`,`Total Bayar : ${y(se.value||O.value)}`,`Jenis Bayar : ${de.value||"-"}`,`Bayar Cash  : ${y(j.value||0)}`,`Sisa        : ${y((se.value||O.value)-(j.value||0))}`,e,"---TERIMA KASIH---".padStart(Math.floor(64/2)),"aninkafashion.com".padStart(Math.floor(65/2)),`


`].join(`
`),P=`intent://${encodeURIComponent(v).replace(/'/g,"%27").replace(/"/g,"%22")}#Intent;scheme=rawbt;package=ru.a402d.rawbtprinter;end;`;window.location.href=P}function At(){Mt()?Dt():St()}function Mt(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}const Pe=s=>{if(!s)return"-";const e=new Date(s),v=new Intl.DateTimeFormat("id-ID",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"Asia/Jakarta"}).formatToParts(e),f=P=>{var x;return((x=v.find(C=>C.type===P))==null?void 0:x.value)||""};return`${f("day")}/${f("month")}/${f("year")} ${f("hour")}:${f("minute")} WIB`};return Re(),bt(),(s,e)=>(u(),d(M,null,[n(l(Bt),{title:"Point of Sale"}),n(Kt,null,{default:r(()=>[t("div",Ks,[t("div",Es,[t("section",Fs,[t("div",Gs,[e[24]||(e[24]=t("h2",{class:"text-sm font-semibold text-gray-800"},"Produk Tersedia",-1)),A(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=a=>w.value=a),onInput:ht,placeholder:"Cari produk...",class:"focus:ring-primary-500 w-full max-w-xs rounded-md border border-gray-300 px-2 py-1 text-xs focus:outline-none focus:ring-2 md:text-sm"},null,544),[[B,w.value]]),n(l(T),{onClick:e[1]||(e[1]=a=>X.value=!0),class:"flex items-center justify-center rounded-md bg-purple-600 p-2 text-white hover:bg-purple-700",title:"Tambah Produk"},{default:r(()=>[n(l(Yt),{class:"h-4 w-4"}),e[23]||(e[23]=_(" Tambah Produk "))]),_:1,__:[23]})]),t("div",Hs,[(u(!0),d(M,null,E(U.value,a=>(u(),d("div",{key:a.id,onClick:v=>at(a),class:"flex cursor-pointer flex-row items-center gap-2 rounded-lg border border-gray-200 bg-white p-2 shadow-sm transition hover:shadow-md md:gap-3 md:p-3"},[t("div",Ws,[a.image_path?(u(),d("img",{key:0,src:Be(a.image_path),alt:"Gambar produk",class:"h-16 w-16 rounded object-cover"},null,8,Js)):(u(),d("div",Ys," Tidak Ada Gambar "))]),t("div",Zs,[t("div",Xs,[t("p",ea,i(a.product_name),1),a.discount&&a.price?(u(),d(M,{key:0},[a.discount>0?(u(),d("span",ta,i(Math.round(a.discount/a.price*100))+"% ",1)):q("",!0)],64)):q("",!0)]),t("p",sa,"Stok: "+i(a.qty_available)+" / "+i(a.uom_id),1),a.variant?(u(),d("div",aa,[e[25]||(e[25]=t("p",{class:"text-xs text-gray-500"},"Tersedia Ukuran:",-1)),t("div",la,[(u(!0),d(M,null,E(ut(a.sizes,a.variant),v=>(u(),d("div",{class:"rounded-full border px-3 py-1 text-xs font-medium",key:v.size_id},i(v.size_id),1))),128))])])):q("",!0),t("div",null,[a.discount&&a.discount>0?(u(),d(M,{key:0},[t("p",na,i(y(a.price)),1),t("p",oa,i(y(a.price_sell??a.price-a.discount)),1),t("p",ia,"(Diskon "+i(y(a.discount))+")",1)],64)):(u(),d("p",ra,i(y(a.price)),1))])])],8,Qs))),128))])]),t("section",ua,[t("div",da,[n(l(T),{variant:"outline",size:"sm",onClick:wt,disabled:b.value.length===0,class:"flex items-center gap-1 bg-indigo-100"},{default:r(()=>[n(l(Zt),{class:"h-4 w-4"}),_(" Disc ("+i(b.value.length)+") ",1)]),_:1},8,["disabled"]),n(l(T),{variant:"outline",size:"sm",onClick:e[2]||(e[2]=a=>W.value=!0),class:"flex items-center gap-1"},{default:r(()=>[n(l(Xt),{class:"h-4 w-4"}),e[26]||(e[26]=_(" QR "))]),_:1,__:[26]}),n(l(T),{variant:"outline",size:"sm",onClick:e[3]||(e[3]=()=>Ee()),class:"flex items-center gap-1"},{default:r(()=>[n(l(es),{class:"h-4 w-4"}),e[27]||(e[27]=_(" Cust "))]),_:1,__:[27]}),n(l(T),{variant:"outline",size:"sm",onClick:pt,class:"flex items-center gap-1"},{default:r(()=>[n(l(ts),{class:"h-4 w-4"}),e[28]||(e[28]=_(" Retur "))]),_:1,__:[28]}),n(l(T),{variant:"outline",size:"sm",onClick:e[4]||(e[4]=a=>vt()),class:"flex items-center gap-1"},{default:r(()=>[n(l(ss),{class:"h-4 w-4"}),e[29]||(e[29]=_(" RePrint "))]),_:1,__:[29]}),n(l(T),{variant:"outline",size:"sm",onClick:Ke,class:"flex items-center gap-1"},{default:r(()=>[n(l(Ze),{class:"h-4 w-4"}),e[30]||(e[30]=_(" Clear "))]),_:1,__:[30]})]),k.value.length===0?(u(),d("div",ca," Tidak ada item di keranjang ")):q("",!0),t("div",pa,[n(l(We),null,{default:r(()=>[n(l(Je),null,{default:r(()=>[n(l(_e),null,{default:r(()=>[n(l(K),{class:"text-xs"},{default:r(()=>e[31]||(e[31]=[_("#")])),_:1,__:[31]}),n(l(K),{class:"text-xs"},{default:r(()=>e[32]||(e[32]=[_("Nama")])),_:1,__:[32]}),n(l(K),{class:"text-center text-xs"},{default:r(()=>e[33]||(e[33]=[_("Qty")])),_:1,__:[33]}),n(l(K),{class:"text-center text-xs"},{default:r(()=>e[34]||(e[34]=[_("Total")])),_:1,__:[34]}),n(l(K),{class:"text-center text-xs"},{default:r(()=>e[35]||(e[35]=[_("Aksi")])),_:1,__:[35]})]),_:1})]),_:1}),n(l(Ye),null,{default:r(()=>[(u(!0),d(M,null,E(k.value,a=>(u(),je(l(_e),{key:a.id},{default:r(()=>[n(l(V),null,{default:r(()=>[t("div",va,[t("input",{type:"checkbox",checked:b.value.includes(a.id+a.size_id),onChange:v=>xt(a.id+a.size_id),class:"text-primary-600 focus:ring-primary-500 absolute left-0 top-0 rounded border-gray-300",title:"Pilih untuk diskon"},null,40,fa)])]),_:2},1024),n(l(V),{class:"text-xs"},{default:r(()=>[t("div",ma,i(a.product_name),1),t("div",_a,"Ukuran : "+i(a.size_id),1),a.discount&&a.discount>0?(u(),d("span",ga,i(y(a.price)),1)):q("",!0),t("span",ya,i(y(a.price_sell||a.price-(a.discount||0))),1),t("span",xa,"Variant: "+i(a.variant||""),1),a.discount&&a.discount>0?(u(),d("div",ba," Diskon: -"+i(y(a.discount)),1)):q("",!0)]),_:2},1024),n(l(V),{class:"text-center"},{default:r(()=>[A(t("input",{type:"number",min:"1",max:a.qty_available,"onUpdate:modelValue":v=>a.quantity=v,class:"w-12 rounded border px-1 py-0.5 text-center text-xs"},null,8,ha),[[B,a.quantity,void 0,{number:!0}]])]),_:2},1024),n(l(V),{class:"text-right text-xs font-semibold text-gray-900"},{default:r(()=>[_(i(y(a.quantity*(a.price_sell||a.price))),1)]),_:2},1024),n(l(V),{class:"text-center"},{default:r(()=>[n(l(T),{variant:"ghost",size:"icon",onClick:v=>kt(a.id),class:"hover:bg-gray-100"},{default:r(()=>[n(l(Ze),{class:"h-4 w-4"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),N.value?(u(),d("div",ka,[t("div",null,[e[36]||(e[36]=t("p",{class:"text-sm font-medium text-gray-500"},"Pelanggan",-1)),t("p",wa,[_(i(N.value)+" ",1),t("span",$a,"(#"+i(R.value)+")",1)])]),t("div",null,[e[37]||(e[37]=t("p",{class:"text-sm font-medium text-gray-500"},"Transaksi Online",-1)),t("p",Ca,i(G.value),1)])])):q("",!0),t("div",qa,[e[39]||(e[39]=t("label",{class:"mb-1 block text-xs font-medium text-gray-900"},"Metode Pembayaran",-1)),A(t("select",{"onUpdate:modelValue":e[5]||(e[5]=a=>S.value=a),class:"focus:ring-primary-500 w-full rounded-lg border border-gray-300 p-1 text-xs focus:outline-none focus:ring-2"},[e[38]||(e[38]=t("option",{value:""},"Pilih metode pembayaran",-1)),(u(!0),d(M,null,E(c.value,a=>(u(),d("option",{key:a.id,value:a.id},i(a.name),9,za))),128))],512),[[Se,S.value]])]),t("div",Pa,[t("div",Ta,[e[40]||(e[40]=t("span",null,"Total",-1)),t("span",ja,i(Fe.value),1)]),n(l(T),{class:"w-full rounded-md bg-indigo-600 py-2 text-xs font-semibold text-white hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500",onClick:qt,disabled:I.value.placingOrder},{default:r(()=>[I.value.placingOrder?(u(),d("span",Sa,"Memproses...")):(u(),d("span",Da,"Bayar"))]),_:1},8,["disabled"])])])]),Y.value?(u(),d("div",Aa,[t("div",Ma,[e[41]||(e[41]=t("h3",{class:"mb-4 text-lg font-semibold"},"Set Discount",-1)),e[42]||(e[42]=t("label",{class:"mb-2 block text-sm font-medium"},"Discount Price",-1)),A(t("input",{type:"number","onUpdate:modelValue":e[6]||(e[6]=a=>g.value=a),class:"focus:ring-primary-500 mb-4 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2"},null,512),[[B,g.value,void 0,{number:!0}]]),t("div",Na,[t("button",{onClick:$t,class:"rounded bg-green-600 px-4 py-2 text-sm text-white hover:bg-green-700"},"Save"),t("button",{onClick:e[7]||(e[7]=a=>Y.value=!1),class:"rounded bg-gray-300 px-4 py-2 text-sm text-gray-700 hover:bg-gray-400"}," Cancel ")])])])):q("",!0),ke.value?(u(),d("div",Ua,[t("div",Ia,[e[47]||(e[47]=t("h3",{class:"mb-4 text-lg font-semibold"},"Masukkan Jumlah Bayar",-1)),A(t("input",{type:"number",min:"0","onUpdate:modelValue":e[8]||(e[8]=a=>j.value=a),onKeypress:et(Oe,["enter"]),class:"mb-4 w-full rounded border px-3 py-2 text-lg",placeholder:"Masukkan jumlah bayar"},null,544),[[B,j.value,void 0,{number:!0}]]),t("div",Va,[e[43]||(e[43]=t("div",null,"Total:",-1)),t("div",Ba,i(Fe.value),1)]),t("div",Ra,[e[44]||(e[44]=t("div",null,"Kembalian:",-1)),t("div",La,i(y(Ue.value)),1)]),t("div",Oa,[n(l(T),{variant:"outline",onClick:e[9]||(e[9]=a=>ke.value=!1)},{default:r(()=>e[45]||(e[45]=[_("Batal")])),_:1,__:[45]}),n(l(T),{onClick:Oe,class:"rounded-md bg-indigo-600 py-2 text-white hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:r(()=>e[46]||(e[46]=[_("Konfirmasi")])),_:1,__:[46]})])])])):q("",!0),n(ue,{show:W.value,onClose:e[10]||(e[10]=a=>W.value=!1),title:"Scan QR Code"},{default:r(()=>[t("div",Ka,[n(l(Ft),{onDetect:jt})])]),_:1},8,["show"]),n(ue,{show:te.value,onClose:e[13]||(e[13]=a=>te.value=!1),title:"Detail Produk"},{default:r(()=>{var a,v;return[$.value?(u(),d("div",Ea,[t("div",Fa,[$.value.image_path?(u(),d("img",{key:0,src:Be($.value.image_path),alt:"Gambar produk",class:"h-24 w-24 rounded object-cover"},null,8,Ga)):(u(),d("div",Ha," Tidak Ada Gambar ")),t("div",null,[t("h3",Qa,i($.value.product_name),1),e[49]||(e[49]=t("span",{class:"mb-1 text-sm font-semibold text-gray-700"},"Pilih Ukuran ",-1)),t("div",Wa,[e[48]||(e[48]=t("br",null,null,-1)),(u(!0),d(M,null,E(Ie.value,f=>(u(),d("button",{key:f.size_id,onClick:P=>D.value=f.size_id,class:Qe(["rounded-full border px-3 py-1 text-sm font-semibold transition",D.value===f.size_id?"border-green-600 bg-green-600 text-white":"border-gray-300 bg-gray-200 text-gray-800 hover:bg-gray-300"])},[t("div",{onClick:P=>ct($.value,f)},i(f.size_id),9,Ya)],10,Ja))),128))])])]),((a=$.value)==null?void 0:a.variant)!=="all"?(u(),d("div",Za,[e[50]||(e[50]=t("h4",{class:"mb-1 text-sm font-semibold text-gray-700"},"Variant",-1)),t("div",Xa,[(u(!0),d(M,null,E(it.value,f=>(u(),d("button",{key:f,onClick:P=>dt(f),class:Qe(["rounded-full border px-3 py-1 text-sm font-semibold transition",H.value===f?"border-indigo-600 bg-indigo-600 text-white":"border-gray-300 bg-gray-200 text-gray-800 hover:bg-gray-300"])},i(f),11,el))),128))])])):q("",!0),t("div",tl,[le.value?(u(),d("div",sl,[t("p",null,[e[51]||(e[51]=_(" Stok: ")),t("strong",null,i(le.value.qty_available),1)]),(le.value.discount??0)>0?(u(),d("span",al," Harga "+i(y(le.value.price)),1)):q("",!0),e[52]||(e[52]=t("br",null,null,-1)),t("span",ll," Harga Diskon "+i(y(le.value.price_sell||le.value.price)),1),e[53]||(e[53]=t("br",null,null,-1)),(le.value.discount??0)>0?(u(),d("span",nl," (Diskon: "+i(y(le.value.discount??0))+") ",1)):q("",!0)])):q("",!0)]),t("div",ol,[n(l(T),{variant:"outline",onClick:e[11]||(e[11]=f=>te.value=!1)},{default:r(()=>e[54]||(e[54]=[_("Batal")])),_:1,__:[54]}),n(l(T),{onClick:e[12]||(e[12]=f=>Le($.value)),disabled:!D.value||!H.value&&((v=$.value)==null?void 0:v.variant)!=="all"},{default:r(()=>e[55]||(e[55]=[_("Tambah ke Keranjang")])),_:1,__:[55]},8,["disabled"])])])):q("",!0)]}),_:1},8,["show"]),n(ue,{show:Ce.value,onClose:Ve,title:"RePrint Struk"},{default:r(()=>[t("div",il,[n(l(Ot),{modelValue:ve.value,"onUpdate:modelValue":e[14]||(e[14]=a=>ve.value=a),class:"w-full text-sm sm:w-64",placeholder:"Cari transaksi...","aria-label":"Search"},null,8,["modelValue"]),n(l(T),{onClick:e[15]||(e[15]=a=>nt()),class:"w-full px-4 py-2 text-sm sm:w-auto"},{default:r(()=>e[56]||(e[56]=[_(" Cari ")])),_:1,__:[56]})]),t("div",rl,[n(l(We),{class:"min-w-full text-sm"},{default:r(()=>[n(l(Je),null,{default:r(()=>[n(l(_e),{class:"bg-gray-100 text-xs uppercase text-gray-600"},{default:r(()=>[n(l(K),{class:"whitespace-nowrap px-2 py-2"},{default:r(()=>e[57]||(e[57]=[_("Aksi")])),_:1,__:[57]}),n(l(K),{class:"whitespace-nowrap px-2 py-2"},{default:r(()=>e[58]||(e[58]=[_("Tanggal")])),_:1,__:[58]}),n(l(K),{class:"whitespace-nowrap px-2 py-2"},{default:r(()=>e[59]||(e[59]=[_("Customer")])),_:1,__:[59]}),n(l(K),{class:"whitespace-nowrap px-2 py-2"},{default:r(()=>e[60]||(e[60]=[_("Total")])),_:1,__:[60]}),n(l(K),{class:"whitespace-nowrap px-2 py-2"},{default:r(()=>e[61]||(e[61]=[_("Pembayaran")])),_:1,__:[61]}),n(l(K),{class:"whitespace-nowrap px-2 py-2"},{default:r(()=>e[62]||(e[62]=[_("Status")])),_:1,__:[62]})]),_:1})]),_:1}),n(l(Ye),null,{default:r(()=>[(u(!0),d(M,null,E(fe.value,a=>(u(),je(l(_e),{key:a.id,class:"cursor-pointer transition hover:bg-gray-50"},{default:r(()=>[n(l(V),{class:"px-2 py-1"},{default:r(()=>[n(l(T),{variant:"outline",size:"sm",onClick:v=>ot(a)},{default:r(()=>e[63]||(e[63]=[_(" Cetak ")])),_:2,__:[63]},1032,["onClick"])]),_:2},1024),n(l(V),{class:"px-2 py-1"},{default:r(()=>[_(i(Pe(a.created_at)),1)]),_:2},1024),n(l(V),{class:"px-2 py-1"},{default:r(()=>[_(i(a.customer),1)]),_:2},1024),n(l(V),{class:"px-2 py-1"},{default:r(()=>[_(i(y(Number(a.total_amount))),1)]),_:2},1024),n(l(V),{class:"px-2 py-1"},{default:r(()=>[_(i(a.payment_method),1)]),_:2},1024),n(l(V),{class:"px-2 py-1"},{default:r(()=>[_(i(a.status),1)]),_:2},1024)]),_:2},1024))),128)),fe.value.length===0?(u(),je(l(_e),{key:0},{default:r(()=>[n(l(V),{colspan:"6",class:"py-3 text-center text-xs text-gray-400"},{default:r(()=>e[64]||(e[64]=[_(" Tidak ada transaksi ditemukan. ")])),_:1,__:[64]})]),_:1})):q("",!0)]),_:1})]),_:1})])]),_:1},8,["show"]),n(ue,{show:$e.value,onClose:qe,title:"Retur Barang"},{default:r(()=>[t("div",ul,[e[67]||(e[67]=t("label",{class:"block text-xs font-medium"},"Produk",-1)),n(l(Et),{modelValue:me.value,"onUpdate:modelValue":e[16]||(e[16]=a=>me.value=a),options:ee.value,label:"product_title",value:"id",onSearch:rt,reduce:a=>({...a,name:a.product_name,product_name:a.product_name,size_id:a.size_id,uom_id:a.uom_id,qty_available:0}),placeholder:"Pilih Produk"},null,8,["modelValue","options","reduce"]),e[68]||(e[68]=t("label",{class:"block text-xs font-medium"},"Qty",-1)),A(t("input",{type:"number","onUpdate:modelValue":e[17]||(e[17]=a=>pe.value=a),min:"1",class:"w-full rounded border p-1 text-xs"},null,512),[[B,pe.value,void 0,{number:!0}]]),e[69]||(e[69]=t("label",{class:"block text-xs font-medium"},"Harga Retur",-1)),A(t("input",{type:"number","onUpdate:modelValue":e[18]||(e[18]=a=>oe.value=a),min:"0",class:"w-full rounded border p-1 text-xs"},null,512),[[B,oe.value,void 0,{number:!0}]]),t("div",dl,[n(l(T),{variant:"outline",onClick:qe},{default:r(()=>e[65]||(e[65]=[_("Batal")])),_:1,__:[65]}),n(l(T),{class:"bg-red-600 text-white",onClick:ft},{default:r(()=>e[66]||(e[66]=[_("Simpan")])),_:1,__:[66]})]),ae.value?(u(),d("div",cl,i(ae.value),1)):q("",!0),be.value?(u(),d("div",pl,"Retur berhasil ditambahkan ke keranjang!")):q("",!0)])]),_:1},8,["show"]),ye.value?(u(),d("div",vl,[t("div",{class:"print-area w-[450px] max-w-full rounded bg-white p-2 font-mono text-[10px] leading-tight shadow",ref_key:"printArea",ref:lt},[t("div",fl,[t("p",ml,i(ie.value),1),t("p",null,i(re.value),1)]),e[77]||(e[77]=t("hr",{class:"my-1 border-t border-dashed"},null,-1)),t("div",_l,[t("p",null,"Tanggal : "+i(ce.value),1),t("p",null,"Kasir     : "+i(ze.value),1),t("p",null,"Nomor     : "+i(G.value),1),t("p",null,"Customer  : "+i(N.value||"-"),1)]),e[78]||(e[78]=t("hr",{class:"my-1 border-t border-dashed"},null,-1)),(u(!0),d(M,null,E(L.value,(a,v)=>(u(),d("div",{key:a.product_id,class:"mb-1"},[t("p",gl,i(v+1)+". "+i(a.product_name)+"   - "+i(a.size_id)+" "+i(a.variant),1),t("div",yl,[t("span",null,i(a.quantity)+" x "+i(y(a.price)),1),t("span",null,"  "+i(y(a.price*a.quantity)),1)]),Number(a.discount)>0?(u(),d("div",xl,[t("div",bl,[t("span",hl,"- "+i(y(a.discount)),1),t("span",null,i(y(a.price*a.quantity-a.discount)),1)])])):q("",!0)]))),128)),e[79]||(e[79]=t("hr",{class:"my-1 border-t border-dashed"},null,-1)),t("div",kl,[e[70]||(e[70]=t("span",null,"Sub Total    :",-1)),t("span",null,i(y(yt.value)),1)]),t("div",wl,[e[71]||(e[71]=t("span",null,"Jumlah Bayar :",-1)),t("span",null,i(y(j.value||0)),1)]),t("div",$l,[e[72]||(e[72]=t("span",null,"Kembalian    :",-1)),t("span",null,i(y(Ue.value)),1)]),t("div",Cl,[e[73]||(e[73]=t("span",null,"Total Disc   :",-1)),t("span",null,i(y(gt.value)),1)]),t("div",ql,[e[74]||(e[74]=t("span",null,"Metode       :",-1)),t("span",null,i(de.value),1)]),e[80]||(e[80]=t("hr",{class:"my-1 border-t border-dashed"},null,-1)),e[81]||(e[81]=t("p",{class:"text-center"},"SELAMAT BERBELANJA",-1)),e[82]||(e[82]=t("hr",{class:"my-1 border-t border-dashed"},null,-1)),t("div",zl,[n(l(T),{variant:"outline",onClick:Tt},{default:r(()=>e[75]||(e[75]=[_("TUTUP")])),_:1,__:[75]}),n(l(T),{onClick:At,class:"rounded-md bg-indigo-600 py-2 text-white hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:r(()=>e[76]||(e[76]=[_("CETAK")])),_:1,__:[76]})])],512)])):q("",!0)]),n(Gt,{show:xe.value,"onUpdate:show":e[19]||(e[19]=a=>xe.value=a),onCustomerSelected:zt},null,8,["show"]),n(ue,{show:Z.value,onClose:e[21]||(e[21]=a=>Z.value=!1),title:"Tambah Produk Custom"},{default:r(()=>[n(st,{onCancel:e[20]||(e[20]=a=>Z.value=!1)})]),_:1},8,["show"]),n(ue,{show:X.value,onClose:e[22]||(e[22]=a=>X.value=!1),title:"Daftar Produk Tanpa Master"},{default:r(()=>[n(Os,{onAddUnlistedToCart:Ct})]),_:1},8,["show"])]),_:1})],64))}}),Ql=Lt(Pl,[["__scopeId","data-v-b33ac853"]]);export{Ql as default};
