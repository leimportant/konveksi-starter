import{U as H,b as v,d as K,r as $,T as O,q as Q,c as W,o as X,f as p,g as y,p as s,u as t,Z as Y,x as d,k as l,C as S,D as g,y as f,V as ee,F as N,B as F,E as te,j as T,z as ae,R as j}from"./app-Lu0TOJyr.js";import{_ as se}from"./AppLayout.vue_vue_type_script_setup_true_lang-CfcYcGa3.js";import{_ as V}from"./Input.vue_vue_type_script_setup_true_lang-DtyOpbOT.js";import{_ as oe,a as ne,b as U,c as E,d as de,e as q}from"./TableRow.vue_vue_type_script_setup_true_lang-CRf76aiI.js";import{u as le}from"./useToast-B3bACON1.js";import{d as re}from"./debounce-BcZQbp_F.js";import{P as ie}from"./plus-DG-y7PlQ.js";import{T as ue}from"./trash-2-CWsnWesJ.js";import"./index-CKrOgPix.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-Tm3FLk7s.js";const me=H("paymentMethod",{state:()=>({items:[],total:0,loaded:!1,loading:!1,currentPage:1,lastPage:1,filterName:"",error:null}),actions:{async fetchPaymentMethods(m=1,o=10){if(!this.loaded){this.loading=!0;try{const r=await v.get("/api/payment-methods",{params:{page:m,perPage:o,name:this.filterName}});this.items=r.data.data,this.total=r.data.total,this.currentPage=r.data.current_page,this.lastPage=r.data.last_page,this.loaded=!0,this.error=null}catch(r){console.error("Failed to fetch payment methods",r),this.error=r.message||"Unknown error"}finally{this.loading=!1}}},setFilter(m,o){m==="name"&&(this.filterName=o,this.currentPage=1,this.loaded=!1,this.fetchPaymentMethods(1))},async createPaymentMethod(m){try{await v.post("/api/payment-methods",{name:m}),this.loaded=!1,await this.fetchPaymentMethods()}catch(o){throw o}},async updatePaymentMethod(m,o){try{await v.put(`/api/payment-methods/${m}`,{name:o}),this.loaded=!1,await this.fetchPaymentMethods()}catch(r){throw r}},async deletePaymentMethod(m){try{await v.delete(`/api/payment-methods/${m}`),this.loaded=!1,await this.fetchPaymentMethods()}catch(o){throw o}}}}),ce={class:"px-4 py-4"},fe={class:"flex justify-between items-center gap-2 mb-2"},he={class:"rounded-md border"},ye={class:"flex justify-end mt-4 space-x-2"},pe=["disabled"],ge=["onClick","disabled"],be=["disabled"],_e={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},ve={class:"bg-white p-6 rounded-lg w-96"},Pe={class:"mb-4"},we={class:"flex justify-end gap-2"},Me={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},xe={class:"bg-white p-6 rounded-lg w-96"},ke={class:"mb-4"},Ce={class:"flex justify-end gap-2"},ze=K({__name:"Index",setup(m){const o=le(),r=$(!1),P=$(!1),w=$(null),c=O({name:""}),z=[{title:"Payment Method",href:"/payment-methods"}],i=me(),{items:B,currentPage:b,lastPage:A,loading:_,filterName:M}=Q(i),x=W(()=>A.value||1),k=async n=>{n<1||n>x.value||await i.fetchPaymentMethods(n)},D=()=>k(b.value+1),I=()=>k(b.value-1),R=re((n,e)=>{i.setFilter(n,e)},400),J=n=>{const e=n.target;R("name",e.value)};X(()=>{i.fetchPaymentMethods()});const L=async()=>{var n,e,a,u;if(!c.name)return o.error("Name is required");try{await i.createPaymentMethod(c.name),o.success("Payment Method created successfully"),c.reset(),i.loaded=!1,await i.fetchPaymentMethods(),r.value=!1}catch(h){const C=(u=(a=(e=(n=h==null?void 0:h.response)==null?void 0:n.data)==null?void 0:e.errors)==null?void 0:a.name)==null?void 0:u[0];o.error(C||"Failed to create Payment Method")}},Z=async()=>{var n,e,a,u;if(!w.value||!c.name)return o.error("Name is required");try{await i.updatePaymentMethod(w.value.id,c.name),o.success("Payment Method updated successfully"),c.reset(),i.loaded=!1,await i.fetchPaymentMethods(),P.value=!1,w.value=null}catch(h){const C=(u=(a=(e=(n=h==null?void 0:h.response)==null?void 0:n.data)==null?void 0:e.errors)==null?void 0:a.name)==null?void 0:u[0];o.error(C||"Failed to update Payment Method")}},G=async n=>{var e,a;if(confirm("Are you sure you want to delete this Payment Method?"))try{await i.deletePaymentMethod(n),o.success("Payment Method deleted successfully"),i.loaded=!1,await i.fetchPaymentMethods()}catch(u){o.error(((a=(e=u==null?void 0:u.response)==null?void 0:e.data)==null?void 0:a.message)??"Failed to delete Payment Method")}};return(n,e)=>(y(),p(N,null,[s(t(Y),{title:"Payment Method Management"}),s(se,{breadcrumbs:z},{default:d(()=>[l("div",ce,[l("div",fe,[s(t(g),{onClick:e[0]||(e[0]=a=>r.value=!0),class:"bg-indigo-600 text-white py-2 h-10 rounded-md hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:d(()=>[s(t(ie),{class:"h-4 w-4"}),e[6]||(e[6]=f(" Add "))]),_:1,__:[6]}),s(t(V),{modelValue:t(M),"onUpdate:modelValue":e[1]||(e[1]=a=>ee(M)?M.value=a:null),placeholder:"Search",onInput:J,class:"w-64","aria-label":"Search",disabled:t(_)},null,8,["modelValue","disabled"])]),l("div",he,[s(t(oe),null,{default:d(()=>[s(t(ne),null,{default:d(()=>[s(t(U),{class:"bg-gray-100"},{default:d(()=>[s(t(E),null,{default:d(()=>e[7]||(e[7]=[f("Name")])),_:1,__:[7]}),s(t(E),{class:"w-24"},{default:d(()=>e[8]||(e[8]=[f("Actions")])),_:1,__:[8]})]),_:1})]),_:1}),s(t(de),null,{default:d(()=>[(y(!0),p(N,null,F(t(B),a=>(y(),te(t(U),{key:a.id},{default:d(()=>[s(t(q),null,{default:d(()=>[f(T(a.name),1)]),_:2},1024),s(t(q),{class:"flex gap-2"},{default:d(()=>[s(t(g),{variant:"ghost",size:"icon",onClick:u=>G(a.id)},{default:d(()=>[s(t(ue),{class:"h-4 w-4"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),l("div",ye,[l("button",{onClick:I,disabled:t(b)===1||t(_),class:"px-3 py-1 rounded border border-gray-300 text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed"}," Previous ",8,pe),(y(!0),p(N,null,F(x.value,a=>(y(),p("button",{key:a,onClick:u=>k(a),class:ae(["px-3 py-1 rounded border text-sm",a===t(b)?"bg-blue-600 border-blue-600 text-white":"border-gray-300 text-gray-700 hover:bg-gray-100"]),disabled:t(_)},T(a),11,ge))),128)),l("button",{onClick:D,disabled:t(b)===x.value||t(_),class:"px-3 py-1 rounded border border-gray-300 text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed"}," Next ",8,be)]),r.value?(y(),p("div",_e,[l("div",ve,[e[11]||(e[11]=l("h2",{class:"text-lg font-semibold mb-4"},"Tambah Jenis Pembayaran",-1)),l("form",{onSubmit:j(L,["prevent"])},[l("div",Pe,[s(t(V),{modelValue:t(c).name,"onUpdate:modelValue":e[2]||(e[2]=a=>t(c).name=a),placeholder:"Payment Method Name",required:""},null,8,["modelValue"])]),l("div",we,[s(t(g),{type:"button",variant:"outline",onClick:e[3]||(e[3]=a=>r.value=!1),class:"h-10"},{default:d(()=>e[9]||(e[9]=[f("Cancel")])),_:1,__:[9]}),s(t(g),{type:"submit",class:"bg-indigo-600 text-white py-2 h-10 rounded-md hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:d(()=>e[10]||(e[10]=[f("Save")])),_:1,__:[10]})])],32)])])):S("",!0),P.value?(y(),p("div",Me,[l("div",xe,[e[14]||(e[14]=l("h2",{class:"text-lg font-semibold mb-4"},"Edit Payment Method",-1)),l("form",{onSubmit:j(Z,["prevent"])},[l("div",ke,[s(t(V),{modelValue:t(c).name,"onUpdate:modelValue":e[4]||(e[4]=a=>t(c).name=a),placeholder:"Payment Method Name",required:""},null,8,["modelValue"])]),l("div",Ce,[s(t(g),{type:"button",variant:"outline",onClick:e[5]||(e[5]=a=>P.value=!1),class:"h-10"},{default:d(()=>e[12]||(e[12]=[f("Cancel")])),_:1,__:[12]}),s(t(g),{type:"submit",class:"bg-indigo-600 text-white py-2 h-10 rounded-md hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:d(()=>e[13]||(e[13]=[f("Update")])),_:1,__:[13]})])],32)])])):S("",!0)])]),_:1})],64))}});export{ze as default};
