import{d as Z,q as H,r as N,aS as J,o as O,w as B,c as S,Q as W,f as d,g as n,p as l,u as s,Z as X,x as r,k as i,l as Y,G as ee,m as te,D as v,y,F as x,B as _,E as w,j as f,C as k,z as se}from"./app-Cxp-5L4P.js";import{_ as ae,a as oe,b as E,c as j,d as le,e as A}from"./TableRow.vue_vue_type_script_setup_true_lang-BXYBSToZ.js";import{u as ne}from"./useToast-DdgFDx6z.js";import{_ as ie}from"./AppLayout.vue_vue_type_script_setup_true_lang-BOKY9Jlb.js";import{u as re}from"./useTransferStockStore-DIy8QScB.js";import{d as de}from"./debounce-BcZQbp_F.js";import{A as ce}from"./vue3-select-AozcrIg0.js";import{S as ue}from"./search-Cfye091D.js";import{E as me}from"./eye-CZ0Og4OS.js";import{S as pe}from"./square-pen-Dqx_yd46.js";import{T as fe}from"./trash-2-DWjP1Gh6.js";import"./index-DEKMW6Xb.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-8RwTf7Nl.js";const xe={class:"w-full px-4 py-4"},ge={class:"mb-4 flex w-full flex-col gap-3 md:flex-row md:items-center"},ye={class:"mb-4 flex w-full flex-col items-center justify-between gap-3 md:flex-row"},_e={class:"w-full overflow-x-auto"},he={class:"text-xs text-gray-500"},be={key:0,class:"mt-1 space-y-1"},ve={class:"mb-1 font-semibold text-gray-800"},we={class:"flex w-full items-center justify-between"},ke={class:"flex-shrink-0"},Te={class:"ml-2 flex-shrink-0 font-semibold"},Ce={key:0,class:"mt-1 flex items-center justify-between rounded-md border-t border-gray-300 bg-white px-1.5 pt-1 text-[10px] font-semibold text-gray-800 shadow-sm"},Pe={class:"ml-2 flex-shrink-0"},$e={key:1,class:"text-xs italic text-gray-400"},Se={class:"flex justify-end space-x-1"},je={class:"mt-4 flex flex-wrap justify-end gap-2"},Ae=["disabled"],De=["onClick"],Ve=["disabled"],Je=Z({__name:"Index",setup(Ne){const D=ne(),m=re(),{transfers:R,currentPage:p,lastPage:z}=H(m),h=N(50),g=N({label:"Pending",value:"Pending"}),q=de(()=>{m.fetchTransfers(1,h.value)},500),b=J({search:"",status:""}),V=()=>{var t;const o=typeof g.value=="string"?g.value:((t=g.value)==null?void 0:t.value)??"";m.filters.productName=b.search,m.filters.status=o,m.fetchTransfers(1,h.value)};O(()=>{m.fetchTransfers(p.value,h.value)}),B(()=>b.search,q),B(p,async o=>{await m.fetchTransfers(o,h.value)});const T=S(()=>z.value||1),F=S(()=>o=>{const t=new Map;return o.forEach(a=>{var c,u;const e=((c=a.product)==null?void 0:c.name)||"Unknown Product";t.has(e)||t.set(e,[]),(u=t.get(e))==null||u.push(a)}),Array.from(t.entries())}),M=S(()=>{const o=new Map;return R.value.forEach(t=>{var e;const a=t.created_at?new Date(t.created_at).toLocaleDateString("id-ID"):"-";o.has(a)||o.set(a,[]),(e=o.get(a))==null||e.push(t)}),Array.from(o.entries()).map(([t,a])=>({key:t,items:a}))}),C=async o=>{o<1||o>T.value||(p.value=o)},I=()=>C(p.value+1),L=()=>C(p.value-1),U=async o=>{var t,a;if(confirm("Are you sure you want to delete this transfer?"))try{await m.deleteTransfer(o),await m.fetchTransfers(),D.success("Transfer deleted successfully")}catch(e){D.error(((a=(t=e==null?void 0:e.response)==null?void 0:t.data)==null?void 0:a.message)??"Failed to delete transfer")}},K=W().props.auth.user.location_id,G=[{title:"Transfer Stocks",href:"/transfer-stocks"}];return(o,t)=>(n(),d(x,null,[l(s(X),{title:"Transfer Stocks"}),l(ie,{breadcrumbs:G},{default:r(()=>[i("div",xe,[i("div",ge,[l(s(ce),{modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=a=>g.value=a),options:[{label:"Semua",value:""},{label:"Pending",value:"Pending"},{label:"Accepted",value:"Accepted"},{label:"Rejected",value:"Rejected"}],placeholder:"Pilih Status",class:"w-full text-sm md:w-48"},null,8,["modelValue"]),Y(i("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>b.search=a),type:"text",placeholder:"Cari data...",onKeyup:ee(V,["enter"]),class:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 md:w-60"},null,544),[[te,b.search]]),l(s(v),{onClick:V,class:"flex w-full items-center justify-center gap-1 rounded-md bg-indigo-600 px-4 py-2 text-white hover:bg-indigo-700 md:w-auto"},{default:r(()=>[l(s(ue),{class:"h-4 w-4"}),t[2]||(t[2]=y(" Cari "))]),_:1,__:[2]})]),i("div",ye,[i("div",_e,[l(s(ae),null,{default:r(()=>[l(s(oe),null,{default:r(()=>[l(s(E),{class:"bg-gray-100"},{default:r(()=>[l(s(j),{class:"min-w-[150px] px-3 py-2 text-xs font-semibold text-gray-700"},{default:r(()=>t[3]||(t[3]=[y("Lokasi Tujuan")])),_:1,__:[3]}),l(s(j),{class:"min-w-[200px] px-3 py-2 text-xs font-semibold text-gray-700"},{default:r(()=>t[4]||(t[4]=[y("Detail ")])),_:1,__:[4]}),l(s(j),{class:"w-[100px] px-3 py-2 text-right text-xs font-semibold text-gray-700"},{default:r(()=>t[5]||(t[5]=[y(" Actions")])),_:1,__:[5]})]),_:1})]),_:1}),l(s(le),null,{default:r(()=>[(n(!0),d(x,null,_(M.value,a=>(n(),d(x,{key:a.key},[(n(!0),d(x,null,_(a.items,e=>(n(),w(s(E),{key:e.id,class:"border-b hover:bg-gray-50"},{default:r(()=>[l(s(A),{class:"min-w-[150px] px-3 py-2 align-top text-sm"},{default:r(()=>{var c;return[y(f(((c=e.location_destination)==null?void 0:c.name)||"-")+" ",1),i("div",he,[i("span",null,f(a.key),1)])]}),_:2},1024),l(s(A),{class:"min-w-[200px] px-3 py-2 align-top text-sm"},{default:r(()=>{var c;return[(c=e.transfer_detail)!=null&&c.length?(n(),d("div",be,[(n(!0),d(x,null,_(F.value(e.transfer_detail),([u,P])=>(n(),d("div",{key:u,class:"flex flex-col gap-0.5 rounded-lg border border-gray-200 bg-gray-50 p-1 text-[10px] text-gray-700"},[i("div",ve,f(u),1),(n(!0),d(x,null,_(P,($,Q)=>(n(),d("div",{key:Q,class:"flex items-center justify-between rounded-md bg-white px-1.5 py-0.5 shadow-sm"},[i("div",we,[i("span",ke,f($.variant),1),i("span",Te,f($.qty)+" "+f($.uom_id),1)])]))),128))]))),128)),e.transfer_detail.length>1?(n(),d("div",Ce,[t[6]||(t[6]=i("span",null,"Total",-1)),i("span",Pe,f(e.transfer_detail.reduce((u,P)=>u+Number(P.qty||0),0)),1)])):k("",!0)])):(n(),d("span",$e,"No details"))]}),_:2},1024),l(s(A),{class:"w-[100px] px-3 py-2 text-right align-top"},{default:r(()=>{var c;return[i("div",Se,[e!=null&&e.id&&(e.status==="Accepted"||e.status==="Rejected")||((c=e.location_destination)==null?void 0:c.id)===s(K)?(n(),w(s(v),{key:0,variant:"ghost",size:"icon",class:"h-7 w-7 hover:bg-gray-100",onClick:u=>o.$inertia.visit(`/transfer-stock/${e.id}/view`)},{default:r(()=>[l(s(me),{class:"h-4 w-4"})]),_:2},1032,["onClick"])):k("",!0),e!=null&&e.id&&(e.status==="Pending"||e.status==="Rejected")?(n(),w(s(v),{key:1,variant:"ghost",size:"icon",class:"h-7 w-7 hover:bg-gray-100",onClick:u=>o.$inertia.visit(`/transfer-stock/${e.id}/edit`)},{default:r(()=>[l(s(pe),{class:"h-4 w-4"})]),_:2},1032,["onClick"])):k("",!0),e!=null&&e.id&&(e.status==="Pending"||e.status==="Rejected")?(n(),w(s(v),{key:2,variant:"ghost",size:"icon",class:"h-7 w-7 hover:bg-gray-100",onClick:u=>U(e.id)},{default:r(()=>[l(s(fe),{class:"h-4 w-4"})]),_:2},1032,["onClick"])):k("",!0)])]}),_:2},1024)]),_:2},1024))),128))],64))),128))]),_:1})]),_:1})])]),i("div",je,[i("button",{onClick:L,disabled:s(p)===1,class:"rounded border border-gray-300 px-3 py-1 text-sm text-gray-700 hover:bg-gray-100 disabled:opacity-50"}," Previous ",8,Ae),(n(!0),d(x,null,_(T.value,a=>(n(),d("button",{key:a,onClick:e=>C(a),class:se(["rounded border px-3 py-1 text-sm",a===s(p)?"border-blue-600 bg-blue-600 text-white":"border-gray-300 text-gray-700 hover:bg-gray-100"])},f(a),11,De))),128)),i("button",{onClick:I,disabled:s(p)===T.value,class:"rounded border border-gray-300 px-3 py-1 text-sm text-gray-700 hover:bg-gray-100 disabled:opacity-50"}," Next ",8,Ve)])])]),_:1})],64))}});export{Je as default};
