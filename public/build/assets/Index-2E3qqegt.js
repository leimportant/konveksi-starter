import{U as X,b as h,d as aa,r as A,T as ea,q as ta,c as la,o as sa,f as x,g as p,p as t,u as e,Z as na,x as s,k as n,D as _,y as d,V as oa,E as U,C as j,F as V,B,j as N,z as ia,aY as F,aZ as G,a_ as R,a$ as E,l as I,W as z,b0 as J}from"./app-C0haUAd3.js";import{_ as T}from"./Input.vue_vue_type_script_setup_true_lang-DYd3c6mh.js";import{_ as k}from"./Label.vue_vue_type_script_setup_true_lang-BPFQJPjJ.js";import{_ as ra,a as da,b as M,c as S,d as ua,e as v}from"./TableRow.vue_vue_type_script_setup_true_lang-7ZGVvEIP.js";import{u as ma}from"./useToast-CqJn-E_m.js";import{_ as fa}from"./AppLayout.vue_vue_type_script_setup_true_lang-BV7Kz6jH.js";import{P as ga}from"./plus-C1nhQA6u.js";import{S as ca}from"./square-pen-BncbPSOn.js";import{T as pa}from"./trash-2-BVBBKuCn.js";import"./index-Dq1WJwb7.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DHmxgee6.js";const _a=X("mealAllowances",{state:()=>({mealAllowances:[],total:0,loaded:!1,loading:!1,currentPage:1,lastPage:1,filterName:"",error:void 0}),actions:{async fetchMealAllowances(g=1,o=50){var u,r;this.loading=!0,this.error=void 0;try{const{data:f}=await h.get("/api/meal-allowances",{params:{page:g,perPage:o,name:this.filterName||void 0}});this.mealAllowances=f.data,this.total=f.total,this.currentPage=g,this.lastPage=f.last_page||1,this.loaded=!0}catch(f){throw this.error=((r=(u=f.response)==null?void 0:u.data)==null?void 0:r.message)||"Gagal memuat data meal allowance",f}finally{this.loading=!1}},setFilter(g,o){g==="name"&&(this.filterName=o,this.currentPage=1,this.fetchMealAllowances(1))},async createMealAllowance(g){var o,u;this.loading=!0;try{const{data:r}=await h.post("/api/meal-allowances",g);return await this.fetchMealAllowances(this.currentPage),r}catch(r){throw this.error=((u=(o=r.response)==null?void 0:o.data)==null?void 0:u.message)||"Gagal membuat meal allowance",r}finally{this.loading=!1}},async updateMealAllowance(g,o){var u,r;this.loading=!0;try{const{data:f}=await h.put(`/api/meal-allowances/${g}`,o);return await this.fetchMealAllowances(this.currentPage),f}catch(f){throw this.error=((r=(u=f.response)==null?void 0:u.data)==null?void 0:r.message)||"Gagal memperbarui meal allowance",f}finally{this.loading=!1}},async deleteMealAllowance(g){var o,u;this.loading=!0;try{await h.delete(`/api/meal-allowances/${g}`),await this.fetchMealAllowances(this.currentPage)}catch(r){throw this.error=((u=(o=r.response)==null?void 0:o.data)==null?void 0:u.message)||"Gagal menghapus meal allowance",r}finally{this.loading=!1}}}}),wa={class:"px-4 py-4"},ba={class:"mb-6 flex flex-wrap items-center justify-between gap-3"},ya={class:"min-w-[180px] flex-1 sm:min-w-[240px] md:min-w-[280px]"},va={class:"overflow-x-auto rounded-md bg-white shadow-sm"},ha={class:"mt-4 flex justify-end space-x-2"},xa=["disabled"],ka=["onClick","disabled"],Ma=["disabled"],$a={class:"space-y-4"},Ca={class:"flex justify-end gap-2"},Pa={class:"space-y-4"},Aa={class:"flex justify-end gap-2"},Ea=aa({__name:"Index",setup(g){const o=ma(),u=A(!1),r=A(!1),f=A(null),m=ea({name:"",amount:0}),c=_a(),{mealAllowances:D,currentPage:b,lastPage:q,loading:y,filterName:$}=ta(c),C=la(()=>q.value||1),P=async i=>{i<1||i>C.value||await c.fetchMealAllowances(i)},H=()=>P(b.value+1),Y=()=>P(b.value-1),Z=i=>{const a=i.target;c.setFilter("name",a.value)};sa(()=>{c.fetchMealAllowances()});const L=i=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(i),W=async()=>{var i,a;if(!m.name)return o.error("Nama wajib diisi");try{await c.createMealAllowance({name:m.name,amount:m.amount}),o.success("Uang makan berhasil ditambahkan"),m.reset(),u.value=!1}catch(l){o.error(((a=(i=l==null?void 0:l.response)==null?void 0:i.data)==null?void 0:a.message)||"Gagal membuat uang makan")}},K=i=>{f.value=i,m.name=i.name,m.amount=i.amount,r.value=!0},O=async()=>{var i,a;if(!f.value)return o.error("Tidak ada data yang dipilih");try{await c.updateMealAllowance(f.value.id,{name:m.name,amount:m.amount}),o.success("Uang makan berhasil diperbarui"),m.reset(),r.value=!1,f.value=null}catch(l){o.error(((a=(i=l==null?void 0:l.response)==null?void 0:i.data)==null?void 0:a.message)||"Gagal memperbarui uang makan")}},Q=async i=>{var a,l;if(confirm("Yakin ingin menghapus data ini?"))try{await c.deleteMealAllowance(i),o.success("Uang makan berhasil dihapus")}catch(w){o.error(((l=(a=w==null?void 0:w.response)==null?void 0:a.data)==null?void 0:l.message)||"Gagal menghapus uang makan")}};return(i,a)=>(p(),x(V,null,[t(e(na),{title:"Uang Makan"}),t(fa,null,{default:s(()=>[n("div",wa,[n("div",ba,[t(e(_),{onClick:a[0]||(a[0]=l=>u.value=!0),class:"flex items-center gap-2 rounded-md bg-indigo-600 px-3 py-2 text-white hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:s(()=>[t(e(ga),{class:"h-4 w-4"}),a[10]||(a[10]=d(" Tambah Data "))]),_:1,__:[10]}),n("div",ya,[t(e(T),{modelValue:e($),"onUpdate:modelValue":a[1]||(a[1]=l=>oa($)?$.value=l:null),onInput:Z,placeholder:"Cari..",class:"w-full text-sm"},null,8,["modelValue"])])]),n("div",va,[t(e(ra),null,{default:s(()=>[t(e(da),null,{default:s(()=>[t(e(M),{class:"bg-gray-100"},{default:s(()=>[t(e(S),null,{default:s(()=>a[11]||(a[11]=[d("Nama")])),_:1,__:[11]}),t(e(S),null,{default:s(()=>a[12]||(a[12]=[d("Jumlah (Rp)")])),_:1,__:[12]}),t(e(S),{class:"w-24 text-center"},{default:s(()=>a[13]||(a[13]=[d("Actions")])),_:1,__:[13]})]),_:1})]),_:1}),t(e(ua),null,{default:s(()=>[e(y)?(p(),U(e(M),{key:0},{default:s(()=>[t(e(v),{colspan:"3",class:"py-4 text-center text-gray-500"},{default:s(()=>a[14]||(a[14]=[d("Memuat data...")])),_:1,__:[14]})]),_:1})):j("",!0),(p(!0),x(V,null,B(e(D),l=>(p(),U(e(M),{key:l.id},{default:s(()=>[t(e(v),null,{default:s(()=>[d(N(l.name),1)]),_:2},1024),t(e(v),null,{default:s(()=>[d(N(L(l.amount)),1)]),_:2},1024),t(e(v),{class:"flex justify-center gap-2"},{default:s(()=>[t(e(_),{variant:"ghost",size:"icon",onClick:w=>K(l)},{default:s(()=>[t(e(ca),{class:"h-4 w-4"})]),_:2},1032,["onClick"]),t(e(_),{variant:"ghost",size:"icon",onClick:w=>Q(l.id)},{default:s(()=>[t(e(pa),{class:"h-4 w-4 text-red-500"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128)),!e(y)&&e(D).length===0?(p(),U(e(M),{key:1},{default:s(()=>[t(e(v),{colspan:"3",class:"py-4 text-center italic text-gray-500"},{default:s(()=>a[15]||(a[15]=[d("Belum ada data")])),_:1,__:[15]})]),_:1})):j("",!0)]),_:1})]),_:1})]),n("div",ha,[n("button",{onClick:Y,disabled:e(b)===1||e(y),class:"rounded border border-gray-300 px-3 py-1 text-gray-700 hover:bg-gray-100 disabled:cursor-not-allowed disabled:opacity-50"}," Previous ",8,xa),(p(!0),x(V,null,B(C.value,l=>(p(),x("button",{key:l,onClick:w=>P(l),class:ia(["rounded border px-3 py-1 text-sm",l===e(b)?"border-blue-600 bg-blue-600 text-white":"border-gray-300 text-gray-700 hover:bg-gray-100"]),disabled:e(y)},N(l),11,ka))),128)),n("button",{onClick:H,disabled:e(b)===C.value||e(y),class:"rounded border border-gray-300 px-3 py-1 text-gray-700 hover:bg-gray-100 disabled:cursor-not-allowed disabled:opacity-50"}," Next ",8,Ma)]),t(e(F),{open:u.value,"onUpdate:open":a[5]||(a[5]=l=>u.value=l)},{default:s(()=>[t(e(G),null,{default:s(()=>[t(e(R),null,{default:s(()=>[t(e(E),null,{default:s(()=>a[16]||(a[16]=[d("Tambah Uang Makan")])),_:1,__:[16]})]),_:1}),n("div",$a,[n("div",null,[t(e(k),null,{default:s(()=>a[17]||(a[17]=[d("Nama")])),_:1,__:[17]}),I(n("select",{"onUpdate:modelValue":a[2]||(a[2]=l=>e(m).name=l),class:"mt-1 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-700 dark:bg-gray-900 dark:text-white"},a[18]||(a[18]=[n("option",{disabled:"",value:""},"Pilih jenis hari",-1),n("option",{value:"full"},"Full Day",-1),n("option",{value:"half"},"Setengah Hari",-1),n("option",{value:"off"},"Tidak Masuk",-1)]),512),[[z,e(m).name]])]),n("div",null,[t(e(k),null,{default:s(()=>a[19]||(a[19]=[d("Jumlah (Rp)")])),_:1,__:[19]}),t(e(T),{modelValue:e(m).amount,"onUpdate:modelValue":a[3]||(a[3]=l=>e(m).amount=l),type:"number"},null,8,["modelValue"])])]),t(e(J),null,{default:s(()=>[n("div",Ca,[t(e(_),{type:"button",variant:"outline",onClick:a[4]||(a[4]=l=>u.value=!1)},{default:s(()=>a[20]||(a[20]=[d("Batal")])),_:1,__:[20]}),t(e(_),{onClick:W,class:"bg-indigo-600 text-white hover:bg-indigo-700"},{default:s(()=>a[21]||(a[21]=[d("Simpan")])),_:1,__:[21]})])]),_:1})]),_:1})]),_:1},8,["open"]),t(e(F),{open:r.value,"onUpdate:open":a[9]||(a[9]=l=>r.value=l)},{default:s(()=>[t(e(G),null,{default:s(()=>[t(e(R),null,{default:s(()=>[t(e(E),null,{default:s(()=>a[22]||(a[22]=[d("Edit Uang Makan")])),_:1,__:[22]})]),_:1}),n("div",Pa,[n("div",null,[t(e(k),null,{default:s(()=>a[23]||(a[23]=[d("Nama")])),_:1,__:[23]}),I(n("select",{"onUpdate:modelValue":a[6]||(a[6]=l=>e(m).name=l),class:"mt-1 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-700 dark:bg-gray-900 dark:text-white"},a[24]||(a[24]=[n("option",{disabled:"",value:""},"Pilih jenis hari",-1),n("option",{value:"full"},"Full Day",-1),n("option",{value:"half"},"Setengah Hari",-1),n("option",{value:"off"},"Tidak Masuk",-1)]),512),[[z,e(m).name]])]),n("div",null,[t(e(k),null,{default:s(()=>a[25]||(a[25]=[d("Jumlah (Rp)")])),_:1,__:[25]}),t(e(T),{modelValue:e(m).amount,"onUpdate:modelValue":a[7]||(a[7]=l=>e(m).amount=l),type:"number"},null,8,["modelValue"])])]),t(e(J),null,{default:s(()=>[n("div",Aa,[t(e(_),{type:"button",variant:"outline",onClick:a[8]||(a[8]=l=>r.value=!1)},{default:s(()=>a[26]||(a[26]=[d("Batal")])),_:1,__:[26]}),t(e(_),{onClick:O,class:"bg-indigo-600 text-white hover:bg-indigo-700"},{default:s(()=>a[27]||(a[27]=[d("Update")])),_:1,__:[27]})])]),_:1})]),_:1})]),_:1},8,["open"])])]),_:1})],64))}});export{Ea as default};
