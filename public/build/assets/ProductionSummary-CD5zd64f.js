import{_ as g}from"./Input.vue_vue_type_script_setup_true_lang-Dw8iDJMQ.js";import{d as D,r as b,o as O,c as j,f as o,g as a,p as y,u,Z as q,x as h,k as s,D as M,y as P,j as l,F as i,B as c}from"./app-36B4zYOK.js";import{_ as R}from"./AppLayout.vue_vue_type_script_setup_true_lang-GP0QoSo9.js";import{u as B}from"./useReportStore-D1YVJaND.js";import"./index-D_L_HNLE.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-C9dYfdTb.js";const T={class:"py-6 px-2 max-w-7xl mx-auto space-y-4"},A={class:"flex flex-wrap gap-2 mb-4 items-end"},C={key:0,class:"py-4 text-center text-gray-500"},E={key:1,class:"py-4 text-center text-red-500"},F={key:2,class:"overflow-x-auto bg-white shadow rounded-lg"},N={class:"min-w-full text-sm text-gray-800"},U={class:"bg-gray-50 font-semibold text-xs uppercase text-gray-600"},$={class:"bg-gray-100 font-semibold hover:bg-gray-200"},z={class:"px-3 py-2"},I={class:"px-3 py-2 text-center"},L={class:"px-3 py-1"},G={class:"px-3 py-1"},K={class:"flex flex-wrap gap-1"},Q={class:"px-3 py-1 text-center"},Y={class:"bg-gray-50 font-semibold text-xs text-gray-600"},Z={class:"px-3 py-2 text-center"},ot=D({__name:"ProductionSummary",setup(H){const p=B(),m=b(""),x=b(""),f=b(""),w=[{title:"Production Summary",href:"/reports/production-summary"}],S=()=>{p.fetchProductionSummary(m.value,x.value,f.value)};O(()=>{const d=new Date,t=new Date(d.getFullYear(),d.getMonth(),1);m.value=t.toISOString().split("T")[0],x.value=d.toISOString().split("T")[0],S()});const _=j(()=>{const d=new Map;return Object.values(p.productionSummary).forEach(t=>{Object.values(t.activities??{}).forEach(e=>{d.has(e.name)||d.set(e.name,e.name)})}),Array.from(d.entries()).map(([t])=>({id:t,name:t}))}),k=(d,t)=>d.activity_role_name===t?d.total_qty:0;return(d,t)=>(a(),o(i,null,[y(u(q),{title:"Production Summary Report"}),y(R,{breadcrumbs:w},{header:h(()=>t[3]||(t[3]=[s("h2",{class:"text-xl font-semibold text-gray-800"},"Production Summary Report",-1)])),default:h(()=>[s("div",T,[s("div",A,[y(u(g),{type:"date",modelValue:m.value,"onUpdate:modelValue":t[0]||(t[0]=e=>m.value=e),class:"w-40"},null,8,["modelValue"]),y(u(g),{type:"date",modelValue:x.value,"onUpdate:modelValue":t[1]||(t[1]=e=>x.value=e),class:"w-40"},null,8,["modelValue"]),y(u(g),{type:"text",modelValue:f.value,"onUpdate:modelValue":t[2]||(t[2]=e=>f.value=e),placeholder:"Search Model / Activity",class:"flex-1 min-w-[200px]"},null,8,["modelValue"]),y(u(M),{class:"bg-indigo-600 text-white hover:bg-indigo-700",onClick:S},{default:h(()=>t[4]||(t[4]=[P("Show")])),_:1,__:[4]})]),u(p).loading?(a(),o("div",C,"Loading...")):u(p).error?(a(),o("div",E,l(u(p).error.message),1)):(a(),o("div",F,[s("table",N,[s("thead",U,[s("tr",null,[t[5]||(t[5]=s("th",{class:"px-3 py-2"},"Model",-1)),t[6]||(t[6]=s("th",{class:"px-3 py-2"},"Variant",-1)),(a(!0),o(i,null,c(_.value,e=>(a(),o("th",{key:"header-role-"+e.id,class:"px-2 py-1 text-center"},l(e.name),1))),128)),t[7]||(t[7]=s("th",{class:"px-3 py-2 text-center"},"Subtotal",-1))])]),s("tbody",null,[(a(!0),o(i,null,c(u(p).productionSummary,e=>(a(),o(i,{key:e.model_id},[s("tr",$,[s("td",z,l(e.description),1),t[8]||(t[8]=s("td",{class:"px-3 py-2"},"-",-1)),(a(!0),o(i,null,c(_.value,r=>{var n;return a(),o("td",{key:"summary-"+r.id+"-"+e.model_id,class:"px-2 py-1 text-center"},l(((n=Object.values(e.activities).find(v=>v.name===r.name))==null?void 0:n.qty)??"-"),1)}),128)),s("td",I,l(e.subtotal_qty),1)]),(a(!0),o(i,null,c(e.details,r=>(a(),o("tr",{key:r.production_id,class:"hover:bg-gray-50"},[s("td",L,"- "+l(r.employee_name),1),s("td",G,[s("div",K,[(a(!0),o(i,null,c(r.items,n=>(a(),o("div",{key:n.size_id,class:"bg-gray-50 border px-2 py-1 rounded text-xs"},l(n.size_id)+" - "+l(n.variant)+" : "+l(n.qty),1))),128))])]),(a(!0),o(i,null,c(_.value,n=>(a(),o("td",{key:"detail-"+n.id+"-"+r.production_id,class:"px-2 py-1 text-center"},l(k(r,n.name)||"-"),1))),128)),s("td",Q,l(r.total_qty),1)]))),128))],64))),128))]),s("tfoot",Y,[s("tr",null,[t[9]||(t[9]=s("td",{colspan:"2",class:"px-3 py-2 text-right"},"Grand Total:",-1)),(a(!0),o(i,null,c(_.value,e=>(a(),o("td",{key:"footer-role-"+e.id,class:"px-2 py-1 text-center"},l(Object.values(u(p).productionSummary).reduce((r,n)=>{var v;return r+(((v=Object.values(n.activities).find(V=>V.name===e.name))==null?void 0:v.qty)??0)},0)),1))),128)),s("td",Z,l(Object.values(u(p).productionSummary).reduce((e,r)=>e+(r.subtotal_qty??0),0)),1)])])])]))])]),_:1})],64))}});export{ot as default};
