import{d as wt,r as c,c as V,Q as $t,w as we,f as v,g as d,p as n,u as i,Z as Ct,x as o,k as a,C as w,l as G,m as X,F as A,B as F,j as r,D as C,y as m,E as $e,U as qt,G as Pt,M as fe,z as Be,b as K,n as zt,_ as Tt}from"./app-Dlow-IqW.js";import{_ as Se,a as Ve,b as le,c as I,d as Oe,e as z}from"./TableRow.vue_vue_type_script_setup_true_lang-BqTWHXmK.js";import{_ as jt}from"./AppLayout.vue_vue_type_script_setup_true_lang-COJZifLC.js";import{_ as Dt}from"./Input.vue_vue_type_script_setup_true_lang-CSQcVFIn.js";import{u as At}from"./useToast-CbF-WIAa.js";import{A as It}from"./vue3-select-D5pJDXna.js";import{U as Nt,_ as Mt}from"./vue-qrcode-reader-CLNbTUNU.js";import{u as Rt}from"./useCurrencyInput-B712mwWR.js";import{P as Bt,S as St,U as Vt,R as Ot}from"./user-plus-C9RJG-PZ.js";import{P as Ut}from"./printer-check-D0GL4-mN.js";import{T as Ue}from"./trash-2-hYB1kF2K.js";import"./index-C4W-OPw1.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CiznyD-g.js";const Et={class:"min-h-screen space-y-4 bg-gray-50 p-2 md:p-4"},Ft={class:"grid grid-cols-1 gap-3 md:grid-cols-5 md:gap-2"},Kt={class:"flex flex-col md:col-span-2 lg:col-span-2"},Lt={class:"mb-2 flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between"},Qt={class:"flex flex-col gap-2 md:gap-3"},Wt=["onClick"],Gt={class:"flex-shrink-0"},Ht=["src"],Jt={key:1,class:"flex h-16 w-16 select-none items-center justify-center rounded bg-gray-200 text-xs text-gray-400"},Yt={class:"flex min-w-0 flex-1 flex-col justify-between"},Xt={class:"flex items-center gap-2"},Zt={class:"flex-1 truncate text-xs font-semibold text-gray-900 md:text-sm"},es={key:0,class:"ml-1 rounded bg-orange-500 px-2 py-0.5 text-[14px] font-bold text-white md:text-xs"},ts={class:"text-[10px] text-gray-400 md:text-xs"},ss={key:0,class:"mt-2"},as={class:"mt-1 flex flex-wrap gap-2"},ls={class:"text-[10px] text-gray-400 line-through md:text-xs"},ns={class:"text-xs font-semibold text-green-600 md:text-sm"},is={class:"text-[10px] text-green-500 md:text-xs"},os={key:1,class:"text-xs font-semibold text-gray-700 md:text-sm"},rs={class:"flex flex-col bg-gray-100 md:col-span-2 lg:col-span-3"},us={class:"flex flex-wrap gap-1 p-2 md:gap-1"},ds={key:0,class:"select-none py-8 text-center text-xs text-gray-400"},cs={class:"overflow-auto p-2"},ps={class:"md-grid-cols-2 relative flex grid-cols-1 items-center justify-center"},vs=["checked","onChange"],fs={class:"max-w-[140px] truncate font-semibold text-gray-900"},_s={class:"max-w-[140px] truncate font-semibold text-gray-900"},ms={key:0,class:"text-[10px] text-gray-400 line-through"},ys={class:"block font-semibold text-gray-900"},gs={class:"text-[11px] text-gray-600"},xs={key:1,class:"text-[11px] text-green-600"},bs=["max","onUpdate:modelValue"],hs={key:1,class:"mt-4 flex flex-col sm:flex-row sm:justify-between items-start sm:items-center gap-2 bg-gray-100 rounded-xl p-4 shadow-sm"},ks={class:"text-xs text-gray-800"},ws={class:"text-xs text-gray-600"},$s={class:"text-xs text-gray-800"},Cs={class:"mt-2 gap-4 rounded-lg p-1 p-4 shadow-sm"},qs=["value"],Ps={class:"mt-4 gap-4 border-t p-4 pt-2"},zs={class:"mb-2 flex justify-between text-xs font-semibold text-gray-700"},Ts={class:"font-bold"},js={key:0},Ds={key:1},As={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 p-4"},Is={class:"w-full max-w-xs rounded-xl bg-white p-6 shadow-lg"},Ns={class:"flex justify-end gap-3"},Ms={key:1,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 p-4"},Rs={class:"w-full max-w-sm rounded-lg bg-white p-6 shadow-lg"},Bs={class:"mb-4 flex justify-between"},Ss={class:"font-semibold"},Vs={class:"mb-4 flex justify-between"},Os={class:"font-semibold text-green-600"},Us={class:"flex justify-end space-x-3"},Es={class:"h-64 w-full"},Fs={key:0,class:"space-y-4"},Ks={class:"flex items-center gap-4"},Ls=["src"],Qs={key:1,class:"flex h-24 w-24 select-none items-center justify-center rounded bg-gray-200 text-xs text-gray-400"},Ws={class:"text-lg font-semibold"},Gs={class:"flex flex-wrap gap-2"},Hs=["onClick"],Js=["onClick"],Ys={key:0,class:"mb-4"},Xs={class:"flex flex-wrap gap-2"},Zs=["onClick"],ea={class:"mb-4"},ta={key:0,class:"mb-4 text-sm text-gray-700"},sa={key:0,class:"mr-2 text-gray-400 line-through"},aa={class:"font-bold"},la={key:1,class:"text-xs text-green-600"},na={class:"flex justify-end gap-2"},ia={class:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 mb-4"},oa={class:"overflow-auto max-h-[60vh] border border-gray-200 rounded-lg shadow-sm"},ra={class:"space-y-2"},ua={class:"mt-2 flex justify-end gap-2"},da={key:0,class:"mt-1 text-xs text-red-600"},ca={key:1,class:"mt-1 text-xs text-red-600"},pa={key:2,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-30 p-4"},va={class:"text-center"},fa={class:"text-[12px] font-bold"},_a={class:"mb-1"},ma={class:"font-bold"},ya={class:"flex justify-between p-1"},ga={key:0},xa={class:"flex justify-between"},ba={class:"text-green-600"},ha={class:"flex justify-between"},ka={class:"flex justify-between"},wa={class:"flex justify-between"},$a={class:"flex justify-between"},Ca={class:"flex justify-between"},qa={class:"no-print mt-2 flex justify-end gap-2"},Pa=wt({__name:"POS_FIX2025",setup(za){const ne=c(!1),ie=c(!1),h=At(),_e=c([]),Ce=c([]),k=c([]),Z=c([]),R=c(null),oe=c({placingOrder:!1}),Ee=Rt(0),me=c(""),qe=c(1),Fe=c(1),re=c(0),B=c([]),ee=c(!1),y=c(null);function Ke(t){y.value=t,M.value=null,P.value=null,y.value.variant==="all"&&y.value.sizes&&y.value.sizes.length>0&&(P.value=y.value.sizes[0].size_id),ee.value=!0}const ue=c(!1),de=c(!1),T=c(null),q=c(null),j=c([]),O=c(0),H=c(""),J=c(""),N=c(""),ye=c(null),Le=c(null),ge=c(!1),xe=c(!1),te=c(""),se=c([]),Pe=c(null),ae=c(null),Y=c(1),L=c(0),U=c(""),ce=c(!1),M=c(null),P=c(null);async function Qe(){try{const t=await K.get("/api/orders/search",{params:{search:te.value}});se.value=t.data.data}catch(t){console.error("Error searching transactions:",t),alert("Failed to search transactions.")}}async function We(t){confirm("Yakin mau tampilkan struk untuk dicetak ulang?")&&(Pe.value=t,J.value=ke(t.created_at),N.value=t.id,q.value=t.customer,j.value=t.order_items.map(e=>({product_id:e.product_id,product_name:e.product_name,quantity:Number(e.quantity),price:Number(e.price),discount:Number(e.discount),price_sell:Number(e.price_sell),variant:e.variant||"",uom_id:e.uom_id,size_id:e.size_id,qty_stock:e.qty_stock,image_path:e.image_path})),O.value=t.total_amount,H.value=t.payment_method,$.value=t.paid_amount,ue.value=!0,Te())}const $=c(null),ze=V(()=>$.value===null?0:$.value-D.value>0?$.value-D.value:0),Ge=V(()=>{var e;if(!((e=y.value)!=null&&e.sizes))return[];const t=y.value.sizes.map(s=>s.variant);return[...new Set(t)]}),He=async t=>{if(t.length<2){_e.value=[];return}try{const e=await K.get("/api/product-with-size",{params:{search:t}});Ce.value=e.data.data}catch(e){console.error("Search error:",e),h.error("Failed to search products")}};function Je(t,e){return t?t.filter(s=>s.variant===e):[]}function Ye(t,e){t&&(t.size_id=e.size_id,P.value=e.size_id),y.value&&(y.value.price=e.price,y.value.price_sell=e.price_sell)}function Xe(){ge.value=!0}function Ze(){xe.value=!0,se.value=[],te.value=""}const et=V(()=>y.value?y.value.variant==="all"?y.value.sizes.map(t=>t):M.value?y.value.sizes.filter(t=>t.variant===M.value):[]:[]);function be(){ge.value=!1,ae.value=null,Y.value=1,L.value=0,U.value="",ce.value=!1}function Te(){xe.value=!1,te.value="",se.value=[],Pe.value=null}async function tt(){if(U.value="",ce.value=!1,!ae.value){U.value="Produk harus dipilih";return}const t=ae.value;if(!t||!t.id){U.value="Produk harus dipilih";return}if(!Y.value||Y.value<1){U.value="Qty minimal 1";return}if(!L.value||L.value<0){U.value="Harga retur harus diisi";return}k.value.push({id:t.id,product_id:t.id,product_name:t.product_name??"",size_id:t.size_id??"",uom_id:t.uom_id??"",qty_stock:0,qty_available:0,image_path:"",sizes:[],variant:null,quantity:-Math.abs(Y.value),price:L.value,price_sell:L.value,isReturn:!0}),ce.value=!0,setTimeout(()=>{be()},1e3)}const Q=c("TOKO ANINKA"),W=c("Blok A lantai SLG Los F No 91-92"),pe=$t().props.auth.user,st=pe==null?void 0:pe.location_id;async function at(){if(st)try{const t=await K.get("/api/locations/get");Q.value=t.data.name||"TOKO ANINKA",W.value=t.data.address||"Blok A lantai SLG Los F No 91-92"}catch{Q.value="TOKO ANINKA",W.value="Blok A lantai SLG Los F No 91-92"}}at();const lt=V(()=>j.value.reduce((t,e)=>t+(e.discount??0)*e.quantity,0)),nt=V(()=>j.value.reduce((t,e)=>t+e.price*e.quantity,0)),ve=c(!1),he=V(()=>pe.name??"Kasir"),je=t=>t?t.startsWith("storage/")?"/"+t:t.startsWith("/storage/")?t:"/storage/"+t:"",f=t=>typeof t!="number"||isNaN(t)?"0,00":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(t),it=t=>{const e=B.value.indexOf(t);e===-1?B.value.push(t):B.value.splice(e,1)},E=V(()=>!P.value||!y.value?null:y.value.variant==="all"?y.value.sizes.find(t=>t.size_id===P.value):M.value?y.value.sizes.find(t=>t.variant===M.value&&t.size_id===P.value):null);async function De(){try{const t=await K.get(`/api/stock?page=${qe.value}&search=${me.value}`);_e.value=t.data.data,Fe.value=t.data.last_page}catch(t){console.error("Error fetching products:",t),h.error("Failed to fetch products")}}async function ot(){try{const t=await K.get("/api/payment-methods");Z.value=t.data.data}catch{h.error("Failed to fetch payment methods")}}function rt(){qe.value=1,De()}const ut=t=>{if(t.qty_stock<=0){h.error("Stok tidak cukup");return}if(t.price<=0&&(!t.price_sell||t.price_sell<=0)){h.error("Harga produk belum ditentukan");return}let e;if(t.sizes&&t.sizes.length>0){if(!P.value){h.error("Silakan pilih ukuran terlebih dahulu");return}if(e=t.sizes.find(l=>l.size_id===P.value&&(M.value===null||l.variant===M.value)),!e||e.qty_stock<=0){h.error("Stok ukuran ini tidak tersedia");return}}const s=1,p=e==null?void 0:e.price_retail,u=e==null?void 0:e.price_sell_retail,b=e==null?void 0:e.discount_retail;if(t.sizes.length&&!e){h.error("Ukuran tidak valid.");return}const _={id:t.product_id||t.id,product_id:t.product_id||t.id,product_name:t.product_name,uom_id:t.uom_id,size_id:(e==null?void 0:e.size_id)??"",qty_stock:(e==null?void 0:e.qty_stock)??t.qty_stock,qty_available:((e==null?void 0:e.qty_stock)??t.qty_stock)-s,image_path:t.image_path??"",price:p??t.price,price_sell:u??t.price_sell??t.price,discount:b??t.discount??0,quantity:s,variant:(e==null?void 0:e.variant)??t.variant??null,sizes:e?[{...e,qty_in_cart:s,qty_available:e.qty_stock-s}]:[]},g=k.value.find(l=>l.id===_.id&&l.size_id===_.size_id&&l.variant===_.variant);if(g){g.quantity+=s;const l=g.quantity>1;e&&(g.price=e[l?"price_grosir":"price_retail"]??g.price,g.price_sell=e[l?"price_sell_grosir":"price_sell_retail"]??g.price_sell,g.discount=e[l?"discount_grosir":"discount_retail"]??g.discount)}else k.value.push(_);ee.value=!1,zt(()=>{ye.value&&(ye.value.scrollTop=ye.value.scrollHeight)})};function dt(t){k.value=k.value.filter(e=>e.id!==t)}function ct(){k.value.length!==0&&(ne.value=!0)}function pt(){k.value=k.value.map(t=>B.value.includes(t.id+t.size_id)?{...t,discount:re.value,price_sell:t.price-re.value}:t),B.value=[],ne.value=!1,h.success("Discount applied successfully")}function vt(){if(k.value.length===0){h.error("Please add items to the cart");return}if(!R.value){h.error("Please select a payment method");return}$.value=null,ve.value=!0}async function Ae(){if(Z.value.length===0){h.error("No payment methods available");return}const t=Z.value.find(e=>e.id===R.value);if((!t||t.name!=="CREDIT")&&($.value===null||$.value<D.value)){h.error("Paid amount must be at least total amount");return}ve.value=!1,await _t()}function Ie(){k.value=[],R.value=null,q.value="",N.value="",B.value=[]}async function Ne(t=null){if(typeof t=="number"&&(T.value=t),typeof T.value=="number")try{const e=await K.get(`/api/customers/get/${T.value}`);q.value=e.data.name,h.success(`Pelanggan ${q.value} berhasil ditambahkan.`)}catch(e){console.error("Error fetching customer details:",e),h.error("Gagal mengambil detail pelanggan."),T.value=null,q.value=null}else de.value=!0}const ft=t=>{T.value=t.id,q.value=t.name,de.value=!1},D=V(()=>k.value.reduce((t,e)=>t+e.price*e.quantity,0)),Me=V(()=>`${f(D.value)}`);async function _t(){var t;if(k.value.length===0){h.error("Please add items to the cart");return}if(!R.value){h.error("Please select a payment method");return}oe.value.placingOrder=!0;try{const e=k.value.map(u=>{const b=u.discount||0;return{product_id:u.product_id??u.id,product_name:u.product_name,quantity:u.quantity,price:u.price,uom_id:u.uom_id,size_id:u.size_id||null,qty_stock:0,image_path:"",discount:b,price_sell:u.price_sell??u.price-b,variant:u.variant||"all"}}),s={items:e,payment_method_id:R.value,total_amount:D.value,paid_amount:$.value,customer_id:T.value,transaction_number:N.value||""},p=await K.post("/api/pos/orders",s);j.value=e.map(u=>{var b;return{...u,uom_id:((b=k.value.find(_=>(_.product_id??_.id)===u.product_id))==null?void 0:b.uom_id)||""}}),O.value=p.data.total_amount,H.value=((t=Z.value.find(u=>u.id===R.value))==null?void 0:t.name)||"",J.value=ke(p.data.created_at),N.value=p.data.transaction_number||"",T.value=null,ue.value=!0}catch(e){console.error("Error placing order:",e),h.error("Failed to place order")}finally{oe.value.placingOrder=!1}}function mt(){ue.value=!1,Ie(),R.value=null}const yt=async t=>{var s;if(t.length===0)return;const e=t[0].rawValue;console.log("QR Code detected:",e),ie.value=!1;try{const p=e.split(",").map(l=>l.trim()),b=(await K.get("/api/orders/scan",{params:{ids:p.join(",")}})).data,_=[];if(b.length>0&&(T.value=b[0].customer_id,q.value=((s=b[0].customer)==null?void 0:s.name)||"Guest",N.value=p.join(",")),b.forEach(l=>{var x;(x=l==null?void 0:l.order_items)!=null&&x.length&&_.push(...l.order_items)}),_.length===0){h.error("No order items found for the scanned QR code(s).");return}const g=_.map(l=>({id:l.product_id,product_id:l.product_id,product_name:l.product_name,uom_id:l.uom_id,size_id:l.size_id||"",qty_stock:l.qty_stock,image_path:l.image_path,price:l.price,price_sell:l.price_sell,discount:l.discount,quantity:l.quantity??1,variant:l.variant||"all",sizes:l.size_id?[{size_id:l.size_id,variant:l.variant||"all",qty_stock:l.qty_stock,qty_in_cart:l.quantity??1,qty_available:l.qty_stock,price:l.price,price_sell:l.price_sell,discount:l.discount,price_retail:l.price,price_sell_retail:l.price_sell,discount_retail:l.discount,price_grosir:l.price,price_sell_grosir:l.price_sell,discount_grosir:l.discount}]:[]}));console.log("Produk dalam pesanan:",g),g.forEach(l=>{const x=k.value.findIndex(S=>(S.product_id??S.id)===(l.product_id??l.id)&&S.size_id===l.size_id);x>-1?k.value[x].quantity+=l.quantity:k.value.push({...l})}),h.success("Order items added to cart!"),T.value&&Ne(T.value)}catch(p){console.error("Error scanning QR code:",p),h.error("Failed to scan QR code or retrieve order details.")}},Re=new WeakMap;we(k,t=>{t.forEach(e=>{Re.has(e)||(Re.set(e,!0),we(()=>e.quantity,s=>{if(!e.sizes||e.sizes.length===0)return;const p=e.sizes[0],u=s>1;e.price=u?p.price_grosir:p.price_retail,e.price_sell=u?p.price_sell_grosir:p.price_sell_retail,e.discount=u?p.discount_grosir:p.discount_retail,p.qty_in_cart=s,p.qty_available=p.qty_stock-s}))})},{deep:!0}),we(Ee.internalValue,t=>{$.value=t});function gt(){const t=window.qz,e=he.value;if(t){const _=j.value.reduce((x,S)=>x+S.quantity,0),g=(O.value||D.value)-($.value||0),l=[];l.push(`     ${Q.value}`),l.push(` ${W.value}`),l.push("----------------------------------------"),l.push(`Kasir   : ${e}`),l.push(`Tanggal : ${J.value}`),l.push(`Nomor   : ${N.value}`),l.push("------------------------------------"),l.push(`Customer: ${q.value||"-"}`),l.push("--------------------------------------"),j.value.forEach(x=>{l.push(`${x.product_name}${x.size_id?" - "+x.size_id:""} ${x.variant?" "+x.variant:""}`),l.push(`${x.quantity} x ${f(x.price)}${" ".repeat(20-(x.quantity+"").length-f(x.price).length)}${f(x.quantity*x.price)}`)}),l.push("--------------------------------"),l.push(`Total QTY        ${_}`),l.push(`Total Bayar      ${f(O.value||D.value)}`),l.push(`Jenis Bayar      ${H.value||"-"}`),l.push(`Bayar Cash       ${f($.value||0)}`),l.push(`Sisa             ${f(g>0?g:0)}`),l.push("--------------------------------------"),l.push("      ---TERIMA KASIH---"),l.push("     aninkafashion.com"),l.push(`


`),t.websocket.connect().then(()=>t.printers.find()).then(x=>{const S=t.configs.create(x);return t.print(S,[{type:"raw",format:"plain",data:l.join(`
`)}])}).catch(x=>{alert("Print error: "+x)}).finally(()=>{t.websocket.disconnect()});return}const s=j.value.reduce((_,g)=>_+g.quantity,0),p=(O.value||D.value)-($.value||0),u=`
    <div style="font-family: 'Courier New', Courier, monospace; font-size: 12px; width: 80mm; padding: 0; margin: 0;">
      <div style="text-align:center; font-weight:bold;">${Q.value}</div>
      <div style="text-align:center;">${W.value}</div>
      <div style="text-align:center;">----------------------------------------</div>
      <div style="display:flex; justify-content:space-between;">
        <span>Kasir   : ${e}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Tanggal : ${J.value}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Nomor   : ${N.value}</span>
      </div>
      <div style="text-align:center;">----------------------------------------</div>
      <div style="display:flex; justify-content:space-between;">
        <span>Customer</span>
        <span>${q.value||"-"}</span>
      </div>
      <div style="text-align:center;">----------------------------------------</div>
      ${j.value.map(_=>`
          <div>${_.product_name} - ${_.size_id} ${_.variant} </div>
          <div style="display:flex; justify-content:space-between;">
            <span>${_.quantity} x ${f(_.price)}</span>
            <span>${f(_.quantity*_.price)}</span>
          </div>
        `).join("")}
      <div style="text-align:center;">----------------------------------------</div>
      <div style="display:flex; justify-content:space-between;">
        <span>Total QTY</span>
        <span>${s}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Total Bayar</span>
        <span>${f(O.value||D.value)}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Jenis Bayar</span>
        <span>${H.value||"-"}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Bayar Cash</span>
        <span>${f($.value||0)}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Sisa</span>
        <span>${f(p>0?p:0)}</span>
      </div>
      <div style="text-align:center;">----------------------------------------</div>
      <div style="text-align:center; margin-top:8px;">---TERIMA KASIH---</div>
      <div style="text-align:center;">aninkafashion.com</div>
    </div>
  `,b=window.open("","","height=600,width=400");if(!b){alert("Please allow pop-ups for printing.");return}b.document.write(`
    <html>
      <head>
        <title>Print Struk</title>
        <style>
          @media print {
            body { margin: 0; }
            div { font-family: 'Courier New', Courier, monospace; font-size: 12px; }
          }
        </style>
      </head>
      <body>
        ${u}
        <script>
          window.onload = function() {
            setTimeout(function() {
              window.print();
              window.onafterprint = function() { window.close(); };
            }, 100);
          };
        <\/script>
      </body>
    </html>
  `),b.document.close()}function xt(){const e="-".repeat(46),p=[Q.value.padStart(Math.floor((46+Q.value.length)/2)),W.value.padStart(Math.floor((46+W.value.length)/2)),e,`Kasir   : ${he.value}`,`Tanggal : ${J.value}`,`Nomor   : ${N.value}`,e,`Customer: ${q.value||"-"}`,e,...j.value.flatMap(_=>{const g=_.product_name+" - "+_.size_id+(_.variant?" "+_.variant:""),l=`${_.quantity} x ${f(_.price)}`,x=f(_.quantity*_.price),S=l.padEnd(23),kt=x.padStart(23);return[g.length>46?g.slice(0,46):g,`${S}${kt}`]}),e,`Total QTY   : ${j.value.reduce((_,g)=>_+g.quantity,0)}`,`Total Bayar : ${f(O.value||D.value)}`,`Jenis Bayar : ${H.value||"-"}`,`Bayar Cash  : ${f($.value||0)}`,`Sisa        : ${f((O.value||D.value)-($.value||0))}`,e,"---TERIMA KASIH---".padStart(Math.floor(64/2)),"aninkafashion.com".padStart(Math.floor(65/2)),`


`].join(`
`),b=`intent://${encodeURIComponent(p).replace(/'/g,"%27").replace(/"/g,"%22")}#Intent;scheme=rawbt;package=ru.a402d.rawbtprinter;end;`;window.location.href=b}function bt(){ht()?xt():gt()}function ht(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}const ke=t=>{if(!t)return"-";const e=new Date(t),p=new Intl.DateTimeFormat("id-ID",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"Asia/Jakarta"}).formatToParts(e),u=b=>{var _;return((_=p.find(g=>g.type===b))==null?void 0:_.value)||""};return`${u("day")}/${u("month")}/${u("year")} ${u("hour")}:${u("minute")} WIB`};return De(),ot(),(t,e)=>(d(),v(A,null,[n(i(Ct),{title:"Point of Sale"}),n(jt,null,{default:o(()=>[a("div",Et,[a("div",Ft,[a("section",Kt,[a("div",Lt,[e[19]||(e[19]=a("h2",{class:"text-sm font-semibold text-gray-800"},"Produk Tersedia",-1)),G(a("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=s=>me.value=s),onInput:rt,placeholder:"Cari produk...",class:"focus:ring-primary-500 w-full max-w-xs rounded-md border border-gray-300 px-2 py-1 text-xs focus:outline-none focus:ring-2 md:text-sm"},null,544),[[X,me.value]])]),a("div",Qt,[(d(!0),v(A,null,F(_e.value,s=>(d(),v("div",{key:s.id,onClick:p=>Ke(s),class:"flex cursor-pointer flex-row items-center gap-2 rounded-lg border border-gray-200 bg-white p-2 shadow-sm transition hover:shadow-md md:gap-3 md:p-3"},[a("div",Gt,[s.image_path?(d(),v("img",{key:0,src:je(s.image_path),alt:"Gambar produk",class:"h-16 w-16 rounded object-cover"},null,8,Ht)):(d(),v("div",Jt," Tidak Ada Gambar "))]),a("div",Yt,[a("div",Xt,[a("p",Zt,r(s.product_name),1),s.discount&&s.price?(d(),v(A,{key:0},[s.discount>0?(d(),v("span",es,r(Math.round(s.discount/s.price*100))+"% ",1)):w("",!0)],64)):w("",!0)]),a("p",ts,"Stok: "+r(s.qty_available)+" / "+r(s.uom_id),1),s.variant?(d(),v("div",ss,[e[20]||(e[20]=a("p",{class:"text-xs text-gray-500"},"Tersedia Ukuran:",-1)),a("div",as,[(d(!0),v(A,null,F(Je(s.sizes,s.variant),p=>(d(),v("div",{class:"rounded-full border px-3 py-1 text-xs font-medium",key:p.size_id},r(p.size_id),1))),128))])])):w("",!0),a("div",null,[s.discount&&s.discount>0?(d(),v(A,{key:0},[a("p",ls,r(f(s.price)),1),a("p",ns,r(f(s.price_sell??s.price-s.discount)),1),a("p",is,"(Diskon "+r(f(s.discount))+")",1)],64)):(d(),v("p",os,r(f(s.price)),1))])])],8,Wt))),128))])]),a("section",rs,[a("div",us,[n(i(C),{variant:"outline",size:"sm",onClick:ct,disabled:B.value.length===0,class:"flex items-center gap-1 bg-indigo-100"},{default:o(()=>[n(i(Bt),{class:"h-4 w-4"}),m(" Disc ("+r(B.value.length)+") ",1)]),_:1},8,["disabled"]),n(i(C),{variant:"outline",size:"sm",onClick:e[1]||(e[1]=s=>ie.value=!0),class:"flex items-center gap-1"},{default:o(()=>[n(i(St),{class:"h-4 w-4"}),e[21]||(e[21]=m(" QR "))]),_:1,__:[21]}),n(i(C),{variant:"outline",size:"sm",onClick:e[2]||(e[2]=()=>Ne()),class:"flex items-center gap-1"},{default:o(()=>[n(i(Vt),{class:"h-4 w-4"}),e[22]||(e[22]=m(" Cust "))]),_:1,__:[22]}),n(i(C),{variant:"outline",size:"sm",onClick:Xe,class:"flex items-center gap-1"},{default:o(()=>[n(i(Ot),{class:"h-4 w-4"}),e[23]||(e[23]=m(" Retur "))]),_:1,__:[23]}),n(i(C),{variant:"outline",size:"sm",onClick:e[3]||(e[3]=s=>Ze()),class:"flex items-center gap-1"},{default:o(()=>[n(i(Ut),{class:"h-4 w-4"}),e[24]||(e[24]=m(" RePrint "))]),_:1,__:[24]}),n(i(C),{variant:"outline",size:"sm",onClick:Ie,class:"flex items-center gap-1"},{default:o(()=>[n(i(Ue),{class:"h-4 w-4"}),e[25]||(e[25]=m(" Clear "))]),_:1,__:[25]})]),k.value.length===0?(d(),v("div",ds," Tidak ada item di keranjang ")):w("",!0),a("div",cs,[n(i(Se),null,{default:o(()=>[n(i(Ve),null,{default:o(()=>[n(i(le),null,{default:o(()=>[n(i(I),{class:"text-xs"},{default:o(()=>e[26]||(e[26]=[m("#")])),_:1,__:[26]}),n(i(I),{class:"text-xs"},{default:o(()=>e[27]||(e[27]=[m("Nama")])),_:1,__:[27]}),n(i(I),{class:"text-center text-xs"},{default:o(()=>e[28]||(e[28]=[m("Qty")])),_:1,__:[28]}),n(i(I),{class:"text-center text-xs"},{default:o(()=>e[29]||(e[29]=[m("Total")])),_:1,__:[29]}),n(i(I),{class:"text-center text-xs"},{default:o(()=>e[30]||(e[30]=[m("Aksi")])),_:1,__:[30]})]),_:1})]),_:1}),n(i(Oe),null,{default:o(()=>[(d(!0),v(A,null,F(k.value,s=>(d(),$e(i(le),{key:s.id},{default:o(()=>[n(i(z),null,{default:o(()=>[a("div",ps,[a("input",{type:"checkbox",checked:B.value.includes(s.id+s.size_id),onChange:p=>it(s.id+s.size_id),class:"text-primary-600 focus:ring-primary-500 absolute left-0 top-0 rounded border-gray-300",title:"Pilih untuk diskon"},null,40,vs)])]),_:2},1024),n(i(z),{class:"text-xs"},{default:o(()=>[a("div",fs,r(s.product_name),1),a("div",_s,"Ukuran : "+r(s.size_id),1),s.discount&&s.discount>0?(d(),v("span",ms,r(f(s.price)),1)):w("",!0),a("span",ys,r(f(s.price_sell||s.price-(s.discount||0))),1),a("span",gs,"Variant: "+r(s.variant||""),1),s.discount&&s.discount>0?(d(),v("div",xs," Diskon: -"+r(f(s.discount)),1)):w("",!0)]),_:2},1024),n(i(z),{class:"text-center"},{default:o(()=>[G(a("input",{type:"number",min:"1",max:s.qty_available,"onUpdate:modelValue":p=>s.quantity=p,class:"w-12 rounded border px-1 py-0.5 text-center text-xs"},null,8,bs),[[X,s.quantity,void 0,{number:!0}]])]),_:2},1024),n(i(z),{class:"text-right text-xs font-semibold text-gray-900"},{default:o(()=>[m(r(f(s.quantity*(s.price_sell||s.price))),1)]),_:2},1024),n(i(z),{class:"text-center"},{default:o(()=>[n(i(C),{variant:"ghost",size:"icon",onClick:p=>dt(s.id),class:"hover:bg-gray-100"},{default:o(()=>[n(i(Ue),{class:"h-4 w-4"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),q.value?(d(),v("div",hs,[a("div",null,[e[31]||(e[31]=a("p",{class:"text-sm text-gray-500 font-medium"},"Pelanggan",-1)),a("p",ks,[m(r(q.value)+" ",1),a("span",ws,"(#"+r(T.value)+")",1)])]),a("div",null,[e[32]||(e[32]=a("p",{class:"text-sm text-gray-500 font-medium"},"Transaksi Online",-1)),a("p",$s,r(N.value),1)])])):w("",!0),a("div",Cs,[e[34]||(e[34]=a("label",{class:"mb-1 block text-xs font-medium text-gray-900"},"Metode Pembayaran",-1)),G(a("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>R.value=s),class:"focus:ring-primary-500 w-full rounded-lg border border-gray-300 p-1 text-xs focus:outline-none focus:ring-2"},[e[33]||(e[33]=a("option",{value:""},"Pilih metode pembayaran",-1)),(d(!0),v(A,null,F(Z.value,s=>(d(),v("option",{key:s.id,value:s.id},r(s.name),9,qs))),128))],512),[[qt,R.value]])]),a("div",Ps,[a("div",zs,[e[35]||(e[35]=a("span",null,"Total",-1)),a("span",Ts,r(Me.value),1)]),n(i(C),{class:"w-full rounded-md bg-indigo-600 py-2 text-xs font-semibold text-white hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500",onClick:vt,disabled:oe.value.placingOrder},{default:o(()=>[oe.value.placingOrder?(d(),v("span",js,"Memproses...")):(d(),v("span",Ds,"Bayar"))]),_:1},8,["disabled"])])])]),ne.value?(d(),v("div",As,[a("div",Is,[e[36]||(e[36]=a("h3",{class:"mb-4 text-lg font-semibold"},"Set Discount",-1)),e[37]||(e[37]=a("label",{class:"mb-2 block text-sm font-medium"},"Discount Price",-1)),G(a("input",{type:"number","onUpdate:modelValue":e[5]||(e[5]=s=>re.value=s),class:"focus:ring-primary-500 mb-4 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2"},null,512),[[X,re.value,void 0,{number:!0}]]),a("div",Ns,[a("button",{onClick:pt,class:"rounded bg-green-600 px-4 py-2 text-sm text-white hover:bg-green-700"},"Save"),a("button",{onClick:e[6]||(e[6]=s=>ne.value=!1),class:"rounded bg-gray-300 px-4 py-2 text-sm text-gray-700 hover:bg-gray-400"}," Cancel ")])])])):w("",!0),ve.value?(d(),v("div",Ms,[a("div",Rs,[e[42]||(e[42]=a("h3",{class:"mb-4 text-lg font-semibold"},"Masukkan Jumlah Bayar",-1)),G(a("input",{type:"number",min:"0","onUpdate:modelValue":e[7]||(e[7]=s=>$.value=s),onKeypress:Pt(Ae,["enter"]),class:"mb-4 w-full rounded border px-3 py-2 text-lg",placeholder:"Masukkan jumlah bayar"},null,544),[[X,$.value,void 0,{number:!0}]]),a("div",Bs,[e[38]||(e[38]=a("div",null,"Total:",-1)),a("div",Ss,r(Me.value),1)]),a("div",Vs,[e[39]||(e[39]=a("div",null,"Kembalian:",-1)),a("div",Os,r(f(ze.value)),1)]),a("div",Us,[n(i(C),{variant:"outline",onClick:e[8]||(e[8]=s=>ve.value=!1)},{default:o(()=>e[40]||(e[40]=[m("Batal")])),_:1,__:[40]}),n(i(C),{onClick:Ae,class:"rounded-md bg-indigo-600 py-2 text-white hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:o(()=>e[41]||(e[41]=[m("Konfirmasi")])),_:1,__:[41]})])])])):w("",!0),n(fe,{show:ie.value,onClose:e[9]||(e[9]=s=>ie.value=!1),title:"Scan QR Code"},{default:o(()=>[a("div",Es,[n(i(Nt),{onDetect:yt})])]),_:1},8,["show"]),n(fe,{show:ee.value,onClose:e[12]||(e[12]=s=>ee.value=!1),title:"Detail Produk"},{default:o(()=>{var s,p;return[y.value?(d(),v("div",Fs,[a("div",Ks,[y.value.image_path?(d(),v("img",{key:0,src:je(y.value.image_path),alt:"Gambar produk",class:"h-24 w-24 rounded object-cover"},null,8,Ls)):(d(),v("div",Qs," Tidak Ada Gambar ")),a("div",null,[a("h3",Ws,r(y.value.product_name),1),e[44]||(e[44]=a("span",{class:"mb-1 text-sm font-semibold text-gray-700"},"Pilih Ukuran ",-1)),a("div",Gs,[e[43]||(e[43]=a("br",null,null,-1)),(d(!0),v(A,null,F(et.value,u=>(d(),v("button",{key:u.size_id,onClick:b=>P.value=u.size_id,class:Be(["rounded-full border px-3 py-1 text-sm font-semibold transition",P.value===u.size_id?"border-green-600 bg-green-600 text-white":"border-gray-300 bg-gray-200 text-gray-800 hover:bg-gray-300"])},[a("div",{onClick:b=>Ye(y.value,u)},r(u.size_id),9,Js)],10,Hs))),128))])])]),((s=y.value)==null?void 0:s.variant)!=="all"?(d(),v("div",Ys,[e[45]||(e[45]=a("h4",{class:"mb-1 text-sm font-semibold text-gray-700"},"Variant",-1)),a("div",Xs,[(d(!0),v(A,null,F(Ge.value,u=>(d(),v("button",{key:u,onClick:()=>{M.value=u,P.value=null},class:Be(["rounded-full border px-3 py-1 text-sm font-semibold transition",M.value===u?"border-indigo-600 bg-indigo-600 text-white":"border-gray-300 bg-gray-200 text-gray-800 hover:bg-gray-300"])},r(u),11,Zs))),128))])])):w("",!0),a("div",ea,[E.value?(d(),v("div",ta,[a("p",null,[e[46]||(e[46]=m(" Stok: ")),a("strong",null,r(E.value.qty_available),1)]),(E.value.discount??0)>0?(d(),v("span",sa," Harga "+r(f(E.value.price)),1)):w("",!0),e[47]||(e[47]=a("br",null,null,-1)),a("span",aa," Harga Diskon "+r(f(E.value.price_sell||E.value.price)),1),e[48]||(e[48]=a("br",null,null,-1)),(E.value.discount??0)>0?(d(),v("span",la," (Diskon: "+r(f(E.value.discount??0))+") ",1)):w("",!0)])):w("",!0)]),a("div",na,[n(i(C),{variant:"outline",onClick:e[10]||(e[10]=u=>ee.value=!1)},{default:o(()=>e[49]||(e[49]=[m("Batal")])),_:1,__:[49]}),n(i(C),{onClick:e[11]||(e[11]=u=>ut(y.value)),disabled:!P.value||!M.value&&((p=y.value)==null?void 0:p.variant)!=="all"},{default:o(()=>e[50]||(e[50]=[m("Tambah ke Keranjang")])),_:1,__:[50]},8,["disabled"])])])):w("",!0)]}),_:1},8,["show"]),n(fe,{show:xe.value,onClose:Te,title:"RePrint Struk"},{default:o(()=>[a("div",ia,[n(i(Dt),{modelValue:te.value,"onUpdate:modelValue":e[13]||(e[13]=s=>te.value=s),class:"w-full sm:w-64 text-sm",placeholder:"Cari transaksi...","aria-label":"Search"},null,8,["modelValue"]),n(i(C),{onClick:e[14]||(e[14]=s=>Qe()),class:"sm:w-auto w-full text-sm px-4 py-2"},{default:o(()=>e[51]||(e[51]=[m(" Cari ")])),_:1,__:[51]})]),a("div",oa,[n(i(Se),{class:"min-w-full text-sm"},{default:o(()=>[n(i(Ve),null,{default:o(()=>[n(i(le),{class:"bg-gray-100 text-gray-600 uppercase text-xs"},{default:o(()=>[n(i(I),{class:"whitespace-nowrap px-2 py-2"},{default:o(()=>e[52]||(e[52]=[m("Aksi")])),_:1,__:[52]}),n(i(I),{class:"whitespace-nowrap px-2 py-2"},{default:o(()=>e[53]||(e[53]=[m("Tanggal")])),_:1,__:[53]}),n(i(I),{class:"whitespace-nowrap px-2 py-2"},{default:o(()=>e[54]||(e[54]=[m("Customer")])),_:1,__:[54]}),n(i(I),{class:"whitespace-nowrap px-2 py-2"},{default:o(()=>e[55]||(e[55]=[m("Total")])),_:1,__:[55]}),n(i(I),{class:"whitespace-nowrap px-2 py-2"},{default:o(()=>e[56]||(e[56]=[m("Pembayaran")])),_:1,__:[56]}),n(i(I),{class:"whitespace-nowrap px-2 py-2"},{default:o(()=>e[57]||(e[57]=[m("Status")])),_:1,__:[57]})]),_:1})]),_:1}),n(i(Oe),null,{default:o(()=>[(d(!0),v(A,null,F(se.value,s=>(d(),$e(i(le),{key:s.id,class:"hover:bg-gray-50 cursor-pointer transition"},{default:o(()=>[n(i(z),{class:"px-2 py-1"},{default:o(()=>[n(i(C),{variant:"outline",size:"sm",onClick:p=>We(s)},{default:o(()=>e[58]||(e[58]=[m(" Cetak ")])),_:2,__:[58]},1032,["onClick"])]),_:2},1024),n(i(z),{class:"px-2 py-1"},{default:o(()=>[m(r(ke(s.created_at)),1)]),_:2},1024),n(i(z),{class:"px-2 py-1"},{default:o(()=>[m(r(s.customer),1)]),_:2},1024),n(i(z),{class:"px-2 py-1"},{default:o(()=>[m(r(f(Number(s.total_amount))),1)]),_:2},1024),n(i(z),{class:"px-2 py-1"},{default:o(()=>[m(r(s.payment_method),1)]),_:2},1024),n(i(z),{class:"px-2 py-1"},{default:o(()=>[m(r(s.status),1)]),_:2},1024)]),_:2},1024))),128)),se.value.length===0?(d(),$e(i(le),{key:0},{default:o(()=>[n(i(z),{colspan:"6",class:"text-center text-xs text-gray-400 py-3"},{default:o(()=>e[59]||(e[59]=[m(" Tidak ada transaksi ditemukan. ")])),_:1,__:[59]})]),_:1})):w("",!0)]),_:1})]),_:1})])]),_:1},8,["show"]),n(fe,{show:ge.value,onClose:be,title:"Retur Barang"},{default:o(()=>[a("div",ra,[e[62]||(e[62]=a("label",{class:"block text-xs font-medium"},"Produk",-1)),n(i(It),{modelValue:ae.value,"onUpdate:modelValue":e[15]||(e[15]=s=>ae.value=s),options:Ce.value,label:"product_title",value:"id",onSearch:He,reduce:s=>({...s,name:s.product_name,product_name:s.product_name,size_id:s.size_id,uom_id:s.uom_id,qty_available:0}),placeholder:"Pilih Produk"},null,8,["modelValue","options","reduce"]),e[63]||(e[63]=a("label",{class:"block text-xs font-medium"},"Qty",-1)),G(a("input",{type:"number","onUpdate:modelValue":e[16]||(e[16]=s=>Y.value=s),min:"1",class:"w-full rounded border p-1 text-xs"},null,512),[[X,Y.value,void 0,{number:!0}]]),e[64]||(e[64]=a("label",{class:"block text-xs font-medium"},"Harga Retur",-1)),G(a("input",{type:"number","onUpdate:modelValue":e[17]||(e[17]=s=>L.value=s),min:"0",class:"w-full rounded border p-1 text-xs"},null,512),[[X,L.value,void 0,{number:!0}]]),a("div",ua,[n(i(C),{variant:"outline",onClick:be},{default:o(()=>e[60]||(e[60]=[m("Batal")])),_:1,__:[60]}),n(i(C),{class:"bg-red-600 text-white",onClick:tt},{default:o(()=>e[61]||(e[61]=[m("Simpan")])),_:1,__:[61]})]),U.value?(d(),v("div",da,r(U.value),1)):w("",!0),ce.value?(d(),v("div",ca,"Retur berhasil ditambahkan ke keranjang! ")):w("",!0)])]),_:1},8,["show"]),ue.value?(d(),v("div",pa,[a("div",{class:"print-area w-[450px] max-w-full rounded bg-white p-2 font-mono text-[10px] leading-tight shadow",ref_key:"printArea",ref:Le},[a("div",va,[a("p",fa,r(Q.value),1),a("p",null,r(W.value),1)]),e[72]||(e[72]=a("hr",{class:"my-1 border-t border-dashed"},null,-1)),a("div",_a,[a("p",null,"Tanggal : "+r(J.value),1),a("p",null,"Kasir     : "+r(he.value),1),a("p",null,"Nomor     : "+r(N.value),1),a("p",null,"Customer  : "+r(q.value||"-"),1)]),e[73]||(e[73]=a("hr",{class:"my-1 border-t border-dashed"},null,-1)),(d(!0),v(A,null,F(j.value,(s,p)=>(d(),v("div",{key:s.product_id,class:"mb-1"},[a("p",ma,r(p+1)+". "+r(s.product_name)+"   - "+r(s.size_id)+" "+r(s.variant),1),a("div",ya,[a("span",null,r(s.quantity)+" x "+r(f(s.price)),1),a("span",null,"  "+r(f(s.price*s.quantity)),1)]),Number(s.discount)>0?(d(),v("div",ga,[a("div",xa,[a("span",ba,"- "+r(f(s.discount)),1),a("span",null,r(f(s.price*s.quantity-s.discount)),1)])])):w("",!0)]))),128)),e[74]||(e[74]=a("hr",{class:"my-1 border-t border-dashed"},null,-1)),a("div",ha,[e[65]||(e[65]=a("span",null,"Sub Total    :",-1)),a("span",null,r(f(nt.value)),1)]),a("div",ka,[e[66]||(e[66]=a("span",null,"Jumlah Bayar :",-1)),a("span",null,r(f($.value||0)),1)]),a("div",wa,[e[67]||(e[67]=a("span",null,"Kembalian    :",-1)),a("span",null,r(f(ze.value)),1)]),a("div",$a,[e[68]||(e[68]=a("span",null,"Total Disc   :",-1)),a("span",null,r(f(lt.value)),1)]),a("div",Ca,[e[69]||(e[69]=a("span",null,"Metode       :",-1)),a("span",null,r(H.value),1)]),e[75]||(e[75]=a("hr",{class:"my-1 border-t border-dashed"},null,-1)),e[76]||(e[76]=a("p",{class:"text-center"},"SELAMAT BERBELANJA",-1)),e[77]||(e[77]=a("hr",{class:"my-1 border-t border-dashed"},null,-1)),a("div",qa,[n(i(C),{variant:"outline",onClick:mt},{default:o(()=>e[70]||(e[70]=[m("TUTUP")])),_:1,__:[70]}),n(i(C),{onClick:bt,class:"rounded-md bg-indigo-600 py-2 text-white hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:o(()=>e[71]||(e[71]=[m("CETAK")])),_:1,__:[71]})])],512)])):w("",!0)]),n(Mt,{show:de.value,"onUpdate:show":e[18]||(e[18]=s=>de.value=s),onCustomerSelected:ft},null,8,["show"])]),_:1})],64))}}),Fa=Tt(Pa,[["__scopeId","data-v-0687a663"]]);export{Fa as default};
