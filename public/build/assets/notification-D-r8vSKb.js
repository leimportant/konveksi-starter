import{M as p,b as u,d,f as o,g as n,k as a,C as l,j as b,u as t,p as h}from"./app-dnJGHIqc.js";const f="BBsBgA3w4kNLbT4J_8jIMs_LoVWXFUjHaszbCZHrcoxDY8KpPsTQdl0RbA8Q2u_Kw13KTBXnV4qt-N5UGd4rtEo";function _(e){const s="=".repeat((4-e.length%4)%4),r=(e+s).replace(/\-/g,"+").replace(/_/g,"/"),i=window.atob(r);return Uint8Array.from([...i].map(c=>c.charCodeAt(0)))}const g=p("pushNotification",{state:()=>({isSubscribed:!1,error:""}),actions:{async subscribe(){if(this.error=null,!("serviceWorker"in navigator)||!("PushManager"in window)){this.error="Push notifications are not supported in your browser.";return}try{const s=await(await navigator.serviceWorker.register("/service-worker.js")).pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:_(f)});await u.post("/api/push/subscribe",s,{headers:{"Content-Type":"application/json"}}),this.isSubscribed=!0}catch(e){this.error=e instanceof Error?e.message:String(e)}},async send(){if(this.error=null,!this.isSubscribed){this.error="You must subscribe to push notifications first.";return}try{await u.post("/api/push/send",{},{headers:{"Content-Type":"application/json"}})}catch(e){this.error=e instanceof Error?e.message:String(e)}}}}),m=["disabled"],S={key:0,class:"text-red-500"},w=["disabled"],y=d({__name:"PushSubscribe",setup(e){const s=g();function r(){s.subscribe()}function i(){s.send()}return(c,k)=>(n(),o("div",null,[a("button",{onClick:r,disabled:t(s).isSubscribed},b(t(s).isSubscribed?"Subscribed!":"Enable Push Notifications"),9,m),t(s).error?(n(),o("p",S,b(t(s).error),1)):l("",!0),a("button",{onClick:i,disabled:!t(s).isSubscribed}," Send Notification ",8,w)]))}}),N=d({__name:"notification",setup(e){return(s,r)=>(n(),o("div",null,[r[0]||(r[0]=a("h1",null,"Notification Page",-1)),h(y)]))}});export{N as default};
