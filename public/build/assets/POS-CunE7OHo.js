import{d as Ge,q as Oe,T as jt,o as Dt,f as d,g as u,k as t,l as D,C as x,m as O,u as l,j as i,U as De,F as j,B,N as At,r as v,c as G,Q as St,w as Te,p as o,Z as It,x as r,D as z,y as g,E as je,G as Nt,M as me,z as Ee,b as Z,n as Ut,_ as Vt}from"./app-9be07bG9.js";import{_ as Mt}from"./Input.vue_vue_type_script_setup_true_lang-CyXQ9FyX.js";import{_ as Ke,a as Le,b as fe,c as R,d as Fe,e as I}from"./TableRow.vue_vue_type_script_setup_true_lang-B97HHtJY.js";import{u as We}from"./useToast-ovM85MRF.js";import{_ as Rt}from"./AppLayout.vue_vue_type_script_setup_true_lang-hqfcYHD2.js";import{A as Bt}from"./vue3-select-Dtaa4_d5.js";import{U as Ot,_ as Et}from"./vue-qrcode-reader-DbnqDUyD.js";import{u as Kt}from"./useProductStore-D51CYdmX.js";import{u as Lt}from"./useCategoryStore-DTds57Ym.js";import{u as Ft}from"./useSizeStore-BTfJWzZm.js";import{u as Qt}from"./useCurrencyInput-l6SmJQd6.js";import{P as Gt}from"./plus-F0Tt-iwd.js";import{P as Wt,S as Ht,U as Jt,R as Yt}from"./user-plus-5bpVqmSK.js";import{P as Zt}from"./printer-check-ZWnJlSwx.js";import{T as Qe}from"./trash-2-5KRDAOY3.js";import"./index-BHTBuFZo.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DpXv-YHW.js";const Xt={class:"p-4 bg-white rounded-lg shadow-md"},es={class:"mb-3"},ts={key:0,class:"mt-1 text-sm text-red-600"},ss={class:"mb-3"},as=["value"],ls={key:0,class:"mt-1 text-sm text-red-600"},ns={class:"mb-4 mt-6 border-t pt-4"},os={class:"grid grid-cols-1 gap-3 md:grid-cols-2 lg:grid-cols-3"},is=["for"],rs=["id","onUpdate:modelValue"],us=["value"],ds={key:0,class:"mt-1 text-sm text-red-600"},cs=["for"],ps=["id","onUpdate:modelValue"],vs={key:0,class:"mt-1 text-sm text-red-600"},ms=["for"],fs=["id","onUpdate:modelValue"],_s={key:0,class:"mt-1 text-sm text-red-600"},gs=["for"],ys=["id","onUpdate:modelValue"],xs={key:0,class:"mt-1 text-sm text-red-600"},bs=["for"],hs=["id","onUpdate:modelValue"],ks={key:0,class:"mt-1 text-sm text-red-600"},ws=["onClick"],$s={class:"flex justify-end mt-6"},Cs=["disabled"],Ps=Ge({__name:"AddProductCustom",setup(He){const ae=Kt(),X=We(),W=Lt(),b=Ft(),{items:ue}=Oe(W),{sizes:_e}=Oe(b),c=jt({name:"",category_id:"",items:[]}),L=()=>{c.items.push({size_id:"",variant:"",qty:1,price_store:0,price_grosir:0})},N=ne=>{c.items.splice(ne,1)},le=async()=>{try{await ae.saveProductCustom(c.data()),X.success("Produk custom berhasil disimpan!"),c.reset(),c.items=[],L()}catch(ne){X.error(ne.message||"Gagal menyimpan produk custom.")}};return Dt(async()=>{await W.fetchCategories(),await b.fetchSizes(),c.items.length===0&&L()}),(ne,P)=>(u(),d("div",Xt,[P[7]||(P[7]=t("h3",{class:"text-lg font-semibold mb-4"},"Tambah Produk Custom",-1)),t("form",{onSubmit:At(le,["prevent"])},[t("div",es,[P[2]||(P[2]=t("label",{for:"name",class:"block text-sm font-medium text-gray-700"},"Nama Produk",-1)),D(t("input",{type:"text",id:"name","onUpdate:modelValue":P[0]||(P[0]=C=>l(c).name=C),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:""},null,512),[[O,l(c).name]]),l(c).errors.name?(u(),d("p",ts,i(l(c).errors.name),1)):x("",!0)]),t("div",ss,[P[4]||(P[4]=t("label",{for:"category_id",class:"block text-sm font-medium text-gray-700"},"Category",-1)),D(t("select",{id:"category_id","onUpdate:modelValue":P[1]||(P[1]=C=>l(c).category_id=C),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:""},[P[3]||(P[3]=t("option",{value:"",disabled:""},"Pilih Kategori",-1)),(u(!0),d(j,null,B(l(ue),C=>(u(),d("option",{key:C.id,value:C.id},i(C.name),9,as))),128))],512),[[De,l(c).category_id]]),l(c).errors.category_id?(u(),d("p",ls,i(l(c).errors.category_id),1)):x("",!0)]),t("div",ns,[P[6]||(P[6]=t("h4",{class:"text-md font-semibold mb-3"},"Detail Produk (Ukuran & Harga)",-1)),(u(!0),d(j,null,B(l(c).items,(C,w)=>(u(),d("div",{key:w,class:"mb-4 rounded-md bg-gray-50 p-3 shadow-sm"},[t("div",os,[t("div",null,[t("label",{for:`size_id-${w}`,class:"block text-sm font-medium text-gray-700"},"Size",8,is),D(t("select",{id:`size_id-${w}`,"onUpdate:modelValue":q=>C.size_id=q,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:""},[P[5]||(P[5]=t("option",{value:"",disabled:""},"Pilih Ukuran",-1)),(u(!0),d(j,null,B(l(_e),q=>(u(),d("option",{key:q.id,value:q.id},i(q.name),9,us))),128))],8,rs),[[De,C.size_id]]),l(c).errors[`items.${w}.size_id`]?(u(),d("p",ds,i(l(c).errors[`items.${w}.size_id`]),1)):x("",!0)]),t("div",null,[t("label",{for:`variant-${w}`,class:"block text-sm font-medium text-gray-700"},"Variant",8,cs),D(t("input",{type:"text",id:`variant-${w}`,"onUpdate:modelValue":q=>C.variant=q,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:""},null,8,ps),[[O,C.variant]]),l(c).errors[`items.${w}.variant`]?(u(),d("p",vs,i(l(c).errors[`items.${w}.variant`]),1)):x("",!0)]),t("div",null,[t("label",{for:`qty-${w}`,class:"block text-sm font-medium text-gray-700"},"Quantity",8,ms),D(t("input",{type:"number",id:`qty-${w}`,"onUpdate:modelValue":q=>C.qty=q,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:""},null,8,fs),[[O,C.qty,void 0,{number:!0}]]),l(c).errors[`items.${w}.qty`]?(u(),d("p",_s,i(l(c).errors[`items.${w}.qty`]),1)):x("",!0)]),t("div",null,[t("label",{for:`price_store-${w}`,class:"block text-sm font-medium text-gray-700"},"Harga Toko",8,gs),D(t("input",{type:"number",id:`price_store-${w}`,"onUpdate:modelValue":q=>C.price_store=q,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:""},null,8,ys),[[O,C.price_store,void 0,{number:!0}]]),l(c).errors[`items.${w}.price_store`]?(u(),d("p",xs,i(l(c).errors[`items.${w}.price_store`]),1)):x("",!0)]),t("div",null,[t("label",{for:`price_grosir-${w}`,class:"block text-sm font-medium text-gray-700"},"Harga Grosir",8,bs),D(t("input",{type:"number",id:`price_grosir-${w}`,"onUpdate:modelValue":q=>C.price_grosir=q,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:""},null,8,hs),[[O,C.price_grosir,void 0,{number:!0}]]),l(c).errors[`items.${w}.price_grosir`]?(u(),d("p",ks,i(l(c).errors[`items.${w}.price_grosir`]),1)):x("",!0)])]),t("button",{type:"button",onClick:q=>N(w),class:"mt-3 text-red-600 text-sm hover:text-red-800"},"Hapus Item",8,ws)]))),128)),t("button",{type:"button",onClick:L,class:"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-indigo-700 bg-indigo-100 hover:bg-indigo-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"}," Tambah Item ")]),t("div",$s,[t("button",{type:"submit",class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",disabled:l(c).processing},i(l(c).processing?"Saving...":"Simpan Produk"),9,Cs)])],32)]))}}),qs={class:"min-h-screen space-y-4 bg-gray-50 p-2 md:p-4"},zs={class:"grid grid-cols-1 gap-3 md:grid-cols-5 md:gap-2"},Ts={class:"flex flex-col md:col-span-2 lg:col-span-2"},js={class:"mb-2 flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between"},Ds={class:"flex flex-col gap-2 md:gap-3"},As=["onClick"],Ss={class:"flex-shrink-0"},Is=["src"],Ns={key:1,class:"flex h-16 w-16 select-none items-center justify-center rounded bg-gray-200 text-xs text-gray-400"},Us={class:"flex min-w-0 flex-1 flex-col justify-between"},Vs={class:"flex items-center gap-2"},Ms={class:"flex-1 truncate text-xs font-semibold text-gray-900 md:text-sm"},Rs={key:0,class:"ml-1 rounded bg-orange-500 px-2 py-0.5 text-[14px] font-bold text-white md:text-xs"},Bs={class:"text-[10px] text-gray-400 md:text-xs"},Os={key:0,class:"mt-2"},Es={class:"mt-1 flex flex-wrap gap-2"},Ks={class:"text-[10px] text-gray-400 line-through md:text-xs"},Ls={class:"text-xs font-semibold text-green-600 md:text-sm"},Fs={class:"text-[10px] text-green-500 md:text-xs"},Qs={key:1,class:"text-xs font-semibold text-gray-700 md:text-sm"},Gs={class:"flex flex-col bg-gray-100 md:col-span-2 lg:col-span-3"},Ws={class:"flex flex-wrap gap-1 p-2 md:gap-1"},Hs={key:0,class:"select-none py-8 text-center text-xs text-gray-400"},Js={class:"overflow-auto p-2"},Ys={class:"md-grid-cols-2 relative flex grid-cols-1 items-center justify-center"},Zs=["checked","onChange"],Xs={class:"max-w-[140px] truncate font-semibold text-gray-900"},ea={class:"max-w-[140px] truncate font-semibold text-gray-900"},ta={key:0,class:"text-[10px] text-gray-400 line-through"},sa={class:"block font-semibold text-gray-900"},aa={class:"text-[11px] text-gray-600"},la={key:1,class:"text-[11px] text-green-600"},na=["max","onUpdate:modelValue"],oa={key:1,class:"mt-4 flex flex-col items-start gap-2 rounded-xl bg-gray-100 p-4 shadow-sm sm:flex-row sm:items-center sm:justify-between"},ia={class:"text-xs text-gray-800"},ra={class:"text-xs text-gray-600"},ua={class:"text-xs text-gray-800"},da={class:"mt-2 gap-4 rounded-lg p-1 p-4 shadow-sm"},ca=["value"],pa={class:"mt-4 gap-4 border-t p-4 pt-2"},va={class:"mb-2 flex justify-between text-xs font-semibold text-gray-700"},ma={class:"font-bold"},fa={key:0},_a={key:1},ga={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 p-4"},ya={class:"w-full max-w-xs rounded-xl bg-white p-6 shadow-lg"},xa={class:"flex justify-end gap-3"},ba={key:1,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 p-4"},ha={class:"w-full max-w-sm rounded-lg bg-white p-6 shadow-lg"},ka={class:"mb-4 flex justify-between"},wa={class:"font-semibold"},$a={class:"mb-4 flex justify-between"},Ca={class:"font-semibold text-green-600"},Pa={class:"flex justify-end space-x-3"},qa={class:"h-64 w-full"},za={key:0,class:"space-y-4"},Ta={class:"flex items-center gap-4"},ja=["src"],Da={key:1,class:"flex h-24 w-24 select-none items-center justify-center rounded bg-gray-200 text-xs text-gray-400"},Aa={class:"text-lg font-semibold"},Sa={class:"flex flex-wrap gap-2"},Ia=["onClick"],Na=["onClick"],Ua={key:0,class:"mb-4"},Va={class:"flex flex-wrap gap-2"},Ma=["onClick"],Ra={class:"mb-4"},Ba={key:0,class:"mb-4 text-sm text-gray-700"},Oa={key:0,class:"mr-2 text-gray-400 line-through"},Ea={class:"font-bold"},Ka={key:1,class:"text-xs text-green-600"},La={class:"flex justify-end gap-2"},Fa={class:"mb-4 flex flex-col items-stretch gap-2 sm:flex-row sm:items-center"},Qa={class:"max-h-[60vh] overflow-auto rounded-lg border border-gray-200 shadow-sm"},Ga={class:"space-y-2"},Wa={class:"mt-2 flex justify-end gap-2"},Ha={key:0,class:"mt-1 text-xs text-red-600"},Ja={key:1,class:"mt-1 text-xs text-red-600"},Ya={key:2,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-30 p-4"},Za={class:"text-center"},Xa={class:"text-[12px] font-bold"},el={class:"mb-1"},tl={class:"font-bold"},sl={class:"flex justify-between p-1"},al={key:0},ll={class:"flex justify-between"},nl={class:"text-green-600"},ol={class:"flex justify-between"},il={class:"flex justify-between"},rl={class:"flex justify-between"},ul={class:"flex justify-between"},dl={class:"flex justify-between"},cl={class:"no-print mt-2 flex justify-end gap-2"},pl=Ge({__name:"POS",setup(He){const ae=v(!1),X=v(!1),W=v(!1),b=We(),ue=v([]),_e=v([]),c=v([]),L=v([]),N=v(null),le=v({placingOrder:!1}),ne=Qt(0),P=v(""),C=v(1),w=v(1),q=v(0),F=v([]),de=v(!1),y=v(null);function Je(s){y.value=s,K.value=null,S.value=null,y.value.variant==="all"&&y.value.sizes&&y.value.sizes.length>0&&(S.value=y.value.sizes[0].size_id),de.value=!0}const ge=v(!1),ye=v(!1),U=v(null),A=v(null),V=v([]),H=v(0),oe=v(""),ie=v(""),E=v(""),ke=v(null),Ye=v(null),we=v(!1),$e=v(!1),ce=v(""),pe=v([]),Ae=v(null),ve=v(null),re=v(1),ee=v(0),J=v(""),xe=v(!1),K=v(null),S=v(null);async function Ze(){try{const s=await Z.get("/api/orders/search",{params:{search:ce.value}});pe.value=s.data.data}catch(s){console.error("Error searching transactions:",s),alert("Failed to search transactions.")}}async function Xe(s){confirm("Yakin mau tampilkan struk untuk dicetak ulang?")&&(Ae.value=s,ie.value=ze(s.created_at),E.value=s.id,A.value=s.customer,V.value=s.order_items.map(e=>({product_id:e.product_id,product_name:e.product_name,quantity:Number(e.quantity),price:Number(e.price),discount:Number(e.discount),price_sell:Number(e.price_sell),variant:e.variant||"",uom_id:e.uom_id,size_id:e.size_id,qty_stock:e.qty_stock,image_path:e.image_path})),H.value=s.total_amount,oe.value=s.payment_method,T.value=s.paid_amount,ge.value=!0,Ie())}const T=v(null),Se=G(()=>T.value===null?0:T.value-M.value>0?T.value-M.value:0),et=G(()=>{var e;if(!((e=y.value)!=null&&e.sizes))return[];const s=y.value.sizes.map(a=>a.variant);return[...new Set(s)]}),tt=async s=>{if(s.length<2){ue.value=[];return}try{const e=await Z.get("/api/product-with-size",{params:{search:s}});_e.value=e.data.data}catch(e){console.error("Search error:",e),b.error("Failed to search products")}};function st(s,e){return s?s.filter(a=>a.variant===e):[]}function at(s,e){s&&(s.size_id=e.size_id,S.value=e.size_id),y.value&&(y.value.price=e.price,y.value.price_sell=e.price_sell)}function lt(){we.value=!0}function nt(){$e.value=!0,pe.value=[],ce.value=""}const ot=G(()=>y.value?y.value.variant==="all"?y.value.sizes.map(s=>s):K.value?y.value.sizes.filter(s=>s.variant===K.value):[]:[]);function Ce(){we.value=!1,ve.value=null,re.value=1,ee.value=0,J.value="",xe.value=!1}function Ie(){$e.value=!1,ce.value="",pe.value=[],Ae.value=null}async function it(){if(J.value="",xe.value=!1,!ve.value){J.value="Produk harus dipilih";return}const s=ve.value;if(!s||!s.id){J.value="Produk harus dipilih";return}if(!re.value||re.value<1){J.value="Qty minimal 1";return}if(!ee.value||ee.value<0){J.value="Harga retur harus diisi";return}c.value.push({id:s.id,product_id:s.id,product_name:s.product_name??"",size_id:s.size_id??"",uom_id:s.uom_id??"",qty_stock:0,qty_available:0,image_path:"",sizes:[],variant:null,quantity:-Math.abs(re.value),price:ee.value,price_sell:ee.value,isReturn:!0}),xe.value=!0,setTimeout(()=>{Ce()},1e3)}const te=v("TOKO ANINKA"),se=v("Blok A lantai SLG Los F No 91-92"),be=St().props.auth.user,rt=be==null?void 0:be.location_id;async function ut(){if(rt)try{const s=await Z.get("/api/locations/get");te.value=s.data.name||"TOKO ANINKA",se.value=s.data.address||"Blok A lantai SLG Los F No 91-92"}catch{te.value="TOKO ANINKA",se.value="Blok A lantai SLG Los F No 91-92"}}ut();const dt=G(()=>V.value.reduce((s,e)=>s+(e.discount??0)*e.quantity,0)),ct=G(()=>V.value.reduce((s,e)=>s+e.price*e.quantity,0)),he=v(!1),Pe=G(()=>be.name??"Kasir"),Ne=s=>s?s.startsWith("storage/")?"/"+s:s.startsWith("/storage/")?s:"/storage/"+s:"",f=s=>typeof s!="number"||isNaN(s)?"0,00":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s),pt=s=>{const e=F.value.indexOf(s);e===-1?F.value.push(s):F.value.splice(e,1)},Y=G(()=>!S.value||!y.value?null:y.value.variant==="all"?y.value.sizes.find(s=>s.size_id===S.value):K.value?y.value.sizes.find(s=>s.variant===K.value&&s.size_id===S.value):null);async function qe(){try{const s=await Z.get(`/api/stock?page=${C.value}&search=${P.value}`);ue.value=s.data.data,w.value=s.data.last_page}catch(s){console.error("Error fetching products:",s),b.error("Failed to fetch products")}}async function vt(){try{const s=await Z.get("/api/payment-methods");L.value=s.data.data}catch{b.error("Failed to fetch payment methods")}}function mt(){C.value=1,qe()}const ft=s=>{if(s.qty_stock<=0){b.error("Stok tidak cukup");return}if(s.price<=0&&(!s.price_sell||s.price_sell<=0)){b.error("Harga produk belum ditentukan");return}let e;if(s.sizes&&s.sizes.length>0){if(!S.value){b.error("Silakan pilih ukuran terlebih dahulu");return}if(e=s.sizes.find(n=>n.size_id===S.value&&(K.value===null||n.variant===K.value)),!e||e.qty_stock<=0){b.error("Stok ukuran ini tidak tersedia");return}}const a=1,m=e==null?void 0:e.price_retail,p=e==null?void 0:e.price_sell_retail,$=e==null?void 0:e.discount_retail;if(s.sizes.length&&!e){b.error("Ukuran tidak valid.");return}const _={id:s.product_id||s.id,product_id:s.product_id||s.id,product_name:s.product_name,uom_id:s.uom_id,size_id:(e==null?void 0:e.size_id)??"",qty_stock:(e==null?void 0:e.qty_stock)??s.qty_stock,qty_available:((e==null?void 0:e.qty_stock)??s.qty_stock)-a,image_path:s.image_path??"",price:m??s.price,price_sell:p??s.price_sell??s.price,discount:$??s.discount??0,quantity:a,variant:(e==null?void 0:e.variant)??s.variant??null,sizes:e?[{...e,qty_in_cart:a,qty_available:e.qty_stock-a}]:[]},h=c.value.find(n=>n.id===_.id&&n.size_id===_.size_id&&n.variant===_.variant);if(h){h.quantity+=a;const n=h.quantity>1;e&&(h.price=e[n?"price_grosir":"price_retail"]??h.price,h.price_sell=e[n?"price_sell_grosir":"price_sell_retail"]??h.price_sell,h.discount=e[n?"discount_grosir":"discount_retail"]??h.discount)}else c.value.push(_);de.value=!1,Ut(()=>{ke.value&&(ke.value.scrollTop=ke.value.scrollHeight)})};function _t(s){c.value=c.value.filter(e=>e.id!==s)}function gt(){c.value.length!==0&&(ae.value=!0)}function yt(){c.value=c.value.map(s=>F.value.includes(s.id+s.size_id)?{...s,discount:q.value,price_sell:s.price-q.value}:s),F.value=[],ae.value=!1,b.success("Discount applied successfully")}function xt(){if(c.value.length===0){b.error("Please add items to the cart");return}if(!N.value){b.error("Please select a payment method");return}T.value=null,he.value=!0}async function Ue(){if(L.value.length===0){b.error("No payment methods available");return}const s=L.value.find(e=>e.id===N.value);if((!s||s.name!=="CREDIT")&&(T.value===null||T.value<M.value)){b.error("Paid amount must be at least total amount");return}he.value=!1,await ht()}function Ve(){c.value=[],N.value=null,A.value="",E.value="",F.value=[]}async function Me(s=null){if(typeof s=="number"&&(U.value=s),typeof U.value=="number")try{const e=await Z.get(`/api/customers/get/${U.value}`);A.value=e.data.name,b.success(`Pelanggan ${A.value} berhasil ditambahkan.`)}catch(e){console.error("Error fetching customer details:",e),b.error("Gagal mengambil detail pelanggan."),U.value=null,A.value=null}else ye.value=!0}const bt=s=>{U.value=s.id,A.value=s.name,ye.value=!1},M=G(()=>c.value.reduce((s,e)=>s+e.price*e.quantity,0)),Re=G(()=>`${f(M.value)}`);async function ht(){var s;if(c.value.length===0){b.error("Please add items to the cart");return}if(!N.value){b.error("Please select a payment method");return}le.value.placingOrder=!0;try{const e=c.value.map(p=>{const $=p.discount||0;return{product_id:p.product_id??p.id,product_name:p.product_name,quantity:p.quantity,price:p.price,uom_id:p.uom_id,size_id:p.size_id||null,qty_stock:0,image_path:"",discount:$,price_sell:p.price_sell??p.price-$,variant:p.variant||"all"}}),a={items:e,payment_method_id:N.value,total_amount:M.value,paid_amount:T.value,customer_id:U.value,transaction_number:E.value||""},m=await Z.post("/api/pos/orders",a);V.value=e.map(p=>{var $;return{...p,uom_id:(($=c.value.find(_=>(_.product_id??_.id)===p.product_id))==null?void 0:$.uom_id)||""}}),H.value=m.data.total_amount,oe.value=((s=L.value.find(p=>p.id===N.value))==null?void 0:s.name)||"",ie.value=ze(m.data.created_at),E.value=m.data.transaction_number||"",U.value=null,ge.value=!0}catch(e){console.error("Error placing order:",e),b.error("Failed to place order")}finally{le.value.placingOrder=!1}}function kt(){ge.value=!1,Ve(),N.value=null}const wt=async s=>{var a;if(s.length===0)return;const e=s[0].rawValue;console.log("QR Code detected:",e),X.value=!1;try{const m=e.split(",").map(n=>n.trim()),$=(await Z.get("/api/orders/scan",{params:{ids:m.join(",")}})).data,_=[];if($.length>0&&(U.value=$[0].customer_id,A.value=((a=$[0].customer)==null?void 0:a.name)||"Guest",E.value=m.join(",")),$.forEach(n=>{var k;(k=n==null?void 0:n.order_items)!=null&&k.length&&_.push(...n.order_items)}),_.length===0){b.error("No order items found for the scanned QR code(s).");return}const h=_.map(n=>({id:n.product_id,product_id:n.product_id,product_name:n.product_name,uom_id:n.uom_id,size_id:n.size_id||"",qty_stock:n.qty_stock,image_path:n.image_path,price:n.price,price_sell:n.price_sell,discount:n.discount,quantity:n.quantity??1,variant:n.variant||"all",sizes:n.size_id?[{size_id:n.size_id,variant:n.variant||"all",qty_stock:n.qty_stock,qty_in_cart:n.quantity??1,qty_available:n.qty_stock,price:n.price,price_sell:n.price_sell,discount:n.discount,price_retail:n.price,price_sell_retail:n.price_sell,discount_retail:n.discount,price_grosir:n.price,price_sell_grosir:n.price_sell,discount_grosir:n.discount}]:[]}));console.log("Produk dalam pesanan:",h),h.forEach(n=>{const k=c.value.findIndex(Q=>(Q.product_id??Q.id)===(n.product_id??n.id)&&Q.size_id===n.size_id);k>-1?c.value[k].quantity+=n.quantity:c.value.push({...n})}),b.success("Order items added to cart!"),U.value&&Me(U.value)}catch(m){console.error("Error scanning QR code:",m),b.error("Failed to scan QR code or retrieve order details.")}},Be=new WeakMap;Te(c,s=>{s.forEach(e=>{Be.has(e)||(Be.set(e,!0),Te(()=>e.quantity,a=>{if(!e.sizes||e.sizes.length===0)return;const m=e.sizes[0],p=a>1;e.price=p?m.price_grosir:m.price_retail,e.price_sell=p?m.price_sell_grosir:m.price_sell_retail,e.discount=p?m.discount_grosir:m.discount_retail,m.qty_in_cart=a,m.qty_available=m.qty_stock-a}))})},{deep:!0}),Te(ne.internalValue,s=>{T.value=s});function $t(){const s=window.qz,e=Pe.value;if(s){const _=V.value.reduce((k,Q)=>k+Q.quantity,0),h=(H.value||M.value)-(T.value||0),n=[];n.push(`     ${te.value}`),n.push(` ${se.value}`),n.push("----------------------------------------"),n.push(`Kasir   : ${e}`),n.push(`Tanggal : ${ie.value}`),n.push(`Nomor   : ${E.value}`),n.push("------------------------------------"),n.push(`Customer: ${A.value||"-"}`),n.push("--------------------------------------"),V.value.forEach(k=>{n.push(`${k.product_name}${k.size_id?" - "+k.size_id:""} ${k.variant?" "+k.variant:""}`),n.push(`${k.quantity} x ${f(k.price)}${" ".repeat(20-(k.quantity+"").length-f(k.price).length)}${f(k.quantity*k.price)}`)}),n.push("--------------------------------"),n.push(`Total QTY        ${_}`),n.push(`Total Bayar      ${f(H.value||M.value)}`),n.push(`Jenis Bayar      ${oe.value||"-"}`),n.push(`Bayar Cash       ${f(T.value||0)}`),n.push(`Sisa             ${f(h>0?h:0)}`),n.push("--------------------------------------"),n.push("      ---TERIMA KASIH---"),n.push("     aninkafashion.com"),n.push(`


`),s.websocket.connect().then(()=>s.printers.find()).then(k=>{const Q=s.configs.create(k);return s.print(Q,[{type:"raw",format:"plain",data:n.join(`
`)}])}).catch(k=>{alert("Print error: "+k)}).finally(()=>{s.websocket.disconnect()});return}const a=V.value.reduce((_,h)=>_+h.quantity,0),m=(H.value||M.value)-(T.value||0),p=`
    <div style="font-family: 'Courier New', Courier, monospace; font-size: 12px; width: 80mm; padding: 0; margin: 0;">
      <div style="text-align:center; font-weight:bold;">${te.value}</div>
      <div style="text-align:center;">${se.value}</div>
      <div style="text-align:center;">----------------------------------------</div>
      <div style="display:flex; justify-content:space-between;">
        <span>Kasir   : ${e}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Tanggal : ${ie.value}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Nomor   : ${E.value}</span>
      </div>
      <div style="text-align:center;">----------------------------------------</div>
      <div style="display:flex; justify-content:space-between;">
        <span>Customer</span>
        <span>${A.value||"-"}</span>
      </div>
      <div style="text-align:center;">----------------------------------------</div>
      ${V.value.map(_=>`
          <div>${_.product_name} - ${_.size_id} ${_.variant} </div>
          <div style="display:flex; justify-content:space-between;">
            <span>${_.quantity} x ${f(_.price)}</span>
            <span>${f(_.quantity*_.price)}</span>
          </div>
        `).join("")}
      <div style="text-align:center;">----------------------------------------</div>
      <div style="display:flex; justify-content:space-between;">
        <span>Total QTY</span>
        <span>${a}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Total Bayar</span>
        <span>${f(H.value||M.value)}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Jenis Bayar</span>
        <span>${oe.value||"-"}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Bayar Cash</span>
        <span>${f(T.value||0)}</span>
      </div>
      <div style="display:flex; justify-content:space-between;">
        <span>Sisa</span>
        <span>${f(m>0?m:0)}</span>
      </div>
      <div style="text-align:center;">----------------------------------------</div>
      <div style="text-align:center; margin-top:8px;">---TERIMA KASIH---</div>
      <div style="text-align:center;">aninkafashion.com</div>
    </div>
  `,$=window.open("","","height=600,width=400");if(!$){alert("Please allow pop-ups for printing.");return}$.document.write(`
    <html>
      <head>
        <title>Print Struk</title>
        <style>
          @media print {
            body { margin: 0; }
            div { font-family: 'Courier New', Courier, monospace; font-size: 12px; }
          }
        </style>
      </head>
      <body>
        ${p}
        <script>
          window.onload = function() {
            setTimeout(function() {
              window.print();
              window.onafterprint = function() { window.close(); };
            }, 100);
          };
        <\/script>
      </body>
    </html>
  `),$.document.close()}function Ct(){const e="-".repeat(46),m=[te.value.padStart(Math.floor((46+te.value.length)/2)),se.value.padStart(Math.floor((46+se.value.length)/2)),e,`Kasir   : ${Pe.value}`,`Tanggal : ${ie.value}`,`Nomor   : ${E.value}`,e,`Customer: ${A.value||"-"}`,e,...V.value.flatMap(_=>{const h=_.product_name+" - "+_.size_id+(_.variant?" "+_.variant:""),n=`${_.quantity} x ${f(_.price)}`,k=f(_.quantity*_.price),Q=n.padEnd(23),Tt=k.padStart(23);return[h.length>46?h.slice(0,46):h,`${Q}${Tt}`]}),e,`Total QTY   : ${V.value.reduce((_,h)=>_+h.quantity,0)}`,`Total Bayar : ${f(H.value||M.value)}`,`Jenis Bayar : ${oe.value||"-"}`,`Bayar Cash  : ${f(T.value||0)}`,`Sisa        : ${f((H.value||M.value)-(T.value||0))}`,e,"---TERIMA KASIH---".padStart(Math.floor(64/2)),"aninkafashion.com".padStart(Math.floor(65/2)),`


`].join(`
`),$=`intent://${encodeURIComponent(m).replace(/'/g,"%27").replace(/"/g,"%22")}#Intent;scheme=rawbt;package=ru.a402d.rawbtprinter;end;`;window.location.href=$}function Pt(){qt()?Ct():$t()}function qt(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}const ze=s=>{if(!s)return"-";const e=new Date(s),m=new Intl.DateTimeFormat("id-ID",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"Asia/Jakarta"}).formatToParts(e),p=$=>{var _;return((_=m.find(h=>h.type===$))==null?void 0:_.value)||""};return`${p("day")}/${p("month")}/${p("year")} ${p("hour")}:${p("minute")} WIB`},zt=()=>{W.value=!1,qe(),b.success("Produk custom berhasil ditambahkan ke daftar!")};return qe(),vt(),(s,e)=>(u(),d(j,null,[o(l(It),{title:"Point of Sale"}),o(Rt,null,{default:r(()=>[t("div",qs,[t("div",zs,[t("section",Ts,[t("div",js,[e[23]||(e[23]=t("h2",{class:"text-sm font-semibold text-gray-800"},"Produk Tersedia",-1)),D(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=a=>P.value=a),onInput:mt,placeholder:"Cari produk...",class:"focus:ring-primary-500 w-full max-w-xs rounded-md border border-gray-300 px-2 py-1 text-xs focus:outline-none focus:ring-2 md:text-sm"},null,544),[[O,P.value]]),o(l(z),{onClick:e[1]||(e[1]=a=>W.value=!0),class:"flex items-center justify-center rounded-md bg-purple-600 p-2 text-white hover:bg-purple-700",title:"Tambah Produk"},{default:r(()=>[o(l(Gt),{class:"h-4 w-4"}),e[22]||(e[22]=g(" Tambah Produk "))]),_:1,__:[22]})]),t("div",Ds,[(u(!0),d(j,null,B(ue.value,a=>(u(),d("div",{key:a.id,onClick:m=>Je(a),class:"flex cursor-pointer flex-row items-center gap-2 rounded-lg border border-gray-200 bg-white p-2 shadow-sm transition hover:shadow-md md:gap-3 md:p-3"},[t("div",Ss,[a.image_path?(u(),d("img",{key:0,src:Ne(a.image_path),alt:"Gambar produk",class:"h-16 w-16 rounded object-cover"},null,8,Is)):(u(),d("div",Ns," Tidak Ada Gambar "))]),t("div",Us,[t("div",Vs,[t("p",Ms,i(a.product_name),1),a.discount&&a.price?(u(),d(j,{key:0},[a.discount>0?(u(),d("span",Rs,i(Math.round(a.discount/a.price*100))+"% ",1)):x("",!0)],64)):x("",!0)]),t("p",Bs,"Stok: "+i(a.qty_available)+" / "+i(a.uom_id),1),a.variant?(u(),d("div",Os,[e[24]||(e[24]=t("p",{class:"text-xs text-gray-500"},"Tersedia Ukuran:",-1)),t("div",Es,[(u(!0),d(j,null,B(st(a.sizes,a.variant),m=>(u(),d("div",{class:"rounded-full border px-3 py-1 text-xs font-medium",key:m.size_id},i(m.size_id),1))),128))])])):x("",!0),t("div",null,[a.discount&&a.discount>0?(u(),d(j,{key:0},[t("p",Ks,i(f(a.price)),1),t("p",Ls,i(f(a.price_sell??a.price-a.discount)),1),t("p",Fs,"(Diskon "+i(f(a.discount))+")",1)],64)):(u(),d("p",Qs,i(f(a.price)),1))])])],8,As))),128))])]),t("section",Gs,[t("div",Ws,[o(l(z),{variant:"outline",size:"sm",onClick:gt,disabled:F.value.length===0,class:"flex items-center gap-1 bg-indigo-100"},{default:r(()=>[o(l(Wt),{class:"h-4 w-4"}),g(" Disc ("+i(F.value.length)+") ",1)]),_:1},8,["disabled"]),o(l(z),{variant:"outline",size:"sm",onClick:e[2]||(e[2]=a=>X.value=!0),class:"flex items-center gap-1"},{default:r(()=>[o(l(Ht),{class:"h-4 w-4"}),e[25]||(e[25]=g(" QR "))]),_:1,__:[25]}),o(l(z),{variant:"outline",size:"sm",onClick:e[3]||(e[3]=()=>Me()),class:"flex items-center gap-1"},{default:r(()=>[o(l(Jt),{class:"h-4 w-4"}),e[26]||(e[26]=g(" Cust "))]),_:1,__:[26]}),o(l(z),{variant:"outline",size:"sm",onClick:lt,class:"flex items-center gap-1"},{default:r(()=>[o(l(Yt),{class:"h-4 w-4"}),e[27]||(e[27]=g(" Retur "))]),_:1,__:[27]}),o(l(z),{variant:"outline",size:"sm",onClick:e[4]||(e[4]=a=>nt()),class:"flex items-center gap-1"},{default:r(()=>[o(l(Zt),{class:"h-4 w-4"}),e[28]||(e[28]=g(" RePrint "))]),_:1,__:[28]}),o(l(z),{variant:"outline",size:"sm",onClick:Ve,class:"flex items-center gap-1"},{default:r(()=>[o(l(Qe),{class:"h-4 w-4"}),e[29]||(e[29]=g(" Clear "))]),_:1,__:[29]})]),c.value.length===0?(u(),d("div",Hs," Tidak ada item di keranjang ")):x("",!0),t("div",Js,[o(l(Ke),null,{default:r(()=>[o(l(Le),null,{default:r(()=>[o(l(fe),null,{default:r(()=>[o(l(R),{class:"text-xs"},{default:r(()=>e[30]||(e[30]=[g("#")])),_:1,__:[30]}),o(l(R),{class:"text-xs"},{default:r(()=>e[31]||(e[31]=[g("Nama")])),_:1,__:[31]}),o(l(R),{class:"text-center text-xs"},{default:r(()=>e[32]||(e[32]=[g("Qty")])),_:1,__:[32]}),o(l(R),{class:"text-center text-xs"},{default:r(()=>e[33]||(e[33]=[g("Total")])),_:1,__:[33]}),o(l(R),{class:"text-center text-xs"},{default:r(()=>e[34]||(e[34]=[g("Aksi")])),_:1,__:[34]})]),_:1})]),_:1}),o(l(Fe),null,{default:r(()=>[(u(!0),d(j,null,B(c.value,a=>(u(),je(l(fe),{key:a.id},{default:r(()=>[o(l(I),null,{default:r(()=>[t("div",Ys,[t("input",{type:"checkbox",checked:F.value.includes(a.id+a.size_id),onChange:m=>pt(a.id+a.size_id),class:"text-primary-600 focus:ring-primary-500 absolute left-0 top-0 rounded border-gray-300",title:"Pilih untuk diskon"},null,40,Zs)])]),_:2},1024),o(l(I),{class:"text-xs"},{default:r(()=>[t("div",Xs,i(a.product_name),1),t("div",ea,"Ukuran : "+i(a.size_id),1),a.discount&&a.discount>0?(u(),d("span",ta,i(f(a.price)),1)):x("",!0),t("span",sa,i(f(a.price_sell||a.price-(a.discount||0))),1),t("span",aa,"Variant: "+i(a.variant||""),1),a.discount&&a.discount>0?(u(),d("div",la," Diskon: -"+i(f(a.discount)),1)):x("",!0)]),_:2},1024),o(l(I),{class:"text-center"},{default:r(()=>[D(t("input",{type:"number",min:"1",max:a.qty_available,"onUpdate:modelValue":m=>a.quantity=m,class:"w-12 rounded border px-1 py-0.5 text-center text-xs"},null,8,na),[[O,a.quantity,void 0,{number:!0}]])]),_:2},1024),o(l(I),{class:"text-right text-xs font-semibold text-gray-900"},{default:r(()=>[g(i(f(a.quantity*(a.price_sell||a.price))),1)]),_:2},1024),o(l(I),{class:"text-center"},{default:r(()=>[o(l(z),{variant:"ghost",size:"icon",onClick:m=>_t(a.id),class:"hover:bg-gray-100"},{default:r(()=>[o(l(Qe),{class:"h-4 w-4"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),A.value?(u(),d("div",oa,[t("div",null,[e[35]||(e[35]=t("p",{class:"text-sm font-medium text-gray-500"},"Pelanggan",-1)),t("p",ia,[g(i(A.value)+" ",1),t("span",ra,"(#"+i(U.value)+")",1)])]),t("div",null,[e[36]||(e[36]=t("p",{class:"text-sm font-medium text-gray-500"},"Transaksi Online",-1)),t("p",ua,i(E.value),1)])])):x("",!0),t("div",da,[e[38]||(e[38]=t("label",{class:"mb-1 block text-xs font-medium text-gray-900"},"Metode Pembayaran",-1)),D(t("select",{"onUpdate:modelValue":e[5]||(e[5]=a=>N.value=a),class:"focus:ring-primary-500 w-full rounded-lg border border-gray-300 p-1 text-xs focus:outline-none focus:ring-2"},[e[37]||(e[37]=t("option",{value:""},"Pilih metode pembayaran",-1)),(u(!0),d(j,null,B(L.value,a=>(u(),d("option",{key:a.id,value:a.id},i(a.name),9,ca))),128))],512),[[De,N.value]])]),t("div",pa,[t("div",va,[e[39]||(e[39]=t("span",null,"Total",-1)),t("span",ma,i(Re.value),1)]),o(l(z),{class:"w-full rounded-md bg-indigo-600 py-2 text-xs font-semibold text-white hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500",onClick:xt,disabled:le.value.placingOrder},{default:r(()=>[le.value.placingOrder?(u(),d("span",fa,"Memproses...")):(u(),d("span",_a,"Bayar"))]),_:1},8,["disabled"])])])]),ae.value?(u(),d("div",ga,[t("div",ya,[e[40]||(e[40]=t("h3",{class:"mb-4 text-lg font-semibold"},"Set Discount",-1)),e[41]||(e[41]=t("label",{class:"mb-2 block text-sm font-medium"},"Discount Price",-1)),D(t("input",{type:"number","onUpdate:modelValue":e[6]||(e[6]=a=>q.value=a),class:"focus:ring-primary-500 mb-4 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:outline-none focus:ring-2"},null,512),[[O,q.value,void 0,{number:!0}]]),t("div",xa,[t("button",{onClick:yt,class:"rounded bg-green-600 px-4 py-2 text-sm text-white hover:bg-green-700"},"Save"),t("button",{onClick:e[7]||(e[7]=a=>ae.value=!1),class:"rounded bg-gray-300 px-4 py-2 text-sm text-gray-700 hover:bg-gray-400"}," Cancel ")])])])):x("",!0),he.value?(u(),d("div",ba,[t("div",ha,[e[46]||(e[46]=t("h3",{class:"mb-4 text-lg font-semibold"},"Masukkan Jumlah Bayar",-1)),D(t("input",{type:"number",min:"0","onUpdate:modelValue":e[8]||(e[8]=a=>T.value=a),onKeypress:Nt(Ue,["enter"]),class:"mb-4 w-full rounded border px-3 py-2 text-lg",placeholder:"Masukkan jumlah bayar"},null,544),[[O,T.value,void 0,{number:!0}]]),t("div",ka,[e[42]||(e[42]=t("div",null,"Total:",-1)),t("div",wa,i(Re.value),1)]),t("div",$a,[e[43]||(e[43]=t("div",null,"Kembalian:",-1)),t("div",Ca,i(f(Se.value)),1)]),t("div",Pa,[o(l(z),{variant:"outline",onClick:e[9]||(e[9]=a=>he.value=!1)},{default:r(()=>e[44]||(e[44]=[g("Batal")])),_:1,__:[44]}),o(l(z),{onClick:Ue,class:"rounded-md bg-indigo-600 py-2 text-white hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:r(()=>e[45]||(e[45]=[g("Konfirmasi")])),_:1,__:[45]})])])])):x("",!0),o(me,{show:X.value,onClose:e[10]||(e[10]=a=>X.value=!1),title:"Scan QR Code"},{default:r(()=>[t("div",qa,[o(l(Ot),{onDetect:wt})])]),_:1},8,["show"]),o(me,{show:de.value,onClose:e[13]||(e[13]=a=>de.value=!1),title:"Detail Produk"},{default:r(()=>{var a,m;return[y.value?(u(),d("div",za,[t("div",Ta,[y.value.image_path?(u(),d("img",{key:0,src:Ne(y.value.image_path),alt:"Gambar produk",class:"h-24 w-24 rounded object-cover"},null,8,ja)):(u(),d("div",Da," Tidak Ada Gambar ")),t("div",null,[t("h3",Aa,i(y.value.product_name),1),e[48]||(e[48]=t("span",{class:"mb-1 text-sm font-semibold text-gray-700"},"Pilih Ukuran ",-1)),t("div",Sa,[e[47]||(e[47]=t("br",null,null,-1)),(u(!0),d(j,null,B(ot.value,p=>(u(),d("button",{key:p.size_id,onClick:$=>S.value=p.size_id,class:Ee(["rounded-full border px-3 py-1 text-sm font-semibold transition",S.value===p.size_id?"border-green-600 bg-green-600 text-white":"border-gray-300 bg-gray-200 text-gray-800 hover:bg-gray-300"])},[t("div",{onClick:$=>at(y.value,p)},i(p.size_id),9,Na)],10,Ia))),128))])])]),((a=y.value)==null?void 0:a.variant)!=="all"?(u(),d("div",Ua,[e[49]||(e[49]=t("h4",{class:"mb-1 text-sm font-semibold text-gray-700"},"Variant",-1)),t("div",Va,[(u(!0),d(j,null,B(et.value,p=>(u(),d("button",{key:p,onClick:()=>{K.value=p,S.value=null},class:Ee(["rounded-full border px-3 py-1 text-sm font-semibold transition",K.value===p?"border-indigo-600 bg-indigo-600 text-white":"border-gray-300 bg-gray-200 text-gray-800 hover:bg-gray-300"])},i(p),11,Ma))),128))])])):x("",!0),t("div",Ra,[Y.value?(u(),d("div",Ba,[t("p",null,[e[50]||(e[50]=g(" Stok: ")),t("strong",null,i(Y.value.qty_available),1)]),(Y.value.discount??0)>0?(u(),d("span",Oa," Harga "+i(f(Y.value.price)),1)):x("",!0),e[51]||(e[51]=t("br",null,null,-1)),t("span",Ea," Harga Diskon "+i(f(Y.value.price_sell||Y.value.price)),1),e[52]||(e[52]=t("br",null,null,-1)),(Y.value.discount??0)>0?(u(),d("span",Ka," (Diskon: "+i(f(Y.value.discount??0))+") ",1)):x("",!0)])):x("",!0)]),t("div",La,[o(l(z),{variant:"outline",onClick:e[11]||(e[11]=p=>de.value=!1)},{default:r(()=>e[53]||(e[53]=[g("Batal")])),_:1,__:[53]}),o(l(z),{onClick:e[12]||(e[12]=p=>ft(y.value)),disabled:!S.value||!K.value&&((m=y.value)==null?void 0:m.variant)!=="all"},{default:r(()=>e[54]||(e[54]=[g("Tambah ke Keranjang")])),_:1,__:[54]},8,["disabled"])])])):x("",!0)]}),_:1},8,["show"]),o(me,{show:$e.value,onClose:Ie,title:"RePrint Struk"},{default:r(()=>[t("div",Fa,[o(l(Mt),{modelValue:ce.value,"onUpdate:modelValue":e[14]||(e[14]=a=>ce.value=a),class:"w-full text-sm sm:w-64",placeholder:"Cari transaksi...","aria-label":"Search"},null,8,["modelValue"]),o(l(z),{onClick:e[15]||(e[15]=a=>Ze()),class:"w-full px-4 py-2 text-sm sm:w-auto"},{default:r(()=>e[55]||(e[55]=[g(" Cari ")])),_:1,__:[55]})]),t("div",Qa,[o(l(Ke),{class:"min-w-full text-sm"},{default:r(()=>[o(l(Le),null,{default:r(()=>[o(l(fe),{class:"bg-gray-100 text-xs uppercase text-gray-600"},{default:r(()=>[o(l(R),{class:"whitespace-nowrap px-2 py-2"},{default:r(()=>e[56]||(e[56]=[g("Aksi")])),_:1,__:[56]}),o(l(R),{class:"whitespace-nowrap px-2 py-2"},{default:r(()=>e[57]||(e[57]=[g("Tanggal")])),_:1,__:[57]}),o(l(R),{class:"whitespace-nowrap px-2 py-2"},{default:r(()=>e[58]||(e[58]=[g("Customer")])),_:1,__:[58]}),o(l(R),{class:"whitespace-nowrap px-2 py-2"},{default:r(()=>e[59]||(e[59]=[g("Total")])),_:1,__:[59]}),o(l(R),{class:"whitespace-nowrap px-2 py-2"},{default:r(()=>e[60]||(e[60]=[g("Pembayaran")])),_:1,__:[60]}),o(l(R),{class:"whitespace-nowrap px-2 py-2"},{default:r(()=>e[61]||(e[61]=[g("Status")])),_:1,__:[61]})]),_:1})]),_:1}),o(l(Fe),null,{default:r(()=>[(u(!0),d(j,null,B(pe.value,a=>(u(),je(l(fe),{key:a.id,class:"cursor-pointer transition hover:bg-gray-50"},{default:r(()=>[o(l(I),{class:"px-2 py-1"},{default:r(()=>[o(l(z),{variant:"outline",size:"sm",onClick:m=>Xe(a)},{default:r(()=>e[62]||(e[62]=[g(" Cetak ")])),_:2,__:[62]},1032,["onClick"])]),_:2},1024),o(l(I),{class:"px-2 py-1"},{default:r(()=>[g(i(ze(a.created_at)),1)]),_:2},1024),o(l(I),{class:"px-2 py-1"},{default:r(()=>[g(i(a.customer),1)]),_:2},1024),o(l(I),{class:"px-2 py-1"},{default:r(()=>[g(i(f(Number(a.total_amount))),1)]),_:2},1024),o(l(I),{class:"px-2 py-1"},{default:r(()=>[g(i(a.payment_method),1)]),_:2},1024),o(l(I),{class:"px-2 py-1"},{default:r(()=>[g(i(a.status),1)]),_:2},1024)]),_:2},1024))),128)),pe.value.length===0?(u(),je(l(fe),{key:0},{default:r(()=>[o(l(I),{colspan:"6",class:"py-3 text-center text-xs text-gray-400"},{default:r(()=>e[63]||(e[63]=[g(" Tidak ada transaksi ditemukan. ")])),_:1,__:[63]})]),_:1})):x("",!0)]),_:1})]),_:1})])]),_:1},8,["show"]),o(me,{show:we.value,onClose:Ce,title:"Retur Barang"},{default:r(()=>[t("div",Ga,[e[66]||(e[66]=t("label",{class:"block text-xs font-medium"},"Produk",-1)),o(l(Bt),{modelValue:ve.value,"onUpdate:modelValue":e[16]||(e[16]=a=>ve.value=a),options:_e.value,label:"product_title",value:"id",onSearch:tt,reduce:a=>({...a,name:a.product_name,product_name:a.product_name,size_id:a.size_id,uom_id:a.uom_id,qty_available:0}),placeholder:"Pilih Produk"},null,8,["modelValue","options","reduce"]),e[67]||(e[67]=t("label",{class:"block text-xs font-medium"},"Qty",-1)),D(t("input",{type:"number","onUpdate:modelValue":e[17]||(e[17]=a=>re.value=a),min:"1",class:"w-full rounded border p-1 text-xs"},null,512),[[O,re.value,void 0,{number:!0}]]),e[68]||(e[68]=t("label",{class:"block text-xs font-medium"},"Harga Retur",-1)),D(t("input",{type:"number","onUpdate:modelValue":e[18]||(e[18]=a=>ee.value=a),min:"0",class:"w-full rounded border p-1 text-xs"},null,512),[[O,ee.value,void 0,{number:!0}]]),t("div",Wa,[o(l(z),{variant:"outline",onClick:Ce},{default:r(()=>e[64]||(e[64]=[g("Batal")])),_:1,__:[64]}),o(l(z),{class:"bg-red-600 text-white",onClick:it},{default:r(()=>e[65]||(e[65]=[g("Simpan")])),_:1,__:[65]})]),J.value?(u(),d("div",Ha,i(J.value),1)):x("",!0),xe.value?(u(),d("div",Ja,"Retur berhasil ditambahkan ke keranjang!")):x("",!0)])]),_:1},8,["show"]),ge.value?(u(),d("div",Ya,[t("div",{class:"print-area w-[450px] max-w-full rounded bg-white p-2 font-mono text-[10px] leading-tight shadow",ref_key:"printArea",ref:Ye},[t("div",Za,[t("p",Xa,i(te.value),1),t("p",null,i(se.value),1)]),e[76]||(e[76]=t("hr",{class:"my-1 border-t border-dashed"},null,-1)),t("div",el,[t("p",null,"Tanggal : "+i(ie.value),1),t("p",null,"Kasir     : "+i(Pe.value),1),t("p",null,"Nomor     : "+i(E.value),1),t("p",null,"Customer  : "+i(A.value||"-"),1)]),e[77]||(e[77]=t("hr",{class:"my-1 border-t border-dashed"},null,-1)),(u(!0),d(j,null,B(V.value,(a,m)=>(u(),d("div",{key:a.product_id,class:"mb-1"},[t("p",tl,i(m+1)+". "+i(a.product_name)+"   - "+i(a.size_id)+" "+i(a.variant),1),t("div",sl,[t("span",null,i(a.quantity)+" x "+i(f(a.price)),1),t("span",null,"  "+i(f(a.price*a.quantity)),1)]),Number(a.discount)>0?(u(),d("div",al,[t("div",ll,[t("span",nl,"- "+i(f(a.discount)),1),t("span",null,i(f(a.price*a.quantity-a.discount)),1)])])):x("",!0)]))),128)),e[78]||(e[78]=t("hr",{class:"my-1 border-t border-dashed"},null,-1)),t("div",ol,[e[69]||(e[69]=t("span",null,"Sub Total    :",-1)),t("span",null,i(f(ct.value)),1)]),t("div",il,[e[70]||(e[70]=t("span",null,"Jumlah Bayar :",-1)),t("span",null,i(f(T.value||0)),1)]),t("div",rl,[e[71]||(e[71]=t("span",null,"Kembalian    :",-1)),t("span",null,i(f(Se.value)),1)]),t("div",ul,[e[72]||(e[72]=t("span",null,"Total Disc   :",-1)),t("span",null,i(f(dt.value)),1)]),t("div",dl,[e[73]||(e[73]=t("span",null,"Metode       :",-1)),t("span",null,i(oe.value),1)]),e[79]||(e[79]=t("hr",{class:"my-1 border-t border-dashed"},null,-1)),e[80]||(e[80]=t("p",{class:"text-center"},"SELAMAT BERBELANJA",-1)),e[81]||(e[81]=t("hr",{class:"my-1 border-t border-dashed"},null,-1)),t("div",cl,[o(l(z),{variant:"outline",onClick:kt},{default:r(()=>e[74]||(e[74]=[g("TUTUP")])),_:1,__:[74]}),o(l(z),{onClick:Pt,class:"rounded-md bg-indigo-600 py-2 text-white hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:r(()=>e[75]||(e[75]=[g("CETAK")])),_:1,__:[75]})])],512)])):x("",!0)]),o(Et,{show:ye.value,"onUpdate:show":e[19]||(e[19]=a=>ye.value=a),onCustomerSelected:bt},null,8,["show"]),o(me,{show:W.value,onClose:e[21]||(e[21]=a=>W.value=!1),title:"Tambah Produk Custom"},{default:r(()=>[o(Ps,{onProductSaved:zt,onCancel:e[20]||(e[20]=a=>W.value=!1)})]),_:1},8,["show"])]),_:1})],64))}}),Dl=Vt(pl,[["__scopeId","data-v-b099a97f"]]);export{Dl as default};
