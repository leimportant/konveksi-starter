import{d as O,q as G,r as $,w as K,o as Z,f as p,g as d,p as c,u as r,Z as H,x as u,k as e,l as k,S as z,m as C,D as P,y as x,O as J,E as N,C as S,F as g,B as w,j as n,z as E}from"./app-CnwsOla3.js";import{_ as W,a as X,b as M,c as V,d as Y,e as B}from"./TableRow.vue_vue_type_script_setup_true_lang-WFdZuwu1.js";import{_ as tt}from"./AppLayout.vue_vue_type_script_setup_true_lang-CWlusLSv.js";import{u as et}from"./usePayrollStore-CxR8bRzd.js";import{P as st}from"./printer-check-Cp8-Rrx_.js";import"./index-Blped6cc.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DPxHMf7k.js";const ot={class:"space-y-4 p-6"},lt={class:"grid grid-cols-2 gap-3 sm:grid-cols-2"},rt={class:"flex flex-col"},at={class:"flex flex-col"},nt={class:"flex items-center gap-2"},it={class:"ml-4 flex items-center"},dt={class:"relative inline-flex cursor-pointer items-center"},ut={class:"overflow-hidden rounded-md border"},ct={class:"flex items-center justify-between rounded bg-gray-200 p-2 font-bold dark:bg-gray-700"},pt={class:"flex-1 text-sm font-bold text-gray-800"},ft={class:E(["grid text-[11px] text-gray-700 sm:grid-cols-2 sm:gap-x-4"])},mt={class:"flex justify-between"},gt={class:"font-bold text-gray-800"},bt={class:"flex justify-between"},yt={class:"font-bold text-gray-800"},xt={class:"flex items-center"},_t={class:"flex justify-between border-t pt-1 sm:border-t-0 sm:pt-0"},vt={class:"font-bold text-gray-900"},ht={class:"mt-2 p-2 flex gap-2"},kt={class:"w-full text-xs"},wt={class:"bg-gray-200 font-bold dark:bg-gray-700"},Dt={colspan:"4",class:"px-3 py-2"},Tt={class:"bg-blue-50 font-semibold px-3 mp-2"},$t={colspan:"5",class:"px-3 py-2"},Ct={class:"p-2"},Nt={class:"p-2 text-right"},St={class:"p-2 text-right"},jt={class:"p-2 text-right font-semibold"},zt={class:"bg-blue-100 font-bold"},Pt={class:"p-2 text-right"},Mt={class:"p-2 text-right"},Vt={key:0},Rt=O({__name:"Index",setup(Bt){const b=et(),{employees:F,startDate:_,endDate:v}=G(b),L=[{title:"Payroll Management",href:"/payroll"}],h=$(!0),D=$(""),q=$("");let j;const U=(o,t)=>(...s)=>{clearTimeout(j),j=setTimeout(()=>o(...s),t)};K(D,o=>{U(()=>{q.value=o,o&&o.trim()?b.loadData(o):b.loadData("")},500)()}),Z(()=>{_.value="2025-10-30",v.value="2025-11-16",b.loadData()});const I=o=>{if(!o)return"-";const t=o.split("T")[0],[s,l,a]=t.split("-");return`${a}/${l}/${s}`},Q=o=>{const t=Array.isArray(o.details)?o.details.flat():[];if(!t.length)return{};const s={};t.forEach(a=>{var y;const i=((y=a.created_at)==null?void 0:y.split("T")[0])||"-",f=a.model_desc||"-";s[i]||(s[i]={}),s[i][f]||(s[i][f]=[]),s[i][f].push(a)});const l={};return Object.keys(s).sort((a,i)=>i.localeCompare(a)).forEach(a=>{l[a]={},Object.keys(s[a]).sort().forEach(i=>{l[a][i]=s[a][i]})}),l},T=(o,t=!1)=>{if(o==null||o==="")return"";const s=typeof o=="string"?parseFloat(o.replace(/[^\d,-]/g,"").replace(/,/g,".")):o;if(isNaN(s))return"";const l={minimumFractionDigits:0,maximumFractionDigits:0};return t&&(l.style="currency",l.currency="IDR"),new Intl.NumberFormat("id-ID",l).format(s)},R=o=>o.reduce((t,s)=>t+Number(s.qty),0),A=o=>o.reduce((t,s)=>{const l=s.price_per_unit||s.price||0;return t+s.qty*l},0);return(o,t)=>(d(),p(g,null,[c(r(H),{title:"Payroll Management"}),c(tt,{breadcrumbs:L},{default:u(()=>[e("div",ot,[e("div",lt,[e("div",rt,[t[4]||(t[4]=e("label",{class:"mb-1 text-xs font-medium"},"Start Date",-1)),k(e("input",{type:"date","onUpdate:modelValue":t[0]||(t[0]=s=>z(_)?_.value=s:null),class:"rounded-md border px-3 py-1.5 text-sm shadow-sm focus:border-indigo-500 focus:ring"},null,512),[[C,r(_),void 0,{lazy:!0}]])]),e("div",at,[t[5]||(t[5]=e("label",{class:"mb-1 text-xs font-medium"},"End Date",-1)),k(e("input",{type:"date","onUpdate:modelValue":t[1]||(t[1]=s=>z(v)?v.value=s:null),class:"rounded-md border px-3 py-1.5 text-sm shadow-sm focus:border-indigo-500 focus:ring"},null,512),[[C,r(v),void 0,{lazy:!0}]])])]),e("div",nt,[k(e("input",{type:"text",placeholder:"Cari","onUpdate:modelValue":t[2]||(t[2]=s=>D.value=s),class:"rounded-md border px-3 py-1.5 text-sm shadow-sm focus:border-indigo-500 focus:ring"},null,512),[[C,D.value,void 0,{lazy:!0}]]),c(r(P),{onClick:r(b).loadData,size:"sm",class:"rounded bg-blue-600 px-4 py-2 text-sm text-white hover:bg-blue-700"},{default:u(()=>t[6]||(t[6]=[x(" Tampilkan ")])),_:1,__:[6]},8,["onClick"]),e("div",it,[e("label",dt,[k(e("input",{id:"detailToggle",type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=s=>h.value=s),class:"peer sr-only"},null,512),[[J,h.value]]),t[7]||(t[7]=e("div",{class:"peer h-6 w-11 rounded-full bg-gray-200 after:absolute after:left-[2px] after:top-[2px] after:h-5 after:w-5 after:rounded-full after:border after:border-gray-300 after:bg-white after:transition-all after:content-[''] peer-checked:bg-blue-600 peer-checked:after:translate-x-full peer-checked:after:border-white"},null,-1)),t[8]||(t[8]=e("span",{class:"ml-3 text-sm"},"Detail",-1))])])]),e("div",ut,[c(r(W),null,{default:u(()=>[c(r(X),null,{default:u(()=>[c(r(M),{class:"bg-gray-50"},{default:u(()=>[c(r(V),null,{default:u(()=>t[9]||(t[9]=[x("Karyawan")])),_:1,__:[9]}),h.value?(d(),N(r(V),{key:0},{default:u(()=>t[10]||(t[10]=[x("Detail")])),_:1,__:[10]})):S("",!0)]),_:1})]),_:1}),c(r(Y),null,{default:u(()=>[(d(!0),p(g,null,w(r(F),s=>(d(),N(r(M),{key:s.employee_id,class:"bg-white align-top hover:bg-gray-50"},{default:u(()=>[c(r(B),{class:"align-top"},{default:u(()=>{var l;return[e("div",ct,[e("span",pt,n((l=s.employee)==null?void 0:l.name),1),e("span",{class:E(["rounded-md border px-2 py-0.5 text-[10px] font-semibold capitalize",s.status==="closed"?"border-green-300 bg-green-50 text-green-700":"border-yellow-300 bg-yellow-50 text-yellow-700"])},n(s.status),3)]),e("div",ft,[e("div",mt,[t[11]||(t[11]=e("span",null,"Upah",-1)),e("span",gt,n(Number(s.total_upah).toLocaleString()),1)]),e("div",bt,[t[12]||(t[12]=e("span",null,"Makan",-1)),e("span",yt,n(Number(s.uang_makan).toLocaleString()),1)]),e("div",xt,[t[13]||(t[13]=e("span",null,"Potongan",-1)),t[14]||(t[14]=e("div",{class:"mx-2 flex-grow border-b border-dotted"},null,-1)),x(" "+n(Number(s.potongan).toLocaleString()),1)]),e("div",_t,[t[15]||(t[15]=e("span",{class:"font-semibold text-gray-800"},"Total Gaji",-1)),e("span",vt,n(Number(s.net_gaji).toLocaleString()),1)]),e("div",ht,[c(r(P),{variant:"outline",size:"icon",class:"flex flex-1 items-center justify-center gap-2 rounded-md bg-green-600 text-sm font-semibold text-white transition hover:bg-green-700 disabled:cursor-not-allowed disabled:opacity-50",onClick:a=>o.$inertia.visit(`/payroll/${s.id}/view`)},{default:u(()=>[c(r(st),{class:"h-4 w-4"}),t[16]||(t[16]=x(" Payslip "))]),_:2,__:[16]},1032,["onClick"])])])]}),_:2},1024),h.value?(d(),N(r(B),{key:0,class:"p-0 align-top sm:p-2"},{default:u(()=>{var l;return[e("table",kt,[(d(!0),p(g,null,w(Q(s),(a,i)=>(d(),p(g,{key:i},[e("tr",wt,[e("td",Dt,"ðŸ“… "+n(I(i)),1)]),(d(!0),p(g,null,w(a,(f,y)=>(d(),p(g,{key:y},[e("tr",Tt,[e("td",$t,"ðŸ§µ Model: "+n(y),1)]),t[19]||(t[19]=e("tr",{class:"bg-gray-100 font-semibold text-gray-600 dark:bg-gray-700"},[e("td",{class:"w-1/3 p-2 text-left"},"Size - Variant"),e("td",{class:"w-1/6 p-2 text-right"},"Qty"),e("td",{class:"w-1/6 p-2 text-right"},"Price"),e("td",{class:"w-1/3 p-2 text-right"},"Total Price")],-1)),(d(!0),p(g,null,w(f,m=>(d(),p("tr",{key:m.id,class:"border-b bg-white"},[e("td",Ct,n(m.size_id)+" - "+n(m.variant),1),e("td",Nt,n(Number(m.qty).toLocaleString()),1),e("td",St,n(T(m.price||0)),1),e("td",jt,n(T(m.qty*(m.price||0))),1)]))),128)),e("tr",zt,[t[17]||(t[17]=e("td",{class:"p-2 text-right"},"Total :",-1)),e("td",Pt,n(R(f)),1),t[18]||(t[18]=e("td",null,null,-1)),e("td",Mt,n(T(A(f))),1)])],64))),128))],64))),128)),(l=s.details)!=null&&l.length?S("",!0):(d(),p("tr",Vt,t[20]||(t[20]=[e("td",{colspan:"4",class:"p-4 text-center text-gray-500"},"Tidak ada data rincian aktivitas.",-1)])))])]}),_:2},1024)):S("",!0)]),_:2},1024))),128))]),_:1})]),_:1})])])]),_:1})],64))}});export{Rt as default};
