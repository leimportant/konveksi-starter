import{_ as b}from"./Input.vue_vue_type_script_setup_true_lang-Uf09B-pt.js";import{d as j,r as h,o as D,c as O,f as o,g as a,p as y,u,Z as q,x as w,k as s,D as C,y as M,j as l,F as i,B as m,C as P}from"./app-VdPjVcKi.js";import{_ as R}from"./AppLayout.vue_vue_type_script_setup_true_lang-DyQgMm7T.js";import{u as B}from"./useReportStore-DWRLf_WB.js";import"./index-IXw_U7aw.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-LneaF6EF.js";const N={class:"py-6 px-2 max-w-7xl mx-auto space-y-4"},T={class:"flex flex-wrap gap-2 mb-4 items-end"},A={key:0,class:"py-4 text-center text-gray-500"},E={key:1,class:"py-4 text-center text-red-500"},F={key:2,class:"overflow-x-auto bg-white shadow rounded-lg"},U={class:"min-w-full text-sm text-gray-800"},$={class:"bg-gray-50 font-semibold text-xs uppercase text-gray-600"},I={class:"bg-gray-100 font-semibold hover:bg-gray-200"},L={class:"px-3 py-2",colspan:"2"},G={class:"px-3 py-2 text-center"},K={class:"px-3 py-1 align-top"},Q={class:"px-3 py-1 align-top min-w-[180px] max-w-[240px]"},Y={key:0,class:"flex flex-col gap-1 rounded-lg border border-gray-200 bg-gray-50 p-1 text-[11px] text-gray-700"},Z={class:"font-semibold"},H={class:"px-3 py-1 text-center align-top"},J={class:"bg-gray-50 font-semibold text-xs text-gray-600"},W={class:"px-3 py-2 text-center"},rt=j({__name:"ProductionSummary",setup(X){const c=B(),x=h(""),_=h(""),f=h(""),k=[{title:"Production Summary",href:"/reports/production-summary"}],S=()=>{c.fetchProductionSummary(x.value,_.value,f.value)};D(()=>{const n=new Date,t=new Date(n.getFullYear(),n.getMonth(),1);x.value=t.toISOString().split("T")[0],_.value=n.toISOString().split("T")[0],S()});const g=O(()=>{const n=new Map;return Object.values(c.productionSummary).forEach(t=>{Object.values(t.activities??{}).forEach(e=>{n.has(e.name)||n.set(e.name,e.name)})}),Array.from(n.entries()).map(([t])=>({id:t,name:t}))}),V=(n,t)=>n.activity_role_name===t?n.total_qty:0;return(n,t)=>(a(),o(i,null,[y(u(q),{title:"Production Summary Report"}),y(R,{breadcrumbs:k},{header:w(()=>t[3]||(t[3]=[s("h2",{class:"text-xl font-semibold text-gray-800"},"Production Summary Report",-1)])),default:w(()=>[s("div",N,[s("div",T,[y(u(b),{type:"date",modelValue:x.value,"onUpdate:modelValue":t[0]||(t[0]=e=>x.value=e),class:"w-40"},null,8,["modelValue"]),y(u(b),{type:"date",modelValue:_.value,"onUpdate:modelValue":t[1]||(t[1]=e=>_.value=e),class:"w-40"},null,8,["modelValue"]),y(u(b),{type:"text",modelValue:f.value,"onUpdate:modelValue":t[2]||(t[2]=e=>f.value=e),placeholder:"Search Model / Activity",class:"flex-1 min-w-[200px]"},null,8,["modelValue"]),y(u(C),{class:"bg-indigo-600 text-white hover:bg-indigo-700",onClick:S},{default:w(()=>t[4]||(t[4]=[M("Show")])),_:1,__:[4]})]),u(c).loading?(a(),o("div",A,"Loading...")):u(c).error?(a(),o("div",E,l(u(c).error.message),1)):(a(),o("div",F,[s("table",U,[s("thead",$,[s("tr",null,[t[5]||(t[5]=s("th",{class:"px-3 py-2",colspan:"2"},"Model",-1)),(a(!0),o(i,null,m(g.value,e=>(a(),o("th",{key:"header-role-"+e.id,class:"px-2 py-1 text-center"},l(e.name),1))),128)),t[6]||(t[6]=s("th",{class:"px-3 py-2 text-center"},"Subtotal",-1))])]),s("tbody",null,[(a(!0),o(i,null,m(u(c).productionSummary,e=>(a(),o(i,{key:e.model_id},[s("tr",I,[s("td",L,l(e.description),1),(a(!0),o(i,null,m(g.value,r=>{var p;return a(),o("td",{key:"summary-"+r.id+"-"+e.model_id,class:"px-2 py-1 text-center"},l(((p=Object.values(e.activities).find(d=>d.name===r.name))==null?void 0:p.qty)??"-"),1)}),128)),s("td",G,l(e.subtotal_qty),1)]),(a(!0),o(i,null,m(e.details,r=>{var p;return a(),o("tr",{key:r.production_id,class:"hover:bg-gray-50"},[s("td",K,l(r.employee_name),1),s("td",Q,[(p=r.items)!=null&&p.length?(a(),o("div",Y,[(a(!0),o(i,null,m(r.items,(d,v)=>(a(),o("div",{key:v,class:"flex items-center justify-between rounded-md bg-white px-1.5 py-0.5 shadow-sm"},[s("span",null,l(d.size_id)+" - "+l(d.variant),1),s("span",Z,l(d.qty),1)]))),128))])):P("",!0)]),(a(!0),o(i,null,m(g.value,d=>(a(),o("td",{key:"detail-"+d.id+"-"+r.production_id,class:"px-2 py-1 text-center align-top"},l(V(r,d.name)||"-"),1))),128)),s("td",H,l(r.total_qty),1)])}),128))],64))),128))]),s("tfoot",J,[s("tr",null,[t[7]||(t[7]=s("td",{colspan:"2",class:"px-3 py-2 text-right"},"Grand Total:",-1)),(a(!0),o(i,null,m(g.value,e=>(a(),o("td",{key:"footer-role-"+e.id,class:"px-2 py-1 text-center"},l(Object.values(u(c).productionSummary).reduce((r,p)=>{var d;return r+(((d=Object.values(p.activities).find(v=>v.name===e.name))==null?void 0:d.qty)??0)},0)),1))),128)),s("td",W,l(Object.values(u(c).productionSummary).reduce((e,r)=>e+(r.subtotal_qty??0),0)),1)])])])]))])]),_:1})],64))}});export{rt as default};
