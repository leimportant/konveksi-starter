import{_ as Q}from"./AppLayout.vue_vue_type_script_setup_true_lang-CXI-OFE0.js";import{r as P,V as A,d as R,o as Z,f as _,g as d,p as a,u as t,Z as H,x as s,k as o,C,y as l,j as m,F as B,B as V,E as X,D as y,aX as N,aY as D,aZ as L,a_ as z,b0 as F}from"./app-Cc0-XsVa.js";import{u as Y}from"./useTransferStockStore-D_GrUSxA.js";import{u as q}from"./useToast-CPWFUHv0.js";import{_ as I,a as K,b as j,c as w,d as U,e as $}from"./TableRow.vue_vue_type_script_setup_true_lang-BrVXD2t_.js";import"./index-BGxQBHr3.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-Cgh6EfYZ.js";function J(){const g=Y(),f=q(),p=P(!1);return{acceptTransfer:async k=>{var v,u;p.value=!0;try{await g.fetchTransferByID(k),await g.acceptTransfer(k),f.success("Transfer diterima"),A.visit("/transfer-stock")}catch(r){console.error(r),f.error(((u=(v=r==null?void 0:r.response)==null?void 0:v.data)==null?void 0:u.message)??"Gagal menerima transfer")}finally{p.value=!1}},rejectTransfer:async k=>{var v,u;p.value=!0;try{await g.fetchTransferByID(k),await g.rejectTransfer(k),f.success("Transfer ditolak"),A.visit("/transfer-stock")}catch(r){console.error(r),f.error(((u=(v=r==null?void 0:r.response)==null?void 0:v.data)==null?void 0:u.message)??"Gagal menolak transfer")}finally{p.value=!1}},loading:p}}const O={class:"p-6 space-y-6"},W={key:0,class:"space-y-6"},h={class:"overflow-x-auto rounded-md border border-gray-200 dark:border-gray-700"},ee={class:"flex flex-col gap-1 border border-gray-200 rounded bg-gray-50 p-2 text-[11px] sm:text-xs text-gray-800"},te={class:"font-semibold"},ae={key:0,class:"flex justify-between bg-white px-2 py-1 rounded shadow-sm border-t font-semibold mt-1 text-gray-900"},se={class:"flex items-center justify-between gap-4"},ne={key:0,class:"flex gap-2"},le={key:1,class:"text-center py-8"},re={class:"flex justify-end gap-2 mt-4"},oe={class:"flex justify-end gap-2 mt-4"},ke=R({__name:"View",props:{id:{}},setup(g){const f=g,p=[{title:"Transfer Stock",href:"/transfer-stock"}],i=Y(),S=q(),{acceptTransfer:k,rejectTransfer:v,loading:u}=J(),r=P(!1),T=P(!1);Z(async()=>{try{await i.fetchTransferByID(f.id),await i.fetchProducts()}catch(b){console.error(b),S.error("Failed to load transfer details")}});const E=b=>b.reduce((e,n)=>{var x;const c=((x=n.product)==null?void 0:x.name)??"Unknown Product";return e[c]=e[c]||[],e[c].push(n),e},{}),G=b=>b.reduce((e,n)=>e+Number(n.qty??0),0);return(b,e)=>(d(),_(B,null,[a(t(H),{title:"Transfer Stock Management"}),a(Q,{breadcrumbs:p},{default:s(()=>[o("div",O,[t(i).transfer?(d(),_("div",W,[a(t(I),null,{default:s(()=>[a(t(K),null,{default:s(()=>[a(t(j),null,{default:s(()=>[a(t(w),null,{default:s(()=>e[9]||(e[9]=[l("Lokasi Asal")])),_:1,__:[9]}),a(t(w),null,{default:s(()=>e[10]||(e[10]=[l("Lokasi Tujuan")])),_:1,__:[10]}),a(t(w),null,{default:s(()=>e[11]||(e[11]=[l("Sloc")])),_:1,__:[11]})]),_:1})]),_:1}),a(t(U),null,{default:s(()=>[a(t(j),null,{default:s(()=>[a(t($),null,{default:s(()=>{var n;return[l(m((n=t(i).transfer.location)==null?void 0:n.name),1)]}),_:1}),a(t($),null,{default:s(()=>{var n;return[l(m((n=t(i).transfer.location_destination)==null?void 0:n.name),1)]}),_:1}),a(t($),null,{default:s(()=>{var n;return[l(m((n=t(i).transfer.sloc)==null?void 0:n.name),1)]}),_:1})]),_:1})]),_:1})]),_:1}),e[18]||(e[18]=o("div",{class:"bg-blue-50 border border-blue-200 text-blue-700 p-3 rounded text-sm"}," âš  Harap periksa kembali *Qty, Size, Variant, dan Produk* sebelum melakukan penerimaan barang. ",-1)),o("div",h,[a(t(I),{class:"min-w-full table-auto text-left text-sm text-gray-800 dark:text-gray-100"},{default:s(()=>[a(t(K),null,{default:s(()=>[a(t(j),null,{default:s(()=>[a(t(w),{class:"w-1/3"},{default:s(()=>e[12]||(e[12]=[l("Produk")])),_:1,__:[12]}),a(t(w),null,{default:s(()=>e[13]||(e[13]=[l("Size/Qty")])),_:1,__:[13]})]),_:1})]),_:1}),a(t(U),null,{default:s(()=>[(d(!0),_(B,null,V(E(t(i).transfer.transfer_detail),(n,c)=>(d(),X(t(j),{key:c},{default:s(()=>[a(t($),{class:"font-semibold align-top"},{default:s(()=>[l(m(c),1)]),_:2},1024),a(t($),null,{default:s(()=>[o("div",ee,[(d(!0),_(B,null,V(n,(x,M)=>(d(),_("div",{key:M,class:"flex justify-between bg-white px-2 py-1 rounded shadow-sm"},[o("span",null,m(x.size_id)+" - "+m(x.variant),1),o("span",te,m(x.qty),1)]))),128)),n.length>1?(d(),_("div",ae,[e[14]||(e[14]=o("span",null,"Total",-1)),o("span",null,m(G(n)),1)])):C("",!0)])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),o("div",se,[a(t(y),{variant:"outline",onClick:e[0]||(e[0]=n=>t(A).visit("/transfer-stock"))},{default:s(()=>e[15]||(e[15]=[l(" Kembali ")])),_:1,__:[15]}),t(i).transfer.status==="Pending"?(d(),_("div",ne,[a(t(y),{variant:"default",onClick:e[1]||(e[1]=n=>r.value=!0),disabled:t(u)},{default:s(()=>e[16]||(e[16]=[l(" Accept ")])),_:1,__:[16]},8,["disabled"]),a(t(y),{variant:"destructive",onClick:e[2]||(e[2]=n=>T.value=!0),disabled:t(u)},{default:s(()=>e[17]||(e[17]=[l(" Reject ")])),_:1,__:[17]},8,["disabled"])])):C("",!0)])])):t(u)?(d(),_("div",le," Loading... ")):C("",!0)]),a(t(N),{open:r.value,"onUpdate:open":e[5]||(e[5]=n=>r.value=n)},{default:s(()=>[a(t(D),null,{default:s(()=>[a(t(L),null,{default:s(()=>[a(t(z),null,{default:s(()=>e[19]||(e[19]=[l("Konfirmasi Penerimaan")])),_:1,__:[19]}),a(t(F),null,{default:s(()=>e[20]||(e[20]=[l(" Pastikan seluruh barang sudah sesuai dengan fisik di gudang. Apakah Anda yakin ingin "),o("strong",null,"menerima",-1),l(" barang ini? ")])),_:1,__:[20]})]),_:1}),o("div",re,[a(t(y),{variant:"outline",onClick:e[3]||(e[3]=n=>r.value=!1)},{default:s(()=>e[21]||(e[21]=[l("Batal")])),_:1,__:[21]}),a(t(y),{variant:"default",onClick:e[4]||(e[4]=()=>{t(k)(f.id),r.value=!1})},{default:s(()=>e[22]||(e[22]=[l(" Ya, Terima ")])),_:1,__:[22]})])]),_:1})]),_:1},8,["open"]),a(t(N),{open:T.value,"onUpdate:open":e[8]||(e[8]=n=>T.value=n)},{default:s(()=>[a(t(D),null,{default:s(()=>[a(t(L),null,{default:s(()=>[a(t(z),null,{default:s(()=>e[23]||(e[23]=[l("Konfirmasi Penolakan")])),_:1,__:[23]}),a(t(F),null,{default:s(()=>e[24]||(e[24]=[l(" Apakah Anda yakin ingin "),o("strong",null,"menolak",-1),l(" barang ini? Tindakan ini tidak dapat dibatalkan. ")])),_:1,__:[24]})]),_:1}),o("div",oe,[a(t(y),{variant:"outline",onClick:e[6]||(e[6]=n=>T.value=!1)},{default:s(()=>e[25]||(e[25]=[l("Batal")])),_:1,__:[25]}),a(t(y),{variant:"destructive",onClick:e[7]||(e[7]=()=>{t(v)(f.id),T.value=!1})},{default:s(()=>e[26]||(e[26]=[l(" Ya, Tolak ")])),_:1,__:[26]})])]),_:1})]),_:1},8,["open"])]),_:1})],64))}});export{ke as default};
