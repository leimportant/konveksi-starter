import{d as K,q as L,r as g,c as M,o as E,f as n,g as r,p as d,u as o,Z as Q,x as _,k as e,D as b,y as G,G as U,F as k,B as S,j as l,E as T,C as z,z as Z}from"./app-CDwT_d22.js";import{_ as H}from"./Input.vue_vue_type_script_setup_true_lang-DI3z5g3h.js";import{u as J}from"./useToast-QNKpNeGN.js";import{_ as W}from"./AppLayout.vue_vue_type_script_setup_true_lang-Der2molT.js";import{u as X}from"./useProductionStore-DNP-R8L0.js";import{P as Y}from"./plus-Brfbvusw.js";import{S as tt}from"./square-pen-wOVolH0p.js";import{T as et}from"./trash-2-CyOBFW7S.js";import{V as at}from"./view-B97jDuxO.js";import"./index-BixaK_zC.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DijOI3sT.js";const ot={class:"px-3 py-4"},st={class:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3"},rt={class:"flex flex-1 gap-2"},nt={key:0,class:"py-4 text-center text-sm text-gray-500"},it={key:1,class:"space-y-2"},lt={class:"overflow-x-auto rounded-md border border-gray-200 dark:border-gray-700"},dt={class:"min-w-full table-auto text-sm text-left text-gray-800 dark:text-gray-100"},ct={class:"px-3 py-2 whitespace-nowrap align-top"},ut={class:"px-3 py-2 max-w-[160px] whitespace-normal align-top"},pt={class:"px-3 py-2 truncate align-top"},yt={class:"px-3 py-2 whitespace-nowrap"},gt={key:0},_t={key:1},vt={class:"px-3 py-2 max-w-[160px] truncate align-top"},ht={class:"px-3 py-2 max-w-[160px] truncate align-top"},xt={class:"px-3 py-2 whitespace-nowrap align-top"},ft={class:"px-3 py-2 text-right align-top"},mt={class:"flex justify-end gap-1 sm:gap-2"},bt={class:"flex justify-end mt-4 space-x-2"},kt=["disabled"],wt=["onClick","disabled"],Pt=["disabled"],Ot=K({__name:"Index",props:{activity_role:{}},setup(F){const w=J(),v=X(),{productions:N,currentPage:c,lastPage:B,loading:h}=L(v),D=g(10),V=g("created_at"),I=g("desc"),x=F,O=[{title:"Production",href:`/production/${x.activity_role}`}],P=M(()=>B.value||1),C=async s=>{var a,t;s<1||s>P.value||(await v.fetchProductions({page:s,per_page:D.value,sort_field:V.value,sort_order:I.value,activity_role_id:x.activity_role,search:f.value,date_from:(a=m.value.from)==null?void 0:a.toISOString(),date_to:(t=m.value.to)==null?void 0:t.toISOString()}),c.value=s)},j=()=>C(c.value+1),A=()=>C(c.value-1),f=g(""),m=g({from:null,to:null});function R(s){return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s)}const $=async(s=1)=>{var a,t,i,y;try{await v.fetchProductions({page:s||c.value,per_page:D.value,sort_field:V.value,sort_order:I.value,activity_role_id:x.activity_role,search:f.value,date_from:(a=m.value.from)==null?void 0:a.toISOString(),date_to:(t=m.value.to)==null?void 0:t.toISOString()})}catch(p){w.error(((y=(i=p==null?void 0:p.response)==null?void 0:i.data)==null?void 0:y.message)??"Failed to fetch productions")}};E($);const q=async s=>{var a,t;if(confirm("Are you sure you want to delete this production?"))try{await v.deleteProduction(s),w.success("Production deleted successfully"),await $(1)}catch(i){w.error(((t=(a=i==null?void 0:i.response)==null?void 0:a.data)==null?void 0:t.message)??"Failed to delete production")}};return(s,a)=>(r(),n(k,null,[d(o(Q),{title:"Production Management"}),d(W,{breadcrumbs:O},{default:_(()=>[e("div",ot,[e("div",st,[e("div",rt,[d(o(b),{onClick:a[0]||(a[0]=t=>s.$inertia.visit(`/production/${x.activity_role}/create`)),class:"flex-shrink-0 flex items-center gap-2 rounded-md bg-indigo-600 px-3 py-2 text-sm font-medium text-white hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:_(()=>[d(o(Y),{class:"h-4 w-4"}),a[3]||(a[3]=G(" Tambah Data "))]),_:1,__:[3]}),d(o(H),{modelValue:f.value,"onUpdate:modelValue":a[1]||(a[1]=t=>f.value=t),placeholder:"Search...",class:"flex-1 text-sm",onKeyup:a[2]||(a[2]=U(t=>$(1),["enter"]))},null,8,["modelValue"])])]),o(h)?(r(),n("div",nt,"Loading...")):(r(),n("div",it,[e("div",lt,[e("table",dt,[a[4]||(a[4]=e("thead",{class:"bg-gray-100 dark:bg-gray-800 text-xs font-semibold uppercase text-gray-600 dark:text-gray-300"},[e("tr",null,[e("th",{class:"px-3 py-2"},"Karyawan"),e("th",{class:"px-3 py-2"},"Model"),e("th",{class:"px-3 py-2"},"Activity"),e("th",{class:"px-3 py-2"},"Size/Qty"),e("th",{class:"px-3 py-2"},"Price/PCS"),e("th",{class:"px-3 py-2"},"Total"),e("th",{class:"px-3 py-2"},"Created At"),e("th",{class:"px-3 py-2 text-right"},"Actions")])],-1)),e("tbody",null,[(r(!0),n(k,null,S(o(N),t=>{var i,y,p;return r(),n("tr",{key:t.id,class:"border-b border-gray-100 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800"},[e("td",ct,l(t.employee_name||"-"),1),e("td",ut,l(((i=t.model)==null?void 0:i.description)||"-"),1),e("td",pt,l(((y=t.activity_role)==null?void 0:y.name)||"-"),1),e("td",yt,[(p=t.items)!=null&&p.length?(r(),n("div",gt,[(r(!0),n(k,null,S(t.items,u=>(r(),n("div",{key:u.id},l(u.size_id)+" - "+l(u.variant)+": "+l(u.qty),1))),128))])):(r(),n("div",_t,"-"))]),e("td",vt,l(R((t==null?void 0:t.price_per_pcs)||0)),1),e("td",ht,l((t==null?void 0:t.total_price)||0),1),e("td",xt,l(t.created_at?new Date(t.created_at).toLocaleDateString():"-"),1),e("td",ft,[e("div",mt,[t.status===1||t.status===3?(r(),T(o(b),{key:0,variant:"ghost",size:"icon",class:"hover:bg-gray-100 dark:hover:bg-gray-700",onClick:u=>s.$inertia.visit(`/production/${t.activity_role_id}/edit/${t.id}`)},{default:_(()=>[d(o(tt),{class:"h-4 w-4"})]),_:2},1032,["onClick"])):z("",!0),t.status===1||t.status===3?(r(),T(o(b),{key:1,variant:"ghost",size:"icon",class:"hover:bg-gray-100 dark:hover:bg-gray-700",onClick:u=>q(t.id)},{default:_(()=>[d(o(et),{class:"h-4 w-4"})]),_:2},1032,["onClick"])):z("",!0),d(o(b),{variant:"ghost",size:"icon",class:"hover:bg-gray-100 dark:hover:bg-gray-700",onClick:u=>s.$inertia.visit(`/production/${t.activity_role_id}/view/${t.id}`)},{default:_(()=>[d(o(at),{class:"h-4 w-4"})]),_:2},1032,["onClick"])])])])}),128))])])]),e("div",bt,[e("button",{onClick:A,disabled:o(c)===1||o(h),class:"px-3 py-1 rounded border border-gray-300 text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed"}," Previous ",8,kt),(r(!0),n(k,null,S(P.value,t=>(r(),n("button",{key:t,onClick:i=>C(t),class:Z(["px-3 py-1 rounded border text-sm",t===o(c)?"bg-blue-600 border-blue-600 text-white":"border-gray-300 text-gray-700 hover:bg-gray-100"]),disabled:o(h)},l(t),11,wt))),128)),e("button",{onClick:j,disabled:o(c)===P.value||o(h),class:"px-3 py-1 rounded border border-gray-300 text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed"}," Next ",8,Pt)])]))])]),_:1})],64))}});export{Ot as default};
