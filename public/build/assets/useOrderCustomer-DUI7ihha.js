import{r as s,b as n}from"./app-DSPsTJSL.js";function O(){const r=s([]),l=s(!0),o=s(null),i=s(null),f=s(!1),g=s(null),y=async()=>{f.value=!0;try{const e=await n.get("/api/bank-account");g.value=e.data}catch(e){console.error("Gagal mengambil rekening:",e),g.value=null}finally{f.value=!1}},c=async e=>{l.value=!0,o.value=null;try{const a=await n.get("/api/orders/customer",{params:e});if(i.value=a.data,e!=null&&e.append&&a.data.data.length===0){l.value=!1;return}e!=null&&e.append?r.value=[...r.value,...a.data.data]:r.value=a.data.data}catch(a){console.error("Error fetching orders:",a),o.value="Failed to load orders. Please try again later."}finally{l.value=!1}},h=async e=>{try{if(!window.confirm("Apakah Anda yakin ingin membatalkan pesanan ini?"))return;await n.post(`/api/orders/${e}/cancel`),await c()}catch(a){console.error("Gagal membatalkan pesanan:",a),o.value="Gagal membatalkan pesanan."}},v=async e=>{try{if(!window.confirm("Apakah Anda yakin ingin membatalkan pesanan ini?"))return;const t=Number(e.replace(/\D+/g,""));await n.delete(`/api/cart-items/${t}/remove`),await u(d.value)}catch(a){console.error("Gagal membatalkan pesanan:",a),o.value="Gagal membatalkan pesanan."}},m=async e=>{try{return(await n.get(`/api/orders/${e}/shipping`)).data}catch(a){throw console.error("Gagal mengambil status pengiriman:",a),new Error("Gagal mengambil status pengiriman")}},u=async e=>{l.value=!0,o.value=null;try{const a=await n.get("/api/orders/request",{params:e});i.value=a.data,e!=null&&e.append?r.value=[...r.value,...a.data.data]:r.value=a.data.data}catch(a){console.error("Error fetching orders:",a),o.value="Failed to load orders. Please try again later."}finally{l.value=!1}};async function w(e,a){try{return(await n.post(`/api/orders/${e}/shipping`,a,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(t){throw console.error("Error updating shipping:",t),t}}async function k(e,a){try{const t=new FormData;return t.append("payment_proof",a),(await n.post(`/api/orders/${e}/upload-payment-proof`,t,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(t){throw console.error("Error uploading payment proof:",t),t}}const d=s({});return{orders:r,isLoading:l,error:o,pagination:i,fetchOrders:c,fetchBankAccount:y,setFilter:(e,a,t)=>{d.value[e]=a,c({[e]:a,...t})},setFilterOrderRequest:(e,a,t)=>{d.value[e]=a;const p={...t,[e]:a};t!=null&&t.status&&(p.status=t.status),u(p)},fetchOrderRequest:u,cancelOrder:h,deleteOrder:v,updateShipping:w,checkShipping:m,uploadPaymentProof:k}}export{O as u};
