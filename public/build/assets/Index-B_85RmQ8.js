import{d as G,r as y,e as ce,E as J,g as u,T as fe,q as D,c as pe,o as ve,f as m,p as l,u as o,Z as be,x as a,k as s,C as F,D as g,y as d,V as ge,F as x,B as C,j as v,z as ye,R as H,l as q,W as j}from"./app-DpWrON_T.js";import{_ as xe}from"./AppLayout.vue_vue_type_script_setup_true_lang-D7oWGhGO.js";import{_ as _e}from"./DocumentList.vue_vue_type_script_setup_true_lang-CzXaR3JY.js";import{_ as O}from"./Input.vue_vue_type_script_setup_true_lang-BUyj-wrB.js";import{_ as we,a as ke,b as L,c as P,d as Ce,e as U}from"./TableRow.vue_vue_type_script_setup_true_lang-Cr3wn1wL.js";import{u as Pe}from"./useToast-BmMZDI9v.js";import{u as Ue}from"./useProductStore-CbRg81Og.js";import{u as $e}from"./useCategoryStore-BqvRUx-h.js";import{u as Me}from"./useUomStore-CvVKNpWd.js";import{d as Se}from"./debounce-BcZQbp_F.js";import{P as Ne}from"./plus-B7dXvs2L.js";import{S as Ve}from"./square-pen-RTK_KiGE.js";import{T as Te}from"./trash-2-sVY2ftDk.js";import{U as qe}from"./upload-DPhB-JCj.js";import"./index-EOWVmPkW.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-ChaEM8tw.js";import"./trash-DsIW1uKs.js";const W=G({__name:"QuillEditor",setup(E){const i=y("");return(b,p)=>{const S=ce("QuillEditor",!0);return u(),J(S,{content:i.value,"onUpdate:content":p[0]||(p[0]=_=>i.value=_),theme:"snow",contentType:"html"},null,8,["content"])}}});function je(E,i){const b=document.createElement("div");b.innerHTML=E||"";const p=b.textContent||b.innerText||"";return p.length>i?p.slice(0,i)+"...":p}const Ee={class:"px-4 py-4"},he={class:"flex justify-between items-center gap-2 mb-2"},ze={class:"rounded-md border"},Be={class:"flex justify-end mt-4 space-x-2"},De=["disabled"],Fe=["onClick"],Oe=["disabled"],Ie={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Ae={class:"relative bg-white p-6 rounded-lg shadow-xl w-full max-w-sm md:max-w-md lg:max-w-lg xl:max-w-4xl max-h-[90vh] overflow-y-auto"},Qe={class:"flex justify-between items-center mb-4"},Re={class:"mt-4 flex justify-end"},He={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Le={class:"bg-white p-6 rounded-lg w-[1000px]"},We={class:"space-y-4"},Ze=["value"],Ge=["value"],Je={class:"flex justify-end gap-2 mt-4"},Ke={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Xe={class:"bg-white p-6 rounded-lg w-[1000px]"},Ye={class:"space-y-4"},et=["value"],tt=["value"],ot={class:"flex justify-end gap-2 mt-4"},Z=10,_t=G({__name:"Index",setup(E){const i=Pe(),b=y(!1),p=y(!1),S=y(null),_=y(!1),N=y(null),K=y("product"),n=fe({name:"",descriptions:"",category_id:0,uom_id:""}),X=[{title:"Product",href:"/products"}],w=Ue(),I=$e(),A=Me(),{items:Q,total:Y,loading:ee,filterName:h}=D(w),{items:z}=D(I),{items:B}=D(A),c=y(1),R=y(0),V=pe(()=>Math.ceil(R.value/Z)),$=async r=>{await w.fetchProducts(r,Z),R.value=Y.value||0,c.value=r};ve(async()=>{await Promise.all([I.fetchCategories(),A.fetchUoms()]),await $(c.value)});const T=async r=>{r<1||r>V.value||await $(r)},te=async()=>{c.value<V.value&&await T(c.value+1)},oe=async()=>{c.value>1&&await T(c.value-1)},se=Se((r,e)=>{w.setFilter(r,e)},400),le=r=>{const e=r.target;se("name",e.value)},ne=async()=>{var r,e,t,f;if(!n.name)return i.error("Name is required");if(!n.category_id)return i.error("Category is required");if(!n.uom_id)return i.error("UOM is required");try{await w.createProduct({name:n.name,descriptions:n.descriptions,category_id:Number(n.category_id),uom_id:n.uom_id}),i.success("Product created successfully"),n.reset(),b.value=!1,await $(c.value)}catch(k){const M=(f=(t=(e=(r=k==null?void 0:k.response)==null?void 0:r.data)==null?void 0:e.errors)==null?void 0:t.name)==null?void 0:f[0];i.error(M||"Failed to create Product")}},re=r=>{N.value=r,n.name=r.name,n.descriptions=r.descriptions,n.category_id=r.category_id,n.uom_id=r.uom_id,_.value=!0},ae=async()=>{var e,t,f,k;if(!N.value||!n.name)return i.error("Name is required");if(!n.category_id)return i.error("Category is required");if(!n.uom_id)return i.error("UOM is required");const r=N.value.id;try{await w.updateProduct(r,{name:n.name,descriptions:n.descriptions,category_id:n.category_id,uom_id:n.uom_id}),i.success("Product updated successfully"),n.reset(),_.value=!1,N.value=null,await $(c.value)}catch(M){const me=(k=(f=(t=(e=M==null?void 0:M.response)==null?void 0:e.data)==null?void 0:t.errors)==null?void 0:f.name)==null?void 0:k[0];i.error(me||"Failed to update Product")}},ie=async r=>{var e,t;if(confirm("Are you sure you want to delete this Product?"))try{await w.deleteProduct(r),i.success("Product deleted successfully"),Q.value.length===1&&c.value>1?await T(c.value-1):await $(c.value)}catch(f){i.error(((t=(e=f==null?void 0:f.response)==null?void 0:e.data)==null?void 0:t.message)??"Failed to delete Product")}},de=r=>{const e=z.value.find(t=>t.id===r);return(e==null?void 0:e.name)||"N/A"},ue=r=>{const e=B.value.find(t=>t.id===r);return(e==null?void 0:e.name)||"N/A"};return(r,e)=>(u(),m(x,null,[l(o(be),{title:"Product Management"}),l(xe,{breadcrumbs:X},{default:a(()=>[s("div",Ee,[s("div",he,[l(o(g),{onClick:e[0]||(e[0]=t=>b.value=!0),class:"bg-indigo-600 text-white py-2 h-10 rounded-md hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:a(()=>[l(o(Ne),{class:"h-4 w-4"}),e[14]||(e[14]=d(" Add "))]),_:1,__:[14]}),l(o(O),{modelValue:o(h),"onUpdate:modelValue":e[1]||(e[1]=t=>ge(h)?h.value=t:null),placeholder:"Search",onInput:le,class:"w-64","aria-label":"Search",disabled:o(ee)},null,8,["modelValue","disabled"])]),s("div",ze,[l(o(we),null,{default:a(()=>[l(o(ke),null,{default:a(()=>[l(o(L),{class:"bg-gray-100"},{default:a(()=>[l(o(P),null,{default:a(()=>e[15]||(e[15]=[d("ID")])),_:1,__:[15]}),l(o(P),null,{default:a(()=>e[16]||(e[16]=[d("Name")])),_:1,__:[16]}),l(o(P),null,{default:a(()=>e[17]||(e[17]=[d("Category")])),_:1,__:[17]}),l(o(P),null,{default:a(()=>e[18]||(e[18]=[d("UOM")])),_:1,__:[18]}),l(o(P),null,{default:a(()=>e[19]||(e[19]=[d("Descriptions")])),_:1,__:[19]}),l(o(P),{class:"w-24"},{default:a(()=>e[20]||(e[20]=[d("Actions")])),_:1,__:[20]})]),_:1})]),_:1}),l(o(Ce),null,{default:a(()=>[(u(!0),m(x,null,C(o(Q),t=>(u(),J(o(L),{key:t.id},{default:a(()=>[l(o(U),null,{default:a(()=>[d(v(t.id),1)]),_:2},1024),l(o(U),null,{default:a(()=>[d(v(t.name),1)]),_:2},1024),l(o(U),null,{default:a(()=>[d(v(de(t.category_id)),1)]),_:2},1024),l(o(U),null,{default:a(()=>[d(v(ue(t.uom_id)),1)]),_:2},1024),l(o(U),null,{default:a(()=>[d(v(o(je)(t.descriptions,50)),1)]),_:2},1024),l(o(U),{class:"flex gap-2"},{default:a(()=>[l(o(g),{variant:"ghost",size:"icon",onClick:f=>re(t)},{default:a(()=>[l(o(Ve),{class:"h-4 w-4"})]),_:2},1032,["onClick"]),l(o(g),{variant:"ghost",size:"icon",onClick:f=>ie(t.id)},{default:a(()=>[l(o(Te),{class:"h-4 w-4"})]),_:2},1032,["onClick"]),l(o(g),{variant:"ghost",size:"icon",onClick:f=>{p.value=!0,S.value=t.id}},{default:a(()=>[l(o(qe),{class:"h-4 w-4"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),s("div",Be,[s("button",{onClick:oe,disabled:c.value===1,class:"px-3 py-1 rounded border border-gray-300 text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed"}," Previous ",8,De),(u(!0),m(x,null,C(V.value,t=>(u(),m("button",{key:t,onClick:f=>T(t),class:ye(["px-3 py-1 rounded border text-xs",t===c.value?"bg-blue-600 border-blue-600 text-white":"border-gray-300 text-gray-700 hover:bg-gray-100"])},v(t),11,Fe))),128)),s("button",{onClick:te,disabled:c.value===V.value,class:"px-3 py-1 rounded border border-gray-300 text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed"}," Next ",8,Oe)]),p.value?(u(),m("div",Ie,[s("div",Ae,[s("div",Qe,[e[22]||(e[22]=s("h2",{class:"text-lg font-semibold"},"Upload Media",-1)),s("button",{onClick:e[2]||(e[2]=t=>p.value=!1),class:"text-gray-500 hover:text-gray-800 transition p-1 rounded-full hover:bg-gray-100","aria-label":"Tutup modal"},e[21]||(e[21]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),l(_e,{"reference-id":S.value,"reference-type":K.value},null,8,["reference-id","reference-type"]),s("div",Re,[l(o(g),{onClick:e[3]||(e[3]=t=>p.value=!1),variant:"outline"},{default:a(()=>e[23]||(e[23]=[d("Tutup")])),_:1,__:[23]})])])])):F("",!0),b.value?(u(),m("div",He,[s("div",Le,[e[32]||(e[32]=s("h2",{class:"text-lg font-semibold mb-4"},"Buat Produk Baru",-1)),s("form",{onSubmit:H(ne,["prevent"])},[s("div",We,[s("div",null,[e[25]||(e[25]=s("label",{class:"block text-xs font-medium mb-1"},"Category",-1)),q(s("select",{"onUpdate:modelValue":e[4]||(e[4]=t=>o(n).category_id=t),class:"w-full text-xs rounded-md border border-input px-3 py-2",required:""},[e[24]||(e[24]=s("option",{value:"0"},"Select Category",-1)),(u(!0),m(x,null,C(o(z),t=>(u(),m("option",{key:t.id,value:t.id},v(t.name),9,Ze))),128))],512),[[j,o(n).category_id]])]),s("div",null,[e[26]||(e[26]=s("label",{class:"block text-xs font-medium mb-1"},"Name",-1)),l(o(O),{modelValue:o(n).name,"onUpdate:modelValue":e[5]||(e[5]=t=>o(n).name=t),placeholder:"Product Name",class:"text-xs",required:""},null,8,["modelValue"])]),s("div",null,[e[28]||(e[28]=s("label",{class:"block text-xs font-medium mb-1"},"UOM",-1)),q(s("select",{"onUpdate:modelValue":e[6]||(e[6]=t=>o(n).uom_id=t),class:"w-full rounded-md border text-xs border-input px-3 py-2",required:""},[e[27]||(e[27]=s("option",{value:""},"Select UOM",-1)),(u(!0),m(x,null,C(o(B),t=>(u(),m("option",{key:t.id,value:t.id},v(t.name),9,Ge))),128))],512),[[j,o(n).uom_id]])])]),s("div",null,[e[29]||(e[29]=s("label",{class:"block text-xs font-medium mb-1"},"Description",-1)),l(o(W),{content:o(n).descriptions,"onUpdate:content":e[7]||(e[7]=t=>o(n).descriptions=t),contentType:"html",class:"w-full border-input px-3 py-2 border min-h-[50px]"},null,8,["content"])]),s("div",Je,[l(o(g),{type:"button",variant:"outline",onClick:e[8]||(e[8]=t=>b.value=!1),class:"h-10"},{default:a(()=>e[30]||(e[30]=[d("Cancel")])),_:1,__:[30]}),l(o(g),{type:"submit",class:"bg-indigo-600 text-white py-2 h-10 rounded-md hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:a(()=>e[31]||(e[31]=[d("Create")])),_:1,__:[31]})])],32)])])):F("",!0),_.value?(u(),m("div",Ke,[s("div",Xe,[e[41]||(e[41]=s("h2",{class:"text-lg font-semibold mb-4"},"Edit Product",-1)),s("form",{onSubmit:H(ae,["prevent"])},[s("div",Ye,[s("div",null,[e[34]||(e[34]=s("label",{class:"block text-xs font-medium mb-1"},"Category",-1)),q(s("select",{"onUpdate:modelValue":e[9]||(e[9]=t=>o(n).category_id=t),class:"w-full text-xs rounded-md border border-input px-3 py-2",required:""},[e[33]||(e[33]=s("option",{value:"0"},"Select Category",-1)),(u(!0),m(x,null,C(o(z),t=>(u(),m("option",{key:t.id,value:t.id},v(t.name),9,et))),128))],512),[[j,o(n).category_id]])]),s("div",null,[e[35]||(e[35]=s("label",{class:"block text-xs font-medium mb-1"},"Name",-1)),l(o(O),{modelValue:o(n).name,"onUpdate:modelValue":e[10]||(e[10]=t=>o(n).name=t),placeholder:"Product Name",class:"text-xs",required:""},null,8,["modelValue"])]),s("div",null,[e[37]||(e[37]=s("label",{class:"block text-xs font-medium mb-1"},"UOM",-1)),q(s("select",{"onUpdate:modelValue":e[11]||(e[11]=t=>o(n).uom_id=t),class:"w-full text-xs rounded-md border border-input px-3 py-2",required:""},[e[36]||(e[36]=s("option",{value:""},"Select UOM",-1)),(u(!0),m(x,null,C(o(B),t=>(u(),m("option",{key:t.id,value:t.id},v(t.name),9,tt))),128))],512),[[j,o(n).uom_id]])]),s("div",null,[e[38]||(e[38]=s("label",{class:"block text-xs font-medium mb-1"},"Description",-1)),l(o(W),{content:o(n).descriptions,"onUpdate:content":e[12]||(e[12]=t=>o(n).descriptions=t),contentType:"html",class:"w-full text-xs border-input px-3 py-2 border min-h-[50px]"},null,8,["content"])])]),s("div",ot,[l(o(g),{type:"button",variant:"outline",onClick:e[13]||(e[13]=t=>_.value=!1),class:"h-10"},{default:a(()=>e[39]||(e[39]=[d("Cancel")])),_:1,__:[39]}),l(o(g),{type:"submit",class:"bg-indigo-600 text-white py-2 h-10 rounded-md hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:a(()=>e[40]||(e[40]=[d("Update")])),_:1,__:[40]})])],32)])])):F("",!0)])]),_:1})],64))}});export{_t as default};
