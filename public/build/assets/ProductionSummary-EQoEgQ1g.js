import{_ as h}from"./Input.vue_vue_type_script_setup_true_lang-7X1Iw5-Q.js";import{d as D,r as b,o as j,c as O,f as s,g as a,p as y,u as d,Z as C,x as w,k as o,D as M,y as P,j as i,F as u,B as m,C as R}from"./app-CRsc3vDL.js";import{_ as T}from"./AppLayout.vue_vue_type_script_setup_true_lang-C_cAySyz.js";import{u as q}from"./useReportStore-Bj87L8Ku.js";import"./index-DDe_h0Gt.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CMK6FtW3.js";const B={class:"py-6 px-2 max-w-7xl mx-auto space-y-4"},N={class:"flex flex-wrap gap-2 mb-4 items-end"},A={key:0,class:"py-4 text-center text-gray-500"},E={key:1,class:"py-4 text-center text-red-500"},F={key:2,class:"overflow-x-auto bg-white shadow rounded-lg"},U={class:"min-w-full text-sm text-gray-800"},$={class:"bg-gray-50 font-semibold text-xs uppercase text-gray-600"},I={class:"bg-gray-100 font-semibold hover:bg-gray-200"},L={class:"px-3 py-2",colspan:"2"},G={class:"px-3 py-1 align-top"},K={class:"px-3 py-1 align-top min-w-[200px]"},Q={key:0,class:"flex flex-col gap-1 rounded-lg border border-gray-200 bg-gray-50 p-1 text-[11px] text-gray-700"},Y={class:"font-semibold"},Z={class:"bg-gray-50 font-semibold text-xs text-gray-600"},se=D({__name:"ProductionSummary",setup(H){const c=q(),x=b(""),g=b(""),f=b(""),S=[{title:"Production Summary",href:"/reports/production-summary"}],k=()=>{c.fetchProductionSummary(x.value,g.value,f.value)};j(()=>{const r=new Date,e=new Date(r.getFullYear(),r.getMonth(),1);x.value=e.toISOString().split("T")[0],g.value=r.toISOString().split("T")[0],k()});const _=O(()=>{const r=new Map;return Object.values(c.productionSummary).forEach(e=>{Object.values(e.activities??{}).forEach(t=>{r.has(t.name)||r.set(t.name,t.name)})}),Array.from(r.entries()).map(([e])=>({id:e,name:e}))}),V=(r,e)=>r.activity_role_name===e?r.total_qty:0;return(r,e)=>(a(),s(u,null,[y(d(C),{title:"Production Summary Report"}),y(T,{breadcrumbs:S},{header:w(()=>e[3]||(e[3]=[o("h2",{class:"text-xl font-semibold text-gray-800"},"Production Summary Report",-1)])),default:w(()=>[o("div",B,[o("div",N,[y(d(h),{type:"date",modelValue:x.value,"onUpdate:modelValue":e[0]||(e[0]=t=>x.value=t),class:"w-40"},null,8,["modelValue"]),y(d(h),{type:"date",modelValue:g.value,"onUpdate:modelValue":e[1]||(e[1]=t=>g.value=t),class:"w-40"},null,8,["modelValue"]),y(d(h),{type:"text",modelValue:f.value,"onUpdate:modelValue":e[2]||(e[2]=t=>f.value=t),placeholder:"Search Model / Activity",class:"flex-1 min-w-[200px]"},null,8,["modelValue"]),y(d(M),{class:"bg-indigo-600 text-white h-10 hover:bg-indigo-700",onClick:k},{default:w(()=>e[4]||(e[4]=[P("Tampilkan")])),_:1,__:[4]})]),d(c).loading?(a(),s("div",A,"Loading...")):d(c).error?(a(),s("div",E,i(d(c).error.message),1)):(a(),s("div",F,[o("table",U,[o("thead",$,[o("tr",null,[e[5]||(e[5]=o("th",{class:"px-3 py-2",colspan:"2"},"Model",-1)),(a(!0),s(u,null,m(_.value,t=>(a(),s("th",{key:"header-role-"+t.id,class:"px-2 py-1 text-center"},i(t.name),1))),128))])]),o("tbody",null,[(a(!0),s(u,null,m(d(c).productionSummary,t=>(a(),s(u,{key:t.model_id},[o("tr",I,[o("td",L,i(t.description),1),(a(!0),s(u,null,m(_.value,l=>{var p;return a(),s("td",{key:"summary-"+l.id+"-"+t.model_id,class:"px-2 py-1 text-center"},i(((p=Object.values(t.activities).find(n=>n.name===l.name))==null?void 0:p.qty)??"-"),1)}),128))]),(a(!0),s(u,null,m(t.details,l=>{var p;return a(),s("tr",{key:l.production_id,class:"hover:bg-gray-50"},[o("td",G,i(l.employee_name),1),o("td",K,[(p=l.items)!=null&&p.length?(a(),s("div",Q,[(a(!0),s(u,null,m(l.items,(n,v)=>(a(),s("div",{key:v,class:"flex items-center justify-between rounded-md bg-white px-1.5 py-0.5 shadow-sm"},[o("span",null,i(n.size_id)+" - "+i(n.variant),1),o("span",Y,i(n.qty),1)]))),128))])):R("",!0)]),(a(!0),s(u,null,m(_.value,n=>(a(),s("td",{key:"detail-"+n.id+"-"+l.production_id,class:"px-2 py-1 text-center align-top"},i(V(l,n.name)||"-"),1))),128))])}),128))],64))),128))]),o("tfoot",Z,[o("tr",null,[e[6]||(e[6]=o("td",{colspan:"2",class:"px-3 py-2 text-right"},"Grand Total:",-1)),(a(!0),s(u,null,m(_.value,t=>(a(),s("td",{key:"footer-role-"+t.id,class:"px-2 py-1 text-center"},i(Object.values(d(c).productionSummary).reduce((l,p)=>{var n;return l+(((n=Object.values(p.activities).find(v=>v.name===t.name))==null?void 0:n.qty)??0)},0)),1))),128))])])])]))])]),_:1})],64))}});export{se as default};
