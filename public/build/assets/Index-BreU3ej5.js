import{M as H,b as w,d as J,q as Q,r as U,o as W,f as y,g as _,p as s,u as t,Z as X,x as r,k as d,C as q,D as v,y as m,F as N,B as M,E as j,j as V,z as ee,K as T,l as z,O as F}from"./app-Bj_kpMHq.js";import{_ as te}from"./AppLayout.vue_vue_type_script_setup_true_lang-C-B5aa47.js";import{_ as g}from"./Input.vue_vue_type_script_setup_true_lang-DJN7_ygH.js";import{_ as ae,a as se,b as I,c as x,d as le,e as k}from"./TableRow.vue_vue_type_script_setup_true_lang-2xZ4sEoC.js";import{u as re}from"./useToast-BKXtDSru.js";import{P as oe}from"./plus-4gLNPrRh.js";import{S as ie}from"./square-pen-BhOOfFiO.js";import{T as ne}from"./trash-2-CS0YxO6-.js";import"./index-DYrEdJEX.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CFabbRMa.js";const de=H("customer",{state:()=>({customers:[],customer:null,loading:!1,error:null,total:0,currentPage:1,lastPage:1}),actions:{async fetchCustomers(f=1,n=10,o=""){var i,u;this.loading=!0;try{const b=new URLSearchParams({page:f.toString(),perPage:n.toString()});o&&b.append("name",o);const c=await w.get(`/api/customers?${b}`);this.customers=c.data.data,this.total=c.data.total,this.currentPage=c.data.current_page,this.lastPage=c.data.last_page,this.error=null}catch(b){this.error=((u=(i=b.response)==null?void 0:i.data)==null?void 0:u.message)||"Error fetching customers"}finally{this.loading=!1}},async fetchCustomer(f){var n,o;this.loading=!0;try{const i=await w.get(`/api/customers/${f}`);this.customer=i.data,this.error=null}catch(i){throw this.error=((o=(n=i.response)==null?void 0:n.data)==null?void 0:o.message)||"Error fetching customer",i}finally{this.loading=!1}},async createCustomer(f){var n,o;this.loading=!0;try{const i=await w.post("/api/customers",f);return this.error=null,i.data}catch(i){throw this.error=((o=(n=i.response)==null?void 0:n.data)==null?void 0:o.message)||"Error creating customer",i}finally{this.loading=!1}},async updateCustomer(f,n){var o,i;this.loading=!0;try{const u=await w.put(`/api/customers/${f}`,n);return this.error=null,u.data}catch(u){throw this.error=((i=(o=u.response)==null?void 0:o.data)==null?void 0:i.message)||"Error updating customer",u}finally{this.loading=!1}},async deleteCustomer(f){var n,o;this.loading=!0;try{await w.delete(`/api/customers/${f}`),this.customers=this.customers.filter(i=>i.id!==f),this.error=null}catch(i){throw this.error=((o=(n=i.response)==null?void 0:n.data)==null?void 0:o.message)||"Error deleting customer",i}finally{this.loading=!1}}}}),ue={class:"px-4 py-4"},me={class:"flex justify-between items-center mb-4"},ce={class:"rounded-md border"},pe={key:0,class:"text-center py-4 text-gray-500"},fe={key:1,class:"text-center py-4 text-gray-500"},ve={class:"flex justify-end mt-4 space-x-2"},_e={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},ge={class:"bg-white p-6 rounded-lg w-96"},be={class:"flex justify-end gap-2 pt-2"},ye={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},he={class:"bg-white p-6 rounded-lg w-96"},Ce={class:"flex justify-end gap-2 pt-2"},h=10,Ne=J({__name:"Index",setup(f){const n=re(),o=de(),{customers:i,currentPage:u,lastPage:b,loading:c}=Q(o),P=U(""),$=U(!1),S=U(!1),Y=[{title:"Customer",href:"/Customers"}],l=U({id:0,name:"",phone_number:"",address:"",credit_limit:0,is_active:"Y"}),A=()=>{l.value={id:0,name:"",phone_number:"",address:"",credit_limit:0,is_active:"Y"}};W(()=>{o.fetchCustomers(u.value,h)});const B=async()=>{await o.fetchCustomers(1,h,P.value)},E=async p=>{p<1||p>b.value||await o.fetchCustomers(p,h,P.value)},D=()=>E(u.value+1),L=()=>E(u.value-1),R=()=>{A(),$.value=!0},K=p=>{l.value={...p},S.value=!0},O=async()=>{var p,e;try{const{...a}=l.value;await o.createCustomer(a),n.success("Customer created"),A(),$.value=!1,await o.fetchCustomers(u.value,h)}catch(a){console.error(a),n.error(((e=(p=a.response)==null?void 0:p.data)==null?void 0:e.message)||"Failed to create customer")}},Z=async()=>{var p,e;try{if(!l.value.id)throw new Error("Customer ID is required for update");await o.updateCustomer(l.value.id,{name:l.value.name,phone_number:l.value.phone_number,address:l.value.address,credit_limit:l.value.credit_limit,is_active:l.value.is_active}),n.success("Customer updated"),S.value=!1,await o.fetchCustomers(u.value,h)}catch(a){console.error(a),n.error(((e=(p=a.response)==null?void 0:p.data)==null?void 0:e.message)||"Failed to update customer")}},G=async p=>{var e,a;if(confirm("Are you sure you want to delete this customer?"))try{await o.deleteCustomer(p),n.success("Customer deleted"),await o.fetchCustomers(u.value,h)}catch(C){console.error(C),n.error(((a=(e=C.response)==null?void 0:e.data)==null?void 0:a.message)||"Failed to delete customer")}};return(p,e)=>(_(),y(N,null,[s(t(X),{title:"Customer Management"}),s(te,{breadcrumbs:Y},{default:r(()=>[d("div",ue,[d("div",me,[s(t(v),{onClick:R,disabled:t(c),class:"bg-indigo-600 text-white py-2 h-10 rounded-md hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500"},{default:r(()=>[s(t(oe),{class:"h-4 w-4 mr-1"}),e[13]||(e[13]=m(" Tambah "))]),_:1,__:[13]},8,["disabled"]),s(t(g),{modelValue:P.value,"onUpdate:modelValue":e[0]||(e[0]=a=>P.value=a),placeholder:"Search customer name",class:"w-64",onInput:B,disabled:t(c)},null,8,["modelValue","disabled"])]),d("div",ce,[s(t(ae),null,{default:r(()=>[s(t(se),null,{default:r(()=>[s(t(I),{class:"bg-gray-100"},{default:r(()=>[s(t(x),null,{default:r(()=>e[14]||(e[14]=[m("Name")])),_:1,__:[14]}),s(t(x),null,{default:r(()=>e[15]||(e[15]=[m("Phone")])),_:1,__:[15]}),s(t(x),null,{default:r(()=>e[16]||(e[16]=[m("Address")])),_:1,__:[16]}),s(t(x),null,{default:r(()=>e[17]||(e[17]=[m("Status")])),_:1,__:[17]}),s(t(x),{class:"w-24"},{default:r(()=>e[18]||(e[18]=[m("Actions")])),_:1,__:[18]})]),_:1})]),_:1}),s(t(le),null,{default:r(()=>[(_(!0),y(N,null,M(t(i),a=>(_(),j(t(I),{key:a.id},{default:r(()=>[s(t(k),null,{default:r(()=>[m(V(a.name),1)]),_:2},1024),s(t(k),null,{default:r(()=>[m(V(a.phone_number),1)]),_:2},1024),s(t(k),null,{default:r(()=>[m(V(a.address),1)]),_:2},1024),s(t(k),null,{default:r(()=>[d("span",{class:ee(a.is_active==="Y"?"text-green-600":"text-red-500")},V(a.is_active==="Y"?"Active":"Inactive"),3)]),_:2},1024),s(t(k),{class:"flex gap-2"},{default:r(()=>[s(t(v),{variant:"ghost",size:"icon",onClick:C=>K(a)},{default:r(()=>[s(t(ie),{class:"h-4 w-4"})]),_:2},1032,["onClick"]),s(t(v),{variant:"ghost",size:"icon",onClick:C=>G(a.id),disabled:t(c)},{default:r(()=>[s(t(ne),{class:"h-4 w-4"})]),_:2},1032,["onClick","disabled"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),t(c)?(_(),y("div",pe,"Loading...")):q("",!0),!t(c)&&t(i).length===0?(_(),y("div",fe,"No customers found.")):q("",!0)]),d("div",ve,[s(t(v),{variant:"outline",onClick:L,disabled:t(u)===1||t(c)},{default:r(()=>e[19]||(e[19]=[m("Previous")])),_:1,__:[19]},8,["disabled"]),(_(!0),y(N,null,M(t(b),a=>(_(),j(t(v),{key:a,onClick:C=>E(a),variant:a===t(u)?"default":"outline",disabled:t(c)},{default:r(()=>[m(V(a),1)]),_:2},1032,["onClick","variant","disabled"]))),128)),s(t(v),{variant:"outline",onClick:D,disabled:t(u)===t(b)||t(c)},{default:r(()=>e[20]||(e[20]=[m("Next")])),_:1,__:[20]},8,["disabled"])]),$.value?(_(),y("div",_e,[d("div",ge,[e[24]||(e[24]=d("h2",{class:"text-lg font-semibold mb-4"},"Add Customer",-1)),d("form",{onSubmit:T(O,["prevent"]),class:"space-y-3"},[s(t(g),{modelValue:l.value.name,"onUpdate:modelValue":e[1]||(e[1]=a=>l.value.name=a),placeholder:"Name",required:""},null,8,["modelValue"]),s(t(g),{modelValue:l.value.phone_number,"onUpdate:modelValue":e[2]||(e[2]=a=>l.value.phone_number=a),placeholder:"Phone",required:""},null,8,["modelValue"]),s(t(g),{modelValue:l.value.address,"onUpdate:modelValue":e[3]||(e[3]=a=>l.value.address=a),placeholder:"Address",required:""},null,8,["modelValue"]),s(t(g),{modelValue:l.value.credit_limit,"onUpdate:modelValue":e[4]||(e[4]=a=>l.value.credit_limit=a),placeholder:"Credit Limit",type:"number",required:""},null,8,["modelValue"]),z(d("select",{"onUpdate:modelValue":e[5]||(e[5]=a=>l.value.is_active=a),class:"w-full border rounded px-2 py-1"},e[21]||(e[21]=[d("option",{value:"Y"},"Active",-1),d("option",{value:"N"},"Inactive",-1)]),512),[[F,l.value.is_active]]),d("div",be,[s(t(v),{type:"button",variant:"outline",onClick:e[6]||(e[6]=a=>$.value=!1),class:"h-10"},{default:r(()=>e[22]||(e[22]=[m("Cancel")])),_:1,__:[22]}),s(t(v),{type:"submit",disabled:t(c)},{default:r(()=>e[23]||(e[23]=[m("Create")])),_:1,__:[23]},8,["disabled"])])],32)])])):q("",!0),S.value?(_(),y("div",ye,[d("div",he,[e[28]||(e[28]=d("h2",{class:"text-lg font-semibold mb-4"},"Edit Customer",-1)),d("form",{onSubmit:T(Z,["prevent"]),class:"space-y-3"},[s(t(g),{modelValue:l.value.name,"onUpdate:modelValue":e[7]||(e[7]=a=>l.value.name=a),placeholder:"Name",required:""},null,8,["modelValue"]),s(t(g),{modelValue:l.value.phone_number,"onUpdate:modelValue":e[8]||(e[8]=a=>l.value.phone_number=a),placeholder:"Phone",required:""},null,8,["modelValue"]),s(t(g),{modelValue:l.value.address,"onUpdate:modelValue":e[9]||(e[9]=a=>l.value.address=a),placeholder:"Address",required:""},null,8,["modelValue"]),s(t(g),{modelValue:l.value.credit_limit,"onUpdate:modelValue":e[10]||(e[10]=a=>l.value.credit_limit=a),placeholder:"Credit Limit",type:"number",required:""},null,8,["modelValue"]),z(d("select",{"onUpdate:modelValue":e[11]||(e[11]=a=>l.value.is_active=a),class:"w-full border rounded px-2 py-1"},e[25]||(e[25]=[d("option",{value:"Y"},"Active",-1),d("option",{value:"N"},"Inactive",-1)]),512),[[F,l.value.is_active]]),d("div",Ce,[s(t(v),{type:"button",variant:"outline",onClick:e[12]||(e[12]=a=>S.value=!1),class:"h-10"},{default:r(()=>e[26]||(e[26]=[m("Cancel")])),_:1,__:[26]}),s(t(v),{type:"submit",disabled:t(c)},{default:r(()=>e[27]||(e[27]=[m("Update")])),_:1,__:[27]},8,["disabled"])])],32)])])):q("",!0)])]),_:1})],64))}});export{Ne as default};
